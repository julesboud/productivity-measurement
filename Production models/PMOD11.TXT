*THIS IS PMOD11.TXT:                                                                               JUNE 19, 2019
*IN THIS RUN WE ESTIMATE AN NQ COST FUNCTION WITH A RANK 4 SUBSTITUTION MATRIX WITH SINGLE TIME TRENDS FOR TECHNICAL PROGRESS
*IN THIS RUN WE ALLOW FOR LINEAR TIME TRENDS FOR THE C, D, F AND H VECTORS IN THE SUBSTITUTION MATRIX 
*READ IN YOUR DATA FROM THE END OF DATOUT.TXT.
*1=CONSUMPTION,2=GOVERNENT,3=GROSS INVESTMENT,4=EXPORTS,5=-IMPORTS,6=-LABOUR,7=CAPITAL SERVICES.
SIZE 10000
PAR 10000
SET NODOECHO
*READ IN OUR PRODUCTION DATA FROM DATOUT.TXT
*YOUR SMPL STATEMENT MAY BE DIFFERENT!
SMPL 1 59
READ YEAR Y1-Y6 QKS
   1960.    26.3291     5.8275     9.8194     6.7505    -7.3855   -22.8392    15.3102
   1961.    26.6542     6.5768     9.4772     7.1975    -7.3855   -23.1658    15.8170
   1962.    28.0356     6.9110    10.5019     7.5312    -7.5519   -23.8817    16.2360
   1963.    29.1733     7.2484    10.8989     8.1945    -7.6852   -24.3020    16.7382
   1964.    30.7173     7.6818    12.0890     9.3073    -8.6546   -25.1535    17.2206
   1965.    32.5863     8.0263    13.9418     9.7265    -9.8109   -26.0396    17.8583
   1966.    34.1303     8.7091    15.2896    11.0036   -11.1150   -27.0978    18.7336
   1967.    35.4305     9.4369    14.3780    12.1846   -11.7243   -27.8731    19.7464
   1968.    36.9745    10.0417    14.9307    13.6826   -12.9179   -28.0557    20.5773
   1969.    38.6810    10.5265    16.1755    14.7757   -14.6399   -28.7721    21.4194
   1970.    39.3311    11.3602    15.2833    16.1311   -14.4145   -28.9216    22.3925
   1971.    41.6013    11.7473    16.4598    16.9161   -15.3679   -29.3850    23.1167
   1972.    44.4545    12.1412    17.3892    18.3771   -17.5684   -30.1761    23.9721
   1973.    47.4473    12.7060    19.3790    20.2311   -20.1006   -31.6326    24.9239
   1974.    49.8181    13.4434    21.0395    19.3183   -22.1271   -32.8131    26.0882
   1975.    51.7206    14.2986    20.4534    17.7156   -21.4833   -33.0545    27.4393
   1976.    54.3728    14.5120    22.3489    19.0918   -22.7999   -33.4266    28.6540
   1977.    55.8839    15.0599    22.6205    20.3166   -22.7167   -33.5441    30.0210
   1978.    57.5511    15.2098    22.6305    22.3415   -23.4307   -34.5975    31.3304
   1979.    58.8683    15.3365    25.3592    23.1841   -25.1098   -36.2242    32.5554
   1980.    59.8734    15.7450    24.7267    23.4320   -24.3383   -37.0969    34.0615
   1981.    60.5903    16.0256    27.5354    23.8102   -24.8282   -37.5278    35.3290
   1982.    59.0380    16.2152    21.4347    23.4788   -20.8857   -35.7933    36.8818
   1983.    60.5145    16.3912    23.2062    24.8339   -22.9956   -35.8113    37.3977
   1984.    62.8379    16.7613    25.6319    29.4589   -26.9925   -36.9227    38.0997
   1985.    65.9172    17.4282    27.8113    30.7788   -29.2221   -38.1872    39.0750
   1986.    68.1726    17.7128    28.6506    32.1621   -31.1418   -39.4162    40.2604
   1987.    70.8153    17.9660    30.7683    33.1867   -32.8232   -40.6935    41.4866
   1988.    73.7400    18.4907    34.3823    36.2053   -37.2626   -41.9086    42.9731
   1989.    76.2601    18.9458    35.7844    36.5090   -39.4265   -42.7031    44.8831
   1990.    77.3115    19.5666    32.9745    38.1600   -40.1900   -42.8023    46.8484
   1991.    76.4567    20.0274    30.7081    38.7719   -41.1977   -41.5037    48.2202
   1992.    77.6407    20.1903    29.6036    41.6498   -43.3076   -41.0117    49.1649
   1993.    79.0775    20.1499    30.5640    46.1561   -46.5462   -41.1079    49.8542
   1994.    81.3605    19.9211    33.1391    52.0774   -50.4057   -42.1546    50.6363
   1995.    83.1793    19.7232    34.3116    56.6969   -53.3182   -42.8325    51.7248
   1996.    85.6472    19.3469    34.5787    59.9433   -56.1757   -43.4991    52.8515
   1997.    89.8392    19.2318    40.1057    65.0927   -64.2451   -44.2165    53.8539
   1998.    92.3073    19.6017    40.5567    71.2875   -67.6481   -45.1306    55.5214
   1999.    95.9495    20.0260    42.6630    79.0019   -73.1014   -46.3354    57.0386
   2000.    99.8447    20.7142    46.0201    86.1484   -79.3120   -47.4912    58.6621
   2001.   102.2780    21.4196    44.7693    83.5908   -75.3965   -47.9471    60.5421
   2002.   106.3654    21.9041    45.7734    84.5857   -76.7693   -48.6128    62.0020
   2003.   109.2856    22.5350    49.8427    83.1247   -80.0149   -49.5328    63.5025
   2004.   112.6095    22.9576    54.1342    87.7231   -86.7951   -50.7605    65.5316
   2005.   117.0342    23.2017    59.7677    89.6708   -93.1403   -51.0538    68.1207
   2006.   121.9331    23.8402    63.1941    90.4487   -98.0782   -51.8495    71.3525
   2007.   127.2912    24.4063    64.7735    91.4822  -103.7161   -52.7713    74.8998
   2008.   131.0613    25.3243    65.9131    87.3253  -104.6073   -53.1864    78.5030
   2009.   131.1314    26.0072    56.1025    76.0019   -91.5938   -51.1343    81.9849
   2010.   135.8272    26.5926    63.6071    81.0475  -104.2033   -52.0037    83.8339
   2011.   138.9496    26.9413    68.3107    84.9106  -110.0108   -52.6904    86.7752
   2012.   141.6134    27.1293    70.8102    87.2596  -114.0781   -53.6777    90.2802
   2013.   145.3221    26.9149    72.8651    89.3414  -116.3441   -54.2857    93.9801
   2014.   149.0919    27.0637    73.7717    94.9089  -119.1989   -54.4655    97.7352
   2015.   152.5129    27.4325    68.5738    98.1056  -119.9171   -55.1570   101.5438
   2016.   155.9334    27.9376    65.5716    99.4050  -119.9134   -55.3865   104.3763
   2017.   161.3917    28.5321    70.0298   100.5152  -124.9652   -55.9555   106.7218
   2018.   164.7692    29.2489    69.9178   103.8092  -128.5486   -56.5946   109.8085
*NOTE Y5 AND Y6 SHOULD BE NEGATIVE
FORMAT(F8.0,7F11.4)
PRINT YEAR Y1-Y6 QKS / FORMAT
READ YEAR P1-P6 PKS 
   1960.   0.89773   1.00000   1.00000   1.00000   1.06756   1.00000   1.00000
   1961.   0.89406   1.03759   0.99259   1.01562   1.09436   1.03783   0.96396
   1962.   0.89892   1.06873   0.99925   1.05575   1.14531   1.07745   1.02562
   1963.   0.91206   1.10010   1.02845   1.06535   1.17343   1.12623   1.08333
   1964.   0.91637   1.13763   1.05964   1.08914   1.18224   1.13993   1.21536
   1965.   0.92881   1.19782   1.11629   1.10790   1.18695   1.26369   1.21335
   1966.   0.96463   1.29635   1.16962   1.14308   1.21241   1.36296   1.29526
   1967.   1.00397   1.38287   1.20580   1.16253   1.22609   1.46402   1.26310
   1968.   1.04758   1.47604   1.22064   1.18143   1.25516   1.57377   1.34024
   1969.   1.08730   1.59531   1.27829   1.20617   1.28478   1.71252   1.36642
   1970.   1.12923   1.71713   1.33401   1.24790   1.31257   1.83811   1.44504
   1971.   1.15718   1.82561   1.41138   1.24839   1.35308   1.98098   1.51103
   1972.   1.20991   1.96554   1.49374   1.29656   1.38653   2.15391   1.58919
   1973.   1.28490   2.13364   1.65426   1.46369   1.48518   2.35356   1.82326
   1974.   1.44942   2.44945   1.93407   1.86865   1.79576   2.70429   2.04906
   1975.   1.65765   2.78712   2.15431   2.13925   2.06156   3.12912   2.18034
   1976.   1.77151   3.12528   2.29680   2.28642   2.11659   3.56607   2.41501
   1977.   1.91431   3.39763   2.42453   2.50194   2.39397   3.93488   2.57977
   1978.   2.07924   3.63897   2.59791   2.73290   2.71434   4.15447   2.79366
   1979.   2.27931   3.98494   2.83243   3.21207   3.06781   4.46399   3.15937
   1980.   2.52763   4.38464   3.08743   3.73553   3.53846   4.91796   3.39638
   1981.   2.74708   4.91939   3.38401   4.04099   3.95426   5.56273   3.61587
   1982.   3.01638   5.49390   3.60822   4.14727   4.11756   6.24893   3.58475
   1983.   3.26127   5.82635   3.67125   4.21319   4.13814   6.56162   4.07891
   1984.   3.41848   6.07350   3.77787   4.35662   4.34065   6.86016   4.49672
   1985.   3.55972   6.32756   3.87159   4.46287   4.46402   7.16425   4.75829
   1986.   3.73458   6.56857   3.98508   4.41701   4.54393   7.37589   4.84206
   1987.   3.85586   6.87489   4.13981   4.49783   4.48351   7.76067   5.06764
   1988.   4.01147   7.16083   4.28586   4.50810   4.37933   8.26106   5.33811
   1989.   4.15743   7.57466   4.43099   4.60311   4.37871   8.73799   5.37826
   1990.   4.36741   8.03974   4.49350   4.56465   4.41114   9.19693   5.25920
   1991.   4.59609   8.41563   4.42007   4.40139   4.33221   9.77799   5.01921
   1992.   4.65546   8.69817   4.45994   4.51208   4.48891  10.15719   5.00482
   1993.   4.72635   8.85551   4.51561   4.71053   4.74804  10.35248   5.23625
   1994.   4.76954   9.01570   4.66404   4.97955   5.03493  10.38077   5.73014
   1995.   4.82523   9.13223   4.69727   5.28907   5.19419  10.53928   6.07353
   1996.   4.90363   9.22659   4.70656   5.31574   5.12027  10.68002   6.19985
   1997.   4.97151   9.36202   4.79795   5.30675   5.15076  11.12098   6.34864
   1998.   5.01776   9.51809   4.88055   5.27519   5.32223  11.51246   6.19830
   1999.   5.09405   9.72422   4.88667   5.33407   5.30013  11.78906   6.65678
   2000.   5.20488  10.20213   4.95455   5.67018   5.40961  12.45550   7.27764
   2001.   5.36642  10.42459   5.02903   5.74611   5.54572  12.78581   7.37429
   2002.   5.42990  10.77862   5.14766   5.64085   5.57733  13.08859   7.45088
   2003.   5.55648  11.07814   5.15229   5.55131   5.20113  13.36237   7.82806
   2004.   5.63263  11.29755   5.27608   5.66995   5.08295  13.75425   8.19918
   2005.   5.74221  11.68784   5.38303   5.82591   5.04749  14.43864   8.51556
   2006.   5.83330  12.08347   5.58802   5.83938   5.00759  15.10787   8.49538
   2007.   5.93187  12.44381   5.82314   5.88460   4.90107  15.77466   8.45843
   2008.   6.10028  12.90299   6.05177   6.50737   5.19288  16.34323   8.67442
   2009.   6.11949  13.27081   6.15048   5.87593   5.16276  16.86988   7.36388
   2010.   6.19963  13.45454   6.15058   5.97304   4.97920  17.09071   7.96290
   2011.   6.33471  13.92438   6.27225   6.38251   5.14857  17.75379   8.34221
   2012.   6.40844  14.18283   6.41689   6.32438   5.18093  18.20148   8.09136
   2013.   6.50498  14.63310   6.50251   6.42089   5.22749  18.72902   8.10508
   2014.   6.62072  14.93871   6.72487   6.62674   5.47099  19.38208   8.27383
   2015.   6.68082  15.14847   6.92227   6.41264   5.69979  19.66401   7.58455
   2016.   6.73839  15.25836   7.07671   6.36223   5.72594  19.57259   7.69156
   2017.   6.80166  15.52044   7.20034   6.61365   5.76175  20.17641   8.06372
   2018.   6.91795  15.78956   7.30232   6.80185   5.90538  20.85639   8.00359
FORMAT(F8.0,7F10.5)
PRINT YEAR P1-P6 PKS / FORMAT
*NORMALIZE PRICES SO THAT ALL PRICES EQUAL ONE IN 1960
DO #=1,6
GENR CON#=P#(1)
ENDO
DO #=1,6
GENR P#=P#/CON#
GENR Y#=Y#*CON#
ENDO 
FORMAT(F8.0,7F10.5)
PRINT YEAR P1-P6 PKS / FORMAT
FORMAT(F8.0,7F11.3)
PRINT YEAR Y1-Y6 QKS / FORMAT
*SEE IF THE VALUE OF INPUTS IS EQUAL TO THE VALUE OF OUTPUTS
GENR CHECK=P1*Y1+P2*Y2+P3*Y3+P4*Y4+P5*Y5+P6*Y6-PKS*QKS
FORMAT(F8.0,F10.5)
PRINT YEAR CHECK / FORMAT
STAT CHECK
*THE MIN AND MAX FOR CHECK SHOULD BE 0 AND IT IS EXCEPT FOR ROUNDING ERRORS
*P1 IS THE PRICE OF CONSUMPTION, P2 IS THE PRICE OF GOVT OUTPUT, P3 IS THE PRICE OF INVESTMENT
*P4 IS THE PRICE OF EXPORTS, P5 IS THE PRICE OF IMPORTS, P6 IS THE PRICE OF LABOUR 
*PKS IS THE (GROSS) PRICE OF CAPITAL SERVICES (INCLUDES DEPRECIATION) AND Y1,Y2,Y3,Y4,Y5,Y6 AND QKS ARE THE 
*CORRESPONDING QUANTITIES (Y5 AND Y6 ARE NEGATIVE).
*GENR GROSS PROFITS, V
GENR V=P1*Y1+P2*Y2+P3*Y3+P4*Y4+P5*Y5+P6*Y6
GENR PK=PKS
GENR K=QKS
*GENR ALSO VK, THE VALUE OF CAPITAL SERVICES. V AND VK SHOULD BE EQUAL SINCE WE HAVE USED BALANCING REAL RATES OF RETURN
GENR VK=PK*K
FORMAT(F6.0,3F12.3,F12.5)
PRINT YEAR V VK K PK / FORMAT
STAT V VK
*THERE IS A BIT OF ROUNDING ERROR BUT BASICALLY V AND VK ARE EQUAL.
GENR T=TIME(-1)
***
*GENR VARIABLES FOR THE NQ MODEL
*GENR THE AVERAGE VARIABLE OUTPUT AND INPUT QUANTITY VECTOR; WE WILL USE A NORMALIZATION OF THIS VECTOR AS OUR ALPHA VECTOR. 
SMPL 1 59
DO #=1,6
STAT Y# / MEAN=YM#
ENDO
*CHANGE THE SIGNS OF YM5 AND YM6 FROM NEGATIVE TO POSITIVE
SMPL 1 1
GENR YM5=-YM5
GENR YM6=-YM6
GENR YMT=0
DO #=1,6
GENR YMT=YMT+YM#
ENDO
SMPL 1 59;
DO #=1,6
GENR GG#=YM#(1)/YMT(1)
ENDO
FORMAT(13F9.4)
SMPL 1 1
PRINT YM1-YM6 YMT GG1-GG6 / FORMAT
*NOTE THAT THE GG# SUM TO 1; THE GG VECTOR IS OUR ALPHA VECTOR FOR THE NORMALIZED QUADRATIC FUNCTIONAL FORM
SMPL 1 59
DO #=1,6
GENR PG#=P#*GG#
ENDO
GENR PG=0
DO#=1,6
GENR PG=PG+PG#
ENDO
*PG IS THE INNER PRODUCT OF THE PRICE VECTOR p WITH THE ALPHA VECTOR IN THE NQ FUNCTIONAL FORM. IT SHOULD START OFF AT 1
*WHICH IT DOES.
*GENR NORMALIZED PRICES v = p/p.g; I.E., PRICES p DIVIDED BY PG = p.g
DO #=1,6
GENR V#=P#/PG
ENDO
FORMAT(F8.0,7F10.4)
PRINT YEAR PG V1-V6 / FORMAT
*GENR DIFFERENCES OF NORMALIZED PRICES WITH THE FIRST NORMALIZED INPUT PRICE
DO #=1,6
GENR V1#=V#-V1
ENDO
*GENR DIFFERENCES OF NORMALIZED PRICES WITH THE SECOND NORMALIZED INPUT PRICE
DO #=2,6
GENR V2#=V#-V2
ENDO
*GENR DIFFERENCES OF NORMALIZED PRICES WITH THE THIRD NORMALIZED INPUT PRICE
DO #=3,6
GENR V3#=V#-V3
ENDO
*GENR DIFFERENCES OF NORMALIZED PRICES WITH THE FOURTH NORMALIZED INPUT PRICE
DO #=4,6
GENR V4#=V#-V4
ENDO
*OUR NQ UNIT PROFIT FUNCTION WITH A RANK ONE SUBSTITUTION MATRIX IS EQUAL TO P(p) DEFINED AS FOLLOWS:
*P(p) = a.p + b.pt + (1/2)(p.c)(p.c)/p.g
*WHERE a.p = SUM(i=1,6)a(i)p(i); p.c = SUM(i=1,6)p(i)c(i) and p.g = SUM(i=1,6)p(i)g(i) AND
*b.p = SUM(i=1,6)b(i)p(i).
*DENOTE THE VECTOR OF FIRST ORDER PARTIAL DERIVATIVES OF P(p) as DP(p). IT IS EQUAL TO:
*DP(p) = a + bt + c(c.v) - (1/2)g(c.v)(c.v)
*WHERE v = p/p.g.
*WE ALSO NEED TO IMPOSE THE FOLLOWING RESTRICTION ON THE COLUMN VECTOR c: C.1 = 0 WHERE 1 = A VECTOR OF ONES
*WE SET c(1) = -SUM(n=2,6)c(n). THEREFORE c.v = SUM(n=2,6)c(n)(v(n)-v(1)) = SUM(n=2,6)c(n)V1#

*FOR THE RANK 2 SUBSTITUTION MATRIX, WE ADD THE TERM (1/2)(p.d)(p.d)/p.g TO THE UNIT COST FUNCTION.
*WE SET THE FIRST COMPONENT OF THE VECTOR d EQUAL TO 0 SO THAT d(1) = 0 (FOR IDENTIFICATION)
*WE ALSO SET d(2)=-SUM(n=3,6)d(n)

*FOR THE RANK 3 SUBSTITUTION MATRIX, WE ADD THE TERM (1/2)(p.f)(p.f)/p.g TO THE UNIT COST FUNCTION.
*WE SET THE FIRST 2 COMPONENTS OF THE VECTOR f EQUAL TO 0 SO THAT f(1)=f(2)=0 (FOR IDENTIFICATION)
*WE ALSO SET f(3)=-SUM(n=4,6)f(n)

*FOR THE RANK 4 SUBSTITUTION MATRIX, WE ADD THE TERM - (1/2)(p.h)(p.h)/p.g TO THE UNIT COST FUNCTION.
*WE SET THE FIRST 3 COMPONENTS OF THE VECTOR h EQUAL TO 0 SO THAT h(1)=h(2)=h(3)=0 (FOR IDENTIFICATION)
*WE ALSO SET h(4)=-SUM(n=5,6)h(n)

*GENR A NORMALIZED TIME TREND VARIABLE W WHICH STARTS AT 0 FOR OBS 1 AND TRENDS LINEARLY TO END UP AT 1 AT OBS 59 
GENR W=T/58
*NOTE THAT THE STARTING COEFs FOR THE FF# ARE SET EQUAL TO THE FINAL F# FROM PMOD10OUT.TXT, EXCEPT THAT TINY
*FINAL COEFS FROM PMOD9OUT ARE SET EQUAL TO 0.0001.
*WE ALLOW FOR LINEAR TIME TRENDS IN THE C D F AND H VECTORS IN THE SUBSTITUTION MATRIX FOR THIS MODEL 

NL 6 / NCOEF=40 LIST CONV=.000001 ITER=1000 PITER=50 GENRVAR
EQ Y1=(A1+B1*T)*K &
+(-(C2+C3+C4+C5+C6)*(C2*V12+C3*V13+C4*V14+C5*V15+C6*V16) &
-(1/2)*GG1*((H5*V45+H6*V46)**2) &
-(1/2)*GG1*((F4*V34+F5*V35+F6*V36)**2) &
-(1/2)*GG1*((D3*V23+D4*V24+D5*V25+D6*V26)**2) &
-(1/2)*GG1*((C2*V12+C3*V13+C4*V14+C5*V15+C6*V16)**2))*K*(1-W) &
+(-(CC2+CC3+CC4+CC5+CC6)*(CC2*V12+CC3*V13+CC4*V14+CC5*V15+CC6*V16) &
-(1/2)*GG1*((HH5*V45+HH6*V46)**2) &
-(1/2)*GG1*((FF4*V34+FF5*V35+FF6*V36)**2) &
-(1/2)*GG1*((DD3*V23+DD4*V24+DD5*V25+DD6*V26)**2) &
-(1/2)*GG1*((CC2*V12+CC3*V13+CC4*V14+CC5*V15+CC6*V16)**2))*K*W
EQ Y2=(A2+B2*T)*K &
+(C2*(C2*V12+C3*V13+C4*V14+C5*V15+C6*V16) &
-(D3+D4+D5+D6)*(D3*V23+D4*V24+D5*V25+D6*V26)  &
-(1/2)*GG2*((H5*V45+H6*V46)**2) &
-(1/2)*GG2*((F4*V34+F5*V35+F6*V36)**2) &
-(1/2)*GG2*((D3*V23+D4*V24+D5*V25+D6*V26)**2) &
-(1/2)*GG2*((C2*V12+C3*V13+C4*V14+C5*V15+C6*V16)**2))*K*(1-W) &
+(CC2*(CC2*V12+CC3*V13+CC4*V14+CC5*V15+CC6*V16) &
-(DD3+DD4+DD5+DD6)*(DD3*V23+DD4*V24+DD5*V25+DD6*V26)  &
-(1/2)*GG2*((HH5*V45+HH6*V46)**2) &
-(1/2)*GG2*((FF4*V34+FF5*V35+FF6*V36)**2) &
-(1/2)*GG2*((DD3*V23+DD4*V24+DD5*V25+DD6*V26)**2) &
-(1/2)*GG2*((CC2*V12+CC3*V13+CC4*V14+CC5*V15+CC6*V16)**2))*K*W
EQ Y3=(A3+B3*T)*K &
+(C3*(C2*V12+C3*V13+C4*V14+C5*V15+C6*V16) &
+D3*(D3*V23+D4*V24+D5*V25+D6*V26)  &
-(F4+F5+F6)*(F4*V34+F5*V35+F6*V36) &
-(1/2)*GG3*((H5*V45+H6*V46)**2) &
-(1/2)*GG3*((F4*V34+F5*V35+F6*V36)**2) &
-(1/2)*GG3*((D3*V23+D4*V24+D5*V25+D6*V26)**2) &
-(1/2)*GG3*((C2*V12+C3*V13+C4*V14+C5*V15+C6*V16)**2))*K*(1-W) &
+(CC3*(CC2*V12+CC3*V13+CC4*V14+CC5*V15+CC6*V16) &
+DD3*(DD3*V23+DD4*V24+DD5*V25+DD6*V26)  &
-(FF4+FF5+FF6)*(FF4*V34+FF5*V35+FF6*V36) &
-(1/2)*GG3*((HH5*V45+HH6*V46)**2) &
-(1/2)*GG3*((FF4*V34+FF5*V35+FF6*V36)**2) &
-(1/2)*GG3*((DD3*V23+DD4*V24+DD5*V25+DD6*V26)**2) &
-(1/2)*GG3*((CC2*V12+CC3*V13+CC4*V14+CC5*V15+CC6*V16)**2))*K*W
EQ Y4=(A4+B4*T)*K &
+(C4*(C2*V12+C3*V13+C4*V14+C5*V15+C6*V16) &
+D4*(D3*V23+D4*V24+D5*V25+D6*V26)  &
+F4*(F4*V34+F5*V35+F6*V36) &
-(H5+H6)*(H5*V45+H6*V46) &
-(1/2)*GG4*((H5*V45+H6*V46)**2) &
-(1/2)*GG4*((F4*V34+F5*V35+F6*V36)**2) &
-(1/2)*GG4*((D3*V23+D4*V24+D5*V25+D6*V26)**2) &
-(1/2)*GG4*((C2*V12+C3*V13+C4*V14+C5*V15+C6*V16)**2))*K*(1-W) &
+(CC4*(CC2*V12+CC3*V13+CC4*V14+CC5*V15+CC6*V16) &
+DD4*(DD3*V23+DD4*V24+DD5*V25+DD6*V26)  &
+FF4*(FF4*V34+FF5*V35+FF6*V36) &
-(HH5+HH6)*(HH5*V45+HH6*V46) &
-(1/2)*GG4*((HH5*V45+HH6*V46)**2) &
-(1/2)*GG4*((FF4*V34+FF5*V35+FF6*V36)**2) &
-(1/2)*GG4*((DD3*V23+DD4*V24+DD5*V25+DD6*V26)**2) &
-(1/2)*GG4*((CC2*V12+CC3*V13+CC4*V14+CC5*V15+CC6*V16)**2))*K*W
EQ Y5=(A5+B5*T)*K &
+(C5*(C2*V12+C3*V13+C4*V14+C5*V15+C6*V16) &
+D5*(D3*V23+D4*V24+D5*V25+D6*V26) &
+F5*(F4*V34+F5*V35+F6*V36) &
+H5*(H5*V45+H6*V46) &
-(1/2)*GG5*((H5*V45+H6*V46)**2) &
-(1/2)*GG5*((F4*V34+F5*V35+F6*V36)**2) &
-(1/2)*GG5*((D3*V23+D4*V24+D5*V25+D6*V26)**2) &
-(1/2)*GG5*((C2*V12+C3*V13+C4*V14+C5*V15+C6*V16)**2))*K*(1-W) &
+(CC5*(CC2*V12+CC3*V13+CC4*V14+CC5*V15+CC6*V16) &
+DD5*(DD3*V23+DD4*V24+DD5*V25+DD6*V26) &
+FF5*(FF4*V34+FF5*V35+FF6*V36) &
+HH5*(HH5*V45+HH6*V46) &
-(1/2)*GG5*((HH5*V45+HH6*V46)**2) &
-(1/2)*GG5*((FF4*V34+FF5*V35+FF6*V36)**2) &
-(1/2)*GG5*((DD3*V23+DD4*V24+DD5*V25+DD6*V26)**2) &
-(1/2)*GG5*((CC2*V12+CC3*V13+CC4*V14+CC5*V15+CC6*V16)**2))*K*W
EQ Y6=(A6+B6*T)*K &
+(C6*(C2*V12+C3*V13+C4*V14+C5*V15+C6*V16) &
+D6*(D3*V23+D4*V24+D5*V25+D6*V26) &
+F6*(F4*V34+F5*V35+F6*V36) &
+H6*(H5*V45+H6*V46) &
-(1/2)*GG6*((H5*V45+H6*V46)**2) &
-(1/2)*GG6*((F4*V34+F5*V35+F6*V36)**2) &
-(1/2)*GG6*((D3*V23+D4*V24+D5*V25+D6*V26)**2) &
-(1/2)*GG6*((C2*V12+C3*V13+C4*V14+C5*V15+C6*V16)**2))*K*(1-W) &
+(CC6*(CC2*V12+CC3*V13+CC4*V14+CC5*V15+CC6*V16) &
+DD6*(DD3*V23+DD4*V24+DD5*V25+DD6*V26) &
+FF6*(FF4*V34+FF5*V35+FF6*V36) &
+HH6*(HH5*V45+HH6*V46) &
-(1/2)*GG6*((HH5*V45+HH6*V46)**2) &
-(1/2)*GG6*((FF4*V34+FF5*V35+FF6*V36)**2) &
-(1/2)*GG6*((DD3*V23+DD4*V24+DD5*V25+DD6*V26)**2) &
-(1/2)*GG6*((CC2*V12+CC3*V13+CC4*V14+CC5*V15+CC6*V16)**2))*K*W
COEF A1        1.9767     
COEF B1      -0.00052636
COEF C2      -0.43222     
COEF C3       0.67115     
COEF C4       0.34897     
COEF C5      -0.77249     
COEF C6      -0.54874     
COEF H5       0.0001
COEF H6       0.0001
COEF HH5      0.0001
COEF HH6      0.0001
COEF F4       0.36714     
COEF F5      -0.57118     
COEF F6       0.39058     
COEF D3      -0.28474     
COEF D4      -0.094711
COEF D5       0.39789     
COEF D6       0.89912     
COEF CC2     -0.0061004
COEF CC3       1.0897     
COEF CC4      0.077957
COEF CC5      -1.2264     
COEF CC6     -0.61927     
COEF FF4      0.0001
COEF FF5      0.0001
COEF FF6      0.0001
COEF DD3     -0.37650     
COEF DD4     -0.47121     
COEF DD5       1.1428     
COEF DD6     -0.25472     
COEF A2       0.47387     
COEF B2      -0.0036215
COEF A3        1.1336     
COEF B3       0.0024982
COEF A4        1.0045     
COEF B4      -0.0012285
COEF A5       -1.0540     
COEF B5      -0.0064682
COEF A6       -1.7529     
COEF B6       0.012323
END
* FINAL LL FROM PMOD10OUT.TXT WAS -611.0828  
* STARTING LL FOR PMOD11.TXT IS   -611.1463, WHICH IS CLOSE TO THE FINAL LL IN PMOD10.TXT.     
* FINAL STATISTICS FOR PMOD11.TXT: TIME =     0.3260 SEC.;   ITER. NO.    58;   FUNCT. EVALUATIONS    76
* FINAL LOG-LIKELIHOOD FUNCTION = -611.0828, WHICH IS THE SAME AS THE PMOD10 LL.
* THUS THE NEW HH5 AND HH6 ARE ESTIMATED AS 0's. H5 AND H6 ARE ALSO STILL 0's 
*HERE ARE THE ESTIMATED COEFFICIENTS
*       COEFFICIENT    ST. ERROR   T-RATIO
* A1        1.9767     0.48166E-01  41.040
* B1      -0.52636E-03 0.21273E-02-0.24744
* C2      -0.43222     0.11362     -3.8041
* C3       0.67115     0.10586      6.3402
* C4       0.34897     0.26325      1.3256
* C5      -0.77249     0.40395     -1.9123
* C6      -0.54874     0.86347E-01 -6.3551
* H5      -0.10821E-07 0.92072    -0.11753E-07
* H6       0.36210E-08 0.44006     0.82283E-08
* F4       0.36714     0.34369      1.0682
* F5      -0.57118     0.36686     -1.5569
* F6       0.39058     0.19332      2.0204
* D3      -0.28474     0.11493     -2.4774
* D4      -0.94711E-01 0.14815    -0.63929
* D5       0.39789     0.19247      2.0673
* D6       0.89912     0.99527E-01  9.0339
* CC2     -0.61004E-02 0.55955E-01-0.10902
* CC3       1.0897     0.15133      7.2007
* CC4      0.77957E-01 0.15919     0.48971
* CC5      -1.2264     0.22064     -5.5586
* CC6     -0.61927     0.74143E-01 -8.3523
* HH5      0.47006E-06  1.4460     0.32507E-06
* HH6     -0.29145E-06 0.83827    -0.34768E-06
* FF4      0.12061E-06  1.8821     0.64082E-07
* FF5     -0.29864E-06  4.2911    -0.69596E-07
* FF6      0.28981E-07  1.0618     0.27295E-07
* DD3     -0.37650     0.18497     -2.0354
* DD4     -0.47121     0.18350     -2.5680
* DD5       1.1428     0.20734      5.5118
* DD6     -0.25472     0.83712E-01 -3.0428
* A2       0.47387     0.14637E-01  32.375
* B2      -0.36215E-02 0.87579E-03 -4.1352
* A3        1.1336     0.67411E-01  16.816
* B3       0.24982E-02 0.33306E-02 0.75009
* A4        1.0045     0.13436      7.4764
* B4      -0.12285E-02 0.36389E-02-0.33759
* A5       -1.0540     0.12151     -8.6738
* B5      -0.64682E-02 0.36416E-02 -1.7762
* A6       -1.7529     0.29190E-01 -60.052
* B6       0.12323E-01 0.19541E-02  6.3063
*R SQUARES ARE:0.9852 0.9909 0.9110 0.8612 0.9369 0.9320; STILL NOT GREAT!
*THE STANDARD ERRORS FOR SOME ELEMENTS OF THE SUBSTITUTION MATRIX ARE RATHER LARGE; HENCE WE WILL NOT BE ABLE 
*TO GENERATE VERY ACCURATE PRICE ELASTICITIES OF NET SUPPLY
*BREAK POINTS FOR THE CANADIAN DATA (WE WILL USE THESE BREAK POINTS IN THE FOLLOWING MODEL)
*EQ1: 18 22 28 31 43 57
*EQ2: 16 24 26 37 51 57
*EQ3: 22 30 32 40 47 57
*EQ4: 14 23 32 41 50 56
*EQ5: 13 32 41 50 52 57
*EQ6: 14 24 29 32 41 57  

*LET US SEE HOW THE ELASTICITIES TURN OUT AND COMPARE THEM WITH THE ELASTICITIES FROM PMOD7OUT.TXT

*FIRST GENR THE C VECTOR AND THEN C TIMES C TRANSPOSE = THE C MATRIX
SMPL 1 59
GENR C1=0
DO #=2,6
GENR C1=C1-C#
ENDO
SMPL 1 1
FORMAT(6F10.6)
PRINT C1-C6 / FORMAT
*GENR THE ELEMENTS OF THE 6X6 RANK ONE C MATRIX
DO #=1,6
DO $=1,6
GENR C#$=C#(1)*C$(1)
ENDO
ENDO
*GENR THE D VECTOR AND THEN D TIMES D TRANSPOSE = THE D MATRIX
SMPL 1 59
GENR D1=0
GENR D2=0
DO #=3,6
GENR D2=D2-D#
ENDO
SMPL 1 1
FORMAT(6F10.6)
PRINT D1-D6 / FORMAT
*GENR THE ELEMENTS OF THE 6X6 RANK ONE D MATRIX
DO #=1,6
DO $=1,6
GENR D#$=D#(1)*D$(1)
ENDO
ENDO
*GENR THE F VECTOR AND THEN F TIMES F TRANSPOSE = THE F MATRIX
SMPL 1 59
GENR F1=0
GENR F2=0
GENR F3=0
DO #=4,6
GENR F3=F3-F#
ENDO
SMPL 1 1
FORMAT(6F10.6)
PRINT F1-F6 / FORMAT
*GENR THE ELEMENTS OF THE 6X6 RANK ONE F MATRIX
DO #=1,6
DO $=1,6
GENR F#$=F#(1)*F$(1)
ENDO
ENDO
*GENR THE H VECTOR AND THEN H TIMES H TRANSPOSE = THE H MATRIX
SMPL 1 59
GENR H1=0
GENR H2=0
GENR H3=0
GENR H4=0
DO #=5,6
GENR H4=H4-H#
ENDO
SMPL 1 1
FORMAT(6F10.6)
PRINT H1-H6 / FORMAT
*GENR THE ELEMENTS OF THE 6X6 RANK ONE H MATRIX
DO #=1,6
DO $=1,6
GENR H#$=H#(1)*H$(1)
ENDO
ENDO

*ADD THE D, F AND H MATRICES TO THE C MATRIX
DO #=1,6
DO $=1,6
GENR C#$=C#$+D#(1)*D$(1)+F#(1)*F$(1)+H#(1)*H$(1)
ENDO
ENDO

*GENR THE INNER PRODUCT OF ROW # OF THE NEW C MATRIX WITH THE VECTOR OF NORMALIZED PRICES FOR EACH OBSERVATION
SMPL 1 59
DO #=1,6
GENR CV#=C#1(1)*V1+C#2(1)*V2+C#3(1)*V3+C#4(1)*V4+C#5(1)*V5+C#6(1)*V6
ENDO 
*GENR V TRANSPOSE TIMES THE C MATRIX TIMES V
GENR VCV=0
DO #=1,6
GENR VCV=VCV+V#*CV#
ENDO
FORMAT(F8.0,7F10.5)
PRINT YEAR VCV CV1-CV6 / FORMAT
*THESE NUMBERS SHOULD ALL START AT 0 AND THEY DO.

*NOW PERFORM THE SAME OPERATIONS TO CONSTRUCT THE CC DD FF AND HH MATRICES
SMPL 1 59
GENR CC1=0
DO #=2,6
GENR CC1=CC1-CC#
ENDO
SMPL 1 1
FORMAT(6F10.6)
PRINT CC1-CC6 / FORMAT
PRINT C1-C6 / FORMAT
*GENR THE ELEMENTS OF THE 6X6 RANK ONE CC MATRIX
DO #=1,6
DO $=1,6
GENR CC#$=CC#(1)*CC$(1)
ENDO
ENDO
*GENR THE DD VECTOR AND THEN DD TIMES DD TRANSPOSE = THE DD MATRIX
SMPL 1 59
GENR DD1=0
GENR DD2=0
DO #=3,6
GENR DD2=DD2-DD#
ENDO
SMPL 1 1
FORMAT(6F10.6)
PRINT DD1-DD6 / FORMAT
PRINT D1-D6 / FORMAT
*GENR THE ELEMENTS OF THE 6X6 RANK ONE DD MATRIX
DO #=1,6
DO $=1,6
GENR DD#$=DD#(1)*DD$(1)
ENDO
ENDO
*GENR THE FF VECTOR AND THEN FF TIMES FF TRANSPOSE = THE FF MATRIX
SMPL 1 59
GENR FF1=0
GENR FF2=0
GENR FF3=0
DO #=4,6
GENR FF3=FF3-FF#
ENDO
SMPL 1 1
FORMAT(6F10.6)
PRINT FF1-FF6 / FORMAT
PRINT F1-F6 / FORMAT
*GENR THE ELEMENTS OF THE 6X6 RANK ONE FF MATRIX
DO #=1,6
DO $=1,6
GENR FF#$=FF#(1)*FF$(1)
ENDO
ENDO
*GENR THE HH VECTOR AND THEN HH TIMES HH TRANSPOSE = THE HH MATRIX
SMPL 1 59
GENR HH1=0
GENR HH2=0
GENR HH3=0
GENR HH4=0
DO #=5,6
GENR HH4=HH4-HH#
ENDO
SMPL 1 1
FORMAT(6F10.6)
PRINT HH1-HH6 / FORMAT
PRINT H1-H6 / FORMAT 
*GENR THE ELEMENTS OF THE 6X6 RANK ONE HH MATRIX
DO #=1,6
DO $=1,6
GENR HH#$=HH#(1)*HH$(1)
ENDO
ENDO

*ADD THE DD, FF AND HH MATRICES TO THE CC MATRIX
DO #=1,6
DO $=1,6
GENR CC#$=CC#$+DD#(1)*DD$(1)+FF#(1)*FF$(1)+HH#(1)*HH$(1)
ENDO
ENDO

*GENR THE INNER PRODUCT OF ROW # OF THE NEW CC MATRIX WITH THE VECTOR OF NORMALIZED PRICES FOR EACH OBSERVATION
SMPL 1 59
DO #=1,6
GENR CCV#=CC#1(1)*V1+CC#2(1)*V2+CC#3(1)*V3+CC#4(1)*V4+CC#5(1)*V5+CC#6(1)*V6
ENDO 
*GENR V TRANSPOSE TIMES THE CC MATRIX TIMES V
GENR VCCV=0
DO #=1,6
GENR VCCV=VCCV+V#*CCV#
ENDO
FORMAT(F8.0,7F10.5)
PRINT YEAR VCV CV1-CV6 / FORMAT
PRINT YEAR VCCV CCV1-CCV6 / FORMAT
*THESE NUMBERS SHOULD ALL START AT 0 AND THEY DO.

*GENR A NEW FINAL SUBSTITUTION MATRIX CF WHICH IS EQUAL TO C*(1-W) + CC*W
SMPL 1 59
DO #=1,6
DO $=1,6
GENR CF#$=C#$(1)*(1-W)+CC#$(1)*W
ENDO
ENDO

*GENR THE INNER PRODUCT OF ROW # OF THE NEW CF MATRIX WITH THE VECTOR OF NORMALIZED PRICES FOR EACH OBSERVATION
SMPL 1 59
DO #=1,6
GENR CFV#=CF#1*V1+CF#2*V2+CF#3*V3+CF#4*V4+CF#5*V5+CF#6*V6
ENDO 
*GENR V TRANSPOSE TIMES THE CF MATRIX TIMES V
GENR VCFV=0
DO #=1,6
GENR VCFV=VCFV+V#*CFV#
ENDO
FORMAT(F8.0,7F10.5)
PRINT YEAR VCFV CFV1-CFV6 / FORMAT
PRINT YEAR VCV CV1-CV6 / FORMAT
PRINT YEAR VCCV CCV1-CCV6 / FORMAT
STAT VCFV VCV VCCV CFV1-CFV6 CV1-CV6 CCV1-CCV6  

*GENR FITTED DEMANDS WHICH ARE ALSO FIRST ORDER PARTIAL DERIVATIVES OF THE PROFIT FUNCTION
SMPL 1 59
DO #=1,6
GENR FY#=(A#+B#*T+CF#1*V1+CF#2*V2+CF#3*V3+CF#4*V4+CF#5*V5+CF#6*V6-.5*GG#(1)*VCFV)*K
ENDO
FORMAT(F8.0,12F9.3)
PRINT YEAR Y1 FY1 Y2 FY2 Y3 FY3 Y4 FY4 Y5 FY5 Y6 FY6 / FORMAT

STAT Y1 FY1 Y2 FY2 Y3 FY3 Y4 FY4 Y5 FY5 Y6 FY6
*THE FITTED SERIES FY# ARE STILL NOT THAT CLOSE TO THE CORRESPONDING ACTUAL SERIES Y#
*FY# SHOULD COINCIDE WITH THE FITTED VALUES IN EQ # IN THE ABOVE NONLINEAR REGRESSION
*THIS CHECK PASSES FOR CANADA

*GENR THE FITTED V
GENR FV=0
DO #=1,6
GENR FV=FV+P#*FY#
ENDO

*GENR A MEASURE OF TECHNICAL PROGRESS (THE PARTIAL DERIVATIVE OF VARIABLE PROFITS WRT TIME DIVIDED BY
*THE (FITTED) VALUE OF LABOUR AND CAPITAL INPUT
*SINCE THE SUBSTITUTION MATRIX IS NOW A FUNCTION OF T, THERE WILL BE A NEW ADDITIONAL TERM TO OUR 
*OLD MEASURE OF TECHNICAL PROGRESS. CALL THIS NEW TERM BIAS0
*WE WILL CALCULATE THIS NEW TERM BY DIFFERENCING THE SUBSTITUTION MATRIX CF#$
SMPL 2 59
DO #=1,6
DO $=1,6
GENR DCF#$=CF#$-LAG(CF#$)
ENDO
ENDO
DO #=1,6
GENR BIAS0#=DCF#1*P1+DCF#2*P2+DCF#3*P3+DCF#4*P4+DCF#5*P5+DCF#6*P6
ENDO
GENR BIAS0=0
DO #=1,6
GENR BIAS0= BIAS0+P#*BIAS0#
ENDO
GENR BIAS0=(.5*BIAS0*K)/(PG*(FV-P6*FY6))
*DEFINE THE NET OUTPUT BIAS CONTRIBUTION TERMS BIAS1-BIAS6; THESE BIAS TERMS ARE THE SAME AS IN PMOD7OUT.TXT
DO #=1,6
GENR BIAS#=B#*P#*K/(FV-P6*FY6)
ENDO
GENR TECH=BIAS0
DO #=1,6
GENR TECH=TECH+BIAS#
ENDO 
FORMAT(F8.0,8F10.5,2F10.3)
PRINT YEAR TECH BIAS0 BIAS1-BIAS6 V FV / FORMAT
STAT TECH BIAS0 BIAS1-BIAS6 V FV
* NAME         N    MEAN        ST. DEV      VARIANCE     MINIMUM      MAXIMUM
* TECH         58  0.31849E-02 0.11525E-02 0.13284E-05  0.89681E-03  0.49568E-02
* BIAS0        58 -0.12574E-02 0.10595E-02 0.11225E-05 -0.33861E-02  0.14842E-04
* BIAS1        58 -0.17903E-03 0.20197E-04 0.40793E-09 -0.20803E-03 -0.14755E-03
* BIAS2        58 -0.20443E-02 0.52052E-03 0.27094E-06 -0.28251E-02 -0.10822E-02
* BIAS3        58  0.81696E-03 0.38570E-04 0.14876E-08  0.71412E-03  0.89592E-03
* BIAS4        58 -0.41566E-03 0.37966E-04 0.14414E-08 -0.50894E-03 -0.35139E-03
* BIAS5        58 -0.19747E-02 0.21523E-03 0.46322E-07 -0.24563E-02 -0.16181E-02
* BIAS6        58  0.82391E-02 0.26151E-02 0.68386E-05  0.36830E-02  0.12622E-01
* V            58   310.92      272.62      74323.       15.247       878.86
* FV           58   308.74      274.89      75562.       27.062       969.58
*NOTE THAT WE HAVE DEFINED TECH ONLY FOR THE YEARS 1961-2018, SIMILAR TO OUR INDEX NUMBER ESTIMATES
*NOTE THAT BIAS0 ADDS A NEGATIVE CONTRIBUTION TO TECH. THE ELEMENTS IN THE FINAL
*SUBSTITUTION MATRIX TEND TO BE SMALLER IN MAGNITUDE THAN THE ELEMENTS IN THE INITIAL SUBSTITUTION MATRIX
*AND SO THIS ADDS A NEGATIVE TREND TO TECH. AVERAGE TECH IS NOW ONLY .32% PER YEAR!
*BIAS6 IS FAIRLY LARGE AND POSITIVE SO TECHNICAL PROGRESS IS PRIMARILY LABOUR SAVING!
*FITTED V (FV) IS STILL NOT THAT CLOSE TO ACTUAL V; THUS OUR ESTIMATES OF TECHNICAL PROGRESS WILL NOT BE ACCURATE (YET).
*FOR COMPARISON PURPOSES, HERE ARE THE ESTIMATES FOR TECH FROM PMOD7OUT.TXT
* NAME         N    MEAN        ST. DEV      VARIANCE     MINIMUM      MAXIMUM
* TECH         59  0.40022E-02 0.47663E-03 0.22718E-06  0.33004E-02  0.48867E-02
* BIAS1        59  0.40152E-02 0.38441E-03 0.14777E-06  0.33545E-02  0.45706E-02
* BIAS2        59 -0.45461E-02 0.11325E-02 0.12826E-05 -0.64027E-02 -0.24767E-02
* BIAS3        59  0.69655E-02 0.30400E-03 0.92415E-07  0.64793E-02  0.77139E-02
* BIAS4        59  0.18346E-02 0.14563E-03 0.21208E-07  0.15862E-02  0.22471E-02
* BIAS5        59 -0.44916E-02 0.47782E-03 0.22831E-06 -0.55743E-02 -0.36592E-02
* BIAS6        59  0.22457E-03 0.70895E-04 0.50261E-08  0.10352E-03  0.35200E-03
* V            59   305.91      272.99      74523.       15.247       878.86
* FV           59   304.45      274.35      75268.       24.271       956.13

*WE DO NOT HAVE TO CHECK CURVATURE CONDITIONS FOR THIS FUNCTIONAL FORM; THEY ARE AUTOMATICALLY SATISFIED
*HOWEVER, WE STILL NEED TO CALCULATE ELASTICITIES OF NET SUPPLY FOR THIS MODEL
*GENR THE MATRIX OF SECOND ORDER PARTIAL DERIVATIVES OF THE UNIT PROFIT FUNCTION WRT VARIABLE PRICES FOR EACH PERIOD
SMPL 1 59
DO #=1,6
DO $=1,6
GENR DC#$=(CF#$-CFV#*GG$(1)-GG#(1)*CFV$+GG#(1)*GG$(1)*VCFV)/PG
ENDO
ENDO
FORMAT(F8.0,6F11.6)
PRINT YEAR DC11 DC12 DC13 DC14 DC15 DC16 / FORMAT
PRINT YEAR DC21 DC22 DC23 DC24 DC25 DC26 / FORMAT
PRINT YEAR DC31 DC32 DC33 DC34 DC35 DC36 / FORMAT
PRINT YEAR DC41 DC42 DC43 DC44 DC45 DC46 / FORMAT
PRINT YEAR DC51 DC52 DC53 DC54 DC55 DC56 / FORMAT
PRINT YEAR DC61 DC62 DC63 DC64 DC65 DC66 / FORMAT
*THESE DERIVATIVES ARE TRENDING DOWNWARD BECAUSE WE ARE DIVIDING EACH TERM BY PG WHICH TRENDS UPWARD; I.E., THE SECOND
*ORDER DERIVATIVES OF THE PROFIT FUNCTION ARE HOMOGEOUS OF DEGREE MINUS 1 IN PRICE p WHICH TREND UP AND SO THE 2nd
*DERIVATIVES WILL IN GENERAL TREND DOWN.

*GENR THE MATRIX OF NET SUPPLY PRICE ELASTICITIES
DO #=1,6
DO $=1,6
GENR E#$=DC#$*P$*K/FY#
ENDO
ENDO
*GENR CHECKS ON OUR COMPUTATIONS
DO #=1,6
GENR CHECK#=E#1+E#2+E#3+E#4+E#5+E#6
ENDO
STAT CHECK1-CHECK6
*ALL CHECK# SHOULD EQUAL 0 AND THEY DO. NOTE THAT A NUMBER LIKE 0.17347E-16 IS 0 (PLUS ROUNDING ERROR)
FORMAT(F8.0,6F10.4)
PRINT YEAR E11 E12 E13 E14 E15 E16 / FORMAT
STAT E11 E12 E13 E14 E15 E16
PRINT YEAR E21 E22 E23 E24 E25 E26 / FORMAT
STAT E21 E22 E23 E24 E25 E26
PRINT YEAR E31 E32 E33 E34 E35 E36 / FORMAT
STAT E31 E32 E33 E34 E35 E36
PRINT YEAR E41 E42 E43 E44 E45 E46 / FORMAT
STAT E41 E42 E43 E44 E45 E46
PRINT YEAR E51 E52 E53 E54 E55 E56 / FORMAT
STAT E51 E52 E53 E54 E55 E56
PRINT YEAR E61 E62 E63 E64 E65 E66 / FORMAT
STAT E61 E62 E63 E64 E65 E66 

*LIST THE OWN ELASTICITIES OF NET SUPPLY
PRINT YEAR E11 E22 E33 E44 E55 E66 / FORMAT
STAT E11 E22 E33 E44 E55 E66
*   YEAR       E11       E22       E33       E44       E55       E66
*   1960.    0.2720    2.1709    0.4996    0.2643   -1.0259   -0.7200
*   1961.    0.2844    2.1253    0.5299    0.2762   -1.0880   -0.7449
*   1962.    0.2928    2.1028    0.5591    0.2911   -1.1643   -0.7613
*   1963.    0.2974    2.1112    0.5902    0.2926   -1.2081   -0.7815
*   1964.    0.2921    2.0258    0.6012    0.2903   -1.2095   -0.7688
*   1965.    0.2959    2.1152    0.6550    0.2850   -1.2055   -0.8384
*   1966.    0.3011    2.0786    0.6825    0.2801   -1.1983   -0.8652
*   1967.    0.3095    2.0793    0.7082    0.2736   -1.1897   -0.8997
*   1968.    0.3266    2.0834    0.7414    0.2733   -1.2150   -0.9426
*   1969.    0.3370    2.0749    0.7850    0.2691   -1.2180   -0.9876
*   1970.    0.3429    2.0431    0.8127    0.2649   -1.2058   -1.0147
*   1971.    0.3514    2.0471    0.8753    0.2608   -1.2346   -1.0607
*   1972.    0.3553    2.0487    0.9091    0.2542   -1.2105   -1.0992
*   1973.    0.3390    2.0252    0.9129    0.2529   -1.1771   -1.0944
*   1974.    0.3228    1.9727    0.9200    0.2706   -1.2270   -1.0633
*   1975.    0.3330    1.9941    0.9516    0.2756   -1.2761   -1.0895
*   1976.    0.3453    2.0192    0.9996    0.2685   -1.2170   -1.1691
*   1977.    0.3650    2.0305    1.0800    0.2857   -1.3517   -1.2064
*   1978.    0.3676    1.9598    1.0989    0.2971   -1.4841   -1.1611
*   1979.    0.3560    1.8743    1.0705    0.3081   -1.5220   -1.1043
*   1980.    0.3581    1.8407    1.0947    0.3251   -1.6345   -1.0855
*   1981.    0.3747    1.8325    1.2005    0.3338   -1.7614   -1.1277
*   1982.    0.3941    1.8418    1.2453    0.3175   -1.7204   -1.1849
*   1983.    0.4015    1.8151    1.1890    0.2988   -1.6294   -1.1805
*   1984.    0.4092    1.7958    1.2194    0.2996   -1.6916   -1.1828
*   1985.    0.4152    1.7762    1.2387    0.2957   -1.7082   -1.1908
*   1986.    0.4186    1.7395    1.2287    0.2829   -1.7036   -1.1771
*   1987.    0.4118    1.7227    1.2013    0.2656   -1.5739   -1.1933
*   1988.    0.4106    1.7415    1.1825    0.2457   -1.4440   -1.2339
*   1989.    0.4120    1.7148    1.1791    0.2348   -1.3744   -1.2546
*   1990.    0.4265    1.6824    1.1867    0.2247   -1.3531   -1.2740
*   1991.    0.4564    1.7037    1.2112    0.2121   -1.3202   -1.3428
*   1992.    0.4702    1.6765    1.2858    0.2165   -1.3873   -1.3710
*   1993.    0.4753    1.6320    1.3459    0.2253   -1.4973   -1.3595
*   1994.    0.4635    1.5517    1.3669    0.2335   -1.5920   -1.3035
*   1995.    0.4601    1.5059    1.3776    0.2401   -1.6321   -1.2862
*   1996.    0.4558    1.4691    1.3372    0.2313   -1.5707   -1.2778
*   1997.    0.4619    1.4619    1.3886    0.2252   -1.5723   -1.3148
*   1998.    0.4758    1.4412    1.5072    0.2260   -1.6765   -1.3470
*   1999.    0.4784    1.3980    1.5018    0.2206   -1.6436   -1.3520
*   2000.    0.4869    1.3595    1.5477    0.2220   -1.6284   -1.3844
*   2001.    0.4907    1.3102    1.5619    0.2188   -1.6589   -1.3737
*   2002.    0.4910    1.2509    1.5871    0.2100   -1.6571   -1.3674
*   2003.    0.4777    1.1955    1.4192    0.1880   -1.4260   -1.3558
*   2004.    0.4654    1.1420    1.3605    0.1778   -1.3207   -1.3510
*   2005.    0.4672    1.0955    1.3607    0.1711   -1.2604   -1.3763
*   2006.    0.4634    1.0420    1.3639    0.1609   -1.2018   -1.3922
*   2007.    0.4530    0.9825    1.3320    0.1492   -1.1130   -1.3975
*   2008.    0.4432    0.8988    1.3262    0.1538   -1.1314   -1.3592
*   2009.    0.4581    0.8424    1.4227    0.1411   -1.1580   -1.3951
*   2010.    0.4489    0.7630    1.3409    0.1335   -1.0745   -1.3682
*   2011.    0.4496    0.6811    1.3542    0.1350   -1.0822   -1.3570
*   2012.    0.4473    0.5981    1.3673    0.1289   -1.0763   -1.3453
*   2013.    0.4480    0.5118    1.3741    0.1252   -1.0688   -1.3331
*   2014.    0.4476    0.4180    1.4228    0.1247   -1.1070   -1.3174
*   2015.    0.4466    0.3217    1.4924    0.1209   -1.1764   -1.2892
*   2016.    0.4293    0.2189    1.4413    0.1153   -1.1636   -1.2275
*   2017.    0.4266    0.1151    1.4406    0.1128   -1.1410   -1.2127
*   2018.    0.4315    0.0080    1.4762    0.1116   -1.1596   -1.1997
* NAME         N    MEAN        ST. DEV     VARIANCE    MINIMUM      MAXIMUM
* E11          59  0.40320     0.64560E-01 0.41680E-02  0.27205      0.49099
* E22          59   1.5098     0.59002     0.34813      0.80279E-02   2.1709
* E33          59   1.1604     0.29962     0.89773E-01  0.49959       1.5871
* E44          59  0.23033     0.63130E-01 0.39854E-02  0.11156      0.33384
* E55          59  -1.3512     0.22053     0.48634E-01  -1.7614      -1.0259
* E66          59  -1.1833     0.19242     0.37025E-01  -1.3975     -0.71998
*NOTE THAT ALL E## ARE POSITIVE FOR #=1,4 AND E55 AND E66 ARE NEGATIVE (WHICH IS CONSISTENT WITH OUR THEORY)
*THESE ELASTICITIES ARE VERY REASONABLE BUT NOTE THAT THEY ARE STILL TRENDING QUITE A BIT
*FOR COMPARISON PURPOSES, WE LIST THE AVERAGE OWN ELASTICITIES FROM PMOD7OUT.TXT
* NAME         N    MEAN       ST. DEV     VARIANCE     MINIMUM      MAXIMUM
* E11          57  0.46200     0.10005     0.10009E-01  0.29085      0.59214
* E22          57   1.0995     0.30833     0.95068E-01  0.71902       1.7972
* E33          57   2.1218     0.21146     0.44716E-01   1.5655       2.5239
* E44          57  0.22709     0.35328E-01 0.12481E-02  0.16924      0.30072
* E55          57  -1.6007     0.55971     0.31327      -2.6687     -0.75020
* E66          57  -1.2964     0.47446     0.22511      -2.2200     -0.57250
*WHICH SET OF ELASTICITIES IS MORE PLAUSIBLE? BEFORE ANSWERING THIS QUESTION, WE NEED TO 
*IMPROVE OUR ESTIMATES OF TECHNICAL PROGRESS, WHICH WE WILL DO IN THE SUBSEQUENT FILE.
STOP  

