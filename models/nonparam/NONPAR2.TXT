*THIS IS THE FILE E59419\NONPAR2.TXT WHICH CONSTRUCTS NONPARAMETRIC ESTIMATES OF EFFICIENCY FOR 
*CANADA FOR THE YEARS 1987-2011. SEE CHAPTER 11 BENCHMARKING FOR THE THEORY
*THIS MODEL CALCULATES TECHNICAL EFFICIENCY FOR EACH OBS ASSUMING A CONVEX, CONSTANT RETURNS TO
*SCALE TECHNOLOGY
*READ IN THE DATA FOR CANADA FROM E59419\DATOUT.TXT
*IT IS EASY TO RUN THIS PROGRAM; ALL YOU HAVE TO DO IS TO READ IN YOUR DATA AND DO A BIT 
*OF EDITING TO REFLECT THE RESULTS FOR YOUR COUNTRY AS OPPOSED TO CANADA
SET NODOECHO
SET NODOECHO
SMPL 1 25
*THE DATA ARE CONSUMPTION, GOVERNMENT, INVESTMENT, EXPORTS, IMPORTS, LABOUR AND CAPITAL SERVICES
READ YEAR P1 P2 P3 P4 P5 P6 PKS
   1994.   4.76954   9.01570   4.66404   4.97955   5.03493  10.38077   5.73014
   1995.   4.82523   9.13223   4.69727   5.28907   5.19419  10.53928   6.07353
   1996.   4.90363   9.22659   4.70656   5.31574   5.12027  10.68002   6.19985
   1997.   4.97151   9.36202   4.79795   5.30675   5.15076  11.12098   6.34864
   1998.   5.01776   9.51809   4.88055   5.27519   5.32223  11.51246   6.19830
   1999.   5.09405   9.72422   4.88667   5.33407   5.30013  11.78906   6.65678
   2000.   5.20488  10.20213   4.95455   5.67018   5.40961  12.45550   7.27764
   2001.   5.36642  10.42459   5.02903   5.74611   5.54572  12.78581   7.37429
   2002.   5.42990  10.77862   5.14766   5.64085   5.57733  13.08859   7.45088
   2003.   5.55648  11.07814   5.15229   5.55131   5.20113  13.36237   7.82806
   2004.   5.63263  11.29755   5.27608   5.66995   5.08295  13.75425   8.19918
   2005.   5.74221  11.68784   5.38303   5.82591   5.04749  14.43864   8.51556
   2006.   5.83330  12.08347   5.58802   5.83938   5.00759  15.10787   8.49538
   2007.   5.93187  12.44381   5.82314   5.88460   4.90107  15.77466   8.45843
   2008.   6.10028  12.90299   6.05177   6.50737   5.19288  16.34323   8.67442
   2009.   6.11949  13.27081   6.15048   5.87593   5.16276  16.86988   7.36388
   2010.   6.19963  13.45454   6.15058   5.97304   4.97920  17.09071   7.96290
   2011.   6.33471  13.92438   6.27225   6.38251   5.14857  17.75379   8.34221
   2012.   6.40844  14.18283   6.41689   6.32438   5.18093  18.20148   8.09136
   2013.   6.50498  14.63310   6.50251   6.42089   5.22749  18.72902   8.10508
   2014.   6.62072  14.93871   6.72487   6.62674   5.47099  19.38208   8.27383
   2015.   6.68082  15.14847   6.92227   6.41264   5.69979  19.66401   7.58455
   2016.   6.73839  15.25836   7.07671   6.36223   5.72594  19.57259   7.69156
   2017.   6.80166  15.52044   7.20034   6.61365   5.76175  20.17641   8.06372
   2018.   6.91795  15.78956   7.30232   6.80185   5.90538  20.85639   8.00359
FORMAT(F8.0,7F11.5)
PRINT YEAR P1 P2 P3 P4 P5 P6 PKS / FORMAT
GENR P7=PKS
READ YEAR Y1 Y2 Y3 Y4 Y5 Y6 QKS
   1994.    81.3605    19.9211    33.1391    52.0774   -50.4057   -42.1546    50.6363
   1995.    83.1793    19.7232    34.3116    56.6969   -53.3182   -42.8325    51.7248
   1996.    85.6472    19.3469    34.5787    59.9433   -56.1757   -43.4991    52.8515
   1997.    89.8392    19.2318    40.1057    65.0927   -64.2451   -44.2165    53.8539
   1998.    92.3073    19.6017    40.5567    71.2875   -67.6481   -45.1306    55.5214
   1999.    95.9495    20.0260    42.6630    79.0019   -73.1014   -46.3354    57.0386
   2000.    99.8447    20.7142    46.0201    86.1484   -79.3120   -47.4912    58.6621
   2001.   102.2780    21.4196    44.7693    83.5908   -75.3965   -47.9471    60.5421
   2002.   106.3654    21.9041    45.7734    84.5857   -76.7693   -48.6128    62.0020
   2003.   109.2856    22.5350    49.8427    83.1247   -80.0149   -49.5328    63.5025
   2004.   112.6095    22.9576    54.1342    87.7231   -86.7951   -50.7605    65.5316
   2005.   117.0342    23.2017    59.7677    89.6708   -93.1403   -51.0538    68.1207
   2006.   121.9331    23.8402    63.1941    90.4487   -98.0782   -51.8495    71.3525
   2007.   127.2912    24.4063    64.7735    91.4822  -103.7161   -52.7713    74.8998
   2008.   131.0613    25.3243    65.9131    87.3253  -104.6073   -53.1864    78.5030
   2009.   131.1314    26.0072    56.1025    76.0019   -91.5938   -51.1343    81.9849
   2010.   135.8272    26.5926    63.6071    81.0475  -104.2033   -52.0037    83.8339
   2011.   138.9496    26.9413    68.3107    84.9106  -110.0108   -52.6904    86.7752
   2012.   141.6134    27.1293    70.8102    87.2596  -114.0781   -53.6777    90.2802
   2013.   145.3221    26.9149    72.8651    89.3414  -116.3441   -54.2857    93.9801
   2014.   149.0919    27.0637    73.7717    94.9089  -119.1989   -54.4655    97.7352
   2015.   152.5129    27.4325    68.5738    98.1056  -119.9171   -55.1570   101.5438
   2016.   155.9334    27.9376    65.5716    99.4050  -119.9134   -55.3865   104.3763
   2017.   161.3917    28.5321    70.0298   100.5152  -124.9652   -55.9555   106.7218
   2018.   164.7692    29.2489    69.9178   103.8092  -128.5486   -56.5946   109.8085
FORMAT(F8.0,7F11.4)
PRINT YEAR Y1 Y2 Y3 Y4 Y5 Y6 QKS / FORMAT
GENR Y7=QKS
*WE NEED TO MAKE THE OUTPUT DATA NEGATIVE AND IMPORTS POSITIVE, THE LABOUR AND CAPITAL DATA POSITIVE
*BECAUSE OF THE WAY SHAZAM SETS UP AN LP AS MAX c'x SUBJECT TO Ax < b (or Ax = b), x nonnegative
GENR Y1=-Y1
GENR Y2=-Y2
GENR Y3=-Y3
GENR Y4=-Y4
GENR Y5=-Y5
GENR Y6=-Y6
FORMAT(F8.0,7F11.4)
PRINT YEAR Y1 Y2 Y3 Y4 Y5 Y6 Y7 / FORMAT
*CONSTRUCT THE A MATRIX WHICH WILL BE COMMON TO ALL OF THE LP'S FOR TECHNICAL EFFICIENCY UNDER CONVEXITY
*WE FIRST CONSTRUCT THE TRANSPOSE OF A. LOAD IN THE VECTORS Y1-Y7
MATRIX B=Y1
MATRIX B=B|Y2
MATRIX B=B|Y3
MATRIX B=B|Y4
MATRIX B=B|Y5
MATRIX B=B|Y6
MATRIX B=B|Y7
PRINT B
*IN THIS MODEL, WE DO NOT ADD COLUMNS OF 1'S AND -1'S TO B BECAUSE WE DROP THE CONSTRAINT THAT THE LAMBDA'S
*MUST SUM TO ONE. SO THE FEASIBLE REGIONS FOR THESE PROGRAMS WILL BE BIGGER THAN THE COUNTERPART FEASIBLE
*REGIONS USED IN NONPAR1 AND SO WE SHOULD GET MORE INEFFICIENCY IN THIS RUN.
*TAKE THE TRANSPOSE OF A
MATRIX A=B'
*NOW WE NEED TO ADD A SPECIFIC COLUMN TO THE A MATRIX; ONE FOR EACH OF OUR 25 OBSERVATIONS
*FOR PROBLEM #, THE SPECIFIC COLUMN CONSISTS OF 5 0's, THE PRIMARY INPUT VECTOR FOR OBSERVATION #
*WHICH IS TWO MORE ROWS
SMPL 1 7
DO #=1,25
GENR D#=0
ENDO
SMPL 6 6
DO #=1,25
GENR D#=-Y6(#)
ENDO
SMPL 7 7
DO #=1,25
GENR D#=-Y7(#)
ENDO
SMPL 1 7
FORMAT(5F13.5)
PRINT D1-D5 / FORMAT
PRINT D20-D25 / FORMAT 
DO #=1,25
MATRIX A#=A|D#
ENDO
PRINT A1
PRINT A25
*EVERYTHING SEEMS TO BE WORKING OK; WE NOW HAVE THE A MATRIX FOR EACH OF OUR 25 LP PROBLEMS
*GENR THE C VECTOR FOR EACH PROGRAM
SMPL 1 26
GENR C=0
SMPL 26 26
GENR C=-1
SMPL 1 26
PRINT C
*NOW TO GENR THE B VECTORS FOR EACH PROGRAM
SMPL 1 7
DO #=1,25
GENR B#=0
ENDO
SMPL 1 1
DO #=1,25
GENR B#=Y1(#)
ENDO
SMPL 2 2
DO #=1,25
GENR B#=Y2(#)
ENDO
SMPL 3 3
DO #=1,25
GENR B#=Y3(#)
ENDO
SMPL 4 4
DO #=1,25
GENR B#=Y4(#)
ENDO
SMPL 5 5
DO #=1,25
GENR B#=Y5(#)
ENDO
SMPL 1 7
PRINT B1-B5 / FORMAT
PRINT B20-B25 / FORMAT
*NOW RUN THE LP'S TO TEST FOR EFFICIENCY OF EACH OBSERVATION ASSUMING A CONVEX TECHNOLOGY
DO #=1,25
LP C A# B# / ITER=50 PRIMAL=F#
MATRIX E#=C'F#
ENDO
*RECALL THAT WE WERE SOLVING A MINIMIZATION PROBLEM BUT WE HAD TO CONVERT IT TO A MAXIMIZATION PROBLEM TO 
*SUIT THE SHAZAM FORMAT FOR RUNNING LP'S.  THUS OUR EFFICIENCY OF OBSERVATION # IS EQUAL TO MINUS 
*THE OPTIMIZED OBJECTIVE FUNCTION.
*FOR EACH OF THE 25 LP'S, THE PRIMAL SOLUTION IS GENERATED AS F#. WE INNER PRODUCT THIS SOLUTION VECTOR
*WITH THE OBJECTIVE FUNCTION C VECTOR TO GET THE OPTIMIZED OBJECTIVE FUNCTION VALUE E
SMPL 1 25
GENR E=0
DO #=1,25
SMPL # #
GENR E=E#(1)
ENDO
SMPL 1 25
*CHANGE THE SIGN OF THE EFFICIENCY MEASURES FROM NEGATIVE TO POSITIVE
GENR E=-E
FORMAT(F8.0,F10.4)
PRINT YEAR E / FORMAT
*   YEAR        E
*   1994.    1.0000
*   1995.    1.0000
*   1996.    0.9923
*   1997.    0.9834
*   1998.    0.9795
*   1999.    0.9879
*   2000.    1.0000
*   2001.    1.0000
*   2002.    1.0000
*   2003.    1.0000
*   2004.    1.0000
*   2005.    1.0000
*   2006.    1.0000
*   2007.    1.0000
*   2008.    1.0000
*   2009.    1.0000
*   2010.    1.0000
*   2011.    1.0000
*   2012.    1.0000
*   2013.    1.0000
*   2014.    1.0000
*   2015.    0.9871
*   2016.    1.0000
*   2018.    1.0000
*THERE ARE NOW 5 INEFFICIENT OBSERVATIONS USING THIS CONSTANT RETURNS TO SCALE EFFICIENCY MODEL. 
*THIS IS A BETTER RESULT THAT THE NONPAR1OU.TXT RESULTS BUT STILL TOO MANY OBSERVATIONS ARE 
*REGARDED AS BEING EFFICIENT
STOP

