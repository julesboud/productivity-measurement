*THIS IS CMOD1.TXT,A 2 GOOD CONSUMER REGRESSION MODEL BASED ON THE           JUNE 30,2019
*NORMALIZED QUADRATIC EXPENDITURE FUNCTION.
*CURVATURE CONDITIONS ARE NOT IMPOSED.
*GOOD 1 IS PER POP CONSUMPTION AND GOOD 2 IS PER POP LABOUR SUPPLY CONVERTED INTO LEISURE DEMAND.
SET NODOECHO
SMPL 1 60
*YOUR SMPL MAY BE DIFFERENT. NOW READ IN PER POP CONSUMER DATA FROM DATOUT.TXT
READ YEAR X1 X2 PC1 PC2
   1959.        0.94213        0.75025        1.00000        1.00000
   1960.        0.94160        0.76335        1.04057        1.03473
   1961.        0.94247        0.74680        1.04632        1.06254
   1962.        0.97524        0.78068        1.05999        1.05361
   1963.        1.02414        0.80649        1.07549        1.09064
   1964.        1.05392        0.83313        1.11047        1.15804
   1965.        1.06367        0.83669        1.14922        1.21684
   1966.        1.09903        0.85221        1.18230        1.27688
   1967.        1.13349        0.85508        1.22689        1.34511
   1968.        1.17089        0.84562        1.26776        1.47316
   1969.        1.21622        0.84341        1.32214        1.60347
   1970.        1.23784        0.85255        1.40137        1.79477
   1971.        1.23051        0.83523        1.49660        1.92863
   1972.        1.26771        0.83397        1.59397        2.13238
   1973.        1.32701        0.84556        1.78636        2.47628
   1974.        1.36983        0.83956        2.10045        3.11785
   1975.        1.36665        0.82688        2.43408        3.60072
   1976.        1.42505        0.82235        2.71156        4.01921
   1977.        1.43581        0.82246        2.96242        4.38523
   1978.        1.44203        0.81665        3.23147        4.69709
   1979.        1.45053        0.83138        3.55176        5.07562
   1980.        1.47679        0.84170        3.89987        5.70114
   1981.        1.54710        0.84202        4.26864        6.40249
   1982.        1.55717        0.80677        4.72946        7.20453
   1983.        1.55210        0.79064        5.07748        7.84229
   1984.        1.54723        0.81438        5.38738        8.10991
   1985.        1.60567        0.83416        5.78719        8.56054
   1986.        1.61458        0.84582        6.27865        8.83882
   1987.        1.64073        0.85775        6.72305        9.38893
   1988.        1.68889        0.87744        7.17196       10.00849
   1989.        1.73208        0.90350        7.64978       10.87793
   1990.        1.70132        0.85249        8.06125       11.89643
   1991.        1.72164        0.82751        8.27285       12.58366
   1992.        1.73828        0.81809        8.42305       13.24905
   1993.        1.75861        0.84515        8.57934       13.07484
   1994.        1.81609        0.87374        8.75687       13.11379
   1995.        1.85525        0.87663        8.99539       13.70776
   1996.        1.88983        0.86914        9.12079       14.47196
   1997.        1.96369        0.87587        9.26638       14.71216
   1998.        2.05364        0.87376        9.34641       15.28891
   1999.        2.11672        0.89384        9.53106       15.37843
   2000.        2.15618        0.89516        9.95020       16.91677
   2001.        2.19783        0.88024       10.20479       17.71036
   2002.        2.26029        0.89303       10.51083       18.26312
   2003.        2.34894        0.89586       10.67488       19.02731
   2004.        2.42599        0.91389       10.85779       19.72856
   2005.        2.47116        0.92363       11.18561       20.63304
   2006.        2.55851        0.93303       11.56763       22.29131
   2007.        2.63103        0.93991       11.92741       23.66468
   2008.        2.59205        0.92852       12.28199       24.64378
   2009.        2.63507        0.91230       12.59164       26.14124
   2010.        2.70228        0.92452       12.83965       27.56287
   2011.        2.73446        0.92660       13.15078       28.38844
   2012.        2.73535        0.91547       13.49229       28.89385
   2013.        2.76057        0.90518       13.80931       29.75176
   2014.        2.78498        0.90588       14.00880       29.81375
   2015.        2.81730        0.90885       14.19698       30.03215
   2016.        2.83561        0.90726       14.35172       30.19166
   2017.        2.87104        0.91980       14.55362       30.50860
   2018.        2.88234        0.92659       14.78896       31.07464
*X1=PER CAPITA CONSUMPTION
*X2=PER CAPITA LABOUR SUPPLY
FORMAT(F8.0,4F15.5)
PRINT YEAR X1 X2 PC1 PC2 / FORMAT
*NOTE THAT PER CAPITA CONSUMPTION INCREASED 3.06 FOLD OVER THE SAMPLE PERIOD (EXACTLY THE SAME AS CANADA!) AND PER CAPITA LABOUR SUPPLY 
*INCREASED 1.24 FOLD. THIS IS DUE TO MORE WOMEN ENTERING THE LABOUR FORCE OVER THE SAMPLE PERIOD
*GENR THE DIFFERENCE BETWEEN THE VALUE OF CONSUMPTION AND THE AFTER TAX VALUE OF LABOUR SUPPLY
GENR VC=PC1*X1
GENR VL=PC2*X2
GENR VCL=VC-VL
FORMAT(F8.0,3F10.3)
PRINT YEAR VC VL VCL / FORMAT
*THE VALUE OF CONSUMPTION EXCEEDS THE VALUE OF AFTER TAX LABOUR INCOME CONSISTENTLY OVER THE SAMPLE PERIOD.

*WE CONVERT LABOUR SUPPLY INTO LEISURE DEMAND
*ASSUME EFFECTIVE HOURS ARE EQUAL TO TWICE THE AVERAGE HOURS OF LABOUR SUPPLIED
*THIS IS THE WEAKNESS OF A LEISURE MODEL; THE MAXIMUM NUMBER OF HOURS THAT COULD BE WORKED IS ARBITRARY.
STAT X2 / MEAN=AVE
GENR ONE=1
GENR H=2*ONE*AVE
GENR X=H-X2
*GENR A NEW X2 WHICH IS EQUAL TO PER CAPITA LEISURE RATHER THAN PER CAPITA LABOUR SUPPLY
GENR X2=X
GENR Y=PC1*X1+PC2*X2
FORMAT(6F12.4)
PRINT X1 X2 PC1 PC2 Y / FORMAT
INDEX PC1 X1 PC2 X2 / CHAIN FISHER=PU QFISHER=INDEXU
FORMAT(4F12.3)
PRINT YEAR PU INDEXU Y / FORMAT
*NOTE THAT PER CAPITA UTILITY HAS GROWN 1.73 FOLD IN CANADA; MUCH MORE SLOWLY THAN
*PER CAPITA CONSUMPTION, WHICH GREW 3.06 FOLD. THIS IS EXPLAINED BY THE FACT THAT PER CAPITA
*LEISURE DECREASED FROM O.970 TO 0.794 (RATIO=.814) OVER THE SAMPLE PERIOD. MOST OTHER COUNTRIES WILL HAVE
*MUCH BIGGER INCREASES IN PER CAPITA UTILITY.

*WE IMPLEMENT A NORMALIZED QUADRATIC EXPENDITURE FUNCTION APPROACH
*WE NEED FIXED WEIGHTS SUMMING TO 1,G1 AND G2. WE INITIALLY
*DEFINE G1 AND G2 AS BEING EQUAL TO THE SAMPLE MEANS OF X1 AND X2 RESPECTIVELY
*AND THEN WE NORMALIZE THEM TO ADD UP TO 1.
STAT X1 / MEAN=GG1
STAT X2 / MEAN=GG2
GENR SUM=GG1+GG2
GENR GG1=GG1/SUM
GENR GG2=GG2/SUM
SMPL 1 1
PRINT GG1 GG2
*NOTE THAT GG1 AND GG2 ARE SCALARS; WE CONVERT THEM TO VECTORS
SMPL 1 60
*YOUR SMPL MAY BE DIFFERENT
GENR G1=1
GENR G2=1
GENR G1=GG1(1)*G1
GENR G2=GG2(1)*G2
GENR PG=PC1*G1+PC2*G2
PRINT YEAR G1 G2 PG / FORMAT
*GENR PG NORMALIZED PRICES AND INCOME:
GENR NY=Y/PG
GENR NP1=PC1/PG
GENR NP2=PC2/PG
*GENR INCOME OR EXPENDITURE NORMALIZED PRICES:
GENR PY1=PC1/Y
GENR PY2=PC2/Y
*GENR EXPENDITURE SHARES:
GENR S1=PY1*X1
GENR S2=PY2*X2
PRINT YEAR NY S1 S2 / FORMAT
STAT S1 S2
FORMAT(5F12.3)
PRINT YEAR NP1 NP2 PY1 PY2 / FORMAT

*OUR FUNCTIONAL FORM FOR THE EXPENDITURE FUNCTION, E(U,P), IS
*A.P+(B.P+.5P.CP/PG)*U WHERE A.P=O,B.P=1 AND CP=0 IN THE BASE YEAR WHEN P EQUALS A VECTOR OF ONES
*A,B AND P ARE VECTORS AND C IS A 2 BY 2 SYMMETRIC MATRIX.
*A DOT SIGNIFIES AN INNER PRODUCT.

NL 1 / NCOEF=3 GENRVAR CONV=.000001 ITER=150 LIST
EQ S1=PY1*A1+(PY1*(B1+C11*(NP1-NP2) &
-.5*G1*C11*(NP1-NP2)*(NP1-NP2)) &
*(NY-A1*(NP1-NP2)) &
/(B1*(NP1-NP2)+NP2+.5*C11*(NP1-NP2)*(NP1-NP2)))
COEF A1 .01 B1 .5 C11 -.1  
END
STOP
* FINAL STATISTICS: TIME =     0.0310 SEC.   ITER. NO.    20   FUNCT. EVALUATIONS    32
* FINAL LOG-LIKELIHOOD FUNCTION = 176.7857
* DURBIN-WATSON = 0.4406    VON NEUMANN RATIO = 0.4481    RHO =  0.73198
* RESIDUAL SUM =  0.13318E-03  RESIDUAL VARIANCE =  0.16154E-03
* SUM OF ABSOLUTE ERRORS=  0.59024
* R-SQUARE BETWEEN OBSERVED AND PREDICTED = 0.9164
*LOTS OF AUTOCORRELATION; R SQUARE NOT TOO BAD
*      COEFFICIENT    ST. ERROR   T-RATIO
* A1       -1.0728     0.68397E-01 -15.685
* B1        1.0840     0.37347E-01  29.026
* C11      0.10666E-01 0.27231E-01 0.39169
*CURVATURE CONDITIONS ARE SATISFIED IF C11 IS NEGATIVE.
*UNFORTUNATELY OUR C11 IS POSITIVE INSTEAD OF BEING NEGATIVE. 
*NOTE THAT WE HAVE MANY BREAK POINTS: MORE IMPORTANT ONES ARE 9 25 31 34 49 56
*WE WILL ATTEMPT TO IMPROVE THE FIT IN SUBSEQUENT MODELS

*WE NOW GENR FITTED UTILITY AND WE GENR ELASTICITIES OF DEMAND
GENR A2=-A1
GENR B2=1-B1
GENR C12=-C11
GENR C21=C12
GENR C22=C11
GENR CP1=C11*NP1+C12*NP2
GENR CP2=C21*NP1+C22*NP2
GENR PCP=NP1*CP1+NP2*CP2
*GENR INDIRECT UTILITY U AND FITTED EXPENDITURE,FE:
GENR U=(NY-A1*NP1-A2*NP2)/(B1*NP1+B2*NP2+.5*PCP)
GENR FE=PC1*A1+PC2*A2+(B1*PC1+B2*PC2+.5*PCP*PG)*U
PRINT YEAR U INDEXU FE Y / FORMAT
*NOTE THAT INDEX U AND THE INDIRECT UTILITY WE GET FROM OUR DEMAND MODEL (U) ARE THE SAME AT THE START
*OF THE SAMPLE PERIOD BUT THEY DIVERGE AS TIME PROGRESSES. U ENDS UP AT  3.69 AND INDEXU ENDED UP AT 3.302.
*OUR ESTIMATED INDIRECT UTILITY GREW ABOUT 1.93 FOLD OVER THE SAMPLE PERIOD.
     
*GENR FITTED X'S AND EXPENDITURE SHARES:
GENR FX1=A1+(B1+CP1-.5*G1*PCP)*U
GENR FX2=A2+(B2+CP2-.5*G2*PCP)*U
GENR FS1=PY1*FX1
GENR FS2=PY2*FX2
FORMAT(F8.0,4F10.5)
PRINT YEAR S1 FS1 S2 FS2 / FORMAT
PRINT YEAR X1 FX1 X2 FX2 / FORMAT
*CHECK THAT YOUR FITTED FS1 PRINTED ABOVE IS EQUAL TO THE FITTED VALUES IN YOUR REGRESSION; OK FOR AUSTRALIA
*WE KNOW THAT THE FITTED SHARE FOR CONSUMPTION IS CLOSE TO THE ACTUAL SHARE FOR CONSUMPTION;
*LET'S SEE HOW CLOSE FITTED CONSUMPTION IS TO ACTUAL CONSUMPTION
OLS X1 FX1 / LIST NOCONSTANT
* R-SQUARE BETWEEN OBSERVED AND PREDICTED = 0.9967, MUCH HIGHER THAN OUR SHARE EQUATION R SQUARE ABOVE
*WHICH WAS 0.9164. THIS HIGHER R SQUARE IS TO BE EXPECTED BECAUSE THE VARIATION IN X1 IS MUCH BIGGER THAN
*THE VARIATION IN S1 AND OUR MODEL EXPLAINS MORE OF THE VARIATION IN X1. BUT THIS REGRESSION SHOWS OUR SIMPLE
*MODEL WITH ONLY 3 PARAMETERS FITS THE DATA QUITE WELL.
*NOTE THAT THE BREAK POINTS IN THE ABOVE REGRESSION, 9 25 31 34 49 56, ARE PRETTY MUCH THE SAME AS THE BREAK 
*POINTS  IN THE FIRST SHARE EQUATION REGRESSION.

*GENR HICKSIAN PRICE ELASTICITIES OF DEMAND ECIJ:
*FIRST GENR THE MATRIX OF SECOND ORDER PARTIAL DERIVATIVES OF THE COST FUNCTION
DO #=1,2
DO $=1,2
GENR DC#$=(C#$-G#*CP$-CP#*G$+G#*G$*PCP)*U/PG
ENDO
ENDO
*GENR HICKSIAN PRICE ELASTICITIES OF DEMAND
DO #=1,2
DO $=1,2
GENR EC#$=DC#$*PC$/FX#
ENDO
ENDO
*GENR CHECKS
GENR CHECK1=EC11+EC12
GENR CHECK2=EC21+EC22
STAT CHECK1 CHECK2
*EACH CHECK# SHOULD EQUAL 0; THESE CHECKS ARE SATISFIED 
*GENR HICKSIAN ELASTICITIES OF DEMAND W.R.T. REAL INCOME OR UTILITY:
DO #=1,2
GENR ECU#=(B#+CP#-.5*G#*PCP)*U/FX#
ENDO
PRINT YEAR EC11 EC12 EC21 EC22 / FORMAT
STAT EC11 EC12 EC21 EC22
* NAME         N    MEAN       ST. DEV      VARIANCE    MINIMUM      MAXIMUM
* EC11         60  0.23309E-01 0.13155E-02 0.17305E-05  0.20232E-01  0.25321E-01
* EC12         60 -0.23309E-01 0.13155E-02 0.17305E-05 -0.25321E-01 -0.20232E-01
* EC21         60 -0.31180E-01 0.63275E-02 0.40037E-04 -0.42328E-01 -0.22171E-01
* EC22         60  0.31180E-01 0.63275E-02 0.40037E-04  0.22171E-01  0.42328E-01
*ALL OF THESE ELASTICITIES HAVE THE WRONG SIGN!
FORMAT(F8.0,2F10.5)
PRINT YEAR ECU1 ECU2 / FORMAT
STAT ECU1 ECU2
* NAME         N    MEAN       ST. DEV      VARIANCE     MINIMUM      MAXIMUM
* ECU1         60   1.6608     0.22434     0.50328E-01   1.3707       2.0887
* ECU2         60 -0.24971     0.58871E-01 0.34658E-02 -0.35811     -0.17487
*THESE INCOME ELASTICITIES ARE OK. NOTE THAT CONSUMPTION IS A NORMAL GOOD (ECU1 IS POSITIVE)
*AND LEISURE IS AN INFERIOR GOOD (ECU2 IS NEGATIVE). 
*THIS MODEL IS NOT SATISFACTORY (THE CURVATURE CONDITIONS ARE NOT SATISFIED) SO WE MOVE ON TO CMOD2 WHERE WE IMPOSE
*CONCAVITY ON THE NORMALIZED QUADRATIC EXPENDITURE FUNCTION.
STOP
