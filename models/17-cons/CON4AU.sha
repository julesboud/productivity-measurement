*THIS IS THE FILE E59418C\CON4.TXT THAT ESTIMATES NONHOMOTHETIC NORMALIZED QUADRATIC PREFERENCES   JUNE 30, 2018
*WE DO NOT IMPOSE MONEY METRIC UTILITY SCALING IN THIS MODEL; WE SPLINE UTILITY IN THIS MODEL (2 BREAK POINTS)
*WE ESTIMATE A NORMALIZED QUADRATIC RANK 2 SUBSTITUTION MATRIX IN THIS MODEL
PAR 10000                   
SIZE 5000
SET NODOECHO
*READ IN AUSTRALIAN DATA FOR 1985-2018 FOR 17 CLASSES OF PER POP CONSUMPTION FROM E59419C\CDATOUT.TXT
SMPL 1 33
READ YEAR P1-P9 
   1985.   1.00000   1.00000   1.00000   1.00000   1.00000   1.00000   1.00000   1.00000   1.00000
   1986.   1.08081   1.10020   1.11920   1.09374   1.07878   1.05148   1.09041   1.10967   1.17568
   1987.   1.13579   1.18814   1.20754   1.17806   1.18601   1.11203   1.16006   1.17853   1.30819
   1988.   1.23865   1.22683   1.31907   1.25635   1.30791   1.16366   1.22593   1.26678   1.41357
   1989.   1.32558   1.30501   1.48947   1.32069   1.41193   1.20684   1.28549   1.37106   1.47655
   1990.   1.36967   1.39833   1.66873   1.38248   1.48231   1.27020   1.33940   1.48489   1.48039
   1991.   1.40268   1.45070   1.81845   1.40490   1.51105   1.32850   1.36029   1.58759   1.54660
   1992.   1.42741   1.50054   2.18350   1.42519   1.51771   1.38134   1.36461   1.54918   1.59462
   1993.   1.45502   1.55733   2.49074   1.41770   1.52410   1.41216   1.38620   1.58936   1.67345
   1994.   1.49049   1.61311   2.69924   1.41868   1.53196   1.42428   1.40707   1.66393   1.73870
   1995.   1.54037   1.70116   3.13760   1.42059   1.55871   1.43444   1.42974   1.73161   1.75008
   1996.   1.58939   1.74321   3.28548   1.42728   1.59540   1.45691   1.44616   1.82523   1.63757
   1997.   1.61070   1.76305   3.39283   1.42534   1.64325   1.47247   1.44963   1.89143   1.52936
   1998.   1.68923   1.79000   3.52070   1.40910   1.68197   1.43159   1.45570   1.87536   1.46444
   1999.   1.71227   1.79827   3.79570   1.39586   1.72289   1.43275   1.45967   2.07594   1.46423
   2000.   1.74502   1.93044   4.30896   1.49544   1.77635   1.58664   1.49303   2.06298   1.46495
   2001.   1.82720   1.97864   4.53981   1.48837   1.83944   1.64727   1.52754   2.13063   1.48470
   2002.   1.89743   2.01557   4.76304   1.50712   1.90733   1.72711   1.52783   2.24390   1.55102
   2003.   1.94634   2.09354   4.94371   1.50970   1.97838   1.79639   1.51476   2.29083   1.49165
   2004.   1.96189   2.16553   4.95969   1.47905   2.05686   1.85682   1.49206   2.35732   1.41504
   2005.   2.05244   2.21593   5.16277   1.45227   2.15215   1.91770   1.49094   2.40023   1.38854
   2006.   2.19318   2.27635   5.56019   1.44119   2.26944   1.98428   1.49948   2.53003   1.40000
   2007.   2.25464   2.35770   5.83753   1.44768   2.41862   2.12298   1.50120   2.58083   1.39309
   2008.   2.34528   2.44708   6.07872   1.43137   2.59616   2.20192   1.49338   2.59126   1.36547
   2009.   2.35795   2.51646   6.36500   1.43690   2.71646   2.43937   1.52554   2.65357   1.37134
   2010.   2.39914   2.55778   7.77426   1.40696   2.82863   2.70454   1.51779   2.67182   1.36071
   2011.   2.42596   2.60481   8.27714   1.41322   2.95277   3.14317   1.52077   2.69743   1.32949
   2012.   2.45480   2.66604   8.86338   1.40982   3.05675   3.68870   1.50064   2.76157   1.30016
   2013.   2.48981   2.73867   9.92116   1.40499   3.14107   3.90917   1.50294   2.83124   1.27409
   2014.   2.55137   2.79576  11.22214   1.38082   3.20957   3.84047   1.49440   2.89136   1.26748
   2015.   2.53452   2.85545  12.63424   1.38316   3.24287   3.83722   1.52627   2.97068   1.32516
   2016.   2.57419   2.87728  14.05046   1.37280   3.28098   4.04080   1.52202   3.00560   1.31152
   2017.   2.54878   2.94138  15.96832   1.32753   3.33466   4.44474   1.48980   3.06670   1.29569

FORMAT(F8.0,9F10.5)
PRINT YEAR P1-P9 / FORMAT
READ YEAR P10-P17
   1985.   1.00000   1.00000   1.00000   1.00000   1.00000   1.00000   1.00000   1.00000
   1986.   1.05777   1.04339   1.03444   1.08949   1.10206   1.09287   1.07920   1.04944
   1987.   1.10338   1.11597   1.11398   1.15056   1.21907   1.17624   1.14931   1.04781
   1988.   1.11019   1.19830   1.13363   1.19647   1.35726   1.23388   1.21910   0.96725
   1989.   1.20737   1.28462   1.12549   1.24076   1.52745   1.31852   1.30327   1.06175
   1990.   1.32751   1.34009   1.15619   1.28992   1.70998   1.41133   1.37226   1.14946
   1991.   1.32065   1.26406   1.20545   1.32519   1.85858   1.46464   1.41215   1.18329
   1992.   1.34018   1.22348   1.20472   1.36426   1.98486   1.51508   1.43567   1.31193
   1993.   1.34587   1.24340   1.19725   1.38864   2.06684   1.55955   1.46084   1.34423
   1994.   1.36799   1.25355   1.21382   1.40352   2.15160   1.60373   1.50465   1.35071
   1995.   1.41830   1.24404   1.21033   1.42192   2.30447   1.64711   1.56637   1.36413
   1996.   1.43527   1.30105   1.20121   1.41089   2.37941   1.68444   1.57343   1.36114
   1997.   1.41593   1.35232   1.20031   1.42013   2.47866   1.71438   1.64069   1.43547
   1998.   1.40432   1.35982   1.15632   1.41907   2.63970   1.75588   1.63162   1.51944
   1999.   1.47429   1.38003   1.09495   1.41496   2.72763   1.81345   1.66224   1.50045
   2000.   1.60080   1.38496   1.17241   1.47121   2.91442   1.97529   1.73812   1.66401
   2001.   1.57891   1.33587   1.17698   1.48662   2.98811   2.04126   1.81101   1.71404
   2002.   1.62813   1.39566   1.22432   1.47846   3.26015   2.10333   1.86266   1.68485
   2003.   1.68636   1.40383   1.24194   1.44805   3.39754   2.18402   1.87369   1.51186
   2004.   1.77714   1.47207   1.26307   1.43938   3.70491   2.25268   1.88425   1.52566
   2005.   1.94750   1.60200   1.26333   1.43959   3.91548   2.32428   1.93343   1.55093
   2006.   2.04471   1.69167   1.27041   1.44515   4.09385   2.40676   1.96699   1.56737
   2007.   2.24916   1.72850   1.28989   1.45472   4.24190   2.49242   1.98233   1.49407
   2008.   2.16253   1.62872   1.25830   1.47628   4.53150   2.48600   2.14810   1.66427
   2009.   2.17161   1.70080   1.25851   1.48619   4.81824   2.54372   2.19621   1.45807
   2010.   2.23963   1.72151   1.20437   1.46427   5.07346   2.59410   2.22838   1.35583
   2011.   2.31016   1.80667   1.17682   1.45380   5.35709   2.68219   2.27100   1.33397
   2012.   2.34495   1.81245   1.22703   1.46541   5.66292   2.74597   2.35631   1.36287
   2013.   2.42872   1.98192   1.11538   1.47327   5.97997   2.80075   2.43393   1.51690
   2014.   2.31320   2.07616   1.01520   1.49592   6.30235   2.84795   2.49639   1.60683
   2015.   2.27453   2.12553   0.88609   1.52077   6.59157   2.92444   2.55412   1.73699
   2016.   2.30209   2.11511   0.81349   1.52108   6.78731   2.96177   2.60333   1.66431
   2017.   2.41135   2.15486   0.78219   1.51379   6.98437   3.02235   2.65984   1.68636
PRINT YEAR P10-P17 / FORMAT
READ YEAR Q1-Q9 
   1985.   1.18670   0.17032   0.20084   0.57239   1.56477   0.20027   0.69621   0.37338   0.34747
   1986.   1.16815   0.16177   0.19824   0.55793   1.60136   0.20566   0.67735   0.38858   0.26656
   1987.   1.16774   0.16187   0.19410   0.56232   1.63475   0.20408   0.69460   0.39061   0.25855
   1988.   1.14383   0.16078   0.19044   0.55474   1.67218   0.20506   0.70379   0.41480   0.31118
   1989.   1.14658   0.16379   0.18703   0.54092   1.70626   0.21580   0.71109   0.41803   0.35497
   1990.   1.13051   0.15859   0.17648   0.50819   1.72145   0.21413   0.66596   0.41988   0.32720
   1991.   1.14362   0.15412   0.16354   0.52049   1.75949   0.21210   0.68666   0.42474   0.30179
   1992.   1.15056   0.15619   0.15182   0.49895   1.79503   0.21975   0.69999   0.45114   0.31909
   1993.   1.15354   0.16632   0.13890   0.49158   1.84064   0.21639   0.70833   0.46453   0.31671
   1994.   1.19261   0.18018   0.12897   0.49630   1.88640   0.22333   0.71946   0.46050   0.35585
   1995.   1.20789   0.17588   0.11855   0.51209   1.92512   0.22699   0.71475   0.45611   0.35708
   1996.   1.18492   0.17848   0.12032   0.51216   1.95995   0.22902   0.71266   0.44873   0.39972
   1997.   1.21429   0.18753   0.12002   0.51757   2.00010   0.24015   0.72240   0.43884   0.48996
   1998.   1.20315   0.19615   0.12157   0.54628   2.04806   0.24885   0.72299   0.47013   0.53184
   1999.   1.22606   0.20611   0.11997   0.56525   2.09339   0.25639   0.77550   0.47065   0.52375
   2000.   1.25855   0.21019   0.11447   0.56178   2.13259   0.26045   0.78401   0.49915   0.54238
   2001.   1.28520   0.21183   0.10949   0.58188   2.16502   0.26051   0.82671   0.54017   0.53699
   2002.   1.29738   0.21714   0.10836   0.61989   2.20719   0.26565   0.86333   0.56527   0.54709
   2003.   1.33019   0.22020   0.10571   0.65708   2.25642   0.27771   0.89868   0.58755   0.59658
   2004.   1.36050   0.23251   0.10700   0.70155   2.30349   0.27693   0.93815   0.60557   0.62096
   2005.   1.37336   0.23615   0.10243   0.73895   2.34082   0.27734   0.91259   0.61501   0.62535
   2006.   1.37697   0.24688   0.09843   0.79546   2.36552   0.27986   0.97344   0.64140   0.65662
   2007.   1.38643   0.25352   0.09181   0.83340   2.37741   0.28327   1.02632   0.67173   0.71485
   2008.   1.39060   0.25890   0.08767   0.85948   2.39056   0.28382   1.03504   0.69896   0.54086
   2009.   1.39477   0.26455   0.08377   0.90146   2.41756   0.28405   1.04220   0.72023   0.57359
   2010.   1.40568   0.27222   0.07757   0.92372   2.44944   0.28239   1.06944   0.74780   0.58052
   2011.   1.42178   0.28026   0.07273   0.92295   2.46630   0.26453   1.09827   0.77608   0.61200
   2012.   1.43997   0.27387   0.07000   0.93543   2.47468   0.24646   1.11038   0.82107   0.68480
   2013.   1.46053   0.27352   0.06669   0.97659   2.48921   0.24013   1.13637   0.82652   0.69428
   2014.   1.44636   0.27816   0.05897   0.98426   2.50562   0.23874   1.18894   0.84095   0.70642
   2015.   1.48582   0.27648   0.05438   1.03357   2.52370   0.24021   1.21462   0.85112   0.73033
   2016.   1.48579   0.27899   0.05035   1.04375   2.54035   0.24286   1.22483   0.87108   0.72913
   2017.   1.52604   0.27901   0.04997   1.07038   2.55915   0.23822   1.24431   0.88604   0.72016
PRINT YEAR Q1-Q9 / FORMAT
READ YEAR Q10-Q17 
   1985.   0.68665   0.23606   0.13143   0.93449   0.17063   0.68424   1.13641   0.13675
   1986.   0.69842   0.23574   0.13591   0.93211   0.17804   0.65669   1.28147   0.13819
   1987.   0.70113   0.24154   0.14119   0.97261   0.17345   0.66340   1.33461   0.15832
   1988.   0.69947   0.25916   0.14946   1.02506   0.18125   0.67455   1.42351   0.18948
   1989.   0.71114   0.26912   0.15974   1.08328   0.19312   0.68809   1.46730   0.20591
   1990.   0.69001   0.28137   0.16258   1.06697   0.18697   0.65300   1.47600   0.18840
   1991.   0.70012   0.30212   0.17604   1.09466   0.18667   0.65172   1.48726   0.17198
   1992.   0.71491   0.30279   0.20089   1.11449   0.18447   0.62606   1.48062   0.17428
   1993.   0.72818   0.29585   0.22230   1.18526   0.18817   0.65001   1.42636   0.17255
   1994.   0.73514   0.30208   0.24210   1.27981   0.19058   0.69853   1.44406   0.19014
   1995.   0.73769   0.33411   0.27682   1.36848   0.19058   0.73032   1.45663   0.20900
   1996.   0.73134   0.33806   0.30940   1.45314   0.19721   0.69692   1.52325   0.23768
   1997.   0.75891   0.33592   0.33441   1.53376   0.20381   0.72892   1.60593   0.26091
   1998.   0.79512   0.36175   0.37880   1.60713   0.21158   0.79319   1.72865   0.29044
   1999.   0.78720   0.37490   0.42740   1.66737   0.22243   0.82005   1.81161   0.29518
   2000.   0.77848   0.41596   0.47832   1.71152   0.22058   0.82223   1.81498   0.32170
   2001.   0.78603   0.42814   0.50507   1.76524   0.23286   0.80410   1.82572   0.28989
   2002.   0.80821   0.44573   0.53408   1.88210   0.22734   0.83242   1.84507   0.29642
   2003.   0.81919   0.46862   0.55479   2.01978   0.23217   0.85798   1.93959   0.39618
   2004.   0.85565   0.49213   0.59255   2.11042   0.23160   0.85231   2.03395   0.47188
   2005.   0.82738   0.50307   0.62698   2.17825   0.23890   0.85716   2.14638   0.48149
   2006.   0.85177   0.55867   0.63973   2.28163   0.24470   0.89096   2.26340   0.53243
   2007.   0.87310   0.63140   0.65237   2.39560   0.24519   0.88356   2.35575   0.65718
   2008.   0.85421   0.60736   0.66196   2.38247   0.25276   0.86403   2.22099   0.64361
   2009.   0.87870   0.59237   0.65950   2.44715   0.26735   0.88748   2.24058   0.77581
   2010.   0.92666   0.66121   0.69684   2.59611   0.27359   0.91068   2.25131   0.89355
   2011.   0.92698   0.68156   0.71625   2.69623   0.27859   0.91492   2.24641   0.95233
   2012.   0.92726   0.66515   0.70323   2.61503   0.28275   0.89940   2.23165   0.97790
   2013.   0.91939   0.61472   0.77890   2.61039   0.28518   0.91532   2.29151   0.94728
   2014.   0.90321   0.59081   0.86079   2.67692   0.28425   0.94407   2.31887   0.87906
   2015.   0.87745   0.59103   0.96742   2.69451   0.28427   0.93572   2.36958   0.87605
   2016.   0.86842   0.59527   1.04844   2.68162   0.28415   0.93906   2.40976   0.93191
   2017.   0.86794   0.59882   1.08895   2.73428   0.28587   0.95375   2.44551   0.94431
PRINT YEAR Q10-Q17 / FORMAT
*1 IS THE SERIES       P31CP010: Food and non-alcoholic beverages
*2 IS THE SERIES       P31CP021: Alcoholic beverages
*3 IS THE SERIES       P31CP022: Tobacco
*4 IS THE SERIES       P31CP030: Clothing and footwear
*5 IS THE SERIES       P31CP041+P31CP042+P31CP043+P31CP044: HOUSING AGGREGATE
*6 IS THE SERIES       P31CP045: Electricity, gas and other fuels
*7 IS THE SERIES       P31CP050: Furnishings, households equipment and routine maintenance of the house
*8 IS THE SERIES       P31CP060: Health
*9 IS THE SERIES       P31CP071: Purchase of vehicles
*10 IS THE SERIES      P31CP072: Operation of personal transport equipment
*11 IS THE SERIES      P31CP073: Transport services
*12 IS THE SERIES      P31CP080: Communications
*13 IS THE SERIES      P31CP090: Recreation and culture
*14 IS THE SERIES      P31CP100: Education
*15 IS THE SERIES      P31CP110: Restaurants and hotels
*16 IS THE SERIES      P31CP120: Miscellaneous goods and services
*17 IS THE SERIES      P33:      Final consumption expenditure of resident households abroad
DO #=1,17
GENR V#=P#*Q#
ENDO
*GENR TOTAL EXPENDITURE Y FOR EACH PERIOD
GENR Y=0
DO #=1,17
GENR Y=Y+V#
ENDO
*GENR CHAINED FISHER PRICE AND QUANTITY INDEXES
INDEX P1 Q1 P2 Q2 P3 Q3 P4 Q4 P5 Q5 P6 Q6 P7 Q7 P8 Q8 P9 Q9 P10 Q10 &
P11 Q11 P12 Q12 P13 Q13 P14 Q14 P15 Q15 P16 Q16 P17 Q17 / CHAIN FISHER=PF QFISHER=QF
*GENR EXPENDITURE Y ON THE 17 COMMODITIES
GENR Y=PF*QF
*GENR THE NORMALIZED QUADRATIC FIXED BASE AND CHAINED INDEXES
*WE FIRST NEED TO GENR FIXED WEIGHTS SUMMING TO 1,G1 TO G17. WE INITIALLY DEFINE THESE G# AS SAMPLE MEANS
DO #=1,17
STAT Q# / MEAN=GG#
ENDO
*SUM THE GG#
SMPL 1 1
GENR SUM=0
DO #=1,17
GENR SUM=SUM+GG#
ENDO
*DEFINE THE NORMALIZED GG#
DO #=1,17
GENR GG#=GG#/SUM
ENDO
FORMAT(9F10.5)
PRINT GG1-GG9 / FORMAT
PRINT GG10-GG17 / FORMAT
SMPL 1 33
GENR ONE=1
DO #=1,17
GENR G#=GG#(1)*ONE
ENDO
*GENR THE LOWE PRICE INDEX PG
GENR PG=0
DO #=1,17
GENR PG=PG+P#*G#
ENDO
*GENR PG NORMALIZED PRICES:
DO #=1,17
GENR PN#=P#/PG
ENDO
FORMAT(9F10.5)
PRINT PG PN1-PN8 / FORMAT
PRINT PN9-PN17 / FORMAT
STAT PG PN1-PN17

*THE EXACT INDEX NUMBER FORMULA FOR NORMALIZED QUADRATIC PREFERENCES USING A FIXED BASE IS
*u(t)/u(1)=SUM(PN#(t)+PN#(1))Q#(t)/(SUM(PN#(t)+PN#(1))Q#(1))
GENR NUM=0
GENR DEN=0
DO #=1,17
GENR NUM=NUM+(PN#+PN#(1))*Q#
GENR DEN=DEN+(PN#+PN#(1))*Q#(1)
ENDO
GENR QNFB=NUM/DEN
*NORMALIZE QNFB TO EQUAL Y IN OBSERVATION 1
GENR CON=QNFB(1)
GENR QNFB=QNFB*Y(1)/CON
GENR PNFB=Y/QNFB
*NOW CONSTRUCT THE NORMALIZED QUADRATIC CHAIN LINKS
GENR QNCH=1
GENR QNCHL=1
GENR NUML=0
GENR DENL=0
SMPL 2 33
DO #=1,17
GENR NUML=NUML+(PN#+LAG(PN#))*Q#
GENR DENL=DENL+(PN#+LAG(PN#))*LAG(Q#)
ENDO
*NOW CONSTRUCT THE NORMALIZED QUADRATIC EXACT INDEX NUMBER FORMULA USING THE CHAIN PRINCIPLE
GENR QNCHL=NUML/DENL
GENR QNCH=LAG(QNCH)*QNCHL
*NORMALIZE QNCH TO EQUAL Y AT OBSERVATION 1
SMPL 1 33
GENR CON=QNCH(1)
GENR QNCH=QNCH*Y(1)/CON
GENR PNCH=Y/QNCH
FORMAT(F8.0,7F10.5)
PRINT YEAR QF QNCH QNFB PF PNCH PNFB Y / FORMAT
*   YEAR      QF        QNCH      QNFB      PF        PNCH      PNFB       Y
*   1985.   9.42901   9.42901   9.42901   1.00000   1.00000   1.00000   9.42901
*   1986.   9.47789   9.47789   9.47789   1.08487   1.08487   1.08487  10.28229
*   1987.   9.64763   9.64763   9.64692   1.16056   1.16056   1.16064  11.19662
*   1988.   9.95313   9.95313   9.94844   1.23539   1.23539   1.23597  12.29599
*   1989.  10.21571  10.21570  10.21129   1.31845   1.31845   1.31902  13.46888
*   1990.  10.02299  10.02298  10.01815   1.38995   1.38995   1.39062  13.93147
*   1991.  10.12546  10.12545  10.12224   1.42675   1.42675   1.42720  14.44647
*   1992.  10.22121  10.22120  10.21281   1.45483   1.45483   1.45603  14.87015
*   1993.  10.33576  10.33575  10.32383   1.48220   1.48220   1.48391  15.31962
*   1994.  10.68357  10.68356  10.67150   1.51261   1.51261   1.51432  16.16007
*   1995.  10.92398  10.92397  10.91254   1.55381   1.55381   1.55544  16.97382
*   1996.  11.14574  11.14573  11.13178   1.57552   1.57552   1.57749  17.56031
*   1997.  11.58996  11.58995  11.58457   1.60232   1.60232   1.60306  18.57081
*   1998.  12.13405  12.13403  12.12103   1.61821   1.61822   1.61995  19.63550
*   1999.  12.50055  12.50053  12.47602   1.64933   1.64933   1.65257  20.61753
*   2000.  12.75038  12.75036  12.72683   1.72463   1.72463   1.72782  21.98966
*   2001.  12.95913  12.95911  12.93337   1.76905   1.76905   1.77257  22.92531
*   2002.  13.32383  13.32381  13.30486   1.82057   1.82057   1.82317  24.25698
*   2003.  13.92029  13.92027  13.89359   1.84433   1.84433   1.84787  25.67356
*   2004.  14.42630  14.42628  14.41754   1.87579   1.87580   1.87693  27.06075
*   2005.  14.69361  14.69358  14.67184   1.93201   1.93201   1.93488  28.38820
*   2006.  15.23701  15.23699  15.20494   1.99714   1.99714   2.00135  30.43045
*   2007.  15.74801  15.74799  15.72309   2.05507   2.05507   2.05832  32.36323
*   2008.  15.51279  15.51277  15.46696   2.12126   2.12127   2.12755  32.90672
*   2009.  15.85834  15.85833  15.79214   2.16360   2.16360   2.17267  34.31107
*   2010.  16.32160  16.32160  16.18677   2.20002   2.20002   2.21834  35.90781
*   2011.  16.54152  16.54152  16.39556   2.25074   2.25074   2.27077  37.23060
*   2012.  16.55908  16.55908  16.38913   2.30924   2.30924   2.33319  38.23891
*   2013.  16.68267  16.68268  16.48590   2.37123   2.37123   2.39953  39.55840
*   2014.  16.77637  16.77639  16.55935   2.40975   2.40975   2.44133  40.42684
*   2015.  16.95788  16.95790  16.72883   2.44835   2.44835   2.48188  41.51889
*   2016.  17.10059  17.10061  16.79531   2.47049   2.47049   2.51540  42.24691
*   2017.  17.31293  17.31296  16.90802   2.50543   2.50543   2.56543  43.37640
*THE CHAINED FISHER AND CHAINED NORMALIZED QUADRATIC INDEXES DIFFER ONLY IN THE 4TH AND 5TH DECIMAL PLACE
*THEY ARE INCREDIBLY CLOSE!

*RUN SEPARATE EQ BY EQU NONHOMOTHETIC LEONTIEF REGRESSIONS USING QNCH AS THE UTILITY LEVEL
GENR U=QNCH
*IN THIS RUN, WE WILL SPLINE UTILITY AT 2 BREAK POINTS 12 AND 16
GENR U=QNCH
*WE WILL SPLINE UTILITY AT OBS 12 AND 16
DO #=1,3
GENR U#=0
ENDO
GENR U1=U
SMPL 13 33
GENR U1=U1(12)
GENR U2=U-U(12)
SMPL 17 33
GENR U2=U2(16)
GENR U3=U-U(16)
SMPL 1 33
GENR CHECK=U-U1-U2-U3
STAT CHECK
*CHECK SHOULD BE 0 FOR ALL OBSERVATIONS AND THIS CHECK IS SATISFIED

*CHANGE NOTATION FOR NORMALIZED PRICES; CALL THEM V# INSTEAD OF PN#
DO #=1,17
GENR V#=PN#
ENDO

*GENR DIFFERENCES OF NORMALIZED PRICES WITH THE FIRST NORMALIZED INPUT PRICE
DO #=1,17
GENR V1D#=V#-V1
ENDO
*GENR DIFFERENCES OF NORMALIZED PRICES WITH THE SECOND NORMALIZED INPUT PRICE
DO #=2,17
GENR V2D#=V#-V2
ENDO
*C(u,p) = a.p + bA.pU1 + bB.pU2 + bC.pU3 - (1/2)(p.c)(p.c)U/p.g WHERE c.1 = 0.
*ADD THE TERM - (1/2)(p.d)(p.d)/p.g WHERE d.1 = 0 AND d(1)=0 
*THE HICKSIAN DEMAND FUNCTIONS ARE AS FOLLOWS
*WE USE THE FINAL COEFS FROM CON3OUT.TXT AS STARTING VALUES IN THE FOLLOWING REGRESSION
 
NL 17 / NCOEF=99 GENRVAR CONV=.000001 ITER=2000 PITER=100 LIST
EQ Q1=A1+BA1*U1+BB1*U2+BC1*U3 &
+(C2+C3+C4+C5+C6+C7+C8+C9+C10+C11+C12+C13+C14+C15+C16+C17)*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7 &
+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12+C13*V1D13+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)*U &
+(1/2)*G1*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12 &
+C13*V1D13+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)**2)*U &
+(1/2)*G1*((D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12 &
+D13*V2D13+D14*V2D14+D15*V2D15+D16*V2D16+D17*V2D17)**2)*U  
EQ Q2=A2+BA2*U1+BB2*U2+BC2*U3 &
-C2*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12+C13*V1D13 &
+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)*U &
+(D3+D4+D5+D6+D7+D8+D9+D10+D11+D12+D13+D14+D15+D16+D17)*(D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8 &
+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12+D13*V2D13+D14*V2D14+D15*V2D15+D16*V2D16+D17*V2D17)*U  &
+(1/2)*G2*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12 &
+C13*V1D13+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)**2)*U &
+(1/2)*G2*((D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12 &
+D13*V2D13+D14*V2D14+D15*V2D15+D16*V2D16+D17*V2D17)**2)*U  
EQ Q3=A3+BA3*U1+BB3*U2+BC3*U3 &
-C3*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12+C13*V1D13 &
+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)*U &
-D3*(D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8 &
+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12+D13*V2D13+D14*V2D14+D15*V2D15+D16*V2D16+D17*V2D17)*U  &
+(1/2)*G3*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12 &
+C13*V1D13+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)**2)*U &
+(1/2)*G3*((D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12 &
+D13*V2D13+D14*V2D14+D15*V2D15+D16*V2D16+D17*V2D17)**2)*U  
EQ Q4=A4+BA4*U1+BB4*U2+BC4*U3 &
-C4*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12+C13*V1D13 &
+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)*U &
-D4*(D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8 &
+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12+D13*V2D13+D14*V2D14+D15*V2D15+D16*V2D16+D17*V2D17)*U  &
+(1/2)*G4*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12 &
+C13*V1D13+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)**2)*U &
+(1/2)*G4*((D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12 &
+D13*V2D13+D14*V2D14+D15*V2D15+D16*V2D16+D17*V2D17)**2)*U  
EQ Q5=A5+BA5*U1+BB5*U2+BC5*U3 &
-C5*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12+C13*V1D13 &
+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)*U &
-D5*(D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8 &
+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12+D13*V2D13+D14*V2D14+D15*V2D15+D16*V2D16+D17*V2D17)*U  &
+(1/2)*G5*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12 &
+C13*V1D13+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)**2)*U &
+(1/2)*G5*((D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12 &
+D13*V2D13+D14*V2D14+D15*V2D15+D16*V2D16+D17*V2D17)**2)*U   
EQ Q6=A6+BA6*U1+BB6*U2+BC6*U3 &
-C6*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12+C13*V1D13 &
+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)*U &
-D6*(D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8 &
+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12+D13*V2D13+D14*V2D14+D15*V2D15+D16*V2D16+D17*V2D17)*U  &
+(1/2)*G6*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12 &
+C13*V1D13+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)**2)*U &
+(1/2)*G6*((D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12 &
+D13*V2D13+D14*V2D14+D15*V2D15+D16*V2D16+D17*V2D17)**2)*U 
EQ Q7=A7+BA7*U1+BB7*U2+BC7*U3 &
-C7*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12+C13*V1D13 &
+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)*U &
-D7*(D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8 &
+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12+D13*V2D13+D14*V2D14+D15*V2D15+D16*V2D16+D17*V2D17)*U  &
+(1/2)*G7*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12 &
+C13*V1D13+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)**2)*U &
+(1/2)*G7*((D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12 &
+D13*V2D13+D14*V2D14+D15*V2D15+D16*V2D16+D17*V2D17)**2)*U 
EQ Q8=A8+BA8*U1+BB8*U2+BC8*U3 &
-C8*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12+C13*V1D13 &
+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)*U &
-D8*(D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8 &
+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12+D13*V2D13+D14*V2D14+D15*V2D15+D16*V2D16+D17*V2D17)*U  &
+(1/2)*G8*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12 &
+C13*V1D13+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)**2)*U &
+(1/2)*G8*((D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12 &
+D13*V2D13+D14*V2D14+D15*V2D15+D16*V2D16+D17*V2D17)**2)*U 
EQ Q9=A9+BA9*U1+BB9*U2+BC9*U3 &
-C9*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12+C13*V1D13 &
+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)*U &
-D9*(D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8 &
+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12+D13*V2D13+D14*V2D14+D15*V2D15+D16*V2D16+D17*V2D17)*U  &
+(1/2)*G9*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12 &
+C13*V1D13+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)**2)*U &
+(1/2)*G9*((D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12 &
+D13*V2D13+D14*V2D14+D15*V2D15+D16*V2D16+D17*V2D17)**2)*U 
EQ Q10=A10+BA10*U1+BB10*U2+BC10*U3 &
-C10*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12+C13*V1D13 &
+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)*U &
-D10*(D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8 &
+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12+D13*V2D13+D14*V2D14+D15*V2D15+D16*V2D16+D17*V2D17)*U  &
+(1/2)*G10*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12 &
+C13*V1D13+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)**2)*U &
+(1/2)*G10*((D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12 &
+D13*V2D13+D14*V2D14+D15*V2D15+D16*V2D16+D17*V2D17)**2)*U 
EQ Q11=A11+BA11*U1+BB11*U2+BC11*U3 &
-C11*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12+C13*V1D13 &
+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)*U &
-D11*(D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8 &
+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12+D13*V2D13+D14*V2D14+D15*V2D15+D16*V2D16+D17*V2D17)*U  &
+(1/2)*G11*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12 &
+C13*V1D13+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)**2)*U &
+(1/2)*G11*((D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12 &
+D13*V2D13+D14*V2D14+D15*V2D15+D16*V2D16+D17*V2D17)**2)*U 
EQ Q12=A12+BA12*U1+BB12*U2+BC12*U3 &
-C12*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12+C13*V1D13 &
+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)*U &
-D12*(D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8 &
+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12+D13*V2D13+D14*V2D14+D15*V2D15+D16*V2D16+D17*V2D17)*U  &
+(1/2)*G12*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12 &
+C13*V1D13+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)**2)*U &
+(1/2)*G12*((D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12 &
+D13*V2D13+D14*V2D14+D15*V2D15+D16*V2D16+D17*V2D17)**2)*U 
EQ Q13=A13+BA13*U1+BB13*U2+BC13*U3 &
-C13*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12+C13*V1D13 &
+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)*U &
-D13*(D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8 &
+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12+D13*V2D13+D14*V2D14+D15*V2D15+D16*V2D16+D17*V2D17)*U  &
+(1/2)*G13*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12 &
+C13*V1D13+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)**2)*U &
+(1/2)*G13*((D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12 &
+D13*V2D13+D14*V2D14+D15*V2D15+D16*V2D16+D17*V2D17)**2)*U 
EQ Q14=A14+BA14*U1+BB14*U2+BC14*U3 &
-C14*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12+C13*V1D13 &
+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)*U &
-D14*(D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8 &
+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12+D13*V2D13+D14*V2D14+D15*V2D15+D16*V2D16+D17*V2D17)*U  &
+(1/2)*G14*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12 &
+C13*V1D13+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)**2)*U &
+(1/2)*G14*((D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12 &
+D13*V2D13+D14*V2D14+D15*V2D15+D16*V2D16+D17*V2D17)**2)*U 
EQ Q15=A15+BA15*U1+BB15*U2+BC15*U3 &
-C15*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12+C13*V1D13 &
+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)*U &
-D15*(D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8 &
+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12+D13*V2D13+D14*V2D14+D15*V2D15+D16*V2D16+D17*V2D17)*U  &
+(1/2)*G15*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12 &
+C13*V1D13+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)**2)*U &
+(1/2)*G15*((D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12 &
+D13*V2D13+D14*V2D14+D15*V2D15+D16*V2D16+D17*V2D17)**2)*U 
EQ Q16=A16+BA16*U1+BB16*U2+BC16*U3 &
-C16*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12+C13*V1D13 &
+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)*U &
-D16*(D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8 &
+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12+D13*V2D13+D14*V2D14+D15*V2D15+D16*V2D16+D17*V2D17)*U  &
+(1/2)*G16*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12 &
+C13*V1D13+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)**2)*U &
+(1/2)*G16*((D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12 &
+D13*V2D13+D14*V2D14+D15*V2D15+D16*V2D16+D17*V2D17)**2)*U 
EQ Q17=A17+BA17*U1+BB17*U2+BC17*U3 &
-C17*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12+C13*V1D13 &
+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)*U &
-D17*(D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8 &
+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12+D13*V2D13+D14*V2D14+D15*V2D15+D16*V2D16+D17*V2D17)*U  &
+(1/2)*G17*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12 &
+C13*V1D13+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)**2)*U &
+(1/2)*G17*((D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12 &
+D13*V2D13+D14*V2D14+D15*V2D15+D16*V2D16+D17*V2D17)**2)*U 
COEF A1       0.96502      
COEF BA1      0.020587     
COEF BB1      0.043213     
COEF BC1      0.047762     
COEF C2       0.076897     
COEF C3       0.0070069    
COEF C4       0.0060705    
COEF C5      -0.11446      
COEF C6      -0.032104     
COEF C7       0.089554     
COEF C8      -0.023712     
COEF C9       0.11340      
COEF C10      0.048916     
COEF C11     -0.083325     
COEF C12      0.095125     
COEF C13     -0.24507      
COEF C14      0.061169     
COEF C15     -0.15292      
COEF C16      0.095414     
COEF C17      0.048320     
COEF A2      -0.13535      
COEF BA2      0.030966     
COEF BB2      0.018547     
COEF BC2      0.0086296    
COEF A3       0.66603      
COEF BA3     -0.049194     
COEF BB3      0.0051719    
COEF BC3     -0.014736     
COEF A4       0.88696      
COEF BA4     -0.035058     
COEF BB4      0.040193     
COEF BC4      0.10483      
COEF A5      -0.24677      
COEF BA5      0.19432      
COEF BB5      0.10309      
COEF BC5      0.10306      
COEF A6       0.13465      
COEF BA6      0.0068912    
COEF BB6      0.031672     
COEF BC6     -0.00049609   
COEF A7       0.31009      
COEF BA7      0.039897     
COEF BB7      0.027706     
COEF BC7      0.088113     
COEF A8       0.087540     
COEF BA8      0.032681     
COEF BB8      0.0074633    
COEF BC8      0.087185     
COEF A9      -0.71504      
COEF BA9      0.10638      
COEF BB9      0.072728     
COEF BC9      0.019138     
COEF A10      0.27537      
COEF BA10     0.043517     
COEF BB10     0.039795     
COEF BC10     0.017896     
COEF A11     -0.10985      
COEF BA11     0.036170     
COEF BB11     0.056719     
COEF BC11     0.063455     
COEF A12     -0.95175      
COEF BA12     0.11584      
COEF BB12     0.071949     
COEF BC12     0.096023     
COEF A13      -1.5763      
COEF BA13     0.26035      
COEF BB13     0.20844      
COEF BC13     0.24828      
COEF A14     -0.090082     
COEF BA14     0.028081     
COEF BB14     0.010610     
COEF BC14     0.0094522    
COEF A15      0.77588      
COEF BA15    -0.012344     
COEF BB15     0.085141     
COEF BC15     0.036250     
COEF A16     -0.16906      
COEF BA16     0.15606      
COEF BB16     0.15142      
COEF BC16     0.13435      
COEF A17     -0.40700      
COEF BA17     0.058396     
COEF BB17     0.033563     
COEF BC17     0.14855          
COEF D3 0.001
COEF D4 0.001
COEF D5 0.001
COEF D6 0.001
COEF D7 0.001
COEF D8 0.001
COEF D9 0.001
COEF D10 0.001
COEF D11 0.001
COEF D12 0.001
COEF D13 0.001
COEF D14 0.001
COEF D15 0.001
COEF D16 0.001
COEF D17 0.001¸
END
STOP
*THE FINAL LL IN CON3OUT.TXT    = 3194.641  
*THE INITIAL LOG-LIKELIHOOD HERE= 3194.350; OUR CODE IS PROBABLY OK
*FINAL LOG-LIKELIHOOD HERE IS   = 3263.830; AN INCREASE OF 69.2 LL POINTS FOR ADDING 15 PARAMETERS   
* FINAL STATISTICS: TIME =    10.0730 SEC.   ITER. NO.   476   FUNCT. EVALUATIONS   503
* THERE IS A BIT OF IMPROVEMENT IN THE R SQUARES BUT NOT A WHOLE LOT.
* THE FINAL LL IN E59418C\CON2OUT.TXT WAS 3105.200

*WE NEED TO GENR THE MATRIX OF SECOND ORDER PARTIAL DERIVATIVES OF THE COST FUNCTION WRT PRICES
*FIRST GENR THE C VECTOR AND THEN C TIMES C TRANSPOSE = THE C MATRIX = CC#$
SMPL 1 1
*GENR THE FIRST COMPONENT OF THE C VECTOR
GENR C1=0
DO #=2,17
GENR C1=C1-C#(1)
ENDO
SMPL 1 47
*GENR INNER PRODUCT OF C VECTOR WITH NORMALIZED PRICE VECTOR V
GENR CV=0
DO #=1,17
GENR CV=CV+C#(1)*V#
ENDO
*GENR V TRANSPOSE TIMES THE C VECTOR SQUARED = CV*CV
GENR VCV=CV*CV

*GENR THE D VECTOR 
SMPL 1 1
GENR D1=0
GENR D2=0
DO #=3,17
GENR D2=D2-D#(1)
ENDO
SMPL 1 47
*GENR INNER PRODUCT OF D VECTOR WITH THE PG NORMALIZED PRICE VECTOR V
GENR DV=0
DO #=1,17
GENR DV=DV+D#(1)*V#
ENDO
*GENR V TRANSPOSE TIMES THE D VECTOR SQUARED = DV*DV
GENR VDV=DV*DV

*GENR FITTED DEMAND FUNCTIONS
DO #= 1,17
GENR FQ#=A#(1)+BA#(1)*U1+BB#(1)*U2+BC#(1)*U3-C#(1)*CV*U+.5*G#*VCV*U-D#(1)*DV*U+.5*G#*VDV*U
ENDO
*COMPARE FITTED DEMANDS WITH ACTUAL DEMANDS
FORMAT(F8.0,10F10.5)
PRINT YEAR Q1 FQ1 Q2 FQ2 Q3 FQ3 Q4 FQ4 Q5 FQ5 / FORMAT
PRINT YEAR Q6 FQ6 Q7 FQ7 Q8 FQ8 Q9 FQ9 Q10 FQ10 / FORMAT
PRINT YEAR Q11 FQ11 Q12 FQ12 Q13 FQ13 Q14 FQ14 Q15 FQ15 / FORMAT
PRINT YEAR Q16 FQ16 Q17 FQ17 / FORMAT
STAT Q1 FQ1 Q2 FQ2 Q3 FQ3 Q4 FQ4 Q5 FQ5 Q6 FQ6 Q7 FQ7 Q8 FQ8 Q9 FQ9 Q10 FQ10
STAT Q11 FQ11 Q12 FQ12 Q13 FQ13 Q14 FQ14 Q15 FQ15 Q16 FQ16 Q17 FQ17 
* NAME         N   MEAN        ST. DEV     VARIANCE     MINIMUM      MAXIMUM
* Q1           47  0.60018     0.29283E-01 0.85747E-03  0.55952      0.66201
* FQ1          47  0.60018     0.29201E-01 0.85271E-03  0.55901      0.65802
* Q2           47  0.13105     0.14664E-01 0.21503E-03  0.10235      0.15215
* FQ2          47  0.13105     0.11439E-01 0.13084E-03  0.11567      0.15263
* Q3           47  0.67640E-01 0.27162E-01 0.73777E-03  0.31230E-01  0.10942
* FQ3          47  0.67640E-01 0.26542E-01 0.70445E-03  0.30425E-01  0.12417
* Q4           47  0.50575     0.10781     0.11623E-01  0.34715      0.76419
* FQ4          47  0.50575     0.10662     0.11367E-01  0.37851      0.77748
* Q5           47  0.85393     0.21045     0.44287E-01  0.61935       1.2929
* FQ5          47  0.85393     0.20812     0.43314E-01  0.59576       1.2920
* Q6           47  0.11680     0.12426E-01 0.15440E-03  0.95800E-01  0.14080
* FQ6          47  0.11680     0.12017E-01 0.14441E-03  0.97002E-01  0.13879
* Q7           47  0.46599     0.11562     0.13368E-01  0.27334      0.68326
* FQ7          47  0.46599     0.11448     0.13105E-01  0.30521      0.68487
* Q8           47  0.18740     0.72545E-01 0.52628E-02  0.96800E-01  0.32489
* FQ8          47  0.18740     0.72530E-01 0.52605E-02  0.99417E-01  0.33407
* Q9           47  0.45387     0.15157     0.22975E-01  0.22975      0.79792
* FQ9          47  0.45387     0.14931     0.22293E-01  0.23970      0.75399
* Q10          47  0.31431     0.50315E-01 0.25316E-02  0.21331      0.40153
* FQ10         47  0.31431     0.49997E-01 0.24997E-02  0.22169      0.39709
* Q11          47  0.95038E-01 0.11647E-01 0.13566E-03  0.73120E-01  0.12880
* FQ11         47  0.95038E-01 0.10266E-01 0.10539E-03  0.81178E-01  0.11886
* Q12          47  0.24760     0.13702     0.18773E-01  0.64910E-01  0.47202
* FQ12         47  0.24760     0.13671     0.18688E-01  0.42064E-01  0.47565
* Q13          47  0.78526     0.32218     0.10380      0.27130       1.2486
* FQ13         47  0.78526     0.32173     0.10351      0.25862       1.2822
* Q14          47  0.63070E-01 0.14078E-01 0.19820E-03  0.37470E-01  0.91900E-01
* FQ14         47  0.63070E-01 0.14014E-01 0.19639E-03  0.38673E-01  0.90643E-01
* Q15          47  0.34588     0.25397E-01 0.64501E-03  0.29238      0.39538
* FQ15         47  0.34588     0.23350E-01 0.54524E-03  0.30931      0.39064
* Q16          47  0.83396     0.28854     0.83257E-01  0.40925       1.3748
* FQ16         47  0.83396     0.28746     0.82634E-01  0.36642       1.3490
* Q17          47  0.15983     0.53308E-01 0.28418E-02  0.97310E-01  0.27300
* FQ17         47  0.15983     0.49243E-01 0.24248E-02  0.91211E-01  0.28003
*THE AVERAGE FITTED DEMAND COINCIDES WITH THE CORRESPONDING AVERAGE ACTUAL DEMAND FOR EVERY COMMODITY.
*THIS RESULT FOLLOWS BECAUSE EACH EQUATION HAS AN INDEPENDENT CONSTANT TERM (THE A#)

*GENR THE COMPONENTS OF THE EXPENDITURE FUNCTION THAT IS IMPLIED BY OUR ESTIMATES
*GENR A.P , BA.P  BB.P  BC.P 
GENR AP=0
GENR BAP=0
GENR BBP=0
GENR BCP=0
DO #=1,17
GENR AP=AP+P#*A#
GENR BAP=BAP+P#*BA#
GENR BBP=BBP+P#*BB#
GENR BCP=BCP+P#*BC#
ENDO
*GENR THE INDIRECT UTILITY FUNCTION THAT CORRESPONDS TO OUR ESTIMATED COEFS
GENR IU=0
SMPL 1 21
GENR IU=(Y-AP)/(BAP-.5*PG*VCV-.5*PG*VDV)
SMPL 22 32
GENR IU=(Y-AP-BAP*IU(21)+BBP*IU(21))/(BBP-.5*PG*VCV-.5*PG*VDV)
SMPL 33 47
GENR IU=(Y-AP-BAP*IU(21)-BBP*(IU(32)-IU(21))+BCP*IU(32))/(BCP-.5*PG*VCV-.5*PG*VDV)
SMPL 1 47
FORMAT(F8.0,9F10.5)
PRINT YEAR U IU AP BAP BBP BCP VCV VDV Y / FORMAT
STAT U IU / PCOR
* NAME         N    MEAN        ST. DEV     VARIANCE     MINIMUM      MAXIMUM
* U            47   5.9360      1.2697      1.6121       4.0542       8.4202
* IU           47   5.9333      1.2708      1.6149       4.0650       8.4279
*  CORRELATION MATRIX OF VARIABLES -       47 OBSERVATIONS
* U          1.0000
* IU        0.99999       1.0000
*              U            IU

*CHECK OUR COMPUTATIONS
*GENR FITTED Y
SMPL 1 47
GENR FY=0
DO #=1,17
GENR FY=FY+P#*FQ#
ENDO
*GENR THE INDIRECT UTILITY THAT CORRESPONDS TO FY, NEWU OR NU
GENR NU=0
SMPL 1 21
GENR NU=(FY-AP)/(BAP-.5*PG*VCV-.5*PG*VDV)
SMPL 22 32
GENR NU=(FY-AP-BAP*NU(21)+BBP*NU(21))/(BBP-.5*PG*VCV-.5*PG*VDV)
SMPL 33 47
GENR NU=(FY-AP-BAP*NU(21)-BBP*(NU(32)-NU(21))+BCP*NU(32))/(BCP-.5*PG*VCV-.5*PG*VDV)
SMPL 1 47
FORMAT(F8.0,5F10.5)
PRINT YEAR IU NU U FY Y / FORMAT
*U IS INDEX NUMBER U; IU IS THE INDIRECT U THAT IS GENERATED BY OUR REGRESSION; NU IS THE INDIRECT U THAT
*IS GENERATED BY OUR REGRESSION BUT USES FITTED EXPENDITURES TO GENERATE THE INDIRECT UTILITY FUNCTION
*NU AND U SHOULD COINCIDE AND THEY DO
STAT IU NU U / PCOR
* NAME         N    MEAN        ST. DEV     VARIANCE     MINIMUM      MAXIMUM
* IU           47   5.9333      1.2708      1.6149       4.0650       8.4279
* NU           47   5.9360      1.2697      1.6121       4.0542       8.4202
* U            47   5.9360      1.2697      1.6121       4.0542       8.4202
*  CORRELATION MATRIX OF VARIABLES -       47 OBSERVATIONS
* IU         1.0000
* NU        0.99999       1.0000
* U         0.99999       1.0000       1.0000
*              IU           NU           U
*IF THE FIT IN OUR ESTIMATING EQUATIONS IS GOOD, THEN OUR METHOD WORKS WELL.

*FINISH UP BY GENERATING ELASTICITIES
*GENR THE MATRIX OF SECOND ORDER PARTIAL DERIVATIVES OF THE COST FUNCTION WRT INPUT PRICES
DO #=1,17
DO $=1,17
GENR D#C$=(-C#(1)*C$(1)+C#(1)*G$*CV+G#*C$(1)*CV-G#*G$*VCV)*U/PG
GENR D#D$=(-D#(1)*D$(1)+D#(1)*G$*DV+G#*D$(1)*DV-G#*G$*VDV)*U/PG
ENDO
ENDO

*CALCULATE THE MATRIX OF ORDINARY PRICE ELASTICITIES OF INPUT DEMAND FOR EACH YEAR
DO #=1,17
DO $=1,17
GENR E#P$=(D#C$+D#D$)*P$/FQ#
ENDO
ENDO
DO #=1,17
GENR CHECK#=E#P1+E#P2+E#P3+E#P4+E#P5+E#P6+E#P7+E#P8+E#P9+E#P10 &
+E#P11+E#P12+E#P13+E#P14+E#P15+E#P16+E#P17
ENDO
DO #=1,17
STAT CHECK#
ENDO
*ALL CHECK# ARE 0; CHECKS ARE SATISFIED
*PRINT OUT THE OWN ELASTICITIES OF DEMAND; THEY SHOULD ALL BE NEGATIVE (OR 0)
FORMAT(F8.0,9F10.5)
PRINT YEAR E1P1 E2P2 E3P3 E4P4 E5P5 E6P6 E7P7 E8P8 E9P9  / FORMAT
PRINT YEAR E10P10 E11P11 E12P12 E13P13 E14P14 E15P15 E16P16 E17P17 / FORMAT
STAT E1P1 E2P2 E3P3 E4P4 E5P5 E6P6 E7P7 E8P8 E9P9 E10P10
STAT E11P11 E12P12 E13P13 E14P14 E15P15 E16P16 E17P17
* NAME         N    MEAN        ST. DEV     VARIANCE     MINIMUM      MAXIMUM
* E1P1         47 -0.50289E-01 0.39737E-02 0.15790E-04 -0.60610E-01 -0.44292E-01
* E2P2         47 -0.16624E-01 0.65611E-02 0.43048E-04 -0.24444E-01 -0.51175E-02
* E3P3         47 -0.62584E-02 0.49974E-02 0.24974E-04 -0.19288E-01 -0.13695E-02
* E4P4         47 -0.21029     0.36263E-01 0.13150E-02 -0.26664     -0.13347
* E5P5         47 -0.14741     0.16420E-01 0.26961E-03 -0.16856     -0.11573
* E6P6         47 -0.10022     0.45566E-01 0.20763E-02 -0.18533     -0.38477E-01
* E7P7         47 -0.13460     0.15118E-01 0.22855E-03 -0.15818     -0.11017
* E8P8         47 -0.76718E-01 0.72087E-02 0.51966E-04 -0.90535E-01 -0.65794E-01
* E9P9         47 -0.47615E-01 0.13768E-01 0.18956E-03 -0.91676E-01 -0.30582E-01
* E10P10       47 -0.16411E-01 0.18375E-02 0.33765E-05 -0.20099E-01 -0.13293E-01
* E11P11       47 -0.12636     0.33557E-01 0.11261E-02 -0.17210     -0.77543E-01
* E12P12       47 -0.39942     0.34723     0.12057      -1.7771     -0.15987
* E13P13       47 -0.18771     0.62393E-01 0.38929E-02 -0.36147     -0.12416
* E14P14       47 -0.55181E-01 0.19417E-01 0.37704E-03 -0.87797E-01 -0.27616E-01
* E15P15       47 -0.21307     0.45744E-01 0.20925E-02 -0.30492     -0.14341
* E16P16       47 -0.58726E-01 0.92686E-02 0.85906E-04 -0.88784E-01 -0.48260E-01
* E17P17       47 -0.16456     0.30871E-01 0.95303E-03 -0.25001     -0.12799
*THE COMMODITY CLASSES THAT HAVE AN AVERAGE OWN ELASTICITY OF DEMAND GREATER THAN 0.19 IN MAGNITUDE ARE
* E4P4      -0.21029   Clothing and footwear
* E12P12    -0.39942   Communications
* E15P15    -0.21307   Restaurants and hotels
*MOST OF THE ELASTICITIES ARE QUITE SMALL IN MAGNITUDE. THEY WILL INCREASE AS WE ADD MORE COLUMNS TO THE MODEL

*GENR INCOME ELASTICITIES OF DEMAND
DO #=1,17
GENR EU#=0
ENDO
SMPL 1 21
DO #=1,17
GENR EU#=(BA#(1)-C#(1)*CV-D#(1)*DV+.5*G#*(VCV+VDV))*U/FQ#
ENDO
SMPL 22 32
DO #=1,17
GENR EU#=(BB#(1)-C#(1)*CV-D#(1)*DV+.5*G#*(VCV+VDV))*U/FQ#
ENDO
SMPL 33 47
DO #=1,17
GENR EU#=(BC#(1)-C#(1)*CV-D#(1)*DV+.5*G#*(VCV+VDV))*U/FQ#
ENDO
SMPL 1 47
FORMAT(F8.0,9F10.4)
PRINT YEAR EU1-EU9 / FORMAT
PRINT YEAR EU10-EU17 / FORMAT
STAT EU1-EU17
* NAME         N    MEAN       ST. DEV     VARIANCE     MINIMUM      MAXIMUM
* EU1          47  0.37209     0.84046E-01 0.70637E-02  0.26063      0.49763
* EU2          47 -0.41664     0.93031     0.86548      -1.6672      0.82031
* EU3          47  -1.8853     0.48895     0.23907      -3.1213      -1.1333
* EU4          47  0.54399     0.79762     0.63619     -0.11047       1.8705
* EU5          47   1.4132     0.11346     0.12872E-01   1.1995       1.5539
* EU6          47  0.60988E-01 0.28191     0.79474E-01 -0.36076      0.41650
* EU7          47  0.79026     0.22589     0.51028E-01  0.48443       1.1304
* EU8          47   1.2386     0.61385     0.37681      0.52469       2.3585
* EU9          47   1.8176     0.34876     0.12163       1.4297       2.5601
* EU10         47  0.95926     0.35611     0.12681      0.57232       1.4167
* EU11         47  0.31143     0.49562     0.24564     -0.53858      0.89907
* EU12         47   1.7407     0.91663     0.84020      0.76730       3.6901
* EU13         47   1.4942     0.72614     0.52728      0.48515       2.6725
* EU14         47  0.22521     0.37220     0.13853     -0.45871      0.73345
* EU15         47  0.65944     0.17261     0.29796E-01  0.38007      0.84478
* EU16         47   1.7662     0.52965     0.28053       1.1126       2.9152
* EU17         47   1.5938     0.97834     0.95715     -0.11796       3.0181
*ON AVERAGE, 15 OF THE 17 COMMODITY GROUPS HAVE POSITIVE INCOME (OR MORE ACCURATELY, EXPENDITURE) ELASTICITIES
*THE AVERAGE IS GREATER THAN 1 FOR THE FOLLOWING 7 CATEGORIES: 
*EU5  housing
*EU8 Health
*EU9 Purchase of vehicles
*EU12 Communications
*EU13 Recreation and culture
*EU16 Miscellaneous goods and services
*EU17 Final consumption expenditure of resident households abroad
*THE 2 NEGATIVE INCOME ELASTICITY OF DEMAND CATEGORIES ARE:
*EU2 Alcoholic beverages
*EU3 Tobacco
*THE 8 CATEGORIES THAT HAVE INCOME ELASTICITIES BETWEEN 0 AND 1 ARE:
*EU1   Food and non-alcoholic beverages 
*EU4   Clothing and footwear
*EU6   Electricity, gas and other fuels
*EU7   Furnishings, households equipment and routine maintenance of the house
*EU10  Operation of personal transport equipment
*EU11  Transport services
*EU14  Education
*EU15  Restaurants and hotels

*1 IS THE SERIES       P31CP010: Food and non-alcoholic beverages
*2 IS THE SERIES       P31CP021: Alcoholic beverages
*3 IS THE SERIES       P31CP022: Tobacco
*4 IS THE SERIES       P31CP030: Clothing and footwear
*5 IS THE SERIES       P31CP041+P31CP042+P31CP043+P31CP044: HOUSING AGGREGATE
*6 IS THE SERIES       P31CP045: Electricity, gas and other fuels
*7 IS THE SERIES       P31CP050: Furnishings, households equipment and routine maintenance of the house
*8 IS THE SERIES       P31CP060: Health
*9 IS THE SERIES       P31CP071: Purchase of vehicles
*10 IS THE SERIES      P31CP072: Operation of personal transport equipment
*11 IS THE SERIES      P31CP073: Transport services
*12 IS THE SERIES      P31CP080: Communications
*13 IS THE SERIES      P31CP090: Recreation and culture
*14 IS THE SERIES      P31CP100: Education
*15 IS THE SERIES      P31CP110: Restaurants and hotels
*16 IS THE SERIES      P31CP120: Miscellaneous goods and services
*17 IS THE SERIES      P33:      Final consumption expenditure of resident households abroad
STOP















