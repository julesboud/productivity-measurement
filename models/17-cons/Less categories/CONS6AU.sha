*THIS IS THE FILE E59418C\CONS6.TXT THAT ESTIMATES NONHOMOTHETIC LEONTIEF PREFERENCES           JULY 22, 2019
*WE DO NOT IMPOSE MONEY METRIC UTILITY SCALING IN THIS MODEL; WE SPLINE UTILITY IN THIS MODEL (2 BREAK POINTS)
*WE ESTIMATE A NORMALIZED QUADRATIC RANK 4 SUBSTITUTION MATRIX IN THIS MODEL; WE HAVE ONLY 12 CONSUMPTION CATEGORIES.
PAR 10000                   
SIZE 1000
SET NODOECHO
*READ IN CANADIAN DATA FOR 1971-2017 FOR 12 CLASSES OF PER POP CONSUMPTION FROM E59418C\CDATOUT.TXT
SMPL 1 33
FORMAT(F8.0,9F10.5)
READ YEAR P1-P6
   1985.   1.00000   1.00000   1.00000   1.00000   1.00000   1.00000
   1986.   1.08081   1.10020   1.11920   1.09374   1.07977   1.10967
   1987.   1.13579   1.18814   1.20754   1.17806   1.17292   1.17853
   1988.   1.23865   1.22683   1.31907   1.25635   1.27387   1.26678
   1989.   1.32558   1.30501   1.48947   1.32069   1.36090   1.37106
   1990.   1.36967   1.39833   1.66873   1.38248   1.42633   1.48489
   1991.   1.40268   1.45070   1.81845   1.40490   1.45540   1.58759
   1992.   1.42741   1.50054   2.18350   1.42519   1.46516   1.54918
   1993.   1.45502   1.55733   2.49074   1.41770   1.47738   1.58936
   1994.   1.49049   1.61311   2.69924   1.41868   1.48887   1.66393
   1995.   1.54037   1.70116   3.13760   1.42059   1.51323   1.73161
   1996.   1.58939   1.74321   3.28548   1.42728   1.54371   1.82523
   1997.   1.61070   1.76305   3.39283   1.42534   1.57802   1.89143
   1998.   1.68923   1.79000   3.52070   1.40910   1.60228   1.87536
   1999.   1.71227   1.79827   3.79570   1.39586   1.63085   2.07594
   2000.   1.74502   1.93044   4.30896   1.49544   1.68747   2.06298
   2001.   1.82720   1.97864   4.53981   1.48837   1.74311   2.13063
   2002.   1.89743   2.01557   4.76304   1.50712   1.79459   2.24390
   2003.   1.94634   2.09354   4.94371   1.50970   1.84362   2.29083
   2004.   1.96189   2.16553   4.95969   1.47905   1.89399   2.35732
   2005.   2.05244   2.21593   5.16277   1.45227   1.96130   2.40023
   2006.   2.19318   2.27635   5.56019   1.44119   2.04603   2.53003
   2007.   2.25464   2.35770   5.83753   1.44768   2.15454   2.58083
   2008.   2.34528   2.44708   6.07872   1.43137   2.27365   2.59126
   2009.   2.35795   2.51646   6.36500   1.43690   2.37900   2.65357
   2010.   2.39914   2.55778   7.77426   1.40696   2.46973   2.67182
   2011.   2.42596   2.60481   8.27714   1.41322   2.58303   2.69743
   2012.   2.45480   2.66604   8.86338   1.40982   2.68184   2.76157
   2013.   2.48981   2.73867   9.92116   1.40499   2.75185   2.83124
   2014.   2.55137   2.79576  11.22214   1.38082   2.78967   2.89136
   2015.   2.53452   2.85545  12.63424   1.38316   2.82103   2.97068
   2016.   2.57419   2.87728  14.05046   1.37280   2.85706   3.00560
   2017.   2.54878   2.94138  15.96832   1.32753   2.90654   3.06670

FORMAT(F8.0,9F10.5)
PRINT YEAR P1-P6 / FORMAT
READ YEAR P7-P12
   1985.   1.00000   1.00000   1.00000   1.00000   1.00000   1.00000
   1986.   1.08424   1.03444   1.08949   1.10206   1.08409   1.04944
   1987.   1.15443   1.11398   1.15056   1.21907   1.15866   1.04781
   1988.   1.19927   1.13363   1.19647   1.35726   1.22452   0.96725
   1989.   1.28507   1.12549   1.24076   1.52745   1.30888   1.06175
   1990.   1.36109   1.15619   1.28992   1.70998   1.38538   1.14946
   1991.   1.35641   1.20545   1.32519   1.85858   1.42941   1.18329
   1992.   1.36882   1.20472   1.36426   1.98486   1.46106   1.31193
   1993.   1.39495   1.19725   1.38864   2.06684   1.49214   1.34423
   1994.   1.42486   1.21382   1.40352   2.15160   1.53606   1.35071
   1995.   1.45164   1.21033   1.42192   2.30447   1.59169   1.36413
   1996.   1.44418   1.20121   1.41089   2.37941   1.60854   1.36114
   1997.   1.41503   1.20031   1.42013   2.47866   1.66413   1.43547
   1998.   1.39124   1.15632   1.41907   2.63970   1.67091   1.51944
   1999.   1.42782   1.09495   1.41496   2.72763   1.70998   1.50045
   2000.   1.48618   1.17241   1.47121   2.91442   1.81268   1.66401
   2001.   1.47081   1.17698   1.48662   2.98811   1.88349   1.71404
   2002.   1.52710   1.22432   1.47846   3.26015   1.93840   1.68485
   2003.   1.53631   1.24194   1.44805   3.39754   1.97096   1.51186
   2004.   1.56820   1.26307   1.43938   3.70491   1.99907   1.52566
   2005.   1.66477   1.26333   1.43959   3.91548   2.05497   1.55093
   2006.   1.73212   1.27041   1.44515   4.09385   2.10267   1.56737
   2007.   1.82202   1.28989   1.45472   4.24190   2.13775   1.49407
   2008.   1.74983   1.25830   1.47628   4.53150   2.25673   1.66427
   2009.   1.77618   1.25851   1.48619   4.81824   2.30786   1.45807
   2010.   1.80793   1.20437   1.46427   5.07346   2.34543   1.35583
   2011.   1.85440   1.17682   1.45380   5.35709   2.40145   1.33397
   2012.   1.86193   1.22703   1.46541   5.66292   2.48094   1.36287
   2013.   1.93594   1.11538   1.47327   5.97997   2.55240   1.51690
   2014.   1.91203   1.01520   1.49592   6.30235   2.61078   1.60683
   2015.   1.92852   0.88609   1.52077   6.59157   2.67421   1.73699
   2016.   1.93214   0.81349   1.52108   6.78731   2.72035   1.66431
   2017.   1.98128   0.78219   1.51379   6.98437   2.77835   1.68636


PRINT YEAR P7-P12 / FORMAT
READ YEAR Q1-Q6
   1985.   1.18670   0.17032   0.20084   0.57239   2.46125   0.37338
   1986.   1.16815   0.16177   0.19824   0.55793   2.48419   0.38858
   1987.   1.16774   0.16187   0.19410   0.56232   2.53347   0.39061
   1988.   1.14383   0.16078   0.19044   0.55474   2.58149   0.41480
   1989.   1.14658   0.16379   0.18703   0.54092   2.63329   0.41803
   1990.   1.13051   0.15859   0.17648   0.50819   2.60507   0.41988
   1991.   1.14362   0.15412   0.16354   0.52049   2.66215   0.42474
   1992.   1.15056   0.15619   0.15182   0.49895   2.71854   0.45114
   1993.   1.15354   0.16632   0.13890   0.49158   2.77030   0.46453
   1994.   1.19261   0.18018   0.12897   0.49630   2.83456   0.46050
   1995.   1.20789   0.17588   0.11855   0.51209   2.87345   0.45611
   1996.   1.18492   0.17848   0.12032   0.51216   2.90935   0.44873
   1997.   1.21429   0.18753   0.12002   0.51757   2.97048   0.43884
   1998.   1.20315   0.19615   0.12157   0.54628   3.02911   0.47013
   1999.   1.22606   0.20611   0.11997   0.56525   3.13087   0.47065
   2000.   1.25855   0.21019   0.11447   0.56178   3.18348   0.49915
   2001.   1.28520   0.21183   0.10949   0.58188   3.25531   0.54017
   2002.   1.29738   0.21714   0.10836   0.61989   3.33650   0.56527
   2003.   1.33019   0.22020   0.10571   0.65708   3.43033   0.58755
   2004.   1.36050   0.23251   0.10700   0.70155   3.51214   0.60557
   2005.   1.37336   0.23615   0.10243   0.73895   3.53352   0.61501
   2006.   1.37697   0.24688   0.09843   0.79546   3.60863   0.64140
   2007.   1.38643   0.25352   0.09181   0.83340   3.66303   0.67173
   2008.   1.39060   0.25890   0.08767   0.85948   3.68436   0.69896
   2009.   1.39477   0.26455   0.08377   0.90146   3.72006   0.72023
   2010.   1.40568   0.27222   0.07757   0.92372   3.77186   0.74780
   2011.   1.42178   0.28026   0.07273   0.92295   3.78785   0.77608
   2012.   1.43997   0.27387   0.07000   0.93543   3.78094   0.82107
   2013.   1.46053   0.27352   0.06669   0.97659   3.80305   0.82652
   2014.   1.44636   0.27816   0.05897   0.98426   3.84832   0.84095
   2015.   1.48582   0.27648   0.05438   1.03357   3.88497   0.85112
   2016.   1.48579   0.27899   0.05035   1.04375   3.91325   0.87108
   2017.   1.52604   0.27901   0.04997   1.07038   3.93818   0.88604
PRINT YEAR Q1-Q6 / FORMAT
READ YEAR Q7-Q12
   1985.   1.27018   0.13143   0.93449   0.17063   1.82065   0.13675
   1986.   1.19728   0.13591   0.93211   0.17804   1.93771   0.13819
   1987.   1.19661   0.14119   0.97261   0.17345   1.99731   0.15832
   1988.   1.27324   0.14946   1.02506   0.18125   2.09692   0.18948
   1989.   1.34503   0.15974   1.08328   0.19312   2.15417   0.20591
   1990.   1.30589   0.16258   1.06697   0.18697   2.12726   0.18840
   1991.   1.30732   0.17604   1.09466   0.18667   2.13709   0.17198
   1992.   1.34232   0.20089   1.11449   0.18447   2.10409   0.17428
   1993.   1.34622   0.22230   1.18526   0.18817   2.07582   0.17255
   1994.   1.40580   0.24210   1.27981   0.19058   2.14383   0.19014
   1995.   1.43756   0.27682   1.36848   0.19058   2.18921   0.20900
   1996.   1.48462   0.30940   1.45314   0.19721   2.21980   0.23768
   1997.   1.60997   0.33441   1.53376   0.20381   2.33424   0.26091
   1998.   1.71600   0.37880   1.60713   0.21158   2.52153   0.29044
   1999.   1.71228   0.42740   1.66737   0.22243   2.63071   0.29518
   2000.   1.76079   0.47832   1.71152   0.22058   2.63631   0.32170
   2001.   1.77473   0.50507   1.76524   0.23286   2.62692   0.28989
   2002.   1.82471   0.53408   1.88210   0.22734   2.67623   0.29642
   2003.   1.90665   0.55479   2.01978   0.23217   2.79460   0.39618
   2004.   1.99192   0.59255   2.11042   0.23160   2.87757   0.47188
   2005.   1.97358   0.62698   2.17825   0.23890   2.98892   0.48149
   2006.   2.08183   0.63973   2.28163   0.24470   3.13716   0.53243
   2007.   2.22334   0.65237   2.39560   0.24519   3.21462   0.65718
   2008.   2.04306   0.66196   2.38247   0.25276   3.06589   0.64361
   2009.   2.08441   0.65950   2.44715   0.26735   3.11038   0.77581
   2010.   2.21446   0.69684   2.59611   0.27359   3.14620   0.89355
   2011.   2.25758   0.71625   2.69623   0.27859   3.14626   0.95233
   2012.   2.29346   0.70323   2.61503   0.28275   3.11502   0.97790
   2013.   2.23966   0.77890   2.61039   0.28518   3.18953   0.94728
   2014.   2.20252   0.86079   2.67692   0.28425   3.24710   0.87906
   2015.   2.18813   0.96742   2.69451   0.28427   3.28644   0.87605
   2016.   2.18126   1.04844   2.68162   0.28415   3.32851   0.93191
   2017.   2.17858   1.08895   2.73428   0.28587   3.37872   0.94431
PRINT YEAR Q7-Q12 / FORMAT
*1 IS THE SERIES       Food and non-alcoholic beverages
*2 IS THE SERIES       Alcoholic beverages
*3 IS THE SERIES       Tobacco
*4 IS THE SERIES       Clothing and footwear
*5 IS THE SERIES       Housing including electricity,gas and household furnishings
*6 IS THE SERIES       Health
*7 IS THE SERIES       Transportation aggregate, owned and purchased
*8 IS THE SERIES       Communications
*9 IS THE SERIES       Recreation and culture
*10 IS THE SERIES      Education
*11 IS THE SERIES      Services aggregate including Restaurants and hotels and Miscellaneous goods and services
*12 IS THE SERIES      Final consumption expenditure of resident households abroad
DO #=1,12
GENR V#=P#*Q#
ENDO

*GENR CHAINED FISHER PRICE AND QUANTITY INDEXES
INDEX P1 Q1 P2 Q2 P3 Q3 P4 Q4 P5 Q5 P6 Q6 P7 Q7 P8 Q8 P9 Q9 P10 Q10 &
P11 Q11 P12 Q12 / CHAIN FISHER=PF QFISHER=QF
*GENR EXPENDITURE Y ON THE 12 COMMODITIES
GENR Y=PF*QF
*GENR THE NORMALIZED QUADRATIC FIXED BASE AND CHAINED INDEXES
*WE FIRST NEED TO GENR FIXED WEIGHTS SUMMING TO 1,G1 TO G12. WE INITIALLY DEFINE THESE G# AS SAMPLE MEANS
DO #=1,12
STAT Q# / MEAN=GG#
ENDO
*SUM THE GG#
SMPL 1 1
GENR SUM=0
DO #=1,12
GENR SUM=SUM+GG#
ENDO
*DEFINE THE NORMALIZED GG#
DO #=1,12
GENR GG#=GG#/SUM
ENDO
FORMAT(6F10.5)
PRINT GG1-GG6 / FORMAT
PRINT GG7-GG12 / FORMAT
SMPL 1 33
GENR ONE=1
DO #=1,12
GENR G#=GG#(1)*ONE
ENDO
*GENR THE LOWE PRICE INDEX PG
GENR PG=0
DO #=1,12
GENR PG=PG+P#*G#
ENDO
*GENR PG NORMALIZED PRICES:
DO #=1,12
GENR PN#=P#/PG
ENDO
FORMAT(7F10.5)
PRINT PG PN1-PN6 / FORMAT
PRINT PG PN7-PN12 / FORMAT
STAT PG PN1-PN12

*THE EXACT INDEX NUMBER FORMULA FOR NORMALIZED QUADRATIC PREFERENCES USING A FIXED BASE IS
*u(t)/u(1)=SUM(PN#(t)+PN#(1))Q#(t)/(SUM(PN#(t)+PN#(1))Q#(1))
GENR NUM=0
GENR DEN=0
DO #=1,12
GENR NUM=NUM+(PN#+PN#(1))*Q#
GENR DEN=DEN+(PN#+PN#(1))*Q#(1)
ENDO
GENR QNFB=NUM/DEN
*NORMALIZE QNFB TO EQUAL Y IN OBSERVATION 1
GENR CON=QNFB(1)
GENR QNFB=QNFB*Y(1)/CON
GENR PNFB=Y/QNFB
*NOW CONSTRUCT THE NORMALIZED QUADRATIC CHAIN LINKS
GENR QNCH=1
GENR QNCHL=1
GENR NUML=0
GENR DENL=0
SMPL 2 33
DO #=1,12
GENR NUML=NUML+(PN#+LAG(PN#))*Q#
GENR DENL=DENL+(PN#+LAG(PN#))*LAG(Q#)
ENDO
*NOW CONSTRUCT THE NORMALIZED QUADRATIC EXACT INDEX NUMBER FORMULA USING THE CHAIN PRINCIPLE
GENR QNCHL=NUML/DENL
GENR QNCH=LAG(QNCH)*QNCHL
*NORMALIZE QNCH TO EQUAL Y AT OBSERVATION 1
SMPL 1 33
GENR CON=QNCH(1)
GENR QNCH=QNCH*Y(1)/CON
GENR PNCH=Y/QNCH
FORMAT(F8.0,7F10.5)
PRINT YEAR QF QNCH QNFB PF PNCH PNFB Y / FORMAT
*THE CHAINED FISHER AND CHAINED NORMALIZED QUADRATIC INDEXES DIFFER ONLY IN THE 4TH AND 5TH DECIMAL PLACE
*THEY ARE INCREDIBLY CLOSE!

GENR U=QNCH
*IN THIS RUN, WE WILL SPLINE UTILITY AT 2 BREAK POINTS 13 AND 17
GENR U=QNCH
*WE WILL SPLINE UTILITY AT OBS 13 AND 17
DO #=1,3
GENR U#=0
ENDO
GENR U1=U
SMPL 14 33
GENR U1=U1(13)
GENR U2=U-U(13)
SMPL 18 33
GENR U2=U2(17)
GENR U3=U-U(17)
SMPL 1 33
GENR CHECK=U-U1-U2-U3
STAT CHECK
*CHECK SHOULD BE 0 FOR ALL OBSERVATIONS AND THIS CHECK IS SATISFIED

*CHANGE NOTATION FOR NORMALIZED PRICES; CALL THEM V# INSTEAD OF PN#
DO #=1,12
GENR V#=PN#
ENDO

*GENR DIFFERENCES OF NORMALIZED PRICES WITH THE FIRST NORMALIZED INPUT PRICE
DO #=1,12
GENR V1D#=V#-V1
ENDO
*GENR DIFFERENCES OF NORMALIZED PRICES WITH THE SECOND NORMALIZED INPUT PRICE
DO #=2,12
GENR V2D#=V#-V2
ENDO

*GENR DIFFERENCES OF NORMALIZED PRICES WITH THE 3RD NORMALIZED INPUT PRICE
DO #=3,12
GENR V3D#=V#-V3
ENDO

*GENR DIFFERENCES OF NORMALIZED PRICES WITH THE 4TH NORMALIZED INPUT PRICE
DO #=4,12
GENR V4D#=V#-V4
ENDO
 
*OUR NQ UNIT COST FUNCTION WITH A RANK ONE SUBSTITUTION MATRIX IS EQUAL TO C(u,p) DEFINED AS FOLLOWS:
*C(u,p) = a.p + bA.pU1 + bB.pU2 + bC.pU3 - (1/2)(p.c)(p.c)U/p.g WHERE c.1 = 0.
*WE SET c(1) = -SUM(n=2,12)c(n). THEREFORE c.v = SUM(n=2,12)c(n)(v(n)-v(1)) = SUM(n=2,12)c(n)V1D#
*ADD THE TERM - (1/2)(p.d)(p.d)/p.g WHERE d.1 = 0 AND d(1)=0           (RANK 2 SUBSTITUTION MATRIX)
*ADD THE TERM - (1/2)(p.e)(p.e)/p.g WHERE e.1 = 0 AND e(1)=e(2)=0      (RANK 3 SUBSTITUTION MATRIX)
*ADD THE TERM - (1/2)(p.f)(p.f)/p.g WHERE f.1 = 0 AND f(1)=f(2)=f(3)=0 (RANK 4 SUBSTITUTION MATRIX)  
*THE HICKSIAN DEMAND FUNCTIONS ARE AS FOLLOWS
*q =a+bA*U1+bB*U2+bC*U3-c(c.v)*U+(1/2)g(c.v)(c.v)*U-d(d.v)*U+(1/2)g(d.v)(d.v)*U-e(e.v)u+(1/2)g(e.v)(e.v)u &
*  -f(f.v)u+(1/2)g(f.v)(f.v)u
   
*WE USE THE FINAL COEFS FROM CONS5OUT.TXT AS STARTING VALUES IN THE FOLLOWING NONLINEAR REGRESSION
*WE WILL NOW RUN A SYSTEM REGRESSION WITH UTILITY SPLINES WITH A RANK 4 SUBSTITUTION MATRIX
 
NL 12 / NCOEF=86 GENRVAR CONV=.000001 ITER=2000 PITER=50 LIST
EQ Q1=A1+BA1*U1+BB1*U2+BC1*U3 &
+(C2+C3+C4+C5+C6+C7+C8+C9+C10+C11+C12)*(C2*V1D2 &
+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12)*U &
+(1/2)*G1*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12)**2)*U &
+(1/2)*G1*((D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12)**2)*U &
+(1/2)*G1*((E4*V3D4+E5*V3D5+E6*V3D6+E7*V3D7+E8*V3D8+E9*V3D9+E10*V3D10+E11*V3D11+E12*V3D12)**2)*U &
+(1/2)*G1*((F5*V4D5+F6*V4D6+F7*V4D7+F8*V4D8+F9*V4D9+F10*V4D10+F11*V4D11+F12*V4D12)**2)*U
EQ Q2=A2+BA2*U1+BB2*U2+BC2*U3 &
-C2*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12)*U &
+(1/2)*G2*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12)**2)*U &
+(D3+D4+D5+D6+D7+D8+D9+D10+D11+D12)*(D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8 &
+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12)*U  &
+(1/2)*G2*((D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12)**2)*U &
+(1/2)*G2*((E4*V3D4+E5*V3D5+E6*V3D6+E7*V3D7+E8*V3D8+E9*V3D9+E10*V3D10+E11*V3D11+E12*V3D12)**2)*U &
+(1/2)*G2*((F5*V4D5+F6*V4D6+F7*V4D7+F8*V4D8+F9*V4D9+F10*V4D10+F11*V4D11+F12*V4D12)**2)*U 
EQ Q3=A3+BA3*U1+BB3*U2+BC3*U3 &
-C3*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12)*U &
+(1/2)*G3*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12)*U &
-D3*(D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12)*U  &
+(1/2)*G3*((D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12)**2)*U &
+(E4+E5+E6+E7+E8+E9+E10+E11+E12)*(E4*V3D4+E5*V3D5+E6*V3D6+E7*V3D7+E8*V3D8+E9*V3D9+E10*V3D10+E11*V3D11+E12*V3D12)*U &
+(1/2)*G3*((E4*V3D4+E5*V3D5+E6*V3D6+E7*V3D7+E8*V3D8+E9*V3D9+E10*V3D10+E11*V3D11+E12*V3D12)**2)*U &
+(1/2)*G3*((F5*V4D5+F6*V4D6+F7*V4D7+F8*V4D8+F9*V4D9+F10*V4D10+F11*V4D11+F12*V4D12)**2)*U 
EQ Q4=A4+BA4*U1+BB4*U2+BC4*U3 &
-C4*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12)*U &
+(1/2)*G4*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12)**2)*U &
-D4*(D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12)*U  &
+(1/2)*G4*((D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12)**2)*U &
-E4*(E4*V3D4+E5*V3D5+E6*V3D6+E7*V3D7+E8*V3D8+E9*V3D9+E10*V3D10+E11*V3D11+E12*V3D12)*U &
+(1/2)*G4*((E4*V3D4+E5*V3D5+E6*V3D6+E7*V3D7+E8*V3D8+E9*V3D9+E10*V3D10+E11*V3D11+E12*V3D12)**2)*U &
+(F5+F6+F7+F8+F9+F10+F11+F12)*(F5*V4D5+F6*V4D6+F7*V4D7+F8*V4D8+F9*V4D9+F10*V4D10+F11*V4D11+F12*V4D12)*U &
+(1/2)*G4*((F5*V4D5+F6*V4D6+F7*V4D7+F8*V4D8+F9*V4D9+F10*V4D10+F11*V4D11+F12*V4D12)**2)*U 
EQ Q5=A5+BA5*U1+BB5*U2+BC5*U3 &
-C5*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12)*U &
+(1/2)*G5*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12)**2)*U &
-D5*(D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12)*U  &
+(1/2)*G5*((D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12)**2)*U &
-E5*(E4*V3D4+E5*V3D5+E6*V3D6+E7*V3D7+E8*V3D8+E9*V3D9+E10*V3D10+E11*V3D11+E12*V3D12)*U &
+(1/2)*G5*((E4*V3D4+E5*V3D5+E6*V3D6+E7*V3D7+E8*V3D8+E9*V3D9+E10*V3D10+E11*V3D11+E12*V3D12)**2)*U &
-F5*(F5*V4D5+F6*V4D6+F7*V4D7+F8*V4D8+F9*V4D9+F10*V4D10+F11*V4D11+F12*V4D12)*U &
+(1/2)*G5*((F5*V4D5+F6*V4D6+F7*V4D7+F8*V4D8+F9*V4D9+F10*V4D10+F11*V4D11+F12*V4D12)**2)*U  
EQ Q6=A6+BA6*U1+BB6*U2+BC6*U3 &
-C6*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12)*U &
+(1/2)*G6*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12)**2)*U &
-D6*(D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12)*U  &
+(1/2)*G6*((D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12)**2)*U &
-E6*(E4*V3D4+E5*V3D5+E6*V3D6+E7*V3D7+E8*V3D8+E9*V3D9+E10*V3D10+E11*V3D11+E12*V3D12)*U &
+(1/2)*G6*((E4*V3D4+E5*V3D5+E6*V3D6+E7*V3D7+E8*V3D8+E9*V3D9+E10*V3D10+E11*V3D11+E12*V3D12)**2)*U &
-F6*(F5*V4D5+F6*V4D6+F7*V4D7+F8*V4D8+F9*V4D9+F10*V4D10+F11*V4D11+F12*V4D12)*U &
+(1/2)*G6*((F5*V4D5+F6*V4D6+F7*V4D7+F8*V4D8+F9*V4D9+F10*V4D10+F11*V4D11+F12*V4D12)**2)*U  
EQ Q7=A7+BA7*U1+BB7*U2+BC7*U3 &
-C7*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12)*U &
+(1/2)*G7*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12)**2)*U &
-D7*(D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12)*U  &
+(1/2)*G7*((D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12)**2)*U &
-E7*(E4*V3D4+E5*V3D5+E6*V3D6+E7*V3D7+E8*V3D8+E9*V3D9+E10*V3D10+E11*V3D11+E12*V3D12)*U &
+(1/2)*G7*((E4*V3D4+E5*V3D5+E6*V3D6+E7*V3D7+E8*V3D8+E9*V3D9+E10*V3D10+E11*V3D11+E12*V3D12)**2)*U &
-F7*(F5*V4D5+F6*V4D6+F7*V4D7+F8*V4D8+F9*V4D9+F10*V4D10+F11*V4D11+F12*V4D12)*U &
+(1/2)*G7*((F5*V4D5+F6*V4D6+F7*V4D7+F8*V4D8+F9*V4D9+F10*V4D10+F11*V4D11+F12*V4D12)**2)*U  
EQ Q8=A8+BA8*U1+BB8*U2+BC8*U3 &
-C8*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12)*U &
+(1/2)*G8*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12)**2)*U &
-D8*(D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12)*U  &
+(1/2)*G8*((D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12)**2)*U &
-E8*(E4*V3D4+E5*V3D5+E6*V3D6+E7*V3D7+E8*V3D8+E9*V3D9+E10*V3D10+E11*V3D11+E12*V3D12)*U &
+(1/2)*G8*((E4*V3D4+E5*V3D5+E6*V3D6+E7*V3D7+E8*V3D8+E9*V3D9+E10*V3D10+E11*V3D11+E12*V3D12)**2)*U &
-F8*(F5*V4D5+F6*V4D6+F7*V4D7+F8*V4D8+F9*V4D9+F10*V4D10+F11*V4D11+F12*V4D12)*U &
+(1/2)*G8*((F5*V4D5+F6*V4D6+F7*V4D7+F8*V4D8+F9*V4D9+F10*V4D10+F11*V4D11+F12*V4D12)**2)*U
EQ Q9=A9+BA9*U1+BB9*U2+BC9*U3 &
-C9*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12)*U &
+(1/2)*G9*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12)**2)*U &
-D9*(D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12)*U  &
+(1/2)*G9*((D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12)**2)*U &
-E9*(E4*V3D4+E5*V3D5+E6*V3D6+E7*V3D7+E8*V3D8+E9*V3D9+E10*V3D10+E11*V3D11+E12*V3D12)*U &
+(1/2)*G9*((E4*V3D4+E5*V3D5+E6*V3D6+E7*V3D7+E8*V3D8+E9*V3D9+E10*V3D10+E11*V3D11+E12*V3D12)**2)*U &
-F9*(F5*V4D5+F6*V4D6+F7*V4D7+F8*V4D8+F9*V4D9+F10*V4D10+F11*V4D11+F12*V4D12)*U &
+(1/2)*G9*((F5*V4D5+F6*V4D6+F7*V4D7+F8*V4D8+F9*V4D9+F10*V4D10+F11*V4D11+F12*V4D12)**2)*U 
EQ Q10=A10+BA10*U1+BB10*U2+BC10*U3 &
-C10*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12)*U &
+(1/2)*G10*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12)**2)*U &
-D10*(D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12)*U  &
+(1/2)*G10*((D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12)**2)*U &
-E10*(E4*V3D4+E5*V3D5+E6*V3D6+E7*V3D7+E8*V3D8+E9*V3D9+E10*V3D10+E11*V3D11+E12*V3D12)*U &
+(1/2)*G10*((E4*V3D4+E5*V3D5+E6*V3D6+E7*V3D7+E8*V3D8+E9*V3D9+E10*V3D10+E11*V3D11+E12*V3D12)**2)*U &
-F10*(F5*V4D5+F6*V4D6+F7*V4D7+F8*V4D8+F9*V4D9+F10*V4D10+F11*V4D11+F12*V4D12)*U &
+(1/2)*G10*((F5*V4D5+F6*V4D6+F7*V4D7+F8*V4D8+F9*V4D9+F10*V4D10+F11*V4D11+F12*V4D12)**2)*U  
EQ Q11=A11+BA11*U1+BB11*U2+BC11*U3 &
-C11*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12)*U &
+(1/2)*G11*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12)**2)*U &
-D11*(D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12)*U  &
+(1/2)*G11*((D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12)**2)*U &
-E11*(E4*V3D4+E5*V3D5+E6*V3D6+E7*V3D7+E8*V3D8+E9*V3D9+E10*V3D10+E11*V3D11+E12*V3D12)*U &
+(1/2)*G11*((E4*V3D4+E5*V3D5+E6*V3D6+E7*V3D7+E8*V3D8+E9*V3D9+E10*V3D10+E11*V3D11+E12*V3D12)**2)*U &
-F11*(F5*V4D5+F6*V4D6+F7*V4D7+F8*V4D8+F9*V4D9+F10*V4D10+F11*V4D11+F12*V4D12)*U &
+(1/2)*G11*((F5*V4D5+F6*V4D6+F7*V4D7+F8*V4D8+F9*V4D9+F10*V4D10+F11*V4D11+F12*V4D12)**2)*U 
EQ Q12=A12+BA12*U1+BB12*U2+BC12*U3 &
-C12*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12)*U &
+(1/2)*G12*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12)**2)*U &
-D12*(D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12)*U  &
+(1/2)*G12*((D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12)**2)*U &
-E12*(E4*V3D4+E5*V3D5+E6*V3D6+E7*V3D7+E8*V3D8+E9*V3D9+E10*V3D10+E11*V3D11+E12*V3D12)*U &
+(1/2)*G12*((E4*V3D4+E5*V3D5+E6*V3D6+E7*V3D7+E8*V3D8+E9*V3D9+E10*V3D10+E11*V3D11+E12*V3D12)**2)*U &
-F12*(F5*V4D5+F6*V4D6+F7*V4D7+F8*V4D8+F9*V4D9+F10*V4D10+F11*V4D11+F12*V4D12)*U &
+(1/2)*G12*((F5*V4D5+F6*V4D6+F7*V4D7+F8*V4D8+F9*V4D9+F10*V4D10+F11*V4D11+F12*V4D12)**2)*U 
COEF A1       0.66077     
COEF BA1      0.053257 
COEF BB1      0.074240 
COEF BC1      0.094404 
COEF C2      -0.058922 
COEF C3      -0.0078738 
COEF C4      -0.12574     
COEF C5      -0.097322 
COEF C6      -0.048077 
COEF C7       0.047789 
COEF C8      -0.0032275
COEF C9       0.074791
COEF C10     -0.038396
COEF C11      0.52849     
COEF C12     -0.015431 
COEF D3       0.0085472
COEF D4       0.0019130
COEF D5       0.10077     
COEF D6      -0.11378     
COEF D7       0.017782 
COEF D8      -0.0048791
COEF D9      -0.15090  
COEF D10      0.0056620
COEF D11      0.13267     
COEF D12     -0.037020 
COEF E4       0.0086380 
COEF E5       0.0040227 
COEF E6      -0.0027067 
COEF E7      -0.086972 
COEF E8       0.19755     
COEF E9      -0.072479 
COEF E10     -0.0054032 
COEF E11      0.050825 
COEF E12     -0.074641 
COEF A2      -0.079798 
COEF BA2      0.025507 
COEF BB2      0.018598 
COEF BC2      0.045669 
COEF A3       0.52959 
COEF BA3     -0.035021 
COEF BB3      0.010832 
COEF BC3     -0.0025645
COEF A4       0.62847     
COEF BA4     -0.0079543 
COEF BB4      0.057544 
COEF BC4      0.12909 
COEF A5       0.078845 
COEF BA5      0.25642 
COEF BB5      0.18934 
COEF BC5      0.20224 
COEF A6       0.16339 
COEF BA6      0.024808 
COEF BB6      0.038000 
COEF BC6      0.039580 
COEF A7      -0.69969 
COEF BA7      0.20064 
COEF BB7      0.15516 
COEF BC7      0.12675 
COEF A8      -0.22648 
COEF BA8      0.036840 
COEF BB8      0.10742 
COEF BC8      0.030278 
COEF A9       -1.8091 
COEF BA9      0.28651 
COEF BB9      0.18139 
COEF BC9      0.16362 
COEF A10     -0.028408 
COEF BA10     0.021729 
COEF BB10     0.011979 
COEF BC10     0.026425 
COEF A11      0.87706 
COEF BA11     0.11123 
COEF BB11     0.21341 
COEF BC11     0.068712 
COEF A12     -0.65267 
COEF BA12     0.083489 
COEF BB12    -0.014533 
COEF BC12     0.17879     
COEF F5 0.0001
COEF F6 0.0001
COEF F7 0.0001
COEF F8 0.0001
COEF F9 0.0001
COEF F10 0.0001
COEF F11 0.0001
COEF F12 0.0001
END
* THE FINAL LL IN E59418C\CONS5OUT.TXT = 1281
* THE INITIAL LL HERE IS =  1281.843 WHICH IS CLOSE TO THE ABOVE LL. A GOOD CHECK ON OUR CODE!
* FINAL STATISTICS:  TIME =     3.0330 SEC.   ITER. NO.   765   FUNCT. EVALUATIONS   803
* FINAL LOG-LIKELIHOOD   =  1302.190, 




*SKIPPED

*WE NEED TO GENR THE MATRIX OF SECOND ORDER PARTIAL DERIVATIVES OF THE COST FUNCTION WRT PRICES
*FIRST GENR THE C VECTOR AND THEN C TIMES C TRANSPOSE = THE C MATRIX = CC#$
SMPL 1 1
*GENR THE FIRST COMPONENT OF THE C VECTOR
GENR C1=0
DO #=2,12
GENR C1=C1-C#(1)
ENDO
SMPL 1 33
*GENR INNER PRODUCT OF C VECTOR WITH NORMALIZED PRICE VECTOR V
GENR CV=0
DO #=1,12
GENR CV=CV+C#(1)*V#
ENDO
*GENR V TRANSPOSE TIMES THE C VECTOR SQUARED = CV*CV
GENR VCV=CV*CV

*GENR THE D VECTOR 
SMPL 1 1
GENR D1=0
GENR D2=0
DO #=3,12
GENR D2=D2-D#(1)
ENDO
SMPL 1 33
*GENR INNER PRODUCT OF D VECTOR WITH THE PG NORMALIZED PRICE VECTOR V
GENR DV=0
DO #=1,12
GENR DV=DV+D#(1)*V#
ENDO
*GENR V TRANSPOSE TIMES THE D VECTOR SQUARED = DV*DV
GENR VDV=DV*DV

*GENR THE E VECTOR 
SMPL 1 1
GENR E1=0
GENR E2=0
GENR E3=0
DO #=4,12
GENR E3=E3-E#(1)
ENDO
SMPL 1 33
*GENR INNER PRODUCT OF THE E VECTOR WITH THE PG NORMALIZED PRICE VECTOR V
GENR EV=0
DO #=1,12
GENR EV=EV+E#(1)*V#
ENDO
*GENR V TRANSPOSE TIMES THE E VECTOR SQUARED = EV*EV
GENR VEV=EV*EV

*GENR THE F VECTOR 
SMPL 1 1
GENR F1=0
GENR F2=0
GENR F3=0
GENR F4=0
DO #=5,12
GENR F4=F4-F#(1)
ENDO
SMPL 1 33
*GENR INNER PRODUCT OF F VECTOR WITH THE PG NORMALIZED PRICE VECTOR V
GENR FV=0
DO #=1,12
GENR FV=FV+F#(1)*V#
ENDO
*GENR V TRANSPOSE TIMES THE F VECTOR SQUARED = FV*FV
GENR VFV=FV*FV

*GENR FITTED DEMAND FUNCTIONS
DO #= 1,12
GENR FQ#=A#(1)+BA#(1)*U1+BB#(1)*U2+BC#(1)*U3-C#(1)*CV*U+.5*G#*VCV*U-D#(1)*DV*U+.5*G#*VDV*U &
-E#(1)*EV*U+.5*G#*VEV*U-F#(1)*FV*U+.5*G#*VFV*U
ENDO
*COMPARE FITTED DEMANDS WITH ACTUAL DEMANDS
FORMAT(F8.0,12F8.4)
PRINT YEAR Q1 FQ1 Q2 FQ2 Q3 FQ3 Q4 FQ4 Q5 FQ5 Q6 FQ6 / FORMAT
PRINT YEAR Q7 FQ7 Q8 FQ8 Q9 FQ9 Q10 FQ10  Q11 FQ11 Q12 FQ12 / FORMAT
STAT Q1 FQ1 Q2 FQ2 Q3 FQ3 Q4 FQ4 Q5 FQ5 Q6 FQ6 Q7 FQ7 Q8 FQ8 Q9 FQ9 Q10 FQ10 Q11 FQ11 Q12 FQ12
* NAME         N   MEAN        ST. DEV     VARIANCE     MINIMUM      MAXIMUM
* Q1           33   1.2953     0.12534     0.15711E-01   1.1305       1.5260
* FQ1          33   1.2953     0.12457     0.15517E-01   1.1353       1.5030
* Q2           33  0.21644     0.46508E-01 0.21629E-02  0.15412      0.28026
* FQ2          33  0.21644     0.46399E-01 0.21529E-02  0.16104      0.28127
* Q3           33  0.11638     0.45225E-01 0.20453E-02  0.49970E-01  0.20084
* FQ3          33  0.11654     0.43691E-01 0.19089E-02  0.56767E-01  0.20673
* Q4           33  0.69996     0.19817     0.39273E-01  0.49158       1.0704
* FQ4          33  0.69996     0.19706     0.38831E-01  0.48386       1.0742
* Q5           33   3.2380     0.50363     0.25364       2.4613       3.9382
* FQ5          33   3.2380     0.50302     0.25303       2.4667       3.9219
* Q6           33  0.58353     0.16776     0.28143E-01  0.37338      0.88604
* FQ6          33  0.58353     0.16702     0.27896E-01  0.37980      0.89225
* Q7           33   1.7688     0.38320     0.14684       1.1966       2.2935
* FQ7          33   1.7688     0.38142     0.14548       1.1943       2.2465
* Q8           33  0.49135     0.28192     0.79482E-01  0.13143       1.0890
* FQ8          33  0.49135     0.28197     0.79505E-01  0.11230       1.0560
* Q9           33   1.8424     0.64839     0.42041      0.93211       2.7343
* FQ9          33   1.8424     0.64805     0.41996      0.90701       2.7272
* Q10          33  0.22761     0.39674E-01 0.15740E-02  0.17063      0.28587
* FQ10         33  0.22761     0.39497E-01 0.15600E-02  0.17045      0.29391
* Q11          33   2.6502     0.49969     0.24969       1.8207       3.3787
* FQ11         33   2.6502     0.49897     0.24897       1.9186       3.3874
* Q12          33  0.46328     0.30808     0.94915E-01  0.13675      0.97790
* FQ12         33  0.46328     0.30912     0.95554E-01  0.10940      0.96006
*THE AVERAGE FITTED DEMAND COINCIDES WITH THE CORRESPONDING AVERAGE ACTUAL DEMAND FOR EVERY COMMODITY
*THIS IS A CHECK ON OUR COMPUTATIONS; SINCE THERE IS A CONSTANT TERM IN EACH REGRESSION, THE SUM OF THE ERRORS 
*IN EACH OF THE 12 EQUATIONS SHOULD EQUAL 0 SO THE MEAN FOR EACH EQUATION WILL EQUAL THE FITTED VALUE MEAN.

*GENR THE COMPONENTS OF THE EXPENDITURE FUNCTION THAT IS IMPLIED BY OUR ESTIMATES
*GENR A.P , BA.P  BB.P  BC.P 
GENR AP=0
GENR BAP=0
GENR BBP=0
GENR BCP=0
DO #=1,12
GENR AP=AP+P#*A#
GENR BAP=BAP+P#*BA#
GENR BBP=BBP+P#*BB#
GENR BCP=BCP+P#*BC#
ENDO
*GENR THE INDIRECT UTILITY FUNCTION THAT CORRESPONDS TO OUR ESTIMATED COEFS
GENR IU=0
SMPL 1 8
GENR IU=(Y-AP)/(BAP-.5*PG*VCV-.5*PG*VDV-.5*PG*VEV-.5*PG*VFV)
SMPL 9 20
GENR IU=(Y-AP-BAP*IU(8)+BBP*IU(8))/(BBP-.5*PG*VCV-.5*PG*VDV-.5*PG*VEV-.5*PG*VFV)
SMPL 21 33
GENR IU=(Y-AP-BAP*IU(8)-BBP*(IU(20)-IU(8))+BCP*IU(20))/(BCP-.5*PG*VCV-.5*PG*VDV-.5*PG*VEV-.5*PG*VFV)
SMPL 1 33
FORMAT(F8.0,8F10.5)
PRINT YEAR U IU AP BAP BBP BCP VCV Y / FORMAT
STAT U IU / PCOR
* NAME         N    MEAN        ST. DEV     VARIANCE     MINIMUM      MAXIMUM
* U            33   13.450      3.0055      9.0330       9.4290       18.047
* IU           33   13.451      3.0073      9.0437       9.4370       18.016
*  CORRELATION MATRIX OF VARIABLES -       33 OBSERVATIONS
* U          1.0000
* IU        0.99999       1.0000
*U AND IU APPROXIMATE EACH OTHER VERY CLOSELY
OLS U IU / LIST

*CHECK OUR COMPUTATIONS
*GENR FITTED Y
SMPL 1 33
GENR FY=0
DO #=1,12
GENR FY=FY+P#*FQ#
ENDO
*GENR THE INDIRECT UTILITY THAT CORRESPONDS TO FY, NEWU OR NU
GENR NU=0
SMPL 1 8
GENR NU=(FY-AP)/(BAP-.5*PG*VCV-.5*PG*VDV-.5*PG*VEV-.5*PG*VFV)
SMPL 9 20
GENR NU=(FY-AP-BAP*NU(8)+BBP*NU(8))/(BBP-.5*PG*VCV-.5*PG*VDV-.5*PG*VEV-.5*PG*VFV)
SMPL 21 33
GENR NU=(FY-AP-BAP*NU(8)-BBP*(NU(20)-NU(8))+BCP*NU(20))/(BCP-.5*PG*VCV-.5*PG*VDV-.5*PG*VEV-.5*PG*VFV)
SMPL 1 33
FORMAT(F8.0,10F10.5)
PRINT YEAR IU NU U AP BAP BBP BCP VCV FY Y / FORMAT
*U IS INDEX NUMBER U; IU IS THE INDIRECT U THAT IS GENERATED BY OUR REGRESSION; NU IS THE INDIRECT U THAT
*IS GENERATED BY OUR REGRESSION BUT USES FITTED EXPENDITURES TO GENERATE THE INDIRECT UTILITY FUNCTION
*NU AND U SHOULD COINCIDE AND THEY DO
STAT IU NU U / PCOR
* NAME         N    MEAN        ST. DEV     VARIANCE     MINIMUM      MAXIMUM
* IU           33   13.451      3.0073      9.0437       9.4370       18.016
* NU           33   13.450      3.0055      9.0330       9.4290       18.047
* U            33   13.450      3.0055      9.0330       9.4290       18.047
*  CORRELATION MATRIX OF VARIABLES -       33 OBSERVATIONS
* IU         1.0000
* NU        0.99999       1.0000
* U         0.99999       1.0000       1.0000
*              IU           NU           U

*FINISH UP BY GENERATING ELASTICITIES
*GENR THE MATRIX OF SECOND ORDER PARTIAL DERIVATIVES OF THE COST FUNCTION WRT INPUT PRICES
DO #=1,12
DO $=1,12
GENR D#C$=(-C#(1)*C$(1)+C#(1)*G$*CV+G#*C$(1)*CV-G#*G$*VCV)*U/PG
GENR D#D$=(-D#(1)*D$(1)+D#(1)*G$*DV+G#*D$(1)*DV-G#*G$*VDV)*U/PG
GENR D#E$=(-E#(1)*E$(1)+E#(1)*G$*EV+G#*E$(1)*EV-G#*G$*VEV)*U/PG
GENR D#F$=(-F#(1)*F$(1)+F#(1)*G$*FV+G#*F$(1)*FV-G#*G$*VFV)*U/PG
ENDO
ENDO

*CALCULATE THE MATRIX OF ORDINARY PRICE ELASTICITIES OF INPUT DEMAND FOR EACH YEAR
DO #=1,12
DO $=1,12
GENR E#P$=(D#C$+D#D$+D#E$+D#F$)*P$/FQ#
ENDO
ENDO

DO #=1,12
GENR CHECK#=E#P1+E#P2+E#P3+E#P4+E#P5+E#P6+E#P7+E#P8+E#P9+E#P10+E#P11+E#P12
ENDO
STAT CHECK1-CHECK12
*ALL CHECK# ARE 0; CHECKS ARE SATISFIED
*PRINT OUT THE OWN ELASTICITIES OF DEMAND; THEY SHOULD ALL BE NEGATIVE (OR 0)
FORMAT(F8.0,6F10.5)
PRINT YEAR E1P1 E2P2 E3P3 E4P4 E5P5 E6P6 / FORMAT
PRINT YEAR E7P7 E8P8 E9P9 E10P10 E11P11 E12P12 / FORMAT
STAT E1P1 E2P2 E3P3 E4P4 E5P5 E6P6 E7P7 E8P8 E9P9 E10P10 E11P11 E12P12
* NAME         N    MEAN        ST. DEV     VARIANCE     MINIMUM      MAXIMUM
* E1P1         33  -36.214      2.4778      6.1396      -41.991      -31.937
* E2P2         33  -17.725      4.4197      19.534      -24.180      -8.3213
* E3P3         33  -122.20      53.095      2819.1      -218.32      -52.053
* E4P4         33  -15.553      4.0275      16.221      -20.547      -7.0887
* E5P5         33  -26.936      2.7197      7.3970      -31.476      -23.644
* E6P6         33  -309.60      60.922      3711.5      -389.72      -203.84
* E7P7         33  -27.136      2.2431      5.0317      -31.691      -24.264
* E8P8         33  -13.862      10.550      111.31      -41.207      -2.6263
* E9P9         33  -7.8046      2.4712      6.1067      -12.750      -4.8375
* E10P10       33  -48.522      16.749      280.52      -75.822      -24.595
* E11P11       33  -33.819      2.3494      5.5196      -38.132      -31.117
* E12P12       33  -554.35      313.44      98247.      -1386.5      -171.74
*FOR COMPARISON PURPOSES, HERE ARE THE AVERAGE ELASTICITIES FROM CONS5OUT.TXT
* E1P1         33  -18.287      1.2483      1.5582      -21.142      -16.153
* E2P2         33  -10.464      2.6094      6.8090      -14.270      -4.9106
* E3P3         33  -74.546      32.343      1046.1      -132.62      -31.691
* E4P4         33  -17.437      4.5166      20.400      -23.053      -7.9356
* E5P5         33  -9.6354     0.97092     0.94268      -11.261      -8.4728
* E6P6         33  -150.05      29.589      875.49      -191.96      -99.317
* E7P7         33  -13.766      1.1392      1.2977      -16.080      -12.306
* E8P8         33  -9.0070      6.8600      47.060      -26.989      -1.7084
* E9P9         33  -4.6622      1.4745      2.1743      -7.5877      -2.8918
* E10P10       33  -54.034      18.648      347.76      -84.546      -27.563
* E11P11       33  -11.983     0.81050     0.65691      -13.440      -11.039
* E12P12       33  -269.09      150.77      22732.      -644.46      -82.988

*GENR INCOME ELASTICITIES OF DEMAND
DO #=1,12
GENR EU#=0
ENDO
SMPL 1 8
DO #=1,12
GENR EU#=(BA#(1)-C#(1)*CV-D#(1)*DV-E#(1)*EV-F#(1)*FV+.5*G#*(VCV+VDV+VEV+VFV))*U/FQ#
ENDO
SMPL 9 20
DO #=1,12
GENR EU#=(BB#(1)-C#(1)*CV-D#(1)*DV-E#(1)*EV-F#(1)*FV+.5*G#*(VCV+VDV+VEV+VFV))*U/FQ#
ENDO
SMPL 21 33
DO #=1,12
GENR EU#=(BC#(1)-C#(1)*CV-D#(1)*DV-E#(1)*EV-F#(1)*FV+.5*G#*(VCV+VDV+VEV+VFV))*U/FQ#
ENDO
SMPL 1 33
FORMAT(F8.0,6F10.4)
PRINT YEAR EU1-EU6 / FORMAT
PRINT YEAR EU7-EU12 / FORMAT
STAT EU1-EU12
* NAME         N    MEAN       ST. DEV     VARIANCE     MINIMUM      MAXIMUM
* EU1          33  0.71114E-01 0.30883     0.95373E-01 -0.48635      0.34268
* EU2          33   1.1594     0.37251     0.13876      0.51044       1.4738
* EU3          33  -1.0878      1.6487      2.7183      -4.7176      0.14396
* EU4          33  0.88301      1.6432      2.7003      -1.9811       2.7788
* EU5          33  0.78490     0.33745     0.11387      0.51195       1.3825
* EU6          33  0.42395     0.38606     0.14905     -0.19976      0.80110
* EU7          33   1.0284     0.41680     0.17372      0.52127       1.6007
* EU8          33  0.82374      1.7637      3.1105      -2.8057       3.5683
* EU9          33   1.7504     0.83522     0.69759       1.0770       3.4827
* EU10         33  0.56695     0.14842     0.22028E-01  0.31995      0.77743
* EU11         33   1.2765     0.19035     0.36235E-01   1.1006       1.6136
* EU12         33   2.3543     0.97764     0.95577      0.74028       4.1171

*FOR COMPARISON, THE EUS FROM CON5
* NAME         N    MEAN       ST. DEV     VARIANCE     MINIMUM      MAXIMUM
* EU1          33  0.83510E-01 0.34340     0.11793     -0.52799      0.40471
* EU2          33   1.1152     0.36602     0.13397      0.47520       1.4119
* EU3          33  -1.1514      1.5784      2.4913      -4.6283      0.12111
* EU4          33  0.85438      1.6313      2.6612      -1.9782       2.7486
* EU5          33  0.80161     0.31555     0.99570E-01  0.51297       1.3474
* EU6          33  0.52055     0.22874     0.52322E-01  0.20523      0.81952
* EU7          33  0.98997     0.42059     0.17690      0.47696       1.5673
* EU8          33  0.89868      1.6324      2.6647      -2.4708       3.4684
* EU9          33   1.7104     0.77758     0.60464       1.0095       3.2763
* EU10         33  0.59116     0.70477E-01 0.49671E-02  0.48219      0.71621
* EU11         33   1.2958     0.25946     0.67321E-01   1.1070       1.7752
* EU12         33   2.2426     0.59008     0.34820       1.3573       3.7117
*FOR COMPARISON PURPOSES, HERE ARE THE INCOME ELASTICITIES FROM CONS4OUT.TXT
* EU1          33  0.17330     0.36863     0.13589     -0.48255      0.47190
* EU2          33  0.87942     0.34538     0.11929      0.27364       1.0966
* EU3          33  -2.0390      1.3151      1.7294      -4.8456     -0.61727
* EU4          33  0.89145      1.6620      2.7623      -1.9910       2.8180
* EU5          33  0.84167     0.30289     0.91744E-01  0.57394       1.3719
* EU6          33  0.98952     0.32696     0.10691      0.64041       1.4750
* EU7          33  0.90707     0.43884     0.19258      0.36462       1.4893
* EU8          33   1.0518      1.6035      2.5711      -2.0790       3.7187
* EU9          33   1.7738     0.78350     0.61388       1.0774       3.3758
* EU10         33  0.31098     0.13924     0.19388E-01  0.74925E-01  0.52875
* EU11         33   1.2689     0.28490     0.81167E-01   1.0739       1.7930
* EU12         33   1.5551     0.66484     0.44201      0.48125       2.8714

*1 IS THE SERIES       Food and non-alcoholic beverages
*2 IS THE SERIES       Alcoholic beverages
*3 IS THE SERIES       Tobacco
*4 IS THE SERIES       Clothing and footwear
*5 IS THE SERIES       Housing including electricity,gas and household furnishings
*6 IS THE SERIES       Health
*7 IS THE SERIES       Transportation aggregate, owned and purchased
*8 IS THE SERIES       Communications
*9 IS THE SERIES       Recreation and culture
*10 IS THE SERIES      Education
*11 IS THE SERIES      Services aggregate including Restaurants and hotels and Miscellaneous goods and services
*12 IS THE SERIES      Final consumption expenditure of resident households abroad
STOP















