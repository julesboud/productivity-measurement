*THIS IS CMOD4.TXT,A 2 GOOD CONSUMER REGRESSION MODEL BASED ON THE                 JUNE 30,2019
*NORMALIZED QUADRATIC EXPENDITURE FUNCTION.
*IN THIS MODEL, WE WILL CALCULATE UTILITY USING THE EXACT INDEX NUMBER FORMULA FOR THE NORMALIZED
*QUADRATIC FUNCTIONAL FORM; SEE EQUATION (90) IN CHAPTER 5, PART II OF THE ECON 594 LECTURE NOTES.
*THIS MODEL FOLLOWS UP ON CMOD3.TXT BUT WE WILL NOW USE THE BREAK POINTS IN CMOD3 TO IMPOSE
*SPLINES ON UTILITY IN ORDER TO IMPROVE THE FIT OF OUR EQUATIONS
*GOOD 1 IS PER POP CONSUMPTION AND GOOD 2 IS PER POP LABOUR SUPPLY CONVERTED INTO LEISURE DEMAND.
SET NODOECHO
SMPL 1 60
*YOUR SMPL MAY BE DIFFERENT. NOW READ IN PER POP CONSUMER DATA FROM DATOUT.TXT
READ YEAR X1 X2 PC1 PC2
   1959.        0.94213        0.75025        1.00000        1.00000
   1960.        0.94160        0.76335        1.04057        1.03473
   1961.        0.94247        0.74680        1.04632        1.06254
   1962.        0.97524        0.78068        1.05999        1.05361
   1963.        1.02414        0.80649        1.07549        1.09064
   1964.        1.05392        0.83313        1.11047        1.15804
   1965.        1.06367        0.83669        1.14922        1.21684
   1966.        1.09903        0.85221        1.18230        1.27688
   1967.        1.13349        0.85508        1.22689        1.34511
   1968.        1.17089        0.84562        1.26776        1.47316
   1969.        1.21622        0.84341        1.32214        1.60347
   1970.        1.23784        0.85255        1.40137        1.79477
   1971.        1.23051        0.83523        1.49660        1.92863
   1972.        1.26771        0.83397        1.59397        2.13238
   1973.        1.32701        0.84556        1.78636        2.47628
   1974.        1.36983        0.83956        2.10045        3.11785
   1975.        1.36665        0.82688        2.43408        3.60072
   1976.        1.42505        0.82235        2.71156        4.01921
   1977.        1.43581        0.82246        2.96242        4.38523
   1978.        1.44203        0.81665        3.23147        4.69709
   1979.        1.45053        0.83138        3.55176        5.07562
   1980.        1.47679        0.84170        3.89987        5.70114
   1981.        1.54710        0.84202        4.26864        6.40249
   1982.        1.55717        0.80677        4.72946        7.20453
   1983.        1.55210        0.79064        5.07748        7.84229
   1984.        1.54723        0.81438        5.38738        8.10991
   1985.        1.60567        0.83416        5.78719        8.56054
   1986.        1.61458        0.84582        6.27865        8.83882
   1987.        1.64073        0.85775        6.72305        9.38893
   1988.        1.68889        0.87744        7.17196       10.00849
   1989.        1.73208        0.90350        7.64978       10.87793
   1990.        1.70132        0.85249        8.06125       11.89643
   1991.        1.72164        0.82751        8.27285       12.58366
   1992.        1.73828        0.81809        8.42305       13.24905
   1993.        1.75861        0.84515        8.57934       13.07484
   1994.        1.81609        0.87374        8.75687       13.11379
   1995.        1.85525        0.87663        8.99539       13.70776
   1996.        1.88983        0.86914        9.12079       14.47196
   1997.        1.96369        0.87587        9.26638       14.71216
   1998.        2.05364        0.87376        9.34641       15.28891
   1999.        2.11672        0.89384        9.53106       15.37843
   2000.        2.15618        0.89516        9.95020       16.91677
   2001.        2.19783        0.88024       10.20479       17.71036
   2002.        2.26029        0.89303       10.51083       18.26312
   2003.        2.34894        0.89586       10.67488       19.02731
   2004.        2.42599        0.91389       10.85779       19.72856
   2005.        2.47116        0.92363       11.18561       20.63304
   2006.        2.55851        0.93303       11.56763       22.29131
   2007.        2.63103        0.93991       11.92741       23.66468
   2008.        2.59205        0.92852       12.28199       24.64378
   2009.        2.63507        0.91230       12.59164       26.14124
   2010.        2.70228        0.92452       12.83965       27.56287
   2011.        2.73446        0.92660       13.15078       28.38844
   2012.        2.73535        0.91547       13.49229       28.89385
   2013.        2.76057        0.90518       13.80931       29.75176
   2014.        2.78498        0.90588       14.00880       29.81375
   2015.        2.81730        0.90885       14.19698       30.03215
   2016.        2.83561        0.90726       14.35172       30.19166
   2017.        2.87104        0.91980       14.55362       30.50860
   2018.        2.88234        0.92659       14.78896       31.07464
*X1=PER CAPITA CONSUMPTION
*X2=PER CAPITA LABOUR SUPPLY
FORMAT(F8.0,4F15.5)
PRINT YEAR X1 X2 PC1 PC2 / FORMAT
*GENR THE DIFFERENCE BETWEEN THE VALUE OF CONSUMPTION AND THE AFTER TAX VALUE OF LABOUR SUPPLY
GENR VC=PC1*X1
GENR VL=PC2*X2
GENR VCL=VC-VL
FORMAT(F8.0,3F10.3)
PRINT YEAR VC VL VCL / FORMAT
*THE VALUE OF CONSUMPTION EXCEEDS THE VALUE OF AFTER TAX LABOUR INCOME CONSISTENTLY OVER THE SAMPLE PERIOD.

*WE CONVERT LABOUR SUPPLY INTO LEISURE DEMAND
*ASSUME EFFECTIVE HOURS ARE EQUAL TO TWICE THE AVERAGE HOURS OF LABOUR SUPPLIED
*THIS IS THE WEAKNESS OF A LEISURE MODEL; THE MAXIMUM NUMBER OF HOURS THAT COULD BE WORKED IS SOMEWHAT ARBITRARY.
STAT X2 / MEAN=AVE
GENR ONE=1
GENR H=2*ONE*AVE
GENR X=H-X2
*GENR A NEW X2 WHICH IS EQUAL TO PER CAPITA LEISURE RATHER THAN PER CAPITA LABOUR SUPPLY
GENR X2=X
GENR Y=PC1*X1+PC2*X2
FORMAT(6F12.4)
PRINT X1 X2 PC1 PC2 Y / FORMAT
INDEX PC1 X1 PC2 X2 / CHAIN FISHER=PUFCH QFISHER=UFCH
FORMAT(4F12.3)
PRINT YEAR PUFCH UFCH Y / FORMAT

*WE NEED FIXED WEIGHTS SUMMING TO 1,G1 AND G2. WE INITIALLY
*DEFINE G1 AND G2 AS BEING EQUAL TO THE SAMPLE MEANS OF X1 AND X2 RESPECTIVELY
*AND THEN WE NORMALIZE THEM TO ADD UP TO 1.
STAT X1 / MEAN=GG1
STAT X2 / MEAN=GG2
GENR SUM=GG1+GG2
GENR GG1=GG1/SUM
GENR GG2=GG2/SUM
SMPL 1 1
PRINT GG1 GG2
*NOTE THAT GG1 AND GG2 ARE SCALARS; WE CONVERT THEM TO VECTORS
SMPL 1 60
*YOUR SMPL MAY BE DIFFERENT
GENR G1=1
GENR G2=1
GENR G1=GG1(1)*G1
GENR G2=GG2(1)*G2
GENR PG=PC1*G1+PC2*G2
PRINT YEAR G1 G2 PG / FORMAT
*GENR PG NORMALIZED PRICES AND INCOME:
GENR NY=Y/PG
GENR NP1=PC1/PG
GENR NP2=PC2/PG
*GENR INCOME OR EXPENDITURE NORMALIZED PRICES:
GENR PY1=PC1/Y
GENR PY2=PC2/Y
*GENR EXPENDITURE SHARES:
GENR S1=PY1*X1
GENR S2=PY2*X2
PRINT YEAR NY S1 S2 / FORMAT
STAT S1 S2
FORMAT(5F12.3)
PRINT YEAR NP1 NP2 PY1 PY2 / FORMAT
*RELABLE PG NORMALIZED PRICES AS V1 AND V2:
GENR V1=PC1/PG
GENR V2=PC2/PG

*THE EXACT INDEX NUMBER FORMULA FOR NORMALIZED QUADRATIC PREFERENCES USING A FIXED BASE IS
*u(t)/u(1)=((V1(t)+V1(1))X1(t)+(V2(t)+V2(1))X2(t))/((V1(t)+V1(1))X1(1)+(V2(t)+V2(1))X2(1))
GENR UNQ=((V1+V1(1))*X1+(V2+V2(1))*X2)/((V1+V1(1))*X1(1)+(V2+V2(1))*X2(1))
*NORMALIZE UNQ TO EQUAL Y AT OBSERVATION 1
GENR CON=UNQ(1)
GENR UNQ=UNQ*Y(1)/CON
*GENR THE CHAINED NORMALIZED QUADRATIC EXACT INDEXES
*FIRST GENR THE CHAINED LINKS
GENR NQLINK=1
SMPL 2 60
GENR NQLINK=((V1+LAG(V1))*X1+(V2+LAG(V2))*X2)/((V1+LAG(V1))*LAG(X1)+(V2+LAG(V2))*LAG(X2))
SMPL 1 60
GENR UNQCH=1
SMPL 2 60
GENR UNQCH=LAG(UNQCH)*NQLINK
*NORMALIZE UNQ TO EQUAL Y AT OBSERVATION 1
SMPL 1 60
GENR CON=UNQCH(1)
GENR UNQCH=UNQCH*Y(1)/CON
*COMPARE UNQ AND UNQCH WITH UFCH THE FISHER CHAINED QUANTITY INDEX
FORMAT(F8.0,6F10.5)
PRINT YEAR UNQ UNQCH UFCH Y V1 V2 / FORMAT
STAT UNQ UNQCH UFCH
*NOTE THAT THE CHAINED NQ INDEX IS VIRTUALLY IDENTICAL TO THE CHAINED FISHER QUANTITY INDEX
*THIS IS TO BE EXPECTED SINCE BOTH INDEXES ARE SUPERLATIVE AND THEY APPROXIMATE EACH OTHER TO THE SECOND
*ORDER AROUND AN EQUAL PRICE AND QUANTITY POINT. THESE INDEXES ARE ALSO PRETTY CLOSE TO THE 
*FIXED BASE NQ QUANTITY INDEX
*IN THIS MODEL, WE WILL USE UNQCH AS AN EXOGENOUS UTILITY SERIES RATHER THAN ESTIMATING IT. AS A RESULT OF THIS CHANGE
*WE WILL HAVE TWO ESTIMATING EQUATIONS INSTEAD OF ONE.
*IN ORDER TO SIMPLIFY THE REGRESSION CODES, WE WILL REDEFINE UNQCH AS U
GENR U=UNQCH

*RECALL THAT IN CMOD3OUT.TXT, WE FOUND THE FOLLOWING BREAK POINTS IN EQ1: 9 17 31 34 47 55 
*WE WILL SPLINE THE B1*U TERMS
SMPL 1 60
DO #=1,7
GENR U#=0
ENDO
GENR U1=U
SMPL 10 60
GENR U1=U1(9)
GENR U2=U-U(9)
SMPL 18 60
GENR U2=U2(17)
GENR U3=U-U(17)
SMPL 32 60
GENR U3=U3(31)
GENR U4=U-U(31)
SMPL 35 60
GENR U4=U4(34)
GENR U5=U-U(34)
SMPL 48 60
GENR U5=U5(47)
GENR U6=U-U(47)
SMPL 56 60
GENR U6=U6(55)
GENR U7=U-U(55)
SMPL 1 60
GENR CHECK=U-U1-U2-U3-U4-U5-U6-U7
STAT CHECK
*CHECK SHOULD BE EQUAL TO 0 AT ALL OBSERVATIONS AND CHECK IS SATISFIED

*OUR FUNCTIONAL FORM FOR THE EXPENDITURE FUNCTION, E(U,P),
*IS A.P+SUM B(i).PU(i)+(.5P.CP/PG)*U WHERE CP*=0 IN A BASE YEAR WHERE THE PRICE VECTOR IS P*
*A,B AND P ARE VECTORS AND C IS A 2 BY 2 SYMMETRIC MATRIX WHICH SATISFIES CP* = 0
*A DOT SIGNIFIES AN INNER PRODUCT.
*WE USE THE FINAL COEF VALUES FROM CMOD3OUT.TXT AS STARTING VALUES HERE
*NOTE: THE TWO REGRESSION EQUATIONS BELOW ARE LINEAR IN THE UNKNOWN PARAMETERS SO YOU MAY BE WONDERING WHY 
*USE A NONLINEAR ESTIMATION PACKAGE TO ESTIMATE THE UNKNOWN COEFS? THE ANSWER IS THAT A11 APPEARS IN BOTH
*EQUATIONS; I.E., THE PARAMETERS ARE NOT COMPLETELY INDEPENDENT IN EACH EQUATION. THE NONLINEAR ESTIMATION
*PACKAGE WILL TAKE CARE OF CROSS EQUATION CONSTRAINTS ON PARAMETERS. 

NL 2 / NCOEF=17 GENRVAR CONV=.000001 ITER=150 LIST
EQ X1=A1+B11*U1+B12*U2+B13*U3+B14*U4+B15*U5+B16*U6+B17*U7-A11*A11*(V1-V2)*U+.5*G1*A11*A11*(V1-V2)*(V1-V2)*U
EQ X2=A2+B21*U1+B22*U2+B23*U3+B24*U4+B25*U5+B26*U6+B27*U7+A11*A11*(V1-V2)*U+.5*G2*A11*A11*(V1-V2)*(V1-V2)*U
COEF A1       -0.58227    
COEF B11       0.80411 
COEF B12       0.80411 
COEF B13       0.80411 
COEF B14       0.80411 
COEF B15       0.80411 
COEF B16       0.80411 
COEF B17       0.80411   
COEF A11       -0.47859      
COEF A2        0.40245   
COEF B21       0.28158
COEF B22       0.28158
COEF B23       0.28158
COEF B24       0.28158
COEF B25       0.28158
COEF B26       0.28158
COEF B27       0.28158     
END
* FINISHING LL FOR CMOD3 = 304.3005
* INITIAL LL HERE IS     = 304.3005 THIS IS EXACTLY EQUAL TO THE FINISHING LL FOR CMOD3; A GOOD CHECK ON OUR CODE.
* FINAL STATISTICS: TIME =     0.0670 SEC.   ITER. NO.    58   FUNCT. EVALUATIONS    73
* FINAL LOG-LIKELIHOOD FUNCTION = 387.9286, AGAIN OF 83 LL POINTS FOR ADDING 12 PARAMETERS. HIGHLY SIGNIFICANT.
*       COEFFICIENT    ST. ERROR   T-RATIO
* A1       -3.1835     0.56398     -5.6447
* B11       2.1694     0.29078      7.4607
* B12      0.87461     0.18440      4.7430
* B13       1.3438     0.87150E-01  15.420
* B14       1.2252     0.16031      7.6431
* B15       1.5109     0.11408      13.245
* B16       1.2843     0.23460      5.4743
* B17       1.4156     0.43650      3.2431
* A11     -0.77951E-01 0.27596    -0.28247
* A2        3.1216     0.41758      7.4756
* B21      -1.1370     0.21570     -5.2712
* B22      0.20912     0.13974      1.4966
* B23     -0.10827     0.61015E-01 -1.7745
* B24     -0.42299E-01 0.11411    -0.37068
* B25     -0.15065     0.73849E-01 -2.0399
* B26      0.42032E-01 0.13139     0.31991
* B27     -0.79432E-02 0.28395    -0.27974E-01

*YAY A11 IS NOT EQUAL TO 0 IN THIS RUN SO ALL ELASTICITIES OF SUBSTITUTION WILL NOT BE EQUAL TO 0!
*EQ 1: R-SQUARE BETWEEN OBSERVED AND PREDICTED = 0.9981
*EQ 2: R-SQUARE BETWEEN OBSERVED AND PREDICTED = 0.8476
*THE FITS ARE SATISFACTORY. THE R SQUARES ARE: 0.9975 AND 0.8790.
*UNFORTUNATELY, SPLINING UTILITY DID NOT COMPLETELY CURE OUR LACK OF FIT PROBLEM. THE PROBLEM WITH THE 
*AUSTRLIAN DATA IS THAT THERE ARE SOME PERIODS WHERE PER CAPITA UTILITY FALLS OR STAYS CONSTANT AND SO
*SPLINING WITH THE UTILITY LEVEL DOES NOT WORK NEARLY AS WELL AS SPLINING WITH TIME DID FOR THE PRODUCTION MODELS
*SINCE TIME T OBVIOUSLY INCREASES AT A STEADY RATE.

*CALCULATE THE INDIRECT UTILITY FUNCTION AND ELASTICITIES
*WE WOULD LIKE OUR ESTIMATED INDIRECT UTILITY LEVELS TO BE CLOSE TO THE INDEX NUMBER ESTIMATES OF UTILITY THAT
*WE HAVE USED IN THE ABOVE REGRESSION.
*FIRST GENR THE COMPLETE VECTORS AND THE SUBSTITUTION MATRIX C THAT WE HAVE ESTIMATED
GENR C11=-A11*A11
GENR C12=-C11
GENR C21=C12
GENR C22=C11
GENR CV1=C11*V1+C12*V2
GENR CV2=C21*V1+C22*V2
GENR VCV=V1*CV1+V2*CV2
*GENR BU1 AND BU2
GENR BU1=B11*U1+B12*U2+B13*U3+B14*U4+B15*U5+B16*U6+B17*U7
GENR BU2=B21*U1+B22*U2+B23*U3+B24*U4+B25*U5+B26*U6+B27*U7
*CONSTRUCT THE IMPLIED INDIRECT UTILITY FUNCTION
*DEFINE SOME PRELIMINARY VARIABLES
*GENR THE INNER PRODUCT OF THE "A" VECTOR WITH CONSUMER PRICES
GENR AP=A1*PC1+A2*PC2
*GENR THE INNER PRODUCTS OF THE B# VECTORS WITH CONSUMER PRICES
DO #=1,7
GENR BP#=B1#*PC1+B2#*PC2
ENDO
FORMAT(F8.0,8F9.5)
PRINT YEAR AP BP1-BP7 / FORMAT 
*RECALL THAT OUR BREAK POINTS ARE: 9 17 31 34 47 55
SMPL 1 60
*GENR IMPLICIT UTILITY
GENR UI=0
SMPL 1 9
GENR UI=(Y-AP)/(BP1+.5*VCV*PG)
FORMAT(F8.0,2F10.5)
SMPL 10 17
GENR UI=(Y-AP-BP1*UI(9)+BP2*UI(9))/(BP2+.5*VCV*PG)
SMPL 18 31
GENR UI=(Y-AP-BP1*UI(9)-BP2*(UI(17)-UI(9))+BP3*UI(17))/(BP3+.5*VCV*PG)
SMPL 32 34
GENR UI=(Y-AP-BP1*UI(9)-BP2*(UI(17)-UI(9))-BP3*(UI(31)-UI(17))+BP4*UI(31))/(BP4+.5*VCV*PG)
SMPL 35 47
GENR UI=(Y-AP-BP1*UI(9)-BP2*(UI(17)-UI(9))-BP3*(UI(31)-UI(17))-BP4*(UI(32)-UI(31))+BP5*U(32))/(BP5+.5*VCV*PG)
SMPL 48 55
GENR UI=(Y-AP-BP1*UI(9)-BP2*(UI(17)-UI(9))-BP3*(UI(31)-UI(17))-BP4*(UI(34)-UI(31)) &
-BP5*(UI(47)-UI(34))+BP6*U(47))/(BP6+.5*VCV*PG)
SMPL 56 60
GENR UI=(Y-AP-BP1*UI(9)-BP2*(UI(17)-UI(9))-BP3*(UI(31)-UI(17))-BP4*(UI(34)-UI(31)) &
-BP5*(UI(47)-UI(34))-BP6*(UI(55)-UI(47))+BP7*U(55))/(BP7+.5*VCV*PG)
SMPL 1 60
FORMAT(F8.0,6F10.5)
PRINT YEAR U UI Y CV1 CV2 VCV / FORMAT   
*   1959.   1.91243   1.91233   1.91243   0.00000   0.00000   0.00000
*   1960.   1.89881   1.89916   1.97024  -0.00003   0.00003  -0.00000
*   1961.   1.91627   1.91647   2.02077   0.00009  -0.00009  -0.00000
*   1962.   1.91501   1.91495   2.02400  -0.00004   0.00004  -0.00000
*   1963.   1.93795   1.93723   2.09836   0.00009  -0.00009  -0.00000
*   1964.   1.94030   1.93912   2.19801   0.00026  -0.00026  -0.00001
*   1965.   1.94617   1.94484   2.29790   0.00035  -0.00035  -0.00002
*   1966.   1.96435   1.96402   2.40815   0.00047  -0.00047  -0.00004
*   1967.   1.99446   1.99761   2.55482   0.00057  -0.00057  -0.00005
*   1968.   2.03990   2.04189   2.77332   0.00094  -0.00094  -0.00014
*   1969.   2.08417   2.08524   3.01448   0.00121  -0.00121  -0.00024
*   1970.   2.09340   2.09459   3.29253   0.00156  -0.00156  -0.00040
*   1971.   2.10667   2.10770   3.54903   0.00161  -0.00161  -0.00042
*   1972.   2.14088   2.14205   3.91121   0.00185  -0.00185  -0.00056
*   1973.   2.17852   2.17961   4.53723   0.00209  -0.00209  -0.00072
*   1974.   2.22191   2.22257   5.62405   0.00255  -0.00255  -0.00107
*   1975.   2.23487   2.23578   6.54438   0.00252  -0.00252  -0.00105
*   1976.   2.28896   2.29083   7.47415   0.00254  -0.00254  -0.00106
*   1977.   2.29777   2.29977   8.19179   0.00253  -0.00253  -0.00105
*   1978.   2.31007   2.31191   8.90556   0.00241  -0.00241  -0.00095
*   1979.   2.29936   2.30100   9.66501   0.00229  -0.00229  -0.00086
*   1980.   2.30889   2.31046  10.76972   0.00244  -0.00244  -0.00098
*   1981.   2.36693   2.36935  12.22878   0.00262  -0.00262  -0.00113
*   1982.   2.41909   2.42345  13.94791   0.00272  -0.00272  -0.00122
*   1983.   2.43517   2.44105  15.17336   0.00282  -0.00282  -0.00131
*   1984.   2.40150   2.40471  15.68445   0.00264  -0.00264  -0.00115
*   1985.   2.42545   2.42871  16.88027   0.00252  -0.00252  -0.00105
*   1986.   2.41880   2.42166  17.86894   0.00219  -0.00219  -0.00079
*   1987.   2.42682   2.42962  19.13145   0.00214  -0.00214  -0.00075
*   1988.   2.44445   2.44697  20.55088   0.00213  -0.00213  -0.00075
*   1989.   2.44996   2.45148  22.13781   0.00226  -0.00226  -0.00084
*   1990.   2.48620   2.48728  24.04155   0.00251  -0.00251  -0.00103
*   1991.   2.53403   2.53750  25.48055   0.00271  -0.00271  -0.00121
*   1992.   2.55952   2.56586  26.59832   0.00294  -0.00294  -0.00142
*   1993.   2.54191   2.53963  26.53339   0.00273  -0.00273  -0.00122
*   1994.   2.55370   2.55075  27.00812   0.00261  -0.00261  -0.00112
*   1995.   2.58241   2.57763  28.25691   0.00272  -0.00272  -0.00122
*   1996.   2.62010   2.61366  29.55828   0.00300  -0.00300  -0.00148
*   1997.   2.67117   2.66337  30.62333   0.00300  -0.00300  -0.00149
*   1998.   2.74616   2.73744  32.14062   0.00321  -0.00321  -0.00169
*   1999.   2.77055   2.76135  32.88805   0.00311  -0.00311  -0.00160
*   2000.   2.80018   2.79112  35.41731   0.00347  -0.00347  -0.00199
*   2001.   2.85289   2.84538  37.31054   0.00362  -0.00362  -0.00215
*   2002.   2.88429   2.87767  38.87057   0.00362  -0.00362  -0.00216
*   2003.   2.94922   2.94580  40.76623   0.00380  -0.00380  -0.00238
*   2004.   2.98354   2.98246  42.25508   0.00393  -0.00393  -0.00254
*   2005.   3.00444   3.00493  44.08426   0.00404  -0.00404  -0.00268
*   2006.   3.05708   3.06128  47.15069   0.00434  -0.00434  -0.00310
*   2007.   3.10114   3.10403  49.85491   0.00454  -0.00454  -0.00340
*   2008.   3.08911   3.09196  51.35408   0.00462  -0.00462  -0.00352
*   2009.   3.14498   3.14775  54.30844   0.00486  -0.00486  -0.00389
*   2010.   3.17498   3.17814  56.63713   0.00509  -0.00509  -0.00427
*   2011.   3.19490   3.19830  58.49921   0.00513  -0.00513  -0.00433
*   2012.   3.21275   3.21640  60.16792   0.00508  -0.00508  -0.00424
*   2013.   3.24681   3.25099  62.38018   0.00512  -0.00512  -0.00431
*   2014.   3.26331   3.26345  63.30252   0.00503  -0.00503  -0.00417
*   2015.   3.28212   3.28198  64.37417   0.00499  -0.00499  -0.00410
*   2016.   3.29782   3.29741  65.25038   0.00495  -0.00495  -0.00403
*   2017.   3.30442   3.30389  66.21371   0.00493  -0.00493  -0.00399
*   2018.   3.30228   3.30176  67.29875   0.00494  -0.00494  -0.00402
*OUR ESTIMATED INDIRECT UTILITY, UI, IS AMAZINGLY CLOSE TO OUR INDEX NUMBER ESTIMATES OF UTILITY, U.
*CVC, VC1 AND VC2 ARE ALL EQUAL TO 0 BECAUSE OUR ESTIMATED A11 TURNED OUT TO BE 0.
GENR DIFF=U-UI
STAT U UI DIFF / PCOR
* NAME        N    MEAN        ST. DEV      VARIANCE     MINIMUM      MAXIMUM
* U            60   2.5505     0.44846     0.20112       1.8988       3.3044
* UI           60   2.5508     0.44817     0.20085       1.8992       3.3039
* DIFF         60 -0.23303E-03 0.36496E-02 0.13320E-04 -0.63374E-02  0.92003E-02

*U AND UI ARE A LOT CLOSER
*  CORRELATION MATRIX OF VARIABLES -       59 OBSERVATIONS
* U          1.0000
* UI        0.99997       1.0000
* DIFF      0.83923E-01  0.75834E-01   1.0000
*              U            UI           DIFF
*THE IMPLICIT UTILITY LEVELS GENERATED BY THE ECONOMETRIC MODEL ARE VERY CLOSE TO THE INDEX NUMBER LEVELS
*THE CORRELATION BETWEEN U AND UI IS 0.99997
 
*GENR FITTED X'S AND EXPENDITURE SHARES:
GENR FX1=A1+BU1+(C11*V1+C12*V2)*U-.5*G1*VCV*U
GENR FX2=A2+BU2+(C21*V1+C22*V2)*U-.5*G2*VCV*U
FORMAT(F8.0,4F10.4)
PRINT YEAR X1 FX1 X2 FX2 / FORMAT
STAT X1 FX1 X2 FX2
* NAME         N    MEAN       ST. DEV      VARIANCE     MINIMUM      MAXIMUM
* X1           60   1.8182     0.61187     0.37439      0.94160       2.8823
* FX1          60   1.8182     0.61132     0.37371      0.93577       2.8627
* X2           60  0.86027     0.47126E-01 0.22209E-02  0.78064      0.97375
* FX2          60  0.86027     0.43549E-01 0.18965E-02  0.79838      0.96270
*CHECK WHETHER FX1 IS THE SAME AS THE PREDICTED VALUE IN EQ1 ABOVE AND WHETHER 
*FX2 IS THE SAME AS THE PREDICTED VALUE IN EQ2 ABOVE. THIS PROVIDES A GOOD CHECK ON OUR COMPUTATIONS.
*THESE CHECKS ARE SATISFIED FOR CANADA

*GENR HICKSIAN PRICE ELASTICITIES OF DEMAND: (SINCE A11 = 0, ALL OF THESE DERIVATIVES WILL EQUAL 0 FOR OUR DATA)
*FIRST CALCULATE THE MATRIX OF SECOND ORDER PARTIAL DERIVATIVES OF THE COST FUNCTION
DO #=1,2
DO $=1,2
GENR DC#$=(C#$-CV#*G$-G#*CV$+VCV*G#*G$)/PG
ENDO
ENDO
*GENR HICKSIAN PRICE ELASTICITIES OF DEMAND ECij=DCij*PCj/FXi
DO #=1,2
DO $=1,2
GENR EC#$=DC#$*PC$/FX#
ENDO
ENDO
*GENR CHECKS
GENR CHECK1=EC11+EC12
GENR CHECK2=EC21+EC22
STAT CHECK1 CHECK2
*CHECKS ARE SATISFIED
FORMAT(F8.0,4F10.5)
PRINT YEAR EC11 EC12 EC21 EC22 / FORMAT
STAT EC11 EC12 EC21 EC22
* NAME        N    MEAN        ST. DEV      VARIANCE     MINIMUM      MAXIMUM
* EC11         60 -0.51343E-02 0.90563E-03 0.82017E-06 -0.64555E-02 -0.37734E-02
* EC12         60  0.51343E-02 0.90563E-03 0.82017E-06  0.37734E-02  0.64555E-02
* EC21         60  0.66382E-02 0.18595E-03 0.34577E-07  0.63104E-02  0.71294E-02
* EC22         60 -0.66382E-02 0.18595E-03 0.34577E-07 -0.71294E-02 -0.63104E-02
*IM AM ELASTICITIES WITH GOOD SIGNS, BUT VERY SMALL

*GENR HICKSIAN ELASTICITIES OF DEMAND W.R.T. REAL INCOME OR UTILITY:
DO #=1,2
GENR ECU#=(BU#+(CV#-.5*G#*VCV)*U)/FX#
ENDO
FORMAT(F8.0,2F10.5)
PRINT YEAR ECU1 ECU2 / FORMAT
STAT ECU1 ECU2
* NAME         N    MEAN       ST. DEV      VARIANCE    MINIMUM      MAXIMUM
* ECU1         60   2.9622     0.67163     0.45109       2.1121       4.4020
* ECU2         60  -2.6378     0.18397     0.33844E-01  -2.9100      -2.2426
*LEISURE IS AN INFERIOR COMMODITY; ITS INCOME ELASTICITY OF DEMAND IS NEGATIVE FOR AUSTRALIA.
*THESE ELASTICITIES ARE VERY REASONABLE. 
STOP