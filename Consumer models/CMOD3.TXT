*THIS IS CMOD3.TXT,A 2 GOOD CONSUMER REGRESSION MODEL BASED ON THE                 JUNE 30,2019
*NORMALIZED QUADRATIC EXPENDITURE FUNCTION.
*IN THIS MODEL, WE WILL CALCULATE UTILITY USING THE EXACT INDEX NUMBER FORMULA FOR THE NORMALIZED
*QUADRATIC FUNCTIONAL FORM; SEE EQUATION (90) IN CHAPTER 5, PART II OF THE ECON 594 LECTURE NOTES.
*GOOD 1 IS PER POP CONSUMPTION AND GOOD 2 IS PER POP LABOUR SUPPLY cONVERTED INTO LEISURE DEMAND.
SET NODOECHO
SMPL 1 59
*YOUR SMPL MAY BE DIFFERENT. NOW READ IN PER POP CONSUMER DATA FROM DATOUT.TXT
READ YEAR X1 X2 PC1 PC2
   1960.        1.45410        1.12136        1.00000        1.00000
   1961.        1.44093        1.11335        1.00488        1.03310
   1962.        1.48598        1.12531        1.01951        1.06765
   1963.        1.51799        1.12416        1.04390        1.11086
   1964.        1.57009        1.14300        1.05854        1.11918
   1965.        1.63646        1.16254        1.08293        1.23494
   1966.        1.68425        1.18879        1.12683        1.29395
   1967.        1.71851        1.20189        1.17561        1.37105
   1968.        1.76315        1.18936        1.22439        1.44518
   1969.        1.81384        1.19944        1.27317        1.52799
   1970.        1.81415        1.18594        1.31707        1.60613
   1971.        1.89424        1.18948        1.35580        1.72707
   1972.        2.00079        1.20741        1.41995        1.85679
   1973.        2.10954        1.25030        1.52055        2.03763
   1974.        2.18424        1.27898        1.68794        2.29393
   1975.        2.23480        1.26973        1.87917        2.67983
   1976.        2.31869        1.26724        2.03260        3.02935
   1977.        2.35541        1.25690        2.20325        3.40516
   1978.        2.40165        1.28353        2.38967        3.57827
   1979.        2.43242        1.33064        2.60848        3.81751
   1980.        2.44225        1.34524        2.87670        4.16445
   1981.        2.44120        1.34418        3.20603        4.58995
   1982.        2.35053        1.26690        3.52639        5.11391
   1983.        2.38561        1.25506        3.77518        5.29755
   1984.        2.45392        1.28185        3.95123        5.58911
   1985.        2.55077        1.31370        4.10563        5.75441
   1986.        2.61195        1.34256        4.28570        5.78694
   1987.        2.67767        1.36792        4.46066        5.90544
   1988.        2.75234        1.39062        4.63126        6.37627
   1989.        2.79579        1.39178        4.83209        6.64102
   1990.        2.79192        1.37414        5.02512        6.80067
   1991.        2.72695        1.31599        5.25976        7.19078
   1992.        2.73659        1.28509        5.34179        7.55151
   1993.        2.75677        1.27403        5.44807        7.77959
   1994.        2.80547        1.29223        5.50986        7.71241
   1995.        2.83866        1.29950        5.58275        7.76175
   1996.        2.89249        1.30600        5.66572        7.79371
   1997.        3.00406        1.31441        5.74299        8.09372
   1998.        3.06107        1.33050        5.81831        8.41526
   1999.        3.15610        1.35496        5.91135        8.56610
   2000.        3.25378        1.37588        6.04376        9.16041
   2001.        3.29710        1.37410        6.16968        9.47560
   2002.        3.39193        1.37817        6.29032        9.93559
   2003.        3.45386        1.39168        6.39723       10.19750
   2004.        3.52588        1.41294        6.49452       10.47479
   2005.        3.62982        1.40769        6.60116       10.89708
   2006.        3.74367        1.41522        6.68393       11.46519
   2007.        3.87046        1.42648        6.78684       11.90826
   2008.        3.94219        1.42223        6.88746       12.45256
   2009.        3.89940        1.35179        6.89830       13.01645
   2010.        3.99430        1.35954        6.99207       13.41807
   2011.        4.04596        1.36396        7.13997       13.79751
   2012.        4.07515        1.37321        7.23261       14.07786
   2013.        4.13406        1.37289        7.32886       14.50027
   2014.        4.19560        1.36259        7.46980       14.92840
   2015.        4.27172        1.37342        7.54551       14.98082
   2016.        4.31835        1.36360        7.61726       14.82008
   2017.        4.41681        1.36137        7.70881       15.42393
   2018.        4.44614        1.35765        7.84062       15.94375
*X1=PER CAPITA CONSUMPTION
*X2=PER CAPITA LABOUR SUPPLY
FORMAT(F8.0,4F15.5)
PRINT YEAR X1 X2 PC1 PC2 / FORMAT
GENR VC=PC1*X1
GENR VL=PC2*X2
GENR VCL=VC-VL
FORMAT(F8.0,3F10.3)
PRINT YEAR VC VL VCL / FORMAT

*WE CONVERT LABOUR SUPPLY INTO LEISURE DEMAND
*ASSUME EFFECTIVE HOURS ARE EQUAL TO TWICE THE AVERAGE HOURS OF LABOUR SUPPLIED
*THIS IS THE WEAKNESS OF A LEISURE MODEL; THE MAXIMUM NUMBER OF HOURS THAT COULD BE WORKED IS SOMEWHAT ARBITRARY.
STAT X2 / MEAN=AVE
GENR ONE=1
GENR H=2*ONE*AVE
GENR X=H-X2
*GENR A NEW X2 WHICH IS EQUAL TO PER CAPITA LEISURE RATHER THAN PER CAPITA LABOUR SUPPLY
GENR X2=X
GENR Y=PC1*X1+PC2*X2
FORMAT(6F12.4)
PRINT X1 X2 PC1 PC2 Y / FORMAT
INDEX PC1 X1 PC2 X2 / CHAIN FISHER=PUFCH QFISHER=UFCH
FORMAT(4F12.3)
PRINT YEAR PUFCH UFCH Y / FORMAT

*WE NEED FIXED WEIGHTS SUMMING TO 1,G1 AND G2. WE INITIALLY
*DEFINE G1 AND G2 AS BEING EQUAL TO THE SAMPLE MEANS OF X1 AND X2 RESPECTIVELY
*AND THEN WE NORMALIZE THEM TO ADD UP TO 1.
STAT X1 / MEAN=GG1
STAT X2 / MEAN=GG2
SMPL 1 1
GENR SUM=GG1+GG2
GENR GG1=GG1/SUM
GENR GG2=GG2/SUM
PRINT GG1 GG2
*NOTE THAT GG1 AND GG2 ARE SCALARS; WE CONVERT THEM TO VECTORS
SMPL 1 59
*YOUR SMPL MAY BE DIFFERENT
GENR G1=1
GENR G2=1
GENR G1=GG1(1)*G1
GENR G2=GG2(1)*G2
GENR PG=PC1*G1+PC2*G2
PRINT YEAR G1 G2 PG / FORMAT
*GENR PG NORMALIZED PRICES AND INCOME:
GENR NY=Y/PG
GENR NP1=PC1/PG
GENR NP2=PC2/PG
*GENR INCOME OR EXPENDITURE NORMALIZED PRICES:
GENR PY1=PC1/Y
GENR PY2=PC2/Y
*GENR EXPENDITURE SHARES:
GENR S1=PY1*X1
GENR S2=PY2*X2
PRINT YEAR NY S1 S2 / FORMAT
STAT S1 S2
FORMAT(5F12.3)
PRINT YEAR NP1 NP2 PY1 PY2 / FORMAT
*RELABLE PG NORMALIZED PRICES AS V1 AND V2:
GENR V1=PC1/PG
GENR V2=PC2/PG

*THE EXACT INDEX NUMBER FORMULA FOR NORMALIZED QUADRATIC PREFERENCES USING A FIXED BASE IS
*u(t)/u(1)=((V1(t)+V1(1))X1(t)+(V2(t)+V2(1))X2(t))/((V1(t)+V1(1))X1(1)+(V2(t)+V2(1))X2(1))
GENR UNQ=((V1+V1(1))*X1+(V2+V2(1))*X2)/((V1+V1(1))*X1(1)+(V2+V2(1))*X2(1))
*NORMALIZE UNQ TO EQUAL Y AT OBSERVATION 1
GENR CON=UNQ(1)
GENR UNQ=UNQ*Y(1)/CON
*GENR THE CHAINED NORMALIZED QUADRATIC EXACT INDEXES
*FIRST GENR THE CHAINED LINKS
GENR NQLINK=1
SMPL 2 59
GENR NQLINK=((V1+LAG(V1))*X1+(V2+LAG(V2))*X2)/((V1+LAG(V1))*LAG(X1)+(V2+LAG(V2))*LAG(X2))
SMPL 1 59
GENR UNQCH=1
SMPL 2 59
GENR UNQCH=LAG(UNQCH)*NQLINK
*NORMALIZE UNQ TO EQUAL Y AT OBSERVATION 1
SMPL 1 59
GENR CON=UNQCH(1)
GENR UNQCH=UNQCH*Y(1)/CON
*COMPARE UNQ AND UNQCH WITH UFCH THE FISHER CHAINED QUANTITY INDEX
FORMAT(F8.0,6F10.5)
PRINT YEAR UNQ UNQCH UFCH Y V1 V2 / FORMAT
*   YEAR      UNQ      UNQCH      UFCH      Y          V1       V2
*   1960.   2.93547   2.93547   2.93547   2.93547   1.00000   1.00000
*   1961.   2.93045   2.93045   2.93045   2.98664   0.99120   1.01903
*   1962.   2.96298   2.96248   2.96248   3.09233   0.98528   1.03181
*   1963.   2.99551   2.99480   2.99480   3.22711   0.98012   1.04298
*   1964.   3.02788   3.02596   3.02596   3.29570   0.98220   1.03847
*   1965.   3.06919   3.06879   3.06880   3.55072   0.95749   1.09189
*   1966.   3.08773   3.08537   3.08538   3.72743   0.95519   1.09686
*   1967.   3.10586   3.10312   3.10313   3.94091   0.95004   1.10798
*   1968.   3.16060   3.15789   3.15790   4.20135   0.94604   1.11664
*   1969.   3.19676   3.19336   3.19337   4.45353   0.94046   1.12869
*   1970.   3.20942   3.20849   3.20850   4.66491   0.93509   1.14031
*   1971.   3.27599   3.27631   3.27633   5.00899   0.92029   1.17230
*   1972.   3.35261   3.34981   3.34982   5.43183   0.91132   1.19169
*   1973.   3.40308   3.39505   3.39507   5.96341   0.90289   1.20992
*   1974.   3.43812   3.42611   3.42613   6.72345   0.89803   1.22043
*   1975.   3.48303   3.48008   3.48010   7.77177   0.88124   1.25671
*   1976.   3.55037   3.55298   3.55300   8.75862   0.86572   1.29026
*   1977.   3.58491   3.59583   3.59585   9.77231   0.85285   1.31809
*   1978.   3.60550   3.60051   3.60053  10.45959   0.86406   1.29384
*   1979.   3.58819   3.56829   3.56831  11.20112   0.87214   1.27638
*   1980.   3.58448   3.55877   3.55879  12.26236   0.87597   1.26810
*   1981.   3.58818   3.55917   3.55919  13.60322   0.87987   1.25968
*   1982.   3.58671   3.57647   3.57649  15.12018   0.87536   1.26943
*   1983.   3.64050   3.62015   3.62016  16.14544   0.88688   1.24452
*   1984.   3.67135   3.64597   3.64599  17.07852   0.88409   1.25056
*   1985.   3.72797   3.68993   3.68995  17.89010   0.88730   1.24362
*   1986.   3.76586   3.70825   3.70827  18.48654   0.90026   1.21561
*   1987.   3.80676   3.73571   3.73573  19.23625   0.90707   1.20087
*   1988.   3.83579   3.77356   3.77358  20.47552   0.89351   1.23018
*   1989.   3.87515   3.80929   3.80931  21.55143   0.89413   1.22885
*   1990.   3.89702   3.82658   3.82660  22.38494   0.89948   1.21729
*   1991.   3.89584   3.83870   3.83872  23.59574   0.89596   1.22489
*   1992.   3.92545   3.88341   3.88343  24.56843   0.88430   1.25010
*   1993.   3.95205   3.91365   3.91367  25.35579   0.88078   1.25771
*   1994.   3.98434   3.93305   3.93307  25.56483   0.88775   1.24263
*   1995.   4.00952   3.95261   3.95263  25.96284   0.89011   1.23753
*   1996.   4.05623   3.99080   3.99082  26.49435   0.89382   1.22953
*   1997.   4.13857   4.07563   4.07565  27.67956   0.88537   1.24778
*   1998.   4.16080   4.10427   4.10429  28.51637   0.87629   1.26741
*   1999.   4.21908   4.15418   4.15420  29.34530   0.87562   1.26886
*   2000.   4.26053   4.20951   4.20953  30.90348   0.85977   1.30313
*   2001.   4.29398   4.24732   4.24734  31.98402   0.85508   1.31326
*   2002.   4.35781   4.31945   4.31947  33.50301   0.84510   1.33484
*   2003.   4.39194   4.35224   4.35226  34.44478   0.84183   1.34191
*   2004.   4.42432   4.38283   4.38285  35.36166   0.83763   1.35098
*   2005.   4.50648   4.47302   4.47304  36.98343   0.82930   1.36899
*   2006.   4.57147   4.55325   4.55327  38.63741   0.81549   1.39884
*   2007.   4.65189   4.63740   4.63742  40.27524   0.80731   1.41652
*   2008.   4.69654   4.69904   4.69906  41.85187   0.79645   1.43999
*   2009.   4.71205   4.76606   4.76608  43.18198   0.78093   1.47354
*   2010.   4.77041   4.82689   4.82691  44.60958   0.77478   1.48684
*   2011.   4.80320   4.85949   4.85952  45.97992   0.77225   1.49231
*   2012.   4.81135   4.86797   4.86799  46.78293   0.76961   1.49801
*   2013.   4.84833   4.91264   4.91267  48.13090   0.76365   1.51090
*   2014.   4.90351   4.97388   4.97391  49.85354   0.75998   1.51883
*   2015.   4.95842   5.01458   5.01461  50.64832   0.76238   1.51363
*   2016.   5.02430   5.06402   5.06405  51.25794   0.76977   1.49766
*   2017.   5.08568   5.14104   5.14106  53.19494   0.75956   1.51974
*   2018.   5.10091   5.16840   5.16842  54.71168   0.75365   1.53252
STAT UNQ UNQCH UFCH
* NAME         N    MEAN       ST. DEV     VARIANCE     MINIMUM      MAXIMUM
* UNQ          59   3.9230     0.63660     0.40525       2.9305       5.1009
* UNQCH        59   3.9107     0.65039     0.42300       2.9305       5.1684
* UFCH         59   3.9107     0.65039     0.42301       2.9305       5.1684
*NOTE THAT THE CHAINED NQ INDEX IS VIRTUALLY IDENTICAL TO THE CHAINED FISHER QUANTITY INDEX
*THIS IS TO BE EXPECTED SINCE BOTH INDEXES ARE SUPERLATIVE AND THEY APPROXIMATE EACH OTHER TO THE SECOND
*ORDER AROUND AN EQUAL PRICE AND QUANTITY POINT. THESE INDEXES ARE ALSO PRETTY CLOSE TO THE 
*FIXED BASE NQ QUANTITY INDEX

*IN THIS MODEL, WE WILL USE UNQCH AS AN EXOGENOUS UTILITY SERIES RATHER THAN ESTIMATING IT. AS A RESULT OF THIS CHANGE
*WE WILL HAVE TWO ESTIMATING EQUATIONS INSTEAD OF ONE.
*IN ORDER TO SIMPLIFY THE REGRESSION CODES, WE WILL REDEFINE UNQCH AS U
GENR U=UNQCH

*OUR FUNCTIONAL FORM FOR THE EXPENDITURE FUNCTION, E(U,P),
*IS A.P+(B.P+.5P.CP/PG)*U WHERE CP*=0 IN THE BASE YEAR.
*WE NO LONGER IMPOSE MONEY METRIC UTILITY SCALING; I.E., WE NO LONGER IMPOSE THE RESTRICTIONS A.P*=O,B.P*=1;
*WE SIMPLY LET THE VECTORS A AND B BE UNCONSTRAINED. BUT WE DO IMPOSE THE RESTRICTIONS C TIMES P* = 0.
*A,B AND P ARE VECTORS AND C IS A 2 BY 2 SYMMETRIC MATRIX.
*A DOT SIGNIFIES AN INNER PRODUCT.
*WE IMPOSE CURVATURE CONDITIONS IN THE REGRESSION WHICH FOLLOWS
*WE CAN ESTIMATE BOTH EQUATIONS NOW IF WE REPLACE U BY UNQ
NL 2 / NCOEF=5 GENRVAR CONV=.000001 ITER=150 LIST
EQ X1=A1+B1*U-A11*A11*(V1-V2)*U+.5*G1*A11*A11*(V1-V2)*(V1-V2)*U
EQ X2=A2+B2*U+A11*A11*(V1-V2)*U+.5*G2*A11*A11*(V1-V2)*(V1-V2)*U
COEF A1      0.01
COEF A2      0.01    
COEF B1      .5
COEF B2      .5     
COEF A11     0.01 
END
* FINAL STATISTICS: TIME =     0.0080 SEC.   ITER. NO.    34   FUNCT. EVALUATIONS    56
* FINAL LOG-LIKELIHOOD FUNCTION = 263.9683
* THIS LL CANNOT BE COMPARED WITH THE CMOD2OUT.TXT LL SINCE
* WE NOW HAVE A 2 EQUATION MODEL INSTEAD OF A SINGLE EQUATION MODEL; ALSO, WE HAVE SWITCHED FROM SHARES
* AS THE DEPENDENT VARIABLES TO PER CAPITA QUANTITIES
*       COEFFICIENT    ST. ERROR   T-RATIO
* A1       -1.1376     0.14398     -7.9011
* B1       0.89985     0.44447E-01  20.246
* A11      0.46402     0.19738E-01  23.508
* A2       0.85259     0.96195E-01  8.8631
* B2       0.20033     0.30490E-01  6.5704
*OUR NEW MODEL NOW ESTIMATES A POSITIVE A11 FOR CANADA
*THE EQUATION R SQUARES ARE: 0.9844 AND 0.3705; NOT TOO BAD FOR A 5 PARAMETER MODEL BUT NOT GREAT
*BREAK POINTS IN EQ1 ARE: 14 23 26 32 41 50
*BREAK POINTS IN EQ2 ARE A BIT DIFFERENT BUT THERE IS MORE VARIATION IN X1 SO WE WILL USE THE X1 BREAK POINTS  

*CALCULATE THE INDIRECT UTILITY FUNCTION AND ELASTICITIES
*CALCULATE THE COMPLETE SUBSTITUTION MATRIX C THAT WE HAVE ESTIMATED
GENR C11=-A11*A11
GENR C12=-C11
GENR C21=C12
GENR C22=C11
GENR CV1=C11*V1+C12*V2
GENR CV2=C21*V1+C22*V2
GENR VCV=V1*CV1+V2*CV2
*GENR THE IMPLIED INDIRECT UTILITY UI
GENR UI=(Y-(A1*PC1+A2*PC2))/(B1*PC1+B2*PC2+.5*VCV*PG)
FORMAT(F8.0,6F10.5)
PRINT YEAR U UI Y CV1 CV2 VCV / FORMAT
*   YEAR       U        UI        Y        CV1        CV2       VCV
*   1960.   2.93547   2.92723   2.93547   0.00000   0.00000   0.00000
*   1961.   2.93045   2.92407   2.98664   0.00599  -0.00599  -0.00017
*   1962.   2.96248   2.95467   3.09233   0.01002  -0.01002  -0.00047
*   1963.   2.99480   2.98556   3.22711   0.01354  -0.01354  -0.00085
*   1964.   3.02596   3.01411   3.29570   0.01211  -0.01211  -0.00068
*   1965.   3.06879   3.05801   3.55072   0.02894  -0.02894  -0.00389
*   1966.   3.08537   3.07411   3.72743   0.03050  -0.03050  -0.00432
*   1967.   3.10312   3.09157   3.94091   0.03401  -0.03401  -0.00537
*   1968.   3.15789   3.14446   4.20135   0.03673  -0.03673  -0.00627
*   1969.   3.19336   3.17928   4.45353   0.04053  -0.04053  -0.00763
*   1970.   3.20849   3.19475   4.66491   0.04419  -0.04419  -0.00907
*   1971.   3.27631   3.26420   5.00899   0.05426  -0.05426  -0.01367
*   1972.   3.34981   3.33883   5.43183   0.06037  -0.06037  -0.01692
*   1973.   3.39505   3.38525   5.96341   0.06611  -0.06611  -0.02030
*   1974.   3.42611   3.41671   6.72345   0.06942  -0.06942  -0.02238
*   1975.   3.48008   3.47295   7.77177   0.08084  -0.08084  -0.03035
*   1976.   3.55298   3.55099   8.75862   0.09141  -0.09141  -0.03881
*   1977.   3.59583   3.59967   9.77231   0.10017  -0.10017  -0.04660
*   1978.   3.60051   3.60121  10.45959   0.09254  -0.09254  -0.03977
*   1979.   3.56829   3.56730  11.20112   0.08704  -0.08704  -0.03518
*   1980.   3.55877   3.55776  12.26236   0.08443  -0.08443  -0.03311
*   1981.   3.55917   3.55858  13.60322   0.08178  -0.08178  -0.03106
*   1982.   3.57647   3.57639  15.12018   0.08485  -0.08485  -0.03344
*   1983.   3.62015   3.61918  16.14544   0.07700  -0.07700  -0.02754
*   1984.   3.64597   3.64559  17.07852   0.07891  -0.07891  -0.02892
*   1985.   3.68993   3.69034  17.89010   0.07672  -0.07672  -0.02734
*   1986.   3.70825   3.71173  18.48654   0.06790  -0.06790  -0.02141
*   1987.   3.73571   3.74195  19.23625   0.06326  -0.06326  -0.01858
*   1988.   3.77356   3.77358  20.47552   0.07249  -0.07249  -0.02440
*   1989.   3.80929   3.80990  21.55143   0.07207  -0.07207  -0.02412
*   1990.   3.82658   3.82990  22.38494   0.06843  -0.06843  -0.02175
*   1991.   3.83870   3.84077  23.59574   0.07082  -0.07082  -0.02330
*   1992.   3.88341   3.88393  24.56843   0.07876  -0.07876  -0.02881
*   1993.   3.91365   3.91446  25.35579   0.08116  -0.08116  -0.03059
*   1994.   3.93305   3.93482  25.56483   0.07641  -0.07641  -0.02712
*   1995.   3.95261   3.95505  25.96284   0.07480  -0.07480  -0.02599
*   1996.   3.99080   3.99453  26.49435   0.07228  -0.07228  -0.02427
*   1997.   4.07563   4.07794  27.67956   0.07803  -0.07803  -0.02828
*   1998.   4.10427   4.10454  28.51637   0.08421  -0.08421  -0.03294
*   1999.   4.15418   4.15524  29.34530   0.08467  -0.08467  -0.03329
*   2000.   4.20951   4.20625  30.90348   0.09546  -0.09546  -0.04232
*   2001.   4.24732   4.24372  31.98402   0.09865  -0.09865  -0.04520
*   2002.   4.31945   4.31557  33.50301   0.10545  -0.10545  -0.05164
*   2003.   4.35224   4.34875  34.44478   0.10767  -0.10767  -0.05385
*   2004.   4.38283   4.37927  35.36166   0.11053  -0.11053  -0.05674
*   2005.   4.47302   4.47098  36.98343   0.11620  -0.11620  -0.06271
*   2006.   4.55325   4.55193  38.63741   0.12560  -0.12560  -0.07327
*   2007.   4.63740   4.63943  40.27524   0.13117  -0.13117  -0.07991
*   2008.   4.69904   4.70341  41.85187   0.13856  -0.13856  -0.08917
*   2009.   4.76606   4.77719  43.18198   0.14913  -0.14913  -0.10329
*   2010.   4.82689   4.84533  44.60958   0.15331  -0.15331  -0.10917
*   2011.   4.85949   4.88174  45.97992   0.15504  -0.15504  -0.11164
*   2012.   4.86797   4.89189  46.78293   0.15683  -0.15683  -0.11424
*   2013.   4.91264   4.94299  48.13090   0.16089  -0.16089  -0.12023
*   2014.   4.97388   5.01190  49.85354   0.16339  -0.16339  -0.12399
*   2015.   5.01458   5.05566  50.64832   0.16175  -0.16175  -0.12152
*   2016.   5.06402   5.10729  51.25794   0.15672  -0.15672  -0.11408
*   2017.   5.14104   5.19561  53.19494   0.16368  -0.16368  -0.12442
*   2018.   5.16840   5.22862  54.71168   0.16770  -0.16770  -0.13062
STAT U UI / PCOR
* NAME         N    MEAN       ST. DEV     VARIANCE     MINIMUM       MAXIMUM
* U            59   3.9107     0.65039     0.42300       2.9305       5.1684
* UI           59   3.9139     0.66369     0.44049       2.9241       5.2286
*  CORRELATION MATRIX OF VARIABLES -       59 OBSERVATIONS
* U          1.0000
* UI        0.99990       1.0000
*              U            UI
*IT CAN BE SEEN THAT OUR INDEX NUMBER ESTIMATES OF UTILITY ARE VERY CLOSE TO THE INDIRECT UTILITY ESTIMATES
*OF UTILITY THAT ARE GENERATED BY OUR ECONOMETRIC MODEL.
*THE CORRELATION BETWEEN U AND UI IS 0.99990
*THUS OUR PROCEDURE OF USING INDEX U INSTEAD OF THE ACTUAL ECONOMETRIC MODEL U IS BASICALLY OK; THERE IS AN
*ERROR IN DOING THIS REPLACEMENT BUT THE ERRORS ARE SMALL ENOUGH SO THAT WE CAN USE THE ECONOMETRIC MODEL
*ESTIMATES OF ELASTICITIES WITH SOME DEGREE OF CONFIDENCE.

*GENR FITTED X'S AND EXPENDITURE SHARES:
GENR FX1=A1+B1*U+(C11*V1+C12*V2)*U-.5*G1*VCV*U
GENR FX2=A2+B2*U+(C21*V1+C22*V2)*U-.5*G2*VCV*U
FORMAT(F8.0,4F10.4)
PRINT YEAR X1 FX1 X2 FX2 / FORMAT
STAT X1 FX1 X2 FX2 \ PCOR
* NAME        N    MEAN        ST. DEV      VARIANCE     MINIMUM      MAXIMUM
* X1           59   2.8130     0.88008     0.77454       1.4409       4.4461
* FX1          59   2.8130     0.88186     0.77768       1.5039       4.6107
* X2           59   1.3014     0.86612E-01 0.75016E-02   1.1762       1.4894
* FX2          59   1.3014     0.84490E-01 0.71385E-02   1.1280       1.4407
*  CORRELATION MATRIX OF VARIABLES -       59 OBSERVATIONS
* X1         1.0000
* FX1       0.99215       1.0000                           THE CORRELATION BETWEEN X1 AND FX1 IS .99215 (PRETTY GOOD)
* X2       -0.84999     -0.79146       1.0000
* FX2      -0.82937     -0.88126      0.60866       1.0000 THE CORRELATION BETWEEN X2 AND FX2 IS .60866 (NOT SO GOOD)
*              X1           FX1          X2           FX2
* THE AVERAGES OF THE FITTED VALUES ARE EXACTLY EQUAL TO THE AVERAGES OF THE TRUE VALUES.
*THE SQUARE OF THE COR BETWEEN X1 AND FX1 IS .99215X.99215 = .9844, THE R SQUARE FOR EQ1
*THE SQUARE OF THE COR BETWEEN X2 AND FX2 IS .60866X.60866 = .3705, THE R SQUARE FOR EQ1
*CHECK WHETHER FX1 IS THE SAME AS THE PREDICTED VALUE IN EQ1 ABOVE AND WHETHER 
*FX2 IS THE SAME AS THE PREDICTED VALUE IN EQ2 ABOVE. THIS PROVIDES A GOOD CHECK ON OUR COMPUTATIONS.
*THESE CHECKS ARE SATISFIED FOR CANADA 

*GENR HICKSIAN PRICE ELASTICITIES OF DEMAND:
*FIRST CALCULATE THE MATRIX OF SECOND ORDER PARTIAL DERIVATIVES OF THE COST FUNCTION
DO #=1,2
DO $=1,2
GENR DC#$=(C#$-CV#*G$-G#*CV$+VCV*G#*G$)/PG
ENDO
ENDO
*GENR HICKSIAN PRICE ELASTICITIES OF DEMAND ECij=DCij*PCj/FXi
DO #=1,2
DO $=1,2
GENR EC#$=DC#$*PC$/FX#
ENDO
ENDO
*GENR CHECKS
GENR CHECK1=EC11+EC12
GENR CHECK2=EC21+EC22
STAT CHECK1 CHECK2
*CHECKS ARE SATISFIED
FORMAT(F8.0,4F10.5)
PRINT YEAR EC11 EC12 EC21 EC22 / FORMAT
STAT EC11 EC12 EC21 EC22
* NAME        N    MEAN        ST. DEV      VARIANCE     MINIMUM      MAXIMUM
* EC11         59 -0.11393     0.19652E-01 0.38621E-03 -0.14608     -0.82658E-01
* EC12         59  0.11393     0.19652E-01 0.38621E-03  0.82658E-01  0.14608
* EC21         59  0.15927     0.45684E-02 0.20871E-04  0.14945      0.16658
* EC22         59 -0.15927     0.45684E-02 0.20871E-04 -0.16658     -0.14945
*THESE PRICE ELASTICITIES ARE RATHER SMALL IN MAGNITUDE BUT THEY HAVE THE RIGHT SIGNS. 
*GENR HICKSIAN ELASTICITIES OF DEMAND W.R.T. REAL INCOME OR UTILITY:
DO #=1,2
GENR ECU#=(B#+CV#-.5*G#*VCV)*U/FX#
ENDO
FORMAT(F8.0,2F10.5)
PRINT YEAR ECU1 ECU2 / FORMAT
STAT ECU1 ECU2
* NAME        N    MEAN        ST. DEV      VARIANCE     MINIMUM      MAXIMUM
* ECU1         59   1.4451     0.13945     0.19446E-01   1.2467       1.7565
* ECU2         59  0.34199     0.44916E-01 0.20175E-02  0.24416      0.40820
*THESE INCOME ELASTICITIES OF DEMAND LOOK OK. 
*YOU MAY OBTAIN INCOME ELASTICITIES OF DEMAND FOR LEISURE WHICH ARE NEGATIVE. THIS CAN OCCUR.
STOP