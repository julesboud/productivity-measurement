*THIS IS THE FILE E59418C\CONS9.TXT THAT ESTIMATES NONHOMOTHETIC LEONTIEF PREFERENCES           JULY 23, 2019
*WE DO NOT IMPOSE MONEY METRIC UTILITY SCALING IN THIS MODEL; WE SPLINE UTILITY IN THIS MODEL (2 BREAK POINTS)
*WE ESTIMATE A NORMALIZED QUADRATIC RANK 7 SUBSTITUTION MATRIX IN THIS MODEL; WE HAVE ONLY 12 CONSUMPTION CATEGORIES.
PAR 10000                   
SIZE 10000
SET NODOECHO
*READ IN CANADIAN DATA FOR 1971-2017 FOR 12 CLASSES OF PER POP CONSUMPTION FROM E59418C\CDATOUT.TXT
SMPL 1 47
FORMAT(F8.0,9F10.5)
READ YEAR P1-P6
   1971.   1.00000   1.00000   1.00000   1.00000   1.00000   1.00000
   1972.   1.08367   1.03200   1.02561   1.01898   1.06062   1.02639
   1973.   1.24875   1.06126   1.06350   1.07008   1.14656   1.06944
   1974.   1.44697   1.12307   1.11885   1.16402   1.28369   1.15152
   1975.   1.62362   1.25711   1.24250   1.21629   1.45696   1.29731
   1976.   1.65641   1.32768   1.35826   1.28543   1.65704   1.42966
   1977.   1.80536   1.40342   1.46677   1.35900   1.87645   1.51075
   1978.   2.02570   1.47683   1.62929   1.40916   2.08131   1.61831
   1979.   2.25946   1.58466   1.71521   1.53319   2.29176   1.77131
   1980.   2.47495   1.78020   1.88273   1.67598   2.54837   1.94561
   1981.   2.74773   2.00590   2.13922   1.79780   2.89787   2.16922
   1982.   2.92112   2.33704   2.47129   1.91375   3.21078   2.42824
   1983.   3.01555   2.58107   2.91981   1.99718   3.47504   2.62952
   1984.   3.18459   2.73944   3.25590   2.04982   3.64267   2.77800
   1985.   3.25732   2.88563   3.83419   2.11360   3.79182   2.91740
   1986.   3.41629   3.14864   4.48468   2.16870   3.94061   3.08136
   1987.   3.56652   3.31114   4.87073   2.26595   4.07447   3.26724
   1988.   3.63794   3.54348   5.26039   2.38730   4.23705   3.45958
   1989.   3.74513   3.69829   6.19530   2.48359   4.44475   3.63685
   1990.   3.88772   3.89583   6.90606   2.56201   4.60475   3.82053
   1991.   3.97799   4.09429   8.73173   2.80354   4.81967   4.01683
   1992.   3.92790   4.29476   9.38165   2.82668   4.93335   4.15818
   1993.   4.00692   4.36186   9.19477   2.85621   5.00493   4.26942
   1994.   4.01740   4.35860   6.61399   2.87534   5.10203   4.30203
   1995.   4.09965   4.41014   6.37944   2.84516   5.15986   4.31338
   1996.   4.14467   4.51224   6.52024   2.82955   5.21978   4.36538
   1997.   4.20144   4.60758   6.94707   2.86933   5.27853   4.41332
   1998.   4.26271   4.69342   7.28562   2.89707   5.33514   4.50907
   1999.   4.30901   4.78300   7.49365   2.94015   5.41581   4.59949
   2000.   4.37563   4.85310   7.86860   2.93467   5.52468   4.70314
   2001.   4.56581   4.96486   8.84200   2.94353   5.64072   4.82936
   2002.   4.68685   5.07595  11.31961   2.92317   5.70163   4.92424
   2003.   4.76499   5.16621  13.05160   2.86222   5.79946   5.01043
   2004.   4.84635   5.29184  13.63745   2.84953   5.85981   5.09444
   2005.   4.96413   5.37897  13.71858   2.82663   5.94281   5.22212
   2006.   5.07845   5.42120  13.75233   2.76974   6.05260   5.34642
   2007.   5.20333   5.52612  14.19918   2.74650   6.16807   5.45219
   2008.   5.38327   5.57747  14.34587   2.66512   6.30984   5.55140
   2009.   5.65436   5.66565  14.78655   2.62129   6.33449   5.69702
   2010.   5.71655   5.65140  15.44631   2.53557   6.40556   5.82357
   2011.   5.91203   5.65004  16.15644   2.51717   6.48358   5.91926
   2012.   6.04766   5.71361  16.50278   2.50248   6.56622   5.94968
   2013.   6.13847   5.80596  16.92565   2.49636   6.67033   5.98655
   2014.   6.28035   5.86771  18.26691   2.53143   6.79002   6.05630
   2015.   6.46341   5.99083  19.15868   2.56836   6.87320   6.14859
   2016.   6.54497   6.08754  20.15318   2.56291   6.94778   6.24510
   2017.   6.52636   6.17881  21.12821   2.54356   6.98661   6.38352
FORMAT(F8.0,9F10.5)
PRINT YEAR P1-P6 / FORMAT
READ YEAR P7-P12
   1971.   1.00000   1.00000   1.00000   1.00000   1.00000   1.00000
   1972.   1.02571   1.04083   1.03099   1.01495   1.04750   1.01236
   1973.   1.05972   1.06741   1.06873   1.02727   1.12678   1.07219
   1974.   1.17633   1.07886   1.14956   1.04547   1.26975   1.15328
   1975.   1.30433   1.10953   1.26146   1.05007   1.43108   1.30496
   1976.   1.40740   1.19659   1.33917   1.06633   1.56201   1.34171
   1977.   1.50399   1.27727   1.40148   1.11480   1.65672   1.53278
   1978.   1.60220   1.33612   1.45475   1.19761   1.78896   1.76411
   1979.   1.76412   1.39033   1.54962   1.22663   1.91135   2.02481
   1980.   2.01089   1.43630   1.66726   1.28844   2.09195   2.27996
   1981.   2.36493   1.53822   1.80020   1.39724   2.31090   2.56481
   1982.   2.67348   1.77976   1.95238   1.52679   2.52173   2.79940
   1983.   2.80770   1.89436   2.06078   1.69061   2.74341   2.94361
   1984.   2.91527   1.93846   2.12495   1.79876   2.83482   3.22635
   1985.   3.03605   1.96794   2.17804   1.90147   2.93345   3.55904
   1986.   3.08542   1.97448   2.26472   1.98110   3.09100   3.76002
   1987.   3.19239   1.92228   2.35863   2.07822   3.22105   3.79983
   1988.   3.27676   1.93113   2.47363   2.19512   3.38444   3.64702
   1989.   3.46816   1.86510   2.57179   2.31084   3.49929   3.66621
   1990.   3.66606   1.84823   2.64506   2.55077   3.66336   3.84310
   1991.   3.71081   1.87219   2.73649   2.95191   3.91885   3.92031
   1992.   3.74279   1.89628   2.72343   3.34321   3.96773   4.17969
   1993.   3.81302   1.90980   2.75553   3.63618   4.06671   4.61720
   1994.   3.91713   1.91096   2.80174   3.96492   4.11939   4.98473
   1995.   4.07034   1.91681   2.82851   4.17019   4.17400   5.12616
   1996.   4.20738   2.00886   2.84894   4.36238   4.26960   5.23062
   1997.   4.27329   2.08545   2.87079   4.50185   4.37284   5.41649
   1998.   4.24427   2.13692   2.87161   4.70893   4.44491   5.85630
   1999.   4.39405   2.06201   2.88707   4.90030   4.53200   6.02572
   2000.   4.60256   2.06484   2.90911   5.07084   4.65175   6.27567
   2001.   4.63008   2.09486   2.93559   5.23533   4.71442   6.63566
   2002.   4.69902   2.11938   2.97125   5.40176   4.82465   6.79797
   2003.   4.79569   2.12452   2.99295   5.63841   4.92666   6.39821
   2004.   4.92441   2.13897   2.98724   5.93586   5.02759   6.29032
   2005.   5.13725   2.15308   2.97970   6.07060   5.13502   6.07553
   2006.   5.25482   2.16248   2.95366   6.15599   5.23311   5.90311
   2007.   5.35379   2.19597   2.92813   6.28925   5.33462   5.88462
   2008.   5.41066   2.22378   2.90659   6.48908   5.41440   6.11815
   2009.   5.07575   2.24709   2.92695   6.76243   5.45782   6.29008
   2010.   5.34458   2.31570   2.93965   7.02665   5.57704   5.80013
   2011.   5.68422   2.35195   2.95603   7.27535   5.67418   5.84844
   2012.   5.82583   2.39102   2.94626   7.54750   5.74475   5.89833
   2013.   5.89997   2.43142   2.94229   7.82216   5.83182   6.16450
   2014.   5.96861   2.54579   2.96496   8.04964   5.92183   6.58791
   2015.   5.77421   2.63688   3.01179   8.28584   5.98951   7.08698
   2016.   5.77816   2.64686   3.05772   8.52541   6.03232   7.23476
   2017.   6.01088   2.63424   3.08522   8.74146   6.08748   7.25027
PRINT YEAR P7-P12 / FORMAT
READ YEAR Q1-Q6
   1971.   0.59784   0.12549   0.10685   0.34715   1.08536   0.09680
   1972.   0.59729   0.13295   0.10831   0.36946   1.10713   0.10139
   1973.   0.59891   0.14042   0.10939   0.37676   1.12451   0.10814
   1974.   0.59831   0.14632   0.10942   0.38982   1.14195   0.10888
   1975.   0.59085   0.14984   0.10848   0.40683   1.12870   0.11206
   1976.   0.58908   0.14773   0.10539   0.42839   1.13045   0.11555
   1977.   0.58305   0.14881   0.10501   0.43508   1.11623   0.12131
   1978.   0.57833   0.15215   0.10066   0.44678   1.11745   0.12645
   1979.   0.57359   0.15041   0.10345   0.45742   1.12485   0.12544
   1980.   0.56776   0.15095   0.10254   0.44946   1.12583   0.12967
   1981.   0.56335   0.14928   0.10319   0.45420   1.10711   0.12281
   1982.   0.56081   0.14104   0.10167   0.42677   1.08574   0.12460
   1983.   0.55952   0.13702   0.09646   0.43451   1.09431   0.12507
   1984.   0.56246   0.13410   0.09101   0.45416   1.11699   0.12971
   1985.   0.56881   0.13422   0.08732   0.47297   1.14491   0.13593
   1986.   0.56657   0.13289   0.08026   0.49376   1.17492   0.14053
   1987.   0.56831   0.13172   0.07579   0.49679   1.20450   0.14123
   1988.   0.57014   0.12769   0.07494   0.48790   1.25418   0.13680
   1989.   0.57115   0.12617   0.07184   0.48153   1.28412   0.13930
   1990.   0.57286   0.11967   0.06707   0.46961   1.30217   0.14224
   1991.   0.57360   0.11154   0.06304   0.42469   1.29769   0.14333
   1992.   0.57528   0.10756   0.05896   0.41751   1.31358   0.14367
   1993.   0.57923   0.10639   0.05454   0.42302   1.34036   0.14867
   1994.   0.58128   0.11005   0.05977   0.43034   1.36427   0.14825
   1995.   0.58319   0.11067   0.06137   0.44336   1.37141   0.15997
   1996.   0.58621   0.10235   0.06109   0.44029   1.38455   0.16245
   1997.   0.59039   0.10600   0.06080   0.44415   1.40171   0.17620
   1998.   0.59730   0.10905   0.06144   0.45256   1.41540   0.18568
   1999.   0.60478   0.11235   0.05898   0.46034   1.43852   0.19170
   2000.   0.61648   0.11468   0.05642   0.47815   1.46736   0.19977
   2001.   0.61606   0.11709   0.05398   0.48884   1.48039   0.20884
   2002.   0.61721   0.12091   0.05050   0.49999   1.51636   0.21974
   2003.   0.62304   0.12387   0.04717   0.51303   1.55328   0.22554
   2004.   0.62774   0.12392   0.04538   0.52263   1.59044   0.23585
   2005.   0.62521   0.12571   0.04278   0.53718   1.62483   0.24471
   2006.   0.62897   0.12989   0.04070   0.56923   1.66131   0.25686
   2007.   0.63203   0.13321   0.03878   0.59191   1.70862   0.26912
   2008.   0.63616   0.13628   0.03769   0.60671   1.74208   0.27737
   2009.   0.63452   0.13555   0.03678   0.59979   1.74863   0.28129
   2010.   0.63604   0.13622   0.03814   0.64100   1.77645   0.28662
   2011.   0.62997   0.13830   0.03708   0.66050   1.80775   0.29066
   2012.   0.62929   0.14094   0.03682   0.67567   1.83224   0.29503
   2013.   0.63735   0.14085   0.03623   0.69897   1.87979   0.30321
   2014.   0.64622   0.14332   0.03484   0.71646   1.92555   0.30893
   2015.   0.64699   0.14590   0.03347   0.73989   1.95644   0.31440
   2016.   0.65291   0.14766   0.03207   0.75041   1.97980   0.32100
   2017.   0.66201   0.15017   0.03123   0.76419   2.00971   0.32489
PRINT YEAR Q1-Q6 / FORMAT
READ YEAR Q7-Q12
   1971.   0.51617   0.06491   0.27130   0.03773   0.70163   0.10301
   1972.   0.56172   0.06776   0.30279   0.03747   0.73534   0.10105
   1973.   0.62033   0.07259   0.33730   0.03990   0.76869   0.10927
   1974.   0.62468   0.07881   0.37285   0.04221   0.78286   0.11331
   1975.   0.65236   0.08490   0.38557   0.04565   0.78083   0.12445
   1976.   0.66392   0.09405   0.41873   0.04768   0.81840   0.14424
   1977.   0.67285   0.09520   0.42664   0.05035   0.84507   0.14473
   1978.   0.69063   0.10169   0.44774   0.04906   0.86815   0.13603
   1979.   0.70407   0.10977   0.46516   0.05055   0.88106   0.11022
   1980.   0.68317   0.11824   0.47164   0.05301   0.88768   0.11030
   1981.   0.66386   0.12505   0.48599   0.05354   0.88509   0.10276
   1982.   0.58331   0.12230   0.46784   0.05572   0.84953   0.09731
   1983.   0.61378   0.12254   0.48307   0.05617   0.85024   0.11106
   1984.   0.66661   0.12808   0.52025   0.05783   0.87083   0.10778
   1985.   0.73217   0.13536   0.54709   0.05887   0.91652   0.10477
   1986.   0.74923   0.14523   0.58326   0.05967   0.96506   0.10258
   1987.   0.78333   0.15336   0.60592   0.05875   0.99993   0.11785
   1988.   0.82327   0.16848   0.64329   0.05983   1.01812   0.13396
   1989.   0.80888   0.18270   0.65169   0.06070   1.05144   0.15661
   1990.   0.77260   0.19388   0.64625   0.05994   1.04269   0.18696
   1991.   0.73816   0.19542   0.62903   0.05836   1.00588   0.18989
   1992.   0.73600   0.20048   0.65107   0.05715   1.02401   0.18240
   1993.   0.73570   0.20326   0.66381   0.05796   1.05016   0.16445
   1994.   0.75629   0.20689   0.70584   0.05677   1.09442   0.13915
   1995.   0.75012   0.22175   0.73230   0.05719   1.11034   0.13782
   1996.   0.77443   0.22956   0.75589   0.05885   1.14291   0.14364
   1997.   0.84169   0.23699   0.80340   0.06140   1.18071   0.14309
   1998.   0.85795   0.24982   0.85891   0.06253   1.21729   0.12767
   1999.   0.89315   0.26654   0.90709   0.06324   1.25082   0.13012
   2000.   0.91414   0.29231   0.95864   0.06390   1.28067   0.13744
   2001.   0.91031   0.30728   0.98528   0.06459   1.29221   0.13426
   2002.   0.95181   0.33169   1.01144   0.06709   1.31876   0.12768
   2003.   0.95310   0.34125   1.02143   0.06935   1.31052   0.13732
   2004.   0.95320   0.35656   1.04839   0.06944   1.34766   0.15508
   2005.   0.96837   0.37594   1.08399   0.07129   1.38037   0.17408
   2006.   0.98522   0.39377   1.13210   0.07305   1.41487   0.19139
   2007.   1.01649   0.40161   1.18471   0.07429   1.45865   0.21445
   2008.   1.03359   0.40850   1.21123   0.07587   1.45783   0.22140
   2009.   1.00730   0.42846   1.19209   0.07679   1.40936   0.21007
   2010.   1.03801   0.42721   1.20628   0.07916   1.44316   0.25047
   2011.   1.04622   0.44083   1.21054   0.08129   1.46683   0.26180
   2012.   1.06404   0.44483   1.22346   0.08348   1.47350   0.27300
   2013.   1.10560   0.45799   1.23138   0.08607   1.50877   0.26861
   2014.   1.14534   0.45698   1.24205   0.08805   1.55888   0.25803
   2015.   1.17348   0.45781   1.24064   0.08971   1.59616   0.24206
   2016.   1.20571   0.46638   1.23335   0.09088   1.63225   0.23229
   2017.   1.24131   0.47202   1.24861   0.09190   1.66440   0.24610
PRINT YEAR Q7-Q12 / FORMAT
*1 IS THE SERIES       Food and non-alcoholic beverages
*2 IS THE SERIES       Alcoholic beverages
*3 IS THE SERIES       Tobacco
*4 IS THE SERIES       Clothing and footwear
*5 IS THE SERIES       Housing including electricity,gas and household furnishings
*6 IS THE SERIES       Health
*7 IS THE SERIES       Transportation aggregate, owned and purchased
*8 IS THE SERIES       Communications
*9 IS THE SERIES       Recreation and culture
*10 IS THE SERIES      Education
*11 IS THE SERIES      Services aggregate including Restaurants and hotels and Miscellaneous goods and services
*12 IS THE SERIES      Final consumption expenditure of resident households abroad
DO #=1,12
GENR V#=P#*Q#
ENDO

*GENR CHAINED FISHER PRICE AND QUANTITY INDEXES
INDEX P1 Q1 P2 Q2 P3 Q3 P4 Q4 P5 Q5 P6 Q6 P7 Q7 P8 Q8 P9 Q9 P10 Q10 &
P11 Q11 P12 Q12 / CHAIN FISHER=PF QFISHER=QF
*GENR EXPENDITURE Y ON THE 12 COMMODITIES
GENR Y=PF*QF
*GENR THE NORMALIZED QUADRATIC FIXED BASE AND CHAINED INDEXES
*WE FIRST NEED TO GENR FIXED WEIGHTS SUMMING TO 1,G1 TO G12. WE INITIALLY DEFINE THESE G# AS SAMPLE MEANS
DO #=1,12
STAT Q# / MEAN=GG#
ENDO
*SUM THE GG#
SMPL 1 1
GENR SUM=0
DO #=1,12
GENR SUM=SUM+GG#
ENDO
*DEFINE THE NORMALIZED GG#
DO #=1,12
GENR GG#=GG#/SUM
ENDO
FORMAT(6F10.5)
PRINT GG1-GG6 / FORMAT
PRINT GG7-GG12 / FORMAT
SMPL 1 47
GENR ONE=1
DO #=1,12
GENR G#=GG#(1)*ONE
ENDO
*GENR THE LOWE PRICE INDEX PG
GENR PG=0
DO #=1,12
GENR PG=PG+P#*G#
ENDO
*GENR PG NORMALIZED PRICES:
DO #=1,12
GENR PN#=P#/PG
ENDO
FORMAT(7F10.5)
PRINT PG PN1-PN6 / FORMAT
PRINT PG PN7-PN12 / FORMAT
STAT PG PN1-PN12

*THE EXACT INDEX NUMBER FORMULA FOR NORMALIZED QUADRATIC PREFERENCES USING A FIXED BASE IS
*u(t)/u(1)=SUM(PN#(t)+PN#(1))Q#(t)/(SUM(PN#(t)+PN#(1))Q#(1))
GENR NUM=0
GENR DEN=0
DO #=1,12
GENR NUM=NUM+(PN#+PN#(1))*Q#
GENR DEN=DEN+(PN#+PN#(1))*Q#(1)
ENDO
GENR QNFB=NUM/DEN
*NORMALIZE QNFB TO EQUAL Y IN OBSERVATION 1
GENR CON=QNFB(1)
GENR QNFB=QNFB*Y(1)/CON
GENR PNFB=Y/QNFB
*NOW CONSTRUCT THE NORMALIZED QUADRATIC CHAIN LINKS
GENR QNCH=1
GENR QNCHL=1
GENR NUML=0
GENR DENL=0
SMPL 2 47
DO #=1,12
GENR NUML=NUML+(PN#+LAG(PN#))*Q#
GENR DENL=DENL+(PN#+LAG(PN#))*LAG(Q#)
ENDO
*NOW CONSTRUCT THE NORMALIZED QUADRATIC EXACT INDEX NUMBER FORMULA USING THE CHAIN PRINCIPLE
GENR QNCHL=NUML/DENL
GENR QNCH=LAG(QNCH)*QNCHL
*NORMALIZE QNCH TO EQUAL Y AT OBSERVATION 1
SMPL 1 47
GENR CON=QNCH(1)
GENR QNCH=QNCH*Y(1)/CON
GENR PNCH=Y/QNCH
FORMAT(F8.0,7F10.5)
PRINT YEAR QF QNCH QNFB PF PNCH PNFB Y / FORMAT
*THE CHAINED FISHER AND CHAINED NORMALIZED QUADRATIC INDEXES DIFFER ONLY IN THE 4TH AND 5TH DECIMAL PLACE
*THEY ARE INCREDIBLY CLOSE!

GENR U=QNCH
*IN THIS RUN, WE WILL SPLINE UTILITY AT 2 BREAK POINTS 21 AND 32
GENR U=QNCH
*WE WILL SPLINE UTILITY AT OBS 21 AND 32
DO #=1,3
GENR U#=0
ENDO
GENR U1=U
SMPL 22 47
GENR U1=U1(21)
GENR U2=U-U(21)
SMPL 33 47
GENR U2=U2(32)
GENR U3=U-U(32)
SMPL 1 47
GENR CHECK=U-U1-U2-U3
STAT CHECK
*CHECK SHOULD BE 0 FOR ALL OBSERVATIONS AND THIS CHECK IS SATISFIED

*CHANGE NOTATION FOR NORMALIZED PRICES; CALL THEM V# INSTEAD OF PN#
DO #=1,12
GENR V#=PN#
ENDO

*GENR DIFFERENCES OF NORMALIZED PRICES WITH THE FIRST NORMALIZED INPUT PRICE
DO #=1,12
GENR V1D#=V#-V1
ENDO
*GENR DIFFERENCES OF NORMALIZED PRICES WITH THE SECOND NORMALIZED INPUT PRICE
DO #=2,12
GENR V2D#=V#-V2
ENDO

*GENR DIFFERENCES OF NORMALIZED PRICES WITH THE 3RD NORMALIZED INPUT PRICE
DO #=3,12
GENR V3D#=V#-V3
ENDO

*GENR DIFFERENCES OF NORMALIZED PRICES WITH THE 4TH NORMALIZED INPUT PRICE
DO #=4,12
GENR V4D#=V#-V4
ENDO

*GENR DIFFERENCES OF NORMALIZED PRICES WITH THE 5TH NORMALIZED INPUT PRICE
DO #=5,12
GENR V5D#=V#-V5
ENDO

*GENR DIFFERENCES OF NORMALIZED PRICES WITH THE 6TH NORMALIZED INPUT PRICE
DO #=6,12
GENR V6D#=V#-V6
ENDO

*GENR DIFFERENCES OF NORMALIZED PRICES WITH THE 7TH NORMALIZED INPUT PRICE
DO #=7,12
GENR V7D#=V#-V7
ENDO
 
*OUR NQ UNIT COST FUNCTION WITH A RANK ONE SUBSTITUTION MATRIX IS EQUAL TO C(u,p) DEFINED AS FOLLOWS:
*C(u,p) = a.p + bA.pU1 + bB.pU2 + bC.pU3 - (1/2)(p.c)(p.c)U/p.g WHERE c.1 = 0.
*WE SET c(1) = -SUM(n=2,12)c(n). THEREFORE c.v = SUM(n=2,12)c(n)(v(n)-v(1)) = SUM(n=2,12)c(n)V1D#
*ADD THE TERM - (1/2)(p.d)(p.d)/p.g WHERE d.1 = 0 AND d(1)=0                (RANK 2 SUBSTITUTION MATRIX)
*ADD THE TERM - (1/2)(p.e)(p.e)/p.g WHERE e.1 = 0 AND e(1)=e(2)=0           (RANK 3 SUBSTITUTION MATRIX)
*ADD THE TERM - (1/2)(p.f)(p.f)/p.g WHERE f.1 = 0 AND f(1)=f(2)=f(3)=0      (RANK 4 SUBSTITUTION MATRIX)
*ADD THE TERM - (1/2)(p.h)(p.h)/p.g WHERE h.1 = 0 AND h(1)=h(2)=h(3)=h(4)=0 (RANK 5 SUBSTITUTION MATRIX) 
*ADD THE TERM - (1/2)(p.i)(p.i)/p.g WHERE i.1 = 0 AND i(1)=i(2)=i(3)=i(4)=i(5)=0         (RANK 6 MATRIX)
*ADD THE TERM - (1/2)(p.j)(p.j)/p.g WHERE j.1 = 0 AND j(1)=j(2)=j(3)=j(4)=j(5)=j(6)=0    (RANK 7 MATRIX)   
*THE HICKSIAN DEMAND FUNCTIONS ARE AS FOLLOWS
*q =a+bA*U1+bB*U2+bC*U3-c(c.v)*U+(1/2)g(c.v)(c.v)*U-d(d.v)*U+(1/2)g(d.v)(d.v)*U-e(e.v)u+(1/2)g(e.v)(e.v)u &
*  -f(f.v)u+(1/2)g(f.v)(f.v)u-h(h.v)u+(1/2)g(h.v)(h.v)u-i(i.v)U+(1/2)g(i.v)(i.v)U-j(j.v)U+(1/2)g(j.v)(j.v)U
   
*WE USE THE FINAL COEFS FROM CONS8OUT.TXT AS STARTING VALUES IN THE FOLLOWING NONLINEAR REGRESSION
*WE WILL NOW RUN A SYSTEM REGRESSION WITH UTILITY SPLINES WITH A RANK 7 SUBSTITUTION MATRIX
 
NL 12 / NCOEF=104 GENRVAR CONV=.000001 ITER=2000 PITER=100 LIST
EQ Q1=A1+BA1*U1+BB1*U2+BC1*U3 &
+(C2+C3+C4+C5+C6+C7+C8+C9+C10+C11+C12)*(C2*V1D2 &
+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12)*U &
+(1/2)*G1*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12)**2)*U &
+(1/2)*G1*((D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12)**2)*U &
+(1/2)*G1*((E4*V3D4+E5*V3D5+E6*V3D6+E7*V3D7+E8*V3D8+E9*V3D9+E10*V3D10+E11*V3D11+E12*V3D12)**2)*U &
+(1/2)*G1*((F5*V4D5+F6*V4D6+F7*V4D7+F8*V4D8+F9*V4D9+F10*V4D10+F11*V4D11+F12*V4D12)**2)*U &
+(1/2)*G1*((H6*V5D6+H7*V5D7+H8*V5D8+H9*V5D9+H10*V5D10+H11*V5D11+H12*V5D12)**2)*U &
+(1/2)*G1*((I7*V6D7+I8*V6D8+I9*V6D9+I10*V6D10+I11*V6D11+I12*V6D12)**2)*U &
+(1/2)*G1*((J8*V7D8+J9*V7D9+J10*V7D10+J11*V7D11+J12*V7D12)**2)*U 
EQ Q2=A2+BA2*U1+BB2*U2+BC2*U3 &
-C2*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12)*U &
+(1/2)*G2*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12)**2)*U &
+(D3+D4+D5+D6+D7+D8+D9+D10+D11+D12)*(D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8 &
+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12)*U  &
+(1/2)*G2*((D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12)**2)*U &
+(1/2)*G2*((E4*V3D4+E5*V3D5+E6*V3D6+E7*V3D7+E8*V3D8+E9*V3D9+E10*V3D10+E11*V3D11+E12*V3D12)**2)*U &
+(1/2)*G2*((F5*V4D5+F6*V4D6+F7*V4D7+F8*V4D8+F9*V4D9+F10*V4D10+F11*V4D11+F12*V4D12)**2)*U &
+(1/2)*G2*((H6*V5D6+H7*V5D7+H8*V5D8+H9*V5D9+H10*V5D10+H11*V5D11+H12*V5D12)**2)*U &
+(1/2)*G2*((I7*V6D7+I8*V6D8+I9*V6D9+I10*V6D10+I11*V6D11+I12*V6D12)**2)*U &
+(1/2)*G2*((J8*V7D8+J9*V7D9+J10*V7D10+J11*V7D11+J12*V7D12)**2)*U 
EQ Q3=A3+BA3*U1+BB3*U2+BC3*U3 &
-C3*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12)*U &
+(1/2)*G3*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12)*U &
-D3*(D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12)*U  &
+(1/2)*G3*((D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12)**2)*U &
+(E4+E5+E6+E7+E8+E9+E10+E11+E12)*(E4*V3D4+E5*V3D5+E6*V3D6+E7*V3D7+E8*V3D8+E9*V3D9+E10*V3D10+E11*V3D11+E12*V3D12)*U &
+(1/2)*G3*((E4*V3D4+E5*V3D5+E6*V3D6+E7*V3D7+E8*V3D8+E9*V3D9+E10*V3D10+E11*V3D11+E12*V3D12)**2)*U &
+(1/2)*G3*((F5*V4D5+F6*V4D6+F7*V4D7+F8*V4D8+F9*V4D9+F10*V4D10+F11*V4D11+F12*V4D12)**2)*U &
+(1/2)*G3*((H6*V5D6+H7*V5D7+H8*V5D8+H9*V5D9+H10*V5D10+H11*V5D11+H12*V5D12)**2)*U &
+(1/2)*G3*((I7*V6D7+I8*V6D8+I9*V6D9+I10*V6D10+I11*V6D11+I12*V6D12)**2)*U &
+(1/2)*G3*((J8*V7D8+J9*V7D9+J10*V7D10+J11*V7D11+J12*V7D12)**2)*U
EQ Q4=A4+BA4*U1+BB4*U2+BC4*U3 &
-C4*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12)*U &
+(1/2)*G4*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12)**2)*U &
-D4*(D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12)*U  &
+(1/2)*G4*((D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12)**2)*U &
-E4*(E4*V3D4+E5*V3D5+E6*V3D6+E7*V3D7+E8*V3D8+E9*V3D9+E10*V3D10+E11*V3D11+E12*V3D12)*U &
+(1/2)*G4*((E4*V3D4+E5*V3D5+E6*V3D6+E7*V3D7+E8*V3D8+E9*V3D9+E10*V3D10+E11*V3D11+E12*V3D12)**2)*U &
+(F5+F6+F7+F8+F9+F10+F11+F12)*(F5*V4D5+F6*V4D6+F7*V4D7+F8*V4D8+F9*V4D9+F10*V4D10+F11*V4D11+F12*V4D12)*U &
+(1/2)*G4*((F5*V4D5+F6*V4D6+F7*V4D7+F8*V4D8+F9*V4D9+F10*V4D10+F11*V4D11+F12*V4D12)**2)*U &
+(1/2)*G4*((H6*V5D6+H7*V5D7+H8*V5D8+H9*V5D9+H10*V5D10+H11*V5D11+H12*V5D12)**2)*U &
+(1/2)*G4*((I7*V6D7+I8*V6D8+I9*V6D9+I10*V6D10+I11*V6D11+I12*V6D12)**2)*U &
+(1/2)*G4*((J8*V7D8+J9*V7D9+J10*V7D10+J11*V7D11+J12*V7D12)**2)*U  
EQ Q5=A5+BA5*U1+BB5*U2+BC5*U3 &
-C5*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12)*U &
+(1/2)*G5*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12)**2)*U &
-D5*(D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12)*U  &
+(1/2)*G5*((D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12)**2)*U &
-E5*(E4*V3D4+E5*V3D5+E6*V3D6+E7*V3D7+E8*V3D8+E9*V3D9+E10*V3D10+E11*V3D11+E12*V3D12)*U &
+(1/2)*G5*((E4*V3D4+E5*V3D5+E6*V3D6+E7*V3D7+E8*V3D8+E9*V3D9+E10*V3D10+E11*V3D11+E12*V3D12)**2)*U &
-F5*(F5*V4D5+F6*V4D6+F7*V4D7+F8*V4D8+F9*V4D9+F10*V4D10+F11*V4D11+F12*V4D12)*U &
+(1/2)*G5*((F5*V4D5+F6*V4D6+F7*V4D7+F8*V4D8+F9*V4D9+F10*V4D10+F11*V4D11+F12*V4D12)**2)*U &
+(H6+H7+H8+H9+H10+H11+H12)*(H6*V5D6+H7*V5D7+H8*V5D8+H9*V5D9+H10*V5D10+H11*V5D11+H12*V5D12)*U &
+(1/2)*G5*((H6*V5D6+H7*V5D7+H8*V5D8+H9*V5D9+H10*V5D10+H11*V5D11+H12*V5D12)**2)*U &
+(1/2)*G5*((I7*V6D7+I8*V6D8+I9*V6D9+I10*V6D10+I11*V6D11+I12*V6D12)**2)*U &
+(1/2)*G5*((J8*V7D8+J9*V7D9+J10*V7D10+J11*V7D11+J12*V7D12)**2)*U  
EQ Q6=A6+BA6*U1+BB6*U2+BC6*U3 &
-C6*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12)*U &
+(1/2)*G6*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12)**2)*U &
-D6*(D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12)*U  &
+(1/2)*G6*((D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12)**2)*U &
-E6*(E4*V3D4+E5*V3D5+E6*V3D6+E7*V3D7+E8*V3D8+E9*V3D9+E10*V3D10+E11*V3D11+E12*V3D12)*U &
+(1/2)*G6*((E4*V3D4+E5*V3D5+E6*V3D6+E7*V3D7+E8*V3D8+E9*V3D9+E10*V3D10+E11*V3D11+E12*V3D12)**2)*U &
-F6*(F5*V4D5+F6*V4D6+F7*V4D7+F8*V4D8+F9*V4D9+F10*V4D10+F11*V4D11+F12*V4D12)*U &
+(1/2)*G6*((F5*V4D5+F6*V4D6+F7*V4D7+F8*V4D8+F9*V4D9+F10*V4D10+F11*V4D11+F12*V4D12)**2)*U &
-H6*(H6*V5D6+H7*V5D7+H8*V5D8+H9*V5D9+H10*V5D10+H11*V5D11+H12*V5D12)*U &
+(1/2)*G6*((H6*V5D6+H7*V5D7+H8*V5D8+H9*V5D9+H10*V5D10+H11*V5D11+H12*V5D12)**2)*U &
+(I7+I8+I9+I10+I11+I12)*(I7*V6D7+I8*V6D8+I9*V6D9+I10*V6D10+I11*V6D11+I12*V6D12)*U &
+(1/2)*G6*((I7*V6D7+I8*V6D8+I9*V6D9+I10*V6D10+I11*V6D11+I12*V6D12)**2)*U &
+(1/2)*G6*((J8*V7D8+J9*V7D9+J10*V7D10+J11*V7D11+J12*V7D12)**2)*U
EQ Q7=A7+BA7*U1+BB7*U2+BC7*U3 &
-C7*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12)*U &
+(1/2)*G7*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12)**2)*U &
-D7*(D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12)*U  &
+(1/2)*G7*((D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12)**2)*U &
-E7*(E4*V3D4+E5*V3D5+E6*V3D6+E7*V3D7+E8*V3D8+E9*V3D9+E10*V3D10+E11*V3D11+E12*V3D12)*U &
+(1/2)*G7*((E4*V3D4+E5*V3D5+E6*V3D6+E7*V3D7+E8*V3D8+E9*V3D9+E10*V3D10+E11*V3D11+E12*V3D12)**2)*U &
-F7*(F5*V4D5+F6*V4D6+F7*V4D7+F8*V4D8+F9*V4D9+F10*V4D10+F11*V4D11+F12*V4D12)*U &
+(1/2)*G7*((F5*V4D5+F6*V4D6+F7*V4D7+F8*V4D8+F9*V4D9+F10*V4D10+F11*V4D11+F12*V4D12)**2)*U &
-H7*(H6*V5D6+H7*V5D7+H8*V5D8+H9*V5D9+H10*V5D10+H11*V5D11+H12*V5D12)*U &
+(1/2)*G7*((H6*V5D6+H7*V5D7+H8*V5D8+H9*V5D9+H10*V5D10+H11*V5D11+H12*V5D12)**2)*U &
-I7*(I7*V6D7+I8*V6D8+I9*V6D9+I10*V6D10+I11*V6D11+I12*V6D12)*U &
+(1/2)*G7*((I7*V6D7+I8*V6D8+I9*V6D9+I10*V6D10+I11*V6D11+I12*V6D12)**2)*U &
+(J8+J9+J10+J11+J12)*(J8*V7D8+J9*V7D9+J10*V7D10+J11*V7D11+J12*V7D12)*U &
+(1/2)*G7*((J8*V7D8+J9*V7D9+J10*V7D10+J11*V7D11+J12*V7D12)**2)*U 
EQ Q8=A8+BA8*U1+BB8*U2+BC8*U3 &
-C8*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12)*U &
+(1/2)*G8*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12)**2)*U &
-D8*(D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12)*U  &
+(1/2)*G8*((D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12)**2)*U &
-E8*(E4*V3D4+E5*V3D5+E6*V3D6+E7*V3D7+E8*V3D8+E9*V3D9+E10*V3D10+E11*V3D11+E12*V3D12)*U &
+(1/2)*G8*((E4*V3D4+E5*V3D5+E6*V3D6+E7*V3D7+E8*V3D8+E9*V3D9+E10*V3D10+E11*V3D11+E12*V3D12)**2)*U &
-F8*(F5*V4D5+F6*V4D6+F7*V4D7+F8*V4D8+F9*V4D9+F10*V4D10+F11*V4D11+F12*V4D12)*U &
+(1/2)*G8*((F5*V4D5+F6*V4D6+F7*V4D7+F8*V4D8+F9*V4D9+F10*V4D10+F11*V4D11+F12*V4D12)**2)*U &
-H8*(H6*V5D6+H7*V5D7+H8*V5D8+H9*V5D9+H10*V5D10+H11*V5D11+H12*V5D12)*U &
+(1/2)*G8*((H6*V5D6+H7*V5D7+H8*V5D8+H9*V5D9+H10*V5D10+H11*V5D11+H12*V5D12)**2)*U &
-I8*(I7*V6D7+I8*V6D8+I9*V6D9+I10*V6D10+I11*V6D11+I12*V6D12)*U &
+(1/2)*G8*((I7*V6D7+I8*V6D8+I9*V6D9+I10*V6D10+I11*V6D11+I12*V6D12)**2)*U &
-J8*(J8*V7D8+J9*V7D9+J10*V7D10+J11*V7D11+J12*V7D12)*U &
+(1/2)*G8*((J8*V7D8+J9*V7D9+J10*V7D10+J11*V7D11+J12*V7D12)**2)*U   
EQ Q9=A9+BA9*U1+BB9*U2+BC9*U3 &
-C9*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12)*U &
+(1/2)*G9*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12)**2)*U &
-D9*(D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12)*U  &
+(1/2)*G9*((D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12)**2)*U &
-E9*(E4*V3D4+E5*V3D5+E6*V3D6+E7*V3D7+E8*V3D8+E9*V3D9+E10*V3D10+E11*V3D11+E12*V3D12)*U &
+(1/2)*G9*((E4*V3D4+E5*V3D5+E6*V3D6+E7*V3D7+E8*V3D8+E9*V3D9+E10*V3D10+E11*V3D11+E12*V3D12)**2)*U &
-F9*(F5*V4D5+F6*V4D6+F7*V4D7+F8*V4D8+F9*V4D9+F10*V4D10+F11*V4D11+F12*V4D12)*U &
+(1/2)*G9*((F5*V4D5+F6*V4D6+F7*V4D7+F8*V4D8+F9*V4D9+F10*V4D10+F11*V4D11+F12*V4D12)**2)*U &
-H9*(H6*V5D6+H7*V5D7+H8*V5D8+H9*V5D9+H10*V5D10+H11*V5D11+H12*V5D12)*U &
+(1/2)*G9*((H6*V5D6+H7*V5D7+H8*V5D8+H9*V5D9+H10*V5D10+H11*V5D11+H12*V5D12)**2)*U &
-I9*(I7*V6D7+I8*V6D8+I9*V6D9+I10*V6D10+I11*V6D11+I12*V6D12)*U &
+(1/2)*G9*((I7*V6D7+I8*V6D8+I9*V6D9+I10*V6D10+I11*V6D11+I12*V6D12)**2)*U &
-J9*(J8*V7D8+J9*V7D9+J10*V7D10+J11*V7D11+J12*V7D12)*U &
+(1/2)*G9*((J8*V7D8+J9*V7D9+J10*V7D10+J11*V7D11+J12*V7D12)**2)*U 
EQ Q10=A10+BA10*U1+BB10*U2+BC10*U3 &
-C10*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12)*U &
+(1/2)*G10*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12)**2)*U &
-D10*(D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12)*U  &
+(1/2)*G10*((D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12)**2)*U &
-E10*(E4*V3D4+E5*V3D5+E6*V3D6+E7*V3D7+E8*V3D8+E9*V3D9+E10*V3D10+E11*V3D11+E12*V3D12)*U &
+(1/2)*G10*((E4*V3D4+E5*V3D5+E6*V3D6+E7*V3D7+E8*V3D8+E9*V3D9+E10*V3D10+E11*V3D11+E12*V3D12)**2)*U &
-F10*(F5*V4D5+F6*V4D6+F7*V4D7+F8*V4D8+F9*V4D9+F10*V4D10+F11*V4D11+F12*V4D12)*U &
+(1/2)*G10*((F5*V4D5+F6*V4D6+F7*V4D7+F8*V4D8+F9*V4D9+F10*V4D10+F11*V4D11+F12*V4D12)**2)*U &
-H10*(H6*V5D6+H7*V5D7+H8*V5D8+H9*V5D9+H10*V5D10+H11*V5D11+H12*V5D12)*U &
+(1/2)*G10*((H6*V5D6+H7*V5D7+H8*V5D8+H9*V5D9+H10*V5D10+H11*V5D11+H12*V5D12)**2)*U &
-I10*(I7*V6D7+I8*V6D8+I9*V6D9+I10*V6D10+I11*V6D11+I12*V6D12)*U &
+(1/2)*G10*((I7*V6D7+I8*V6D8+I9*V6D9+I10*V6D10+I11*V6D11+I12*V6D12)**2)*U &
-J10*(J8*V7D8+J9*V7D9+J10*V7D10+J11*V7D11+J12*V7D12)*U &
+(1/2)*G10*((J8*V7D8+J9*V7D9+J10*V7D10+J11*V7D11+J12*V7D12)**2)*U
EQ Q11=A11+BA11*U1+BB11*U2+BC11*U3 &
-C11*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12)*U &
+(1/2)*G11*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12)**2)*U &
-D11*(D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12)*U  &
+(1/2)*G11*((D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12)**2)*U &
-E11*(E4*V3D4+E5*V3D5+E6*V3D6+E7*V3D7+E8*V3D8+E9*V3D9+E10*V3D10+E11*V3D11+E12*V3D12)*U &
+(1/2)*G11*((E4*V3D4+E5*V3D5+E6*V3D6+E7*V3D7+E8*V3D8+E9*V3D9+E10*V3D10+E11*V3D11+E12*V3D12)**2)*U &
-F11*(F5*V4D5+F6*V4D6+F7*V4D7+F8*V4D8+F9*V4D9+F10*V4D10+F11*V4D11+F12*V4D12)*U &
+(1/2)*G11*((F5*V4D5+F6*V4D6+F7*V4D7+F8*V4D8+F9*V4D9+F10*V4D10+F11*V4D11+F12*V4D12)**2)*U &
-H11*(H6*V5D6+H7*V5D7+H8*V5D8+H9*V5D9+H10*V5D10+H11*V5D11+H12*V5D12)*U &
+(1/2)*G11*((H6*V5D6+H7*V5D7+H8*V5D8+H9*V5D9+H10*V5D10+H11*V5D11+H12*V5D12)**2)*U &
-I11*(I7*V6D7+I8*V6D8+I9*V6D9+I10*V6D10+I11*V6D11+I12*V6D12)*U &
+(1/2)*G11*((I7*V6D7+I8*V6D8+I9*V6D9+I10*V6D10+I11*V6D11+I12*V6D12)**2)*U &
-J11*(J8*V7D8+J9*V7D9+J10*V7D10+J11*V7D11+J12*V7D12)*U &
+(1/2)*G11*((J8*V7D8+J9*V7D9+J10*V7D10+J11*V7D11+J12*V7D12)**2)*U 
EQ Q12=A12+BA12*U1+BB12*U2+BC12*U3 &
-C12*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12)*U &
+(1/2)*G12*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12)**2)*U &
-D12*(D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12)*U  &
+(1/2)*G12*((D3*V2D3+D4*V2D4+D5*V2D5+D6*V2D6+D7*V2D7+D8*V2D8+D9*V2D9+D10*V2D10+D11*V2D11+D12*V2D12)**2)*U &
-E12*(E4*V3D4+E5*V3D5+E6*V3D6+E7*V3D7+E8*V3D8+E9*V3D9+E10*V3D10+E11*V3D11+E12*V3D12)*U &
+(1/2)*G12*((E4*V3D4+E5*V3D5+E6*V3D6+E7*V3D7+E8*V3D8+E9*V3D9+E10*V3D10+E11*V3D11+E12*V3D12)**2)*U &
-F12*(F5*V4D5+F6*V4D6+F7*V4D7+F8*V4D8+F9*V4D9+F10*V4D10+F11*V4D11+F12*V4D12)*U &
+(1/2)*G12*((F5*V4D5+F6*V4D6+F7*V4D7+F8*V4D8+F9*V4D9+F10*V4D10+F11*V4D11+F12*V4D12)**2)*U &
-H12*(H6*V5D6+H7*V5D7+H8*V5D8+H9*V5D9+H10*V5D10+H11*V5D11+H12*V5D12)*U &
+(1/2)*G12*((H6*V5D6+H7*V5D7+H8*V5D8+H9*V5D9+H10*V5D10+H11*V5D11+H12*V5D12)**2)*U &
-I12*(I7*V6D7+I8*V6D8+I9*V6D9+I10*V6D10+I11*V6D11+I12*V6D12)*U &
+(1/2)*G12*((I7*V6D7+I8*V6D8+I9*V6D9+I10*V6D10+I11*V6D11+I12*V6D12)**2)*U &
-J12*(J8*V7D8+J9*V7D9+J10*V7D10+J11*V7D11+J12*V7D12)*U &
+(1/2)*G12*((J8*V7D8+J9*V7D9+J10*V7D10+J11*V7D11+J12*V7D12)**2)*U
COEF	A1	0.571810
COEF	BA1	0.008984
COEF	BB1	0.039482
COEF	BC1	0.038911
COEF	C2	0.079424
COEF	C3	0.001181
COEF	C4	0.127680
COEF	C5	-0.202410
COEF	C6	0.085323
COEF	C7	-0.088383
COEF	C8	0.083467
COEF	C9	-0.070627
COEF	C10	-0.006627
COEF	C11	0.060591
COEF	C12	0.034891
COEF	D3	0.009249
COEF	D4	0.020733
COEF	D5	-0.028332
COEF	D6	-0.079962
COEF	D7	-0.115230
COEF	D8	0.026580
COEF	D9	0.234980
COEF	D10	0.033022
COEF	D11	-0.048825
COEF	D12	0.017441
COEF	E4	0.028414
COEF	E5	0.032788
COEF	E6	0.012182
COEF	E7	-0.037145
COEF	E8	0.089402
COEF	E9	-0.053416
COEF	E10	0.012436
COEF	E11	-0.086899
COEF	E12	0.040988
COEF	F5	-0.088313
COEF	F6	-0.008024
COEF	F7	-0.028072
COEF	F8	0.075176
COEF	F9	0.152840
COEF	F10	-0.036583
COEF	F11	0.088702
COEF	F12	0.076882
COEF	H6	0.005573
COEF	H7	-0.108660
COEF	H8	0.006457
COEF	H9	-0.095944
COEF	H10	-0.017420
COEF	H11	-0.031917
COEF	H12	0.103770
COEF	I7	0.001640
COEF	I8	0.060072
COEF	I9	-0.242340
COEF	I10	-0.013826
COEF	I11	0.286380
COEF	I12	-0.057215
COEF	A2	0.223260
COEF	BA2	-0.021019
COEF	BB2	0.006500
COEF	BC2	0.008537
COEF	A3	0.259110
COEF	BA3	-0.033934
COEF	BB3	-0.014892
COEF	BC3	0.001944
COEF	A4	0.260580
COEF	BA4	0.023136
COEF	BB4	0.000288
COEF	BC4	0.097301
COEF	A5	-0.145790
COEF	BA5	0.296310
COEF	BB5	0.228820
COEF	BC5	0.289630
COEF	A6	-0.052288
COEF	BA6	0.033228
COEF	BB6	0.076911
COEF	BC6	0.035248
COEF	A7	-0.327910
COEF	BA7	0.216680
COEF	BB7	0.132400
COEF	BC7	0.196040
COEF	A8	-0.110280
COEF	BA8	0.039077
COEF	BB8	0.121150
COEF	BC8	0.036376
COEF	A9	-0.294660
COEF	BA9	0.139520
COEF	BB9	0.283190
COEF	BC9	0.065795
COEF	A10	0.059119
COEF	BA10	-0.004676
COEF	BB10	-0.006790
COEF	BC10	0.001731
COEF	A11	-0.502860
COEF	BA11	0.293710
COEF	BB11	0.276610
COEF	BC11	0.234000
COEF	A12	-0.058133
COEF	BA12	0.036265
COEF	BB12	-0.001501
COEF	BC12	0.033889
COEF J8  0.00001
COEF J9  0.00001
COEF J10 0.00001
COEF J11 0.00001
COEF J12 0.00001
END
* THE FINAL LL IN CONS8OUT.TXT = 2346.832 
* THE INITIAL LL HERE IS       = 2346.701 WHICH IS CLOSE TO THE ABOVE LL. A GOOD CHECK ON OUR CODE!
* FINAL STATISTICS: TIME       = 19.4080 SEC.   ITER. NO.  1060   FUNCT. EVALUATIONS  1116
* FINAL LOG-LIKELIHOOD         = 2349.252  , A GAIN OF 2.420 FOR ADDING 5 PARAMETERS. THE GAIN IS SMALL!

*WE NEED TO GENR THE MATRIX OF SECOND ORDER PARTIAL DERIVATIVES OF THE COST FUNCTION WRT PRICES
*FIRST GENR THE C VECTOR AND THEN C TIMES C TRANSPOSE = THE C MATRIX = CC#$
SMPL 1 1
*GENR THE FIRST COMPONENT OF THE C VECTOR
GENR C1=0
DO #=2,12
GENR C1=C1-C#(1)
ENDO
SMPL 1 47
*GENR INNER PRODUCT OF C VECTOR WITH NORMALIZED PRICE VECTOR V
GENR CV=0
DO #=1,12
GENR CV=CV+C#(1)*V#
ENDO
*GENR V TRANSPOSE TIMES THE C VECTOR SQUARED = CV*CV
GENR VCV=CV*CV

*GENR THE D VECTOR 
SMPL 1 1
GENR D1=0
GENR D2=0
DO #=3,12
GENR D2=D2-D#(1)
ENDO
SMPL 1 47
*GENR INNER PRODUCT OF D VECTOR WITH THE PG NORMALIZED PRICE VECTOR V
GENR DV=0
DO #=1,12
GENR DV=DV+D#(1)*V#
ENDO
*GENR V TRANSPOSE TIMES THE D VECTOR SQUARED = DV*DV
GENR VDV=DV*DV

*GENR THE E VECTOR 
SMPL 1 1
GENR E1=0
GENR E2=0
GENR E3=0
DO #=4,12
GENR E3=E3-E#(1)
ENDO
SMPL 1 47
*GENR INNER PRODUCT OF THE E VECTOR WITH THE PG NORMALIZED PRICE VECTOR V
GENR EV=0
DO #=1,12
GENR EV=EV+E#(1)*V#
ENDO
*GENR V TRANSPOSE TIMES THE E VECTOR SQUARED = EV*EV
GENR VEV=EV*EV

*GENR THE F VECTOR 
SMPL 1 1
GENR F1=0
GENR F2=0
GENR F3=0
GENR F4=0
DO #=5,12
GENR F4=F4-F#(1)
ENDO
SMPL 1 47
*GENR INNER PRODUCT OF F VECTOR WITH THE PG NORMALIZED PRICE VECTOR V
GENR FV=0
DO #=1,12
GENR FV=FV+F#(1)*V#
ENDO
*GENR V TRANSPOSE TIMES THE F VECTOR SQUARED = FV*FV
GENR VFV=FV*FV

*GENR THE H VECTOR 
SMPL 1 1
GENR H1=0
GENR H2=0
GENR H3=0
GENR H4=0
GENR H5=0
DO #=6,12
GENR H5=H5-H#(1)
ENDO
SMPL 1 47
*GENR INNER PRODUCT OF H VECTOR WITH THE PG NORMALIZED PRICE VECTOR V
GENR HV=0
DO #=1,12
GENR HV=HV+H#(1)*V#
ENDO
*GENR V TRANSPOSE TIMES THE H VECTOR SQUARED = HV*HV
GENR VHV=HV*HV

*GENR THE I VECTOR 
SMPL 1 1
GENR I1=0
GENR I2=0
GENR I3=0
GENR I4=0
GENR I5=0
GENR I6=0
DO #=7,12
GENR I6=I6-I#(1)
ENDO
SMPL 1 47
*GENR INNER PRODUCT OF I VECTOR WITH THE PG NORMALIZED PRICE VECTOR V
GENR IV=0
DO #=1,12
GENR IV=IV+I#(1)*V#
ENDO
*GENR V TRANSPOSE TIMES THE I VECTOR SQUARED = IV*IV
GENR VIV=IV*IV

*GENR THE J VECTOR 
SMPL 1 1
GENR J1=0
GENR J2=0
GENR J3=0
GENR J4=0
GENR J5=0
GENR J6=0
GENR J7=0
DO #=8,12
GENR J7=J7-J#(1)
ENDO
SMPL 1 47
*GENR INNER PRODUCT OF J VECTOR WITH THE PG NORMALIZED PRICE VECTOR V
GENR JV=0
DO #=1,12
GENR JV=JV+J#(1)*V#
ENDO
*GENR V TRANSPOSE TIMES THE J VECTOR SQUARED = JV*JV
GENR VJV=JV*JV

*GENR FITTED DEMAND FUNCTIONS
DO #= 1,12
GENR FQ#=A#(1)+BA#(1)*U1+BB#(1)*U2+BC#(1)*U3-C#(1)*CV*U+.5*G#*VCV*U-D#(1)*DV*U+.5*G#*VDV*U-E#(1)*EV*U+.5*G#*VEV*U &
-F#(1)*FV*U+.5*G#*VFV*U-H#(1)*HV*U+.5*G#*VHV*U-I#(1)*IV*U+.5*G#*VIV*U-J#(1)*JV*U+.5*G#*VJV*U
ENDO
*COMPARE FITTED DEMANDS WITH ACTUAL DEMANDS
FORMAT(F8.0,12F8.4)
PRINT YEAR Q1 FQ1 Q2 FQ2 Q3 FQ3 Q4 FQ4 Q5 FQ5 Q6 FQ6 / FORMAT
PRINT YEAR Q7 FQ7 Q8 FQ8 Q9 FQ9 Q10 FQ10  Q11 FQ11 Q12 FQ12 / FORMAT
STAT Q1 FQ1 Q2 FQ2 Q3 FQ3 Q4 FQ4 Q5 FQ5 Q6 FQ6 Q7 FQ7 Q8 FQ8 Q9 FQ9 Q10 FQ10 Q11 FQ11 Q12 FQ12
* NAME         N   MEAN        ST. DEV     VARIANCE     MINIMUM      MAXIMUM
* Q1           47  0.60018     0.29283E-01 0.85747E-03  0.55952      0.66201
* FQ1          47  0.60018     0.29042E-01 0.84344E-03  0.56243      0.66028
* Q2           47  0.13105     0.14664E-01 0.21503E-03  0.10235      0.15215
* FQ2          47  0.13105     0.11607E-01 0.13471E-03  0.11431      0.15031
* Q3           47  0.67640E-01 0.27162E-01 0.73777E-03  0.31230E-01  0.10942
* FQ3          47  0.73518E-01 0.23841E-01 0.56839E-03  0.40935E-01  0.12394
* Q4           47  0.50575     0.10781     0.11623E-01  0.34715      0.76419
* FQ4          47  0.50575     0.10593     0.11221E-01  0.37318      0.76009
* Q5           47   1.4162     0.29155     0.85000E-01   1.0854       2.0097
* FQ5          47   1.4162     0.29046     0.84368E-01   1.0453       2.0359
* Q6           47  0.18740     0.72545E-01 0.52628E-02  0.96800E-01  0.32489
* FQ6          47  0.18740     0.72495E-01 0.52556E-02  0.96587E-01  0.32754
* Q7           47  0.83795     0.18547     0.34398E-01  0.51617       1.2413
* FQ7          47  0.83795     0.18394     0.33834E-01  0.55954       1.2103
* Q8           47  0.24760     0.13702     0.18773E-01  0.64910E-01  0.47202
* FQ8          47  0.24760     0.13662     0.18664E-01  0.37599E-01  0.47990
* Q9           47  0.78526     0.32218     0.10380      0.27130       1.2486
* FQ9          47  0.78526     0.32181     0.10356      0.24451       1.2644
* Q10          47  0.63070E-01 0.14078E-01 0.19820E-03  0.37470E-01  0.91900E-01
* FQ10         47  0.63070E-01 0.13942E-01 0.19439E-03  0.37613E-01  0.89461E-01
* Q11          47   1.1406     0.27773     0.77134E-01  0.70163       1.6644
* FQ11         47   1.1406     0.27700     0.76728E-01  0.69081       1.6261
* Q12          47  0.15983     0.53308E-01 0.28418E-02  0.97310E-01  0.27300
* FQ12         47  0.15983     0.49415E-01 0.24418E-02  0.82909E-01  0.27600
*THE AVERAGE FITTED DEMAND COINCIDES WITH THE CORRESPONDING AVERAGE ACTUAL DEMAND FOR EVERY COMMODITY
*THIS IS A CHECK ON OUR COMPUTATIONS; SINCE THERE IS A CONSTANT TERM IN EACH REGRESSION, THE SUM OF THE ERRORS 
*IN EACH OF THE 12 EQUATIONS SHOULD EQUAL 0 SO THE MEAN FOR EACH EQUATION WILL EQUAL THE FITTED VALUE MEAN.

*GENR THE COMPONENTS OF THE EXPENDITURE FUNCTION THAT IS IMPLIED BY OUR ESTIMATES
*GENR A.P , BA.P  BB.P  BC.P 
GENR AP=0
GENR BAP=0
GENR BBP=0
GENR BCP=0
DO #=1,12
GENR AP=AP+P#*A#
GENR BAP=BAP+P#*BA#
GENR BBP=BBP+P#*BB#
GENR BCP=BCP+P#*BC#
ENDO
*GENR THE INDIRECT UTILITY FUNCTION THAT CORRESPONDS TO OUR ESTIMATED COEFS
GENR IU=0
SMPL 1 21
GENR IU=(Y-AP)/(BAP-.5*PG*VCV-.5*PG*VDV-.5*PG*VEV-.5*PG*VFV-.5*PG*VHV-.5*PG*VIV-.5*PG*VJV)
SMPL 22 32
GENR IU=(Y-AP-BAP*IU(21)+BBP*IU(21))/(BBP-.5*PG*VCV-.5*PG*VDV-.5*PG*VEV-.5*PG*VFV-.5*PG*VHV-.5*PG*VIV-.5*PG*VJV)
SMPL 33 47
GENR IU=(Y-AP-BAP*IU(21)-BBP*(IU(32)-IU(21))+BCP*IU(32))/(BCP-.5*PG*VCV-.5*PG*VDV-.5*PG*VEV-.5*PG*VFV-.5*PG*VHV-.5*PG*VIV &
-.5*PG*VJV)
SMPL 1 47
FORMAT(F8.0,8F10.5)
PRINT YEAR U IU AP BAP BBP BCP VCV Y / FORMAT
STAT U IU / PCOR
* NAME         N    MEAN        ST. DEV     VARIANCE     MINIMUM      MAXIMUM
* U            47   5.9359      1.2697      1.6120       4.0542       8.4202
* IU           47   5.9268      1.2635      1.5965       4.0611       8.3949
*  CORRELATION MATRIX OF VARIABLES -       47 OBSERVATIONS
* U          1.0000
* IU         1.0000       1.0000
*              U            IU
*U AND IU APPROXIMATE EACH OTHER VERY CLOSELY
OLS U IU / LIST

*CHECK OUR COMPUTATIONS
*GENR FITTED Y
SMPL 1 47
GENR FY=0
DO #=1,12
GENR FY=FY+P#*FQ#
ENDO
*GENR THE INDIRECT UTILITY THAT CORRESPONDS TO FY, NEWU OR NU
GENR NU=0
SMPL 1 21
GENR NU=(FY-AP)/(BAP-.5*PG*VCV-.5*PG*VDV-.5*PG*VEV-.5*PG*VFV-.5*PG*VHV-.5*PG*VIV-.5*PG*VJV)
SMPL 22 32
GENR NU=(FY-AP-BAP*NU(21)+BBP*NU(21))/(BBP-.5*PG*VCV-.5*PG*VDV-.5*PG*VEV-.5*PG*VFV-.5*PG*VHV-.5*PG*VIV-.5*PG*VJV)
SMPL 33 47
GENR NU=(FY-AP-BAP*NU(21)-BBP*(NU(32)-NU(21))+BCP*NU(32))/(BCP-.5*PG*VCV-.5*PG*VDV-.5*PG*VEV-.5*PG*VFV-.5*PG*VHV-.5*PG*VIV &
-.5*PG*VJV)
SMPL 1 47
FORMAT(F8.0,10F10.5)
PRINT YEAR IU NU U AP BAP BBP BCP VCV FY Y / FORMAT
*U IS INDEX NUMBER U; IU IS THE INDIRECT U THAT IS GENERATED BY OUR REGRESSION; NU IS THE INDIRECT U THAT
*IS GENERATED BY OUR REGRESSION BUT USES FITTED EXPENDITURES TO GENERATE THE INDIRECT UTILITY FUNCTION
*NU AND U SHOULD COINCIDE AND THEY DO
STAT IU NU U / PCOR
* NAME         N    MEAN        ST. DEV     VARIANCE     MINIMUM      MAXIMUM
* IU           47   5.9268      1.2635      1.5965       4.0611       8.3949
* NU           47   5.9359      1.2697      1.6120       4.0542       8.4202
* U            47   5.9359      1.2697      1.6120       4.0542       8.4202
*  CORRELATION MATRIX OF VARIABLES -       47 OBSERVATIONS
* IU         1.0000
* NU         1.0000       1.0000
* U          1.0000       1.0000       1.0000
*              IU           NU           U
*FINISH UP BY GENERATING ELASTICITIES
*GENR THE MATRIX OF SECOND ORDER PARTIAL DERIVATIVES OF THE COST FUNCTION WRT INPUT PRICES
DO #=1,12
DO $=1,12
GENR D#C$=(-C#(1)*C$(1)+C#(1)*G$*CV+G#*C$(1)*CV-G#*G$*VCV)*U/PG
GENR D#D$=(-D#(1)*D$(1)+D#(1)*G$*DV+G#*D$(1)*DV-G#*G$*VDV)*U/PG
GENR D#E$=(-E#(1)*E$(1)+E#(1)*G$*EV+G#*E$(1)*EV-G#*G$*VEV)*U/PG
GENR D#F$=(-F#(1)*F$(1)+F#(1)*G$*FV+G#*F$(1)*FV-G#*G$*VFV)*U/PG
GENR D#H$=(-H#(1)*H$(1)+H#(1)*G$*HV+G#*H$(1)*HV-G#*G$*VHV)*U/PG
GENR D#I$=(-I#(1)*I$(1)+I#(1)*G$*IV+G#*I$(1)*IV-G#*G$*VIV)*U/PG
GENR D#J$=(-J#(1)*J$(1)+J#(1)*G$*JV+G#*J$(1)*JV-G#*G$*VJV)*U/PG
ENDO
ENDO

*CALCULATE THE MATRIX OF ORDINARY PRICE ELASTICITIES OF INPUT DEMAND FOR EACH YEAR
DO #=1,12
DO $=1,12
GENR E#P$=(D#C$+D#D$+D#E$+D#F$+D#H$+D#I$+D#J$)*P$/FQ#
ENDO
ENDO

DO #=1,12
GENR CHECK#=E#P1+E#P2+E#P3+E#P4+E#P5+E#P6+E#P7+E#P8+E#P9+E#P10+E#P11+E#P12
ENDO
STAT CHECK1-CHECK12
*ALL CHECK# ARE 0; CHECKS ARE SATISFIED
*PRINT OUT THE OWN ELASTICITIES OF DEMAND; THEY SHOULD ALL BE NEGATIVE (OR 0)
FORMAT(F8.0,6F10.5)
PRINT YEAR E1P1 E2P2 E3P3 E4P4 E5P5 E6P6 / FORMAT
PRINT YEAR E7P7 E8P8 E9P9 E10P10 E11P11 E12P12 / FORMAT
STAT E1P1 E2P2 E3P3 E4P4 E5P5 E6P6 E7P7 E8P8 E9P9 E10P10 E11P11 E12P12
* NAME         N    MEAN        ST. DEV     VARIANCE     MINIMUM      MAXIMUM
* E1P1         47 -0.15136     0.22867E-01 0.52290E-03 -0.20050     -0.10919
* E2P2         47 -0.61090     0.16960     0.28764E-01 -0.80685     -0.35433
* E3P3         47 -0.37574     0.34258     0.11736      -1.2602     -0.52401E-01
* E4P4         47 -0.60604     0.12017     0.14441E-01 -0.84433     -0.37766
* E5P5         47 -0.33672     0.13897E-01 0.19314E-03 -0.34797     -0.29885
* E6P6         47 -0.51389     0.70816E-01 0.50149E-02 -0.71752     -0.42041
* E7P7         47 -0.23089     0.94992E-02 0.90234E-04 -0.25808     -0.21545
* E8P8         47 -0.58392     0.49035     0.24045      -2.3860     -0.23159
* E9P9         47 -0.99751     0.44427     0.19738      -2.3053     -0.57209
* E10P10       47 -0.31874     0.10191     0.10386E-01 -0.47402     -0.16344
* E11P11       47 -0.57558     0.29844E-01 0.89064E-03 -0.65426     -0.54397
* E12P12       47  -1.0857     0.25599     0.65530E-01  -1.8281     -0.78303
*FOR COMPARISON PURPOSES, HERE ARE THE AVERAGE ELASTICITIES FROM CONS8OUT.TXT 
* E1P1         47 -0.98128E-01 0.15431E-01 0.23813E-03 -0.13147     -0.72796E-01
* E2P2         47 -0.53516     0.14890     0.22172E-01 -0.71076     -0.31066
* E3P3         47 -0.38282     0.35082     0.12308      -1.2929     -0.52990E-01
* E4P4         47 -0.58922     0.11736     0.13772E-01 -0.81963     -0.36562
* E5P5         47 -0.29208     0.96304E-02 0.92744E-04 -0.30008     -0.26616
* E6P6         47 -0.53091     0.73333E-01 0.53778E-02 -0.74386     -0.43439
* E7P7         47 -0.22874     0.96779E-02 0.93662E-04 -0.25822     -0.21367
* E8P8         47 -0.51733     0.43270     0.18723      -2.1022     -0.20536
* E9P9         47 -0.99429     0.44352     0.19671      -2.3091     -0.56970
* E10P10       47 -0.30629     0.97996E-01 0.96033E-02 -0.45607     -0.15660
* E11P11       47 -0.54465     0.26787E-01 0.71753E-03 -0.61593     -0.51573
* E12P12       47  -1.0471     0.24540     0.60219E-01  -1.7576     -0.75620
*FOR COMPARISON PURPOSES, HERE ARE THE AVERAGE ELASTICITIES FROM CONS7OUT.TXT 
* E1P1         47 -0.89774E-01 0.13470E-01 0.18143E-03 -0.11911     -0.68101E-01
* E2P2         47 -0.51658     0.14367     0.20640E-01 -0.68758     -0.30234
* E3P3         47 -0.37865     0.34551     0.11938      -1.2806     -0.52966E-01
* E4P4         47 -0.43862     0.85315E-01 0.72787E-02 -0.60740     -0.27569
* E5P5         47 -0.26257     0.80995E-02 0.65602E-04 -0.27088     -0.24099
* E6P6         47 -0.43696     0.58606E-01 0.34346E-02 -0.59698     -0.35817
* E7P7         47 -0.16251     0.86895E-02 0.75508E-04 -0.19229     -0.15023
* E8P8         47 -0.50754     0.42290     0.17884      -2.0424     -0.20216
* E9P9         47 -0.81865     0.36107     0.13037      -1.8763     -0.47072
* E10P10       47 -0.29581     0.94902E-01 0.90064E-02 -0.44327     -0.15131
* E11P11       47 -0.50711     0.24504E-01 0.60046E-03 -0.57281     -0.48080
* E12P12       47  -1.0609     0.24928     0.62140E-01  -1.7883     -0.77135
*FOR COMPARISON PURPOSES, HERE ARE THE AVERAGE ELASTICITIES FROM CONS6OUT.TXT 
* E1P1         47 -0.90565E-01 0.14682E-01 0.21555E-03 -0.12169     -0.65730E-01
* E2P2         47 -0.60326     0.16776     0.28142E-01 -0.79514     -0.35165
* E3P3         47 -0.18493     0.17539     0.30762E-01 -0.68043     -0.24526E-01
* E4P4         47 -0.41055     0.80262E-01 0.64420E-02 -0.57137     -0.25818
* E5P5         47 -0.17893     0.72662E-02 0.52797E-04 -0.19079     -0.16597
* E6P6         47 -0.45018     0.66134E-01 0.43737E-02 -0.64959     -0.36398
* E7P7         47 -0.81129E-01 0.69220E-02 0.47914E-04 -0.10909     -0.73936E-01
* E8P8         47 -0.50409     0.43366     0.18806      -2.1456     -0.19906
* E9P9         47 -0.90874     0.40069     0.16055      -2.0576     -0.52177
* E10P10       47 -0.32542     0.10421     0.10859E-01 -0.48836     -0.16777
* E11P11       47 -0.26041     0.16522E-01 0.27297E-03 -0.30964     -0.24310
* E12P12       47 -0.37755     0.72804E-01 0.53004E-02 -0.59575     -0.29979
*FOR COMPARISON PURPOSES, HERE ARE THE AVERAGE ELASTICITIES FROM CONS5OUT.TXT
* E1P1         47 -0.83801E-01 0.13103E-01 0.17168E-03 -0.11155     -0.61775E-01
* E2P2         47 -0.59397     0.16551     0.27395E-01 -0.78624     -0.34490
* E3P3         47 -0.20029     0.18937     0.35861E-01 -0.73625     -0.26697E-01
* E4P4         47 -0.24109     0.45198E-01 0.20428E-02 -0.32134     -0.15306
* E5P5         47 -0.14648     0.74915E-02 0.56123E-04 -0.15704     -0.13119
* E6P6         47 -0.42029     0.59973E-01 0.35968E-02 -0.59270     -0.34037
* E7P7         47 -0.60593E-01 0.64462E-02 0.41553E-04 -0.86632E-01 -0.54974E-01
* E8P8         47 -0.23207     0.20298     0.41201E-01  -1.0567     -0.94560E-01
* E9P9         47 -0.87097     0.38292     0.14663      -1.9650     -0.49980
* E10P10       47 -0.16205     0.52690E-01 0.27762E-02 -0.24670     -0.82209E-01
* E11P11       47 -0.55199E-01 0.10869E-01 0.11813E-03 -0.88252E-01 -0.46419E-01
* E12P12       47 -0.27809     0.52728E-01 0.27802E-02 -0.43224     -0.22370

*GENR INCOME ELASTICITIES OF DEMAND
DO #=1,12
GENR EU#=0
ENDO
SMPL 1 21
DO #=1,12
GENR EU#=(BA#(1)-C#(1)*CV-D#(1)*DV-E#(1)*EV-F#(1)*FV-H#(1)*HV-I#(1)*IV-I#(1)*IV-J#(1)*JV &
+.5*G#*(VCV+VDV+VEV+VFV+VHV+VIV+VJV))*U/FQ#
ENDO
SMPL 22 32
DO #=1,12
GENR EU#=(BB#(1)-C#(1)*CV-D#(1)*DV-E#(1)*EV-F#(1)*FV-H#(1)*HV-I#(1)*IV-I#(1)*IV-J#(1)*JV &
+.5*G#*(VCV+VDV+VEV+VFV+VHV+VIV+VJV))*U/FQ#
ENDO
SMPL 33 47
DO #=1,12
GENR EU#=(BC#(1)-C#(1)*CV-D#(1)*DV-E#(1)*EV-F#(1)*FV-H#(1)*HV-I#(1)*IV-I#(1)*IV-J#(1)*JV &
+.5*G#*(VCV+VDV+VEV+VFV+VHV+VIV+VJV))*U/FQ#
ENDO
SMPL 1 47
FORMAT(F8.0,6F10.4)
PRINT YEAR EU1-EU6 / FORMAT
PRINT YEAR EU7-EU12 / FORMAT
STAT EU1-EU12
* NAME         N    MEAN       ST. DEV     VARIANCE     MINIMUM      MAXIMUM
* EU1          47  0.23733     0.16433     0.27003E-01  0.32334E-01  0.42624
* EU2          47  0.66808E-01 0.56661     0.32105     -0.77620      0.67835
* EU3          47  -1.1876     0.83776     0.70184      -2.8826     -0.39901E-01
* EU4          47  0.61545     0.51895     0.26931      0.69129E-01   1.4345
* EU5          47   1.0359     0.12123     0.14697E-01  0.80739       1.1242
* EU6          47   1.6519     0.64112     0.41103       1.1017       3.1305
* EU7          47   1.2658     0.24825     0.61628E-01  0.83766       1.5644
* EU8          47   1.7794     0.92150     0.84917      0.83650       3.6726
* EU9          47   1.5282     0.62455     0.39006      0.67896       2.6634
* EU10         47  0.20019     0.48058     0.23096     -0.41489      0.89700
* EU11         47   1.3596     0.23379     0.54659E-01   1.0400       1.7761
* EU12         47   1.1377     0.61054     0.37276     -0.56771E-01   1.6600
*FOR COMPARISON PURPOSES, HERE ARE THE CORRESPONDING AVERAGE INCOME ELASTICITIES FROM CONS8OUT.TXT
* EU1          47  0.18849     0.16678     0.27816E-01 -0.20737E-01  0.37386
* EU2          47 -0.43973E-01 0.56695     0.32144     -0.89851      0.57921
* EU3          47  -1.1914     0.84187     0.70874      -2.8824     -0.33335E-01
* EU4          47  0.66318     0.51991     0.27031      0.12176       1.4968
* EU5          47   1.0529     0.11653     0.13580E-01  0.83450       1.1381
* EU6          47   1.5976     0.64363     0.41426       1.0405       3.0676
* EU7          47   1.2747     0.25402     0.64526E-01  0.84129       1.5956
* EU8          47   1.9926     0.93545     0.87508      0.98434       3.8337
* EU9          47   1.5001     0.63536     0.40369      0.65039       2.6212
* EU10         47  0.15054     0.47540     0.22601     -0.47326      0.83929
* EU11         47   1.3691     0.21698     0.47078E-01   1.0810       1.7310
* EU12         47   1.0977     0.64121     0.41115     -0.16287       1.6540
*FOR COMPARISON PURPOSES, HERE ARE THE CORRESPONDING AVERAGE INCOME ELASTICITIES FROM CONS7OUT.TXT
* EU1          47  0.19949     0.16500     0.27225E-01 -0.71442E-02  0.37910
* EU2          47 -0.99715E-02 0.53234     0.28339     -0.82904      0.61667
* EU3          47  -1.1860     0.83653     0.69979      -2.9075     -0.48837E-01
* EU4          47  0.64132     0.50770     0.25776      0.14506       1.4526
* EU5          47   1.0397     0.10824     0.11716E-01  0.83612       1.1138
* EU6          47   1.6073     0.59729     0.35675       1.0645       2.9989
* EU7          47   1.2923     0.26972     0.72748E-01  0.82775       1.6261
* EU8          47   1.9510     0.91560     0.83832      0.97608       3.7765
* EU9          47   1.5456     0.64095     0.41082      0.68945       2.6793
* EU10         47  0.96241E-01 0.50216     0.25216     -0.63300      0.81831
* EU11         47   1.3525     0.21549     0.46437E-01   1.0656       1.7068
* EU12         47   1.1336     0.63104     0.39822     -0.97858E-01   1.7137
*FOR COMPARISON PURPOSES, HERE ARE THE CORRESPONDING AVERAGE INCOME ELASTICITIES FROM CONS6OUT.TXT
* EU1          47  0.16388     0.20220     0.40884E-01 -0.80754E-01  0.39580
* EU2          47  0.27876E-01 0.49272     0.24277     -0.71615      0.52396
* EU3          47  -1.7288     0.50653     0.25658      -3.0464      -1.1162
* EU4          47  0.71613     0.45960     0.21123      0.25902       1.4589
* EU5          47   1.0510     0.13660     0.18660E-01  0.83363       1.2434
* EU6          47   1.9074     0.61092     0.37323       1.2022       3.3269
* EU7          47   1.2503     0.28484     0.81135E-01  0.82039       1.6347
* EU8          47   2.1558     0.91137     0.83059       1.1589       3.9678
* EU9          47   1.5051     0.61743     0.38122      0.68839       2.6246
* EU10         47  0.12161     0.42491     0.18055     -0.53013      0.74104
* EU11         47   1.3356     0.34055     0.11597      0.88264       1.8377
* EU12         47   1.2236     0.82029     0.67288      0.93837E-01   2.8764
*FOR COMPARISON PURPOSES, HERE ARE THE CORRESPONDING AVERAGE INCOME ELASTICITIES FROM CONS5OUT.TXT
* EU1          47  0.17066     0.20665     0.42704E-01 -0.77764E-01  0.40550
* EU2          47  0.30771E-01 0.39413     0.15534     -0.61279      0.42904
* EU3          47  -1.7096     0.51507     0.26530      -3.0466      -1.0943
* EU4          47  0.72651     0.49448     0.24451      0.28145       1.5490
* EU5          47   1.0525     0.14205     0.20177E-01  0.84604       1.2670
* EU6          47   1.8556     0.60114     0.36136       1.2021       3.2766
* EU7          47   1.2368     0.26330     0.69326E-01  0.82918       1.5847
* EU8          47   2.2433      1.0097      1.0195       1.0895       4.9945
* EU9          47   1.5086     0.61438     0.37747      0.71800       2.6639
* EU10         47  0.76244E-01 0.63929     0.40869     -0.89973      0.91072
* EU11         47   1.3414     0.39242     0.15400      0.83422       1.9371
* EU12         47   1.2285     0.79899     0.63838      0.40831E-01   2.7463
*FOR COMPARISON PURPOSES, HERE ARE THE INCOME ELASTICITIES FROM CONS4OUT.TXT
* EU1          47  0.24904     0.13444     0.18074E-01  0.82173E-01  0.42213
* EU2          47 -0.53587     0.93333     0.87110      -1.8515      0.65399
* EU3          47  -1.4671     0.52568     0.27634      -2.7157     -0.79064
* EU4          47  0.58475     0.65724     0.43197     -0.15582E-01   1.6705
* EU5          47   1.0949     0.12322     0.15183E-01  0.88870       1.2602
* EU6          47   1.2090     0.69211     0.47902      0.44069       2.5442
* EU7          47   1.2451     0.27182     0.73886E-01  0.83675       1.6111
* EU8          47   2.2807      1.0488      1.0999       1.0817       5.2617
* EU9          47   1.8789     0.90549     0.81991      0.60989       3.5855
* EU10         47  0.49530     0.22066     0.48690E-01  0.71914E-01  0.80830
* EU11         47   1.2766     0.32928     0.10843      0.84138       1.7600
* EU12         47   1.1282     0.86289     0.74457     -0.77817E-01   2.7834

*1 IS THE SERIES       Food and non-alcoholic beverages
*2 IS THE SERIES       Alcoholic beverages
*3 IS THE SERIES       Tobacco
*4 IS THE SERIES       Clothing and footwear
*5 IS THE SERIES       Housing including electricity,gas and household furnishings
*6 IS THE SERIES       Health
*7 IS THE SERIES       Transportation aggregate, owned and purchased
*8 IS THE SERIES       Communications
*9 IS THE SERIES       Recreation and culture
*10 IS THE SERIES      Education
*11 IS THE SERIES      Services aggregate including Restaurants and hotels and Miscellaneous goods and services
*12 IS THE SERIES      Final consumption expenditure of resident households abroad
STOP















