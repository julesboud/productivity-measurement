*THIS IS THE FILE E59418C\CON3.TXT THAT ESTIMATES NONHOMOTHETIC LEONTIEF PREFERENCES           JUNE 24, 2018
*WE DO NOT IMPOSE MONEY METRIC UTILITY SCALING IN THIS MODEL; WE SPLINE UTILITY IN THIS MODEL (2 BREAK POINTS)
*WE ESTIMATE A NORMALIZED QUADRATIC RANK 1 SUBSTITUTION MATRIX IN THIS MODEL
PAR 10000                   
SIZE 5000
SET NODOECHO
*READ IN CANADIAN DATA FOR 1971-2017 FOR 17 CLASSES OF PER POP CONSUMPTION FROM E59418C\CDATOUT.TXT
SMPL 1 47
FORMAT(F8.0,9F10.5)
READ YEAR P1-P9 
   1971.   1.00000   1.00000   1.00000   1.00000   1.00000   1.00000   1.00000   1.00000   1.00000
   1972.   1.08367   1.03200   1.02561   1.01898   1.07822   1.03870   1.02957   1.02639   1.02457
   1973.   1.24875   1.06126   1.06350   1.07008   1.17431   1.14647   1.08460   1.06944   1.04357
   1974.   1.44697   1.12307   1.11885   1.16402   1.30371   1.30908   1.22491   1.15152   1.11592
   1975.   1.62362   1.25711   1.24250   1.21629   1.49304   1.50812   1.35793   1.29731   1.19110
   1976.   1.65641   1.32768   1.35826   1.28543   1.73712   1.78426   1.45087   1.42966   1.25338
   1977.   1.80536   1.40342   1.46677   1.35900   2.01596   2.07523   1.53863   1.51075   1.32982
   1978.   2.02570   1.47683   1.62929   1.40916   2.28657   2.29846   1.62124   1.61831   1.44531
   1979.   2.25946   1.58466   1.71521   1.53319   2.52202   2.53317   1.77730   1.77131   1.61348
   1980.   2.47495   1.78020   1.88273   1.67598   2.80156   2.89921   1.95259   1.94561   1.79278
   1981.   2.74773   2.00590   2.13922   1.79780   3.17561   3.52648   2.16029   2.16922   1.98924
   1982.   2.92112   2.33704   2.47129   1.91375   3.50360   4.13371   2.34207   2.42824   2.08358
   1983.   3.01555   2.58107   2.91981   1.99718   3.81959   4.55508   2.45605   2.62952   2.16834
   1984.   3.18459   2.73944   3.25590   2.04982   4.02364   4.82139   2.52429   2.77800   2.25952
   1985.   3.25732   2.88563   3.83419   2.11360   4.20954   5.04604   2.58258   2.91740   2.36463
   1986.   3.41629   3.14864   4.48468   2.16870   4.43039   4.97178   2.67171   3.08136   2.55742
   1987.   3.56652   3.31114   4.87073   2.26595   4.60504   5.00148   2.76172   3.26724   2.61211
   1988.   3.63794   3.54348   5.26039   2.38730   4.80483   5.12688   2.86600   3.45958   2.73176
   1989.   3.74513   3.69829   6.19530   2.48359   5.08695   5.19203   2.98193   3.63685   2.89218
   1990.   3.88772   3.89583   6.90606   2.56201   5.27447   5.55249   3.03069   3.82053   2.92071
   1991.   3.97799   4.09429   8.73173   2.80354   5.45543   6.23842   3.16690   4.01683   2.85689
   1992.   3.92790   4.29476   9.38165   2.82668   5.60251   6.51196   3.16567   4.15818   2.98904
   1993.   4.00692   4.36186   9.19477   2.85621   5.68059   6.76451   3.16950   4.26942   3.11169
   1994.   4.01740   4.35860   6.61399   2.87534   5.82016   6.93474   3.16010   4.30203   3.31190
   1995.   4.09965   4.41014   6.37944   2.84516   5.92031   6.81316   3.18510   4.31338   3.49355
   1996.   4.14467   4.51224   6.52024   2.82955   5.98983   6.89099   3.22087   4.36538   3.64062
   1997.   4.20144   4.60758   6.94707   2.86933   6.03388   7.12804   3.25899   4.41332   3.72526
   1998.   4.26271   4.69342   7.28562   2.89707   6.09968   7.17494   3.29948   4.50907   3.75119
   1999.   4.30901   4.78300   7.49365   2.94015   6.16384   7.37573   3.38122   4.59949   3.83483
   2000.   4.37563   4.85310   7.86860   2.93467   6.23861   8.03415   3.41849   4.70314   3.80668
   2001.   4.56581   4.96486   8.84200   2.94353   6.31834   8.75103   3.45896   4.82936   3.84827
   2002.   4.68685   5.07595  11.31961   2.92317   6.41666   8.51765   3.51307   4.92424   3.88914
   2003.   4.76499   5.16621  13.05160   2.86222   6.48284   9.20775   3.53567   5.01043   3.89388
   2004.   4.84635   5.29184  13.63745   2.84953   6.54419   9.53583   3.53510   5.09444   3.89431
   2005.   4.96413   5.37897  13.71858   2.82663   6.59880  10.23485   3.54065   5.22212   3.92004
   2006.   5.07845   5.42120  13.75233   2.76974   6.72325  10.73124   3.54533   5.34642   3.92016
   2007.   5.20333   5.52612  14.19918   2.74650   6.91244  10.68764   3.55326   5.45219   3.90609
   2008.   5.38327   5.57747  14.34587   2.66512   7.07357  11.49330   3.53650   5.55140   3.62517
   2009.   5.65436   5.66565  14.78655   2.62129   7.18448  10.40432   3.59696   5.69702   3.47127
   2010.   5.71655   5.65140  15.44631   2.53557   7.27069  10.87099   3.56958   5.82357   3.64552
   2011.   5.91203   5.65004  16.15644   2.51717   7.36047  11.23829   3.57271   5.91926   3.70478
   2012.   6.04766   5.71361  16.50278   2.50248   7.47123  11.40728   3.58287   5.94968   3.78689
   2013.   6.13847   5.80596  16.92565   2.49636   7.60035  11.75307   3.59349   5.98655   3.83652
   2014.   6.28035   5.86771  18.26691   2.53143   7.71884  12.49235   3.60851   6.05630   3.90150
   2015.   6.46341   5.99083  19.15868   2.56836   7.81618  12.40459   3.68431   6.14859   3.99180
   2016.   6.54497   6.08754  20.15318   2.56291   7.88195  12.48248   3.76905   6.24510   4.10012
   2017.   6.52636   6.17881  21.12821   2.54356   7.94578  12.31590   3.78605   6.38352   4.20485
PRINT YEAR P1-P9 / FORMAT
READ YEAR P10-P17 
   1971.   1.00000   1.00000   1.00000   1.00000   1.00000   1.00000   1.00000   1.00000
   1972.   1.01944   1.04784   1.04083   1.03099   1.01495   1.06077   1.03806   1.01236
   1973.   1.07458   1.07129   1.06741   1.06873   1.02727   1.17832   1.09033   1.07219
   1974.   1.24401   1.18673   1.07886   1.14956   1.04547   1.36187   1.20492   1.15328
   1975.   1.42223   1.35458   1.10953   1.26146   1.05007   1.56035   1.34045   1.30496
   1976.   1.55496   1.51868   1.19659   1.33917   1.06633   1.68271   1.47714   1.34171
   1977.   1.66866   1.63730   1.27727   1.40148   1.11480   1.80188   1.55514   1.53278
   1978.   1.75147   1.71944   1.33612   1.45475   1.19761   1.93070   1.68916   1.76411
   1979.   1.91866   1.84797   1.39033   1.54962   1.22663   2.15011   1.74868   2.02481
   1980.   2.21259   2.17830   1.43630   1.66726   1.28844   2.36167   1.90867   2.27996
   1981.   2.74869   2.50365   1.53822   1.80020   1.39724   2.61634   2.10381   2.56481
   1982.   3.21074   2.99415   1.77976   1.95238   1.52679   2.91731   2.25862   2.79940
   1983.   3.37501   3.19594   1.89436   2.06078   1.69061   3.10693   2.49497   2.94361
   1984.   3.48869   3.33661   1.93846   2.12495   1.79876   3.24904   2.55692   3.22635
   1985.   3.62263   3.46000   1.96794   2.17804   1.90147   3.39765   2.62689   3.55904
   1986.   3.43213   3.60678   1.97448   2.26472   1.98110   3.59569   2.75999   3.76002
   1987.   3.57193   3.81505   1.92228   2.35863   2.07822   3.75975   2.86982   3.79983
   1988.   3.62483   3.82126   1.93113   2.47363   2.19512   3.95268   3.01430   3.64702
   1989.   3.85639   3.98107   1.86510   2.57179   2.31084   4.15693   3.08137   3.66621
   1990.   4.22071   4.32269   1.84823   2.64506   2.55077   4.35464   3.22443   3.84310
   1991.   4.27465   4.78940   1.87219   2.73649   2.95191   4.78449   3.39099   3.92031
   1992.   4.16470   4.85400   1.89628   2.72343   3.34321   4.86654   3.42358   4.17969
   1993.   4.11934   5.09500   1.90980   2.75553   3.63618   4.92651   3.53521   4.61720
   1994.   4.10203   5.21092   1.91096   2.80174   3.96492   5.00204   3.57610   4.98473
   1995.   4.22234   5.34244   1.91681   2.82851   4.17019   5.12180   3.60151   5.12616
   1996.   4.33954   5.49040   2.00886   2.84894   4.36238   5.19915   3.70000   5.23062
   1997.   4.39568   5.49690   2.08545   2.87079   4.50185   5.28061   3.80683   5.41649
   1998.   4.22887   5.68116   2.13692   2.87161   4.70893   5.39316   3.85963   5.85630
   1999.   4.44074   5.89776   2.06201   2.88707   4.90030   5.50981   3.93097   6.02572
   2000.   4.96310   6.13729   2.06484   2.90911   5.07084   5.65308   4.03575   6.27567
   2001.   4.97087   6.15327   2.09486   2.93559   5.23533   5.81421   4.05699   6.63566
   2002.   5.02347   6.42668   2.11938   2.97125   5.40176   5.98753   4.13765   6.79797
   2003.   5.27647   6.43719   2.12452   2.99295   5.63841   6.11400   4.22518   6.39821
   2004.   5.61200   6.48661   2.13897   2.98724   5.93586   6.27804   4.29791   6.29032
   2005.   6.11249   6.62697   2.15308   2.97970   6.07060   6.45717   4.37414   6.07553
   2006.   6.36818   6.87800   2.16248   2.95366   6.15599   6.62837   4.44154   5.90311
   2007.   6.64963   6.93358   2.19597   2.92813   6.28925   6.80767   4.51112   5.88462
   2008.   7.21643   7.16008   2.22378   2.90659   6.48908   6.97389   4.55795   6.11815
   2009.   6.57957   6.97419   2.24709   2.92695   6.76243   7.16117   4.55282   6.29008
   2010.   6.97974   7.21561   2.31570   2.93965   7.02665   7.32971   4.64851   5.80013
   2011.   7.78487   7.41978   2.35195   2.95603   7.27535   7.51426   4.71224   5.84844
   2012.   7.98971   7.62644   2.39102   2.94626   7.54750   7.68764   4.74665   5.89833
   2013.   8.05444   7.84064   2.43142   2.94229   7.82216   7.82652   4.81182   6.16450
   2014.   8.11335   7.92548   2.54579   2.96496   8.04964   7.97476   4.87782   6.58791
   2015.   7.38262   7.88791   2.63688   3.01179   8.28584   8.19935   4.89398   7.08698
   2016.   7.20995   7.82121   2.64686   3.05772   8.52541   8.41300   4.88360   7.23476
   2017.   7.70439   7.86242   2.63424   3.08522   8.74146   8.62863   4.88812   7.25027
PRINT YEAR P10-P17 / FORMAT
READ YEAR Q1-Q9 
   1971.   0.59784   0.12549   0.10685   0.34715   0.67918   0.13284   0.27334   0.09680   0.22975
   1972.   0.59729   0.13295   0.10831   0.36946   0.66891   0.13942   0.29933   0.10139   0.25902
   1973.   0.59891   0.14042   0.10939   0.37676   0.65633   0.13471   0.33573   0.10814   0.29454
   1974.   0.59831   0.14632   0.10942   0.38982   0.64502   0.14080   0.35975   0.10888   0.29035
   1975.   0.59085   0.14984   0.10848   0.40683   0.63625   0.13525   0.36124   0.11206   0.31672
   1976.   0.58908   0.14773   0.10539   0.42839   0.63131   0.13605   0.36790   0.11555   0.32122
   1977.   0.58305   0.14881   0.10501   0.43508   0.62642   0.13266   0.36162   0.12131   0.32333
   1978.   0.57833   0.15215   0.10066   0.44678   0.62281   0.13332   0.36715   0.12645   0.32262
   1979.   0.57359   0.15041   0.10345   0.45742   0.62122   0.13198   0.38082   0.12544   0.32641
   1980.   0.56776   0.15095   0.10254   0.44946   0.62004   0.13131   0.38474   0.12967   0.29671
   1981.   0.56335   0.14928   0.10319   0.45420   0.61935   0.12241   0.37484   0.12281   0.28341
   1982.   0.56081   0.14104   0.10167   0.42677   0.62718   0.12128   0.33618   0.12460   0.23407
   1983.   0.55952   0.13702   0.09646   0.43451   0.63404   0.11473   0.34950   0.12507   0.28079
   1984.   0.56246   0.13410   0.09101   0.45416   0.64373   0.11457   0.36695   0.12971   0.33029
   1985.   0.56881   0.13422   0.08732   0.47297   0.65501   0.11789   0.38299   0.13593   0.39132
   1986.   0.56657   0.13289   0.08026   0.49376   0.66898   0.11743   0.40505   0.14053   0.39380
   1987.   0.56831   0.13172   0.07579   0.49679   0.69134   0.11421   0.41744   0.14123   0.41647
   1988.   0.57014   0.12769   0.07494   0.48790   0.71735   0.12275   0.43195   0.13680   0.43905
   1989.   0.57115   0.12617   0.07184   0.48153   0.73834   0.12738   0.43273   0.13930   0.41750
   1990.   0.57286   0.11967   0.06707   0.46961   0.76168   0.12415   0.42545   0.14224   0.39263
   1991.   0.57360   0.11154   0.06304   0.42469   0.77975   0.12148   0.39241   0.14333   0.38341
   1992.   0.57528   0.10756   0.05896   0.41751   0.79567   0.12018   0.39170   0.14367   0.37487
   1993.   0.57923   0.10639   0.05454   0.42302   0.81193   0.12308   0.39868   0.14867   0.36474
   1994.   0.58128   0.11005   0.05977   0.43034   0.82678   0.12094   0.41451   0.14825   0.36921
   1995.   0.58319   0.11067   0.06137   0.44336   0.83695   0.11839   0.41275   0.15997   0.35735
   1996.   0.58621   0.10235   0.06109   0.44029   0.84486   0.12217   0.41124   0.16245   0.37604
   1997.   0.59039   0.10600   0.06080   0.44415   0.85626   0.11715   0.42878   0.17620   0.44434
   1998.   0.59730   0.10905   0.06144   0.45256   0.86877   0.10942   0.44463   0.18568   0.44906
   1999.   0.60478   0.11235   0.05898   0.46034   0.88025   0.11194   0.45528   0.19170   0.48074
   2000.   0.61648   0.11468   0.05642   0.47815   0.89269   0.11466   0.47284   0.19977   0.50274
   2001.   0.61606   0.11709   0.05398   0.48884   0.90442   0.10844   0.48775   0.20884   0.50402
   2002.   0.61721   0.12091   0.05050   0.49999   0.92279   0.11015   0.50846   0.21974   0.55644
   2003.   0.62304   0.12387   0.04717   0.51303   0.94412   0.11213   0.52469   0.22554   0.56057
   2004.   0.62774   0.12392   0.04538   0.52263   0.96752   0.11055   0.54706   0.23585   0.54720
   2005.   0.62521   0.12571   0.04278   0.53718   0.99063   0.10940   0.56470   0.24471   0.55845
   2006.   0.62897   0.12989   0.04070   0.56923   1.01527   0.10351   0.59756   0.25686   0.57213
   2007.   0.63203   0.13321   0.03878   0.59191   1.03906   0.10724   0.62206   0.26912   0.59582
   2008.   0.63616   0.13628   0.03769   0.60671   1.06413   0.10552   0.63688   0.27737   0.62044
   2009.   0.63452   0.13555   0.03678   0.59979   1.08541   0.10368   0.61161   0.28129   0.59838
   2010.   0.63604   0.13622   0.03814   0.64100   1.10906   0.10022   0.62363   0.28662   0.61974
   2011.   0.62997   0.13830   0.03708   0.66050   1.13439   0.10204   0.62255   0.29066   0.61217
   2012.   0.62929   0.14094   0.03682   0.67567   1.16078   0.09888   0.62255   0.29503   0.64026
   2013.   0.63735   0.14085   0.03623   0.69897   1.19397   0.10086   0.63416   0.30321   0.67633
   2014.   0.64622   0.14332   0.03484   0.71646   1.22384   0.10152   0.65394   0.30893   0.71078
   2015.   0.64699   0.14590   0.03347   0.73989   1.25309   0.09918   0.65748   0.31440   0.73524
   2016.   0.65291   0.14766   0.03207   0.75041   1.27517   0.09580   0.66557   0.32100   0.76372
   2017.   0.66201   0.15017   0.03123   0.76419   1.29285   0.09593   0.68326   0.32489   0.79792
PRINT YEAR Q1-Q9 / FORMAT
READ YEAR Q10-Q17 
   1971.   0.21331   0.07312   0.06491   0.27130   0.03773   0.29238   0.40925   0.10301
   1972.   0.22602   0.07670   0.06776   0.30279   0.03747   0.30501   0.43034   0.10105
   1973.   0.24491   0.08104   0.07259   0.33730   0.03990   0.31726   0.45152   0.10927
   1974.   0.24858   0.08560   0.07881   0.37285   0.04221   0.32055   0.46268   0.11331
   1975.   0.24956   0.08765   0.08490   0.38557   0.04565   0.31820   0.46322   0.12445
   1976.   0.25591   0.08815   0.09405   0.41873   0.04768   0.33453   0.48433   0.14424
   1977.   0.26020   0.09027   0.09520   0.42664   0.05035   0.33656   0.51032   0.14473
   1978.   0.27126   0.09605   0.10169   0.44774   0.04906   0.34530   0.52477   0.13603
   1979.   0.27400   0.10265   0.10977   0.46516   0.05055   0.34064   0.54419   0.11022
   1980.   0.27941   0.10267   0.11824   0.47164   0.05301   0.34129   0.55063   0.11030
   1981.   0.27343   0.10170   0.12505   0.48599   0.05354   0.33918   0.55040   0.10276
   1982.   0.25379   0.08580   0.12230   0.46784   0.05572   0.31352   0.54353   0.09731
   1983.   0.25270   0.08185   0.12254   0.48307   0.05617   0.30683   0.55282   0.11106
   1984.   0.26011   0.08679   0.12808   0.52025   0.05783   0.31038   0.57108   0.10778
   1985.   0.27069   0.09161   0.13536   0.54709   0.05887   0.31994   0.60966   0.10477
   1986.   0.28227   0.09311   0.14523   0.58326   0.05967   0.32818   0.65325   0.10258
   1987.   0.29640   0.09281   0.15336   0.60592   0.05875   0.33165   0.68781   0.11785
   1988.   0.30829   0.09965   0.16848   0.64329   0.05983   0.34461   0.69124   0.13396
   1989.   0.30675   0.10421   0.18270   0.65169   0.06070   0.35932   0.70931   0.15661
   1990.   0.29929   0.09772   0.19388   0.64625   0.05994   0.34918   0.71306   0.18696
   1991.   0.28866   0.08558   0.19542   0.62903   0.05836   0.31390   0.71957   0.18989
   1992.   0.29388   0.08452   0.20048   0.65107   0.05715   0.31716   0.73593   0.18240
   1993.   0.30543   0.08089   0.20326   0.66381   0.05796   0.32127   0.76035   0.16445
   1994.   0.31698   0.08433   0.20689   0.70584   0.05677   0.33147   0.79705   0.13915
   1995.   0.31672   0.08751   0.22175   0.73230   0.05719   0.33176   0.81504   0.13782
   1996.   0.31978   0.09136   0.22956   0.75589   0.05885   0.33477   0.84845   0.14364
   1997.   0.31996   0.09733   0.23699   0.80340   0.06140   0.34329   0.88006   0.14309
   1998.   0.33080   0.09821   0.24982   0.85891   0.06253   0.35385   0.90743   0.12767
   1999.   0.34316   0.09446   0.26654   0.90709   0.06324   0.36347   0.93261   0.13012
   2000.   0.34435   0.09525   0.29231   0.95864   0.06390   0.37385   0.95248   0.13744
   2001.   0.34472   0.09128   0.30728   0.98528   0.06459   0.37387   0.96580   0.13426
   2002.   0.34948   0.08603   0.33169   1.01144   0.06709   0.37243   0.99878   0.12768
   2003.   0.35045   0.08371   0.34125   1.02143   0.06935   0.36259   1.00342   0.13732
   2004.   0.35394   0.08891   0.35656   1.04839   0.06944   0.36658   1.04100   0.15508
   2005.   0.35563   0.09232   0.37594   1.08399   0.07129   0.36815   1.07701   0.17408
   2006.   0.35845   0.09474   0.39377   1.13210   0.07305   0.37092   1.11349   0.19139
   2007.   0.36568   0.09852   0.40161   1.18471   0.07429   0.37271   1.16248   0.21445
   2008.   0.36299   0.10108   0.40850   1.21123   0.07587   0.37215   1.16236   0.22140
   2009.   0.35774   0.09778   0.42846   1.19209   0.07679   0.35545   1.13041   0.21007
   2010.   0.36493   0.10274   0.42721   1.20628   0.07916   0.35715   1.16827   0.25047
   2011.   0.37024   0.10738   0.44083   1.21054   0.08129   0.35901   1.19378   0.26180
   2012.   0.36789   0.10949   0.44483   1.22346   0.08348   0.36366   1.19436   0.27300
   2013.   0.38040   0.11024   0.45799   1.23138   0.08607   0.37041   1.22612   0.26861
   2014.   0.38916   0.11426   0.45698   1.24205   0.08805   0.38082   1.26993   0.25803
   2015.   0.39433   0.11788   0.45781   1.24064   0.08971   0.38447   1.30933   0.24206
   2016.   0.39851   0.12303   0.46638   1.23335   0.09088   0.39109   1.34245   0.23229
   2017.   0.40153   0.12880   0.47202   1.24861   0.09190   0.39538   1.37485   0.24610
PRINT YEAR Q10-Q17 / FORMAT
*1 IS THE SERIES       P31CP010: Food and non-alcoholic beverages
*2 IS THE SERIES       P31CP021: Alcoholic beverages
*3 IS THE SERIES       P31CP022: Tobacco
*4 IS THE SERIES       P31CP030: Clothing and footwear
*5 IS THE SERIES       P31CP041+P31CP042+P31CP043+P31CP044: HOUSING AGGREGATE
*6 IS THE SERIES       P31CP045: Electricity, gas and other fuels
*7 IS THE SERIES       P31CP050: Furnishings, households equipment and routine maintenance of the house
*8 IS THE SERIES       P31CP060: Health
*9 IS THE SERIES       P31CP071: Purchase of vehicles
*10 IS THE SERIES      P31CP072: Operation of personal transport equipment
*11 IS THE SERIES      P31CP073: Transport services
*12 IS THE SERIES      P31CP080: Communications
*13 IS THE SERIES      P31CP090: Recreation and culture
*14 IS THE SERIES      P31CP100: Education
*15 IS THE SERIES      P31CP110: Restaurants and hotels
*16 IS THE SERIES      P31CP120: Miscellaneous goods and services
*17 IS THE SERIES      P33:      Final consumption expenditure of resident households abroad
DO #=1,17
GENR V#=P#*Q#
ENDO
*GENR TOTAL EXPENDITURE Y FOR EACH PERIOD
GENR Y=0
DO #=1,17
GENR Y=Y+V#
ENDO
*GENR CHAINED FISHER PRICE AND QUANTITY INDEXES
INDEX P1 Q1 P2 Q2 P3 Q3 P4 Q4 P5 Q5 P6 Q6 P7 Q7 P8 Q8 P9 Q9 P10 Q10 &
P11 Q11 P12 Q12 P13 Q13 P14 Q14 P15 Q15 P16 Q16 P17 Q17 / CHAIN FISHER=PF QFISHER=QF
*GENR EXPENDITURE Y ON THE 17 COMMODITIES
GENR Y=PF*QF
*GENR THE NORMALIZED QUADRATIC FIXED BASE AND CHAINED INDEXES
*WE FIRST NEED TO GENR FIXED WEIGHTS SUMMING TO 1,G1 TO G17. WE INITIALLY DEFINE THESE G# AS SAMPLE MEANS
DO #=1,17
STAT Q# / MEAN=GG#
ENDO
*SUM THE GG#
SMPL 1 1
GENR SUM=0
DO #=1,17
GENR SUM=SUM+GG#
ENDO
*DEFINE THE NORMALIZED GG#
DO #=1,17
GENR GG#=GG#/SUM
ENDO
FORMAT(9F10.5)
PRINT GG1-GG9 / FORMAT
PRINT GG10-GG17 / FORMAT
SMPL 1 47
GENR ONE=1
DO #=1,17
GENR G#=GG#(1)*ONE
ENDO
*GENR THE LOWE PRICE INDEX PG
GENR PG=0
DO #=1,17
GENR PG=PG+P#*G#
ENDO
*GENR PG NORMALIZED PRICES:
DO #=1,17
GENR PN#=P#/PG
ENDO
FORMAT(9F10.5)
PRINT PG PN1-PN8 / FORMAT
PRINT PN9-PN17 / FORMAT
STAT PG PN1-PN17

*THE EXACT INDEX NUMBER FORMULA FOR NORMALIZED QUADRATIC PREFERENCES USING A FIXED BASE IS
*u(t)/u(1)=SUM(PN#(t)+PN#(1))Q#(t)/(SUM(PN#(t)+PN#(1))Q#(1))
GENR NUM=0
GENR DEN=0
DO #=1,17
GENR NUM=NUM+(PN#+PN#(1))*Q#
GENR DEN=DEN+(PN#+PN#(1))*Q#(1)
ENDO
GENR QNFB=NUM/DEN
*NORMALIZE QNFB TO EQUAL Y IN OBSERVATION 1
GENR CON=QNFB(1)
GENR QNFB=QNFB*Y(1)/CON
GENR PNFB=Y/QNFB
*NOW CONSTRUCT THE NORMALIZED QUADRATIC CHAIN LINKS
GENR QNCH=1
GENR QNCHL=1
GENR NUML=0
GENR DENL=0
SMPL 2 47
DO #=1,17
GENR NUML=NUML+(PN#+LAG(PN#))*Q#
GENR DENL=DENL+(PN#+LAG(PN#))*LAG(Q#)
ENDO
*NOW CONSTRUCT THE NORMALIZED QUADRATIC EXACT INDEX NUMBER FORMULA USING THE CHAIN PRINCIPLE
GENR QNCHL=NUML/DENL
GENR QNCH=LAG(QNCH)*QNCHL
*NORMALIZE QNCH TO EQUAL Y AT OBSERVATION 1
SMPL 1 47
GENR CON=QNCH(1)
GENR QNCH=QNCH*Y(1)/CON
GENR PNCH=Y/QNCH
FORMAT(F8.0,7F10.5)
PRINT YEAR QF QNCH QNFB PF PNCH PNFB Y / FORMAT
*   YEAR      QF        QNCH      QNFB      PF        PNCH      PNFB       Y
*   1971.   4.05425   4.05425   4.05425   1.00000   1.00000   1.00000   4.05425
*   1972.   4.22168   4.22168   4.22168   1.04692   1.04693   1.04693   4.41978
*   1973.   4.40094   4.40093   4.40023   1.12271   1.12271   1.12289   4.94099
*   1974.   4.49981   4.49979   4.49914   1.24779   1.24780   1.24798   5.61484
*   1975.   4.55181   4.55179   4.55235   1.38986   1.38986   1.38969   6.32638
*   1976.   4.67529   4.67527   4.67456   1.50461   1.50462   1.50485   7.03450
*   1977.   4.71007   4.71005   4.70174   1.63353   1.63354   1.63643   7.69407
*   1978.   4.77226   4.77224   4.75637   1.77396   1.77397   1.77988   8.46579
*   1979.   4.80388   4.80385   4.78917   1.93550   1.93551   1.94144   9.29789
*   1980.   4.79527   4.79524   4.77837   2.13717   2.13718   2.14472  10.24828
*   1981.   4.75087   4.75084   4.73315   2.39541   2.39542   2.40437  11.38025
*   1982.   4.56029   4.56026   4.53428   2.63464   2.63465   2.64975  12.01470
*   1983.   4.62409   4.62406   4.60629   2.81729   2.81730   2.82817  13.02738
*   1984.   4.76547   4.76544   4.75418   2.94462   2.94464   2.95161  14.03248
*   1985.   4.95153   4.95150   4.94644   3.06302   3.06304   3.06617  15.16665
*   1986.   5.08745   5.08742   5.08891   3.19491   3.19492   3.19399  16.25394
*   1987.   5.22564   5.22561   5.22846   3.31871   3.31872   3.31692  17.34236
*   1988.   5.38242   5.38239   5.38546   3.44692   3.44694   3.44498  18.55280
*   1989.   5.46844   5.46840   5.45790   3.59823   3.59825   3.60517  19.67669
*   1990.   5.46060   5.46056   5.43831   3.75244   3.75246   3.76782  20.49056
*   1991.   5.33023   5.33019   5.28203   3.93880   3.93882   3.97473  20.99467
*   1992.   5.35809   5.35806   5.30710   4.00461   4.00464   4.04309  21.45707
*   1993.   5.40937   5.40933   5.36678   4.08574   4.08576   4.11816  22.10126
*   1994.   5.52229   5.52226   5.51608   4.13025   4.13027   4.13490  22.80843
*   1995.   5.59067   5.59064   5.59436   4.19043   4.19046   4.18767  23.42733
*   1996.   5.68565   5.68561   5.69524   4.26206   4.26209   4.25488  24.23256
*   1997.   5.87212   5.87208   5.89312   4.33475   4.33478   4.31930  25.45416
*   1998.   5.99189   5.99185   6.02387   4.38923   4.38925   4.36593  26.29976
*   1999.   6.14959   6.14955   6.19079   4.46647   4.46650   4.43674  27.46696
*   2000.   6.32052   6.32048   6.36837   4.57101   4.57104   4.53666  28.89117
*   2001.   6.37799   6.37795   6.41665   4.66313   4.66316   4.63503  29.74139
*   2002.   6.52602   6.52598   6.55559   4.75652   4.75655   4.73507  31.04114
*   2003.   6.60385   6.60381   6.61307   4.83203   4.83206   4.82530  31.90999
*   2004.   6.74913   6.74909   6.75118   4.90124   4.90126   4.89975  33.07907
*   2005.   6.90496   6.90492   6.90826   4.98363   4.98366   4.98125  34.41180
*   2006.   7.09387   7.09383   7.10627   5.04935   5.04938   5.04054  35.81942
*   2007.   7.31745   7.31741   7.32839   5.12622   5.12625   5.11857  37.51086
*   2008.   7.42386   7.42382   7.41813   5.20431   5.20434   5.20833  38.63605
*   2009.   7.33593   7.33589   7.32281   5.21387   5.21390   5.22321  38.24860
*   2010.   7.52497   7.52493   7.50398   5.29027   5.29030   5.30507  39.80914
*   2011.   7.62565   7.62561   7.58612   5.40496   5.40499   5.43312  41.21633
*   2012.   7.71771   7.71767   7.67108   5.47677   5.47680   5.51006  42.26813
*   2013.   7.89117   7.89113   7.83705   5.55429   5.55432   5.59265  43.82990
*   2014.   8.05863   8.05859   7.98336   5.66067   5.66070   5.71404  45.61726
*   2015.   8.16197   8.16192   8.08251   5.72365   5.72368   5.77992  46.71623
*   2016.   8.26530   8.26526   8.17596   5.78027   5.78030   5.84343  47.77569
*   2017.   8.42024   8.42020   8.32700   5.84824   5.84827   5.91373  49.24361
*THE CHAINED FISHER AND CHAINED NORMALIZED QUADRATIC INDEXES DIFFER ONLY IN THE 4TH AND 5TH DECIMAL PLACE
*THEY ARE INCREDIBLY CLOSE!

*RUN SEPARATE EQ BY EQU NONHOMOTHETIC LEONTIEF REGRESSIONS USING QNCH AS THE UTILITY LEVEL
GENR U=QNCH
*IN THIS RUN, WE WILL SPLINE UTILITY AT 2 BREAK POINTS 21 AND 32
GENR U=QNCH
*WE WILL SPLINE UTILITY AT OBS 21 AND 32
DO #=1,3
GENR U#=0
ENDO
GENR U1=U
SMPL 22 47
GENR U1=U1(21)
GENR U2=U-U(21)
SMPL 33 47
GENR U2=U2(32)
GENR U3=U-U(32)
SMPL 1 47
GENR CHECK=U-U1-U2-U3
STAT CHECK
*CHECK SHOULD BE 0 FOR ALL OBSERVATIONS AND THIS CHECK IS SATISFIED

*CHANGE NOTATION FOR NORMALIZED PRICES; CALL THEM V# INSTEAD OF PN#
DO #=1,17
GENR V#=PN#
ENDO

*GENR DIFFERENCES OF NORMALIZED PRICES WITH THE FIRST NORMALIZED INPUT PRICE
DO #=1,17
GENR V1D#=V#-V1
ENDO
*NOTE: IN THE DESCRIPTIONS BELOW, I SOMETIMES REFER TO 
*OUR NQ UNIT COST FUNCTION WITH A RANK ONE SUBSTITUTION MATRIX IS EQUAL TO C(u,p) DEFINED AS FOLLOWS:
*C(u,p) = a.p + bA.pU1 + bB.pU2 + bC.pU3 - (1/2)(p.c)(p.c)U/p.g WHERE c.1 = 0.
*WE SET c(1) = -SUM(n=2,17)c(n). THEREFORE c.v = SUM(n=2,17)c(n)(v(n)-v(1)) = SUM(n=2,17)c(n)V1D#
*THE HICKSIAN DEMAND FUNCTIONS ARE AS FOLLOWS
*q = a + bA*U1 + bB*U2 + bC*U3- c(c.v)*U + (1/2)g(c.v)(c.v)*U - d(d.v)*U + (1/2)g(d.v)(d.v)*U
   
*WE USE THE FINAL COEFS FROM CON2OUT.TXT AS STARTING VALUES IN THE FOLLOWING REGRESSION
*HOWEVER, SHAZAM ROUNDS OFF THE STARTING VALUES AND IN SOME CASES, GREATLY CHANGES THE STARTING COEFS
*THIS EXPLAINS WHY THE STARTING LL MAY NOT BE EQUAL TO THE FINISHING LL IN THE PREVIOUS RUN.
*WE WILL NOW RUN A SYSTEM REGRESSION WITH UTILITY SPLINES WITH A RANK 1 SUBSTITUTION MATRIX
 
NL 17 / NCOEF=84 GENRVAR CONV=.000001 ITER=2000 PITER=100 LIST
EQ Q1=A1+BA1*U1+BB1*U2+BC1*U3 &
+(C2+C3+C4+C5+C6+C7+C8+C9+C10+C11+C12+C13+C14+C15+C16+C17)*(C2*V1D2 &
+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12+C13*V1D13+C14*V1D14 &
+C15*V1D15+C16*V1D16+C17*V1D17)*U &
+(1/2)*G1*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12 &
+C13*V1D13+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)**2)*U 
EQ Q2=A2+BA2*U1+BB2*U2+BC2*U3 &
-C2*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12+C13*V1D13 &
+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)*U &
+(1/2)*G2*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12 &
+C13*V1D13+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)**2)*U 
EQ Q3=A3+BA3*U1+BB3*U2+BC3*U3 &
-C3*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12+C13*V1D13 &
+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)*U &
+(1/2)*G3*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12 &
+C13*V1D13+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)**2)*U 
EQ Q4=A4+BA4*U1+BB4*U2+BC4*U3 &
-C4*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12+C13*V1D13 &
+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)*U &
+(1/2)*G4*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12 &
+C13*V1D13+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)**2)*U 
EQ Q5=A5+BA5*U1+BB5*U2+BC5*U3 &
-C5*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12+C13*V1D13 &
+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)*U &
+(1/2)*G5*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12 &
+C13*V1D13+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)**2)*U 
EQ Q6=A6+BA6*U1+BB6*U2+BC6*U3 &
-C6*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12+C13*V1D13 &
+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)*U &
+(1/2)*G6*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12 &
+C13*V1D13+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)**2)*U
EQ Q7=A7+BA7*U1+BB7*U2+BC7*U3 &
-C7*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12+C13*V1D13 &
+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)*U &
+(1/2)*G7*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12 &
+C13*V1D13+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)**2)*U
EQ Q8=A8+BA8*U1+BB8*U2+BC8*U3 &
-C8*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12+C13*V1D13 &
+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)*U &
+(1/2)*G8*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12 &
+C13*V1D13+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)**2)*U
EQ Q9=A9+BA9*U1+BB9*U2+BC9*U3 &
-C9*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12+C13*V1D13 &
+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)*U &
+(1/2)*G9*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12 &
+C13*V1D13+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)**2)*U
EQ Q10=A10+BA10*U1+BB10*U2+BC10*U3 &
-C10*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12+C13*V1D13 &
+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)*U &
+(1/2)*G10*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12 &
+C13*V1D13+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)**2)*U
EQ Q11=A11+BA11*U1+BB11*U2+BC11*U3 &
-C11*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12+C13*V1D13 &
+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)*U &
+(1/2)*G11*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12 &
+C13*V1D13+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)**2)*U
EQ Q12=A12+BA12*U1+BB12*U2+BC12*U3 &
-C12*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12+C13*V1D13 &
+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)*U &
+(1/2)*G12*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12 &
+C13*V1D13+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)**2)*U
EQ Q13=A13+BA13*U1+BB13*U2+BC13*U3 &
-C13*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12+C13*V1D13 &
+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)*U &
+(1/2)*G13*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12 &
+C13*V1D13+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)**2)*U
EQ Q14=A14+BA14*U1+BB14*U2+BC14*U3 &
-C14*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12+C13*V1D13 &
+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)*U &
+(1/2)*G14*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12 &
+C13*V1D13+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)**2)*U
EQ Q15=A15+BA15*U1+BB15*U2+BC15*U3 &
-C15*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12+C13*V1D13 &
+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)*U &
+(1/2)*G15*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12 &
+C13*V1D13+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)**2)*U
EQ Q16=A16+BA16*U1+BB16*U2+BC16*U3 &
-C16*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12+C13*V1D13 &
+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)*U &
+(1/2)*G16*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12 &
+C13*V1D13+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)**2)*U
EQ Q17=A17+BA17*U1+BB17*U2+BC17*U3 &
-C17*(C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12+C13*V1D13 &
+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)*U &
+(1/2)*G17*((C2*V1D2+C3*V1D3+C4*V1D4+C5*V1D5+C6*V1D6+C7*V1D7+C8*V1D8+C9*V1D9+C10*V1D10+C11*V1D11+C12*V1D12 &
+C13*V1D13+C14*V1D14+C15*V1D15+C16*V1D16+C17*V1D17)**2)*U
COEF A1       0.65645     
COEF BA1     -0.016369
COEF BB1      0.042693
COEF BC1      0.016412 
COEF A2       0.25491     
COEF BA2     -0.025037
COEF BB2     -0.0049176
COEF BC2      0.019608
COEF A3       0.29051     
COEF BA3     -0.041176
COEF BB3     -0.018994
COEF BC3     -0.0097210
COEF A4       0.13914     
COEF BA4      0.060461
COEF BB4      0.015445
COEF BC4      0.15569     
COEF A5       0.086544
COEF BA5      0.12254     
COEF BB5      0.15870     
COEF BC5      0.18879     
COEF A6       0.17988     
COEF BA6     -0.010969
COEF BB6     -0.0092193
COEF BC6     -0.0074522
COEF A7      -0.013983
COEF BA7      0.079032
COEF BB7      0.088958
COEF BC7      0.096802
COEF A8      -0.027180
COEF BA8      0.031568
COEF BB8      0.067376
COEF BC8      0.058843
COEF A9      -0.24116     
COEF BA9      0.11739     
COEF BB9      0.10701     
COEF BC9      0.12835     
COEF A10     -0.0382300
COEF BA10     0.0636220
COEF BB10     0.0392820
COEF BC10     0.0245820
COEF A11      0.0362070
COEF BA11     0.0110630
COEF BB11    -0.00733470
COEF BC11     0.0190950
COEF A12     -0.36376     
COEF BA12     0.10120     
COEF BB12     0.13409     
COEF BC12     0.0818840
COEF A13     -0.88741     
COEF BA13     0.28506    
COEF BB13     0.34285     
COEF BC13     0.13343     
COEF A14     -0.020547
COEF BA14     0.014967
COEF BB14     0.0051559
COEF BC14     0.014360
COEF A15      0.22322     
COEF BA15     0.021066
COEF BB15     0.024448
COEF BC15     0.0082959
COEF A16     -0.73675     
COEF BA16     0.27182     
COEF BB16     0.24805     
COEF BC16     0.17716     
COEF A17     -0.097154
COEF BA17     0.046122
COEF BB17    -0.0046037
COEF BC17     0.074640
COEF C2 0.001
COEF C3 0.001
COEF C4 0.001
COEF C5 0.001
COEF C6 0.001
COEF C7 0.001
COEF C8 0.001
COEF C9 0.001
COEF C10 0.001
COEF C11 0.001
COEF C12 0.001
COEF C13 0.001
COEF C14 0.001
COEF C15 0.001
COEF C16 0.001
COEF C17 0.001
END
* THE FINAL LL IN E59418C\CON2OUT.TXT WAS 3105.200 
* THE INITIAL LL HERE IS = 3104.800 WHICH IS CLOSE TO THE ABOVE LL. A GOOD CHECK ON OUR CODE! 
* TIME =    10.6160 SEC.  ITER. NO.   858   FUNCT. EVALUATIONS   898
* FINAL LOG-LIKELIHOOD = 3194.641 AN IMPROVEMENT OF CLOSE TO 90 POINTS FOR ADDING 16 PARAMETERS; OK INCREASE
* MOST OF THE ESTIMATED COEFS HAVE T STATS GREATER THAN 2 IN MAGNITUDE
* THE R SQUARES ARE AS FOLLOWS: .9883 .5884 .9542 0.9640 .9761 .9268 .9770 .9980 0.9713 0.9845 0.7291 
* 0.9938 0.9971 0.9873 0.7996 0.9925 0.8443
*FOR SOME EQUATIONS, THE FIT IS GOOD; FOR SOME EQUATIONS IT IS NOT SO GOOD.WE ARE CAPTURING THE GENERAL TRENDS PRETTY WELL.

*WE NEED TO GENR THE MATRIX OF SECOND ORDER PARTIAL DERIVATIVES OF THE COST FUNCTION WRT PRICES
*FIRST GENR THE C VECTOR AND THEN C TIMES C TRANSPOSE = THE C MATRIX = CC#$
SMPL 1 1
*GENR THE FIRST COMPONENT OF THE C VECTOR
GENR C1=0
DO #=2,17
GENR C1=C1-C#(1)
ENDO
SMPL 1 47
*GENR INNER PRODUCT OF C VECTOR WITH NORMALIZED PRICE VECTOR V
GENR CV=0
DO #=1,17
GENR CV=CV+C#(1)*V#
ENDO

*GENR V TRANSPOSE TIMES THE C VECTOR SQUARED = CV*CV
GENR VCV=CV*CV
*GENR FITTED DEMAND FUNCTIONS
DO #= 1,17
GENR FQ#=A#(1)+BA#(1)*U1+BB#(1)*U2+BC#(1)*U3-C#(1)*CV*U+.5*G#*VCV*U
ENDO
*COMPARE FITTED DEMANDS WITH ACTUAL DEMANDS
FORMAT(F8.0,10F10.5)
PRINT YEAR Q1 FQ1 Q2 FQ2 Q3 FQ3 Q4 FQ4 Q5 FQ5 / FORMAT
PRINT YEAR Q6 FQ6 Q7 FQ7 Q8 FQ8 Q9 FQ9 Q10 FQ10 / FORMAT
PRINT YEAR Q11 FQ11 Q12 FQ12 Q13 FQ13 Q14 FQ14 Q15 FQ15 / FORMAT
PRINT YEAR Q16 FQ16 Q17 FQ17 / FORMAT
STAT Q1 FQ1 Q2 FQ2 Q3 FQ3 Q4 FQ4 Q5 FQ5 Q6 FQ6 Q7 FQ7 Q8 FQ8 Q9 FQ9 Q10 FQ10
STAT Q11 FQ11 Q12 FQ12 Q13 FQ13 Q14 FQ14 Q15 FQ15 Q16 FQ16 Q17 FQ17 
* NAME         N   MEAN        ST. DEV     VARIANCE     MINIMUM      MAXIMUM
* Q1           47  0.60018     0.29283E-01 0.85747E-03  0.55952      0.66201
* FQ1          47  0.60018     0.29150E-01 0.84974E-03  0.55929      0.65607
* Q2           47  0.13105     0.14664E-01 0.21503E-03  0.10235      0.15215
* FQ2          47  0.13105     0.11379E-01 0.12949E-03  0.11548      0.15297
* Q3           47  0.67640E-01 0.27162E-01 0.73777E-03  0.31230E-01  0.10942
* FQ3          47  0.67640E-01 0.26556E-01 0.70520E-03  0.30585E-01  0.12436
* Q4           47  0.50575     0.10781     0.11623E-01  0.34715      0.76419
* FQ4          47  0.50575     0.10609     0.11255E-01  0.37942      0.76523
* Q5           47  0.85393     0.21045     0.44287E-01  0.61935       1.2929
* FQ5          47  0.85393     0.20791     0.43227E-01  0.59329       1.2957
* Q6           47  0.11680     0.12426E-01 0.15440E-03  0.95800E-01  0.14080
* FQ6          47  0.11680     0.11878E-01 0.14109E-03  0.98426E-01  0.13857
* Q7           47  0.46599     0.11562     0.13368E-01  0.27334      0.68326
* FQ7          47  0.46599     0.11433     0.13071E-01  0.30632      0.69414
* Q8           47  0.18740     0.72545E-01 0.52628E-02  0.96800E-01  0.32489
* FQ8          47  0.18740     0.72488E-01 0.52545E-02  0.99374E-01  0.33007
* Q9           47  0.45387     0.15157     0.22975E-01  0.22975      0.79792
* FQ9          47  0.45387     0.14931     0.22293E-01  0.24009      0.76025
* Q10          47  0.31431     0.50315E-01 0.25316E-02  0.21331      0.40153
* FQ10         47  0.31431     0.50004E-01 0.25004E-02  0.22177      0.39541
* Q11          47  0.95038E-01 0.11647E-01 0.13566E-03  0.73120E-01  0.12880
* FQ11         47  0.95038E-01 0.10033E-01 0.10067E-03  0.81806E-01  0.12304
* Q12          47  0.24760     0.13702     0.18773E-01  0.64910E-01  0.47202
* FQ12         47  0.24760     0.13666     0.18676E-01  0.42593E-01  0.48429
* Q13          47  0.78526     0.32218     0.10380      0.27130       1.2486
* FQ13         47  0.78526     0.32172     0.10350      0.26002       1.2789
* Q14          47  0.63070E-01 0.14078E-01 0.19820E-03  0.37470E-01  0.91900E-01
* FQ14         47  0.63070E-01 0.14001E-01 0.19602E-03  0.38928E-01  0.90584E-01
* Q15          47  0.34588     0.25397E-01 0.64501E-03  0.29238      0.39538
* FQ15         47  0.34588     0.23071E-01 0.53229E-03  0.30507      0.38351
* Q16          47  0.83396     0.28854     0.83257E-01  0.40925       1.3748
* FQ16         47  0.83396     0.28740     0.82598E-01  0.36668       1.3414
* Q17          47  0.15983     0.53308E-01 0.28418E-02  0.97310E-01  0.27300
* FQ17         47  0.15983     0.49074E-01 0.24082E-02  0.89675E-01  0.28342
*THE AVERAGE FITTED DEMAND COINCIDES WITH THE CORRESPONDING AVERAGE ACTUAL DEMAND FOR EVERY COMMODITY; SURPRISING!

*GENR THE COMPONENTS OF THE EXPENDITURE FUNCTION THAT IS IMPLIED BY OUR ESTIMATES
*GENR A.P , BA.P  BB.P  BC.P 
GENR AP=0
GENR BAP=0
GENR BBP=0
GENR BCP=0
DO #=1,17
GENR AP=AP+P#*A#
GENR BAP=BAP+P#*BA#
GENR BBP=BBP+P#*BB#
GENR BCP=BCP+P#*BC#
ENDO
*GENR THE INDIRECT UTILITY FUNCTION THAT CORRESPONDS TO OUR ESTIMATED COEFS
GENR IU=0
SMPL 1 21
GENR IU=(Y-AP)/(BAP-.5*PG*VCV)
SMPL 22 32
GENR IU=(Y-AP-BAP*IU(21)+BBP*IU(21))/(BBP-.5*PG*VCV)
SMPL 33 47
GENR IU=(Y-AP-BAP*IU(21)-BBP*(IU(32)-IU(21))+BCP*IU(32))/(BCP-.5*PG*VCV)
SMPL 1 47
FORMAT(F8.0,8F10.5)
PRINT YEAR U IU AP BAP BBP BCP VCV Y / FORMAT
STAT U IU
* NAME         N    MEAN        ST. DEV     VARIANCE     MINIMUM      MAXIMUM
* U            47   5.9360      1.2697      1.6121       4.0542       8.4202
* IU           47   5.9324      1.2712      1.6159       4.0646       8.4275
*U AND IU APPROXIMATE EACH OTHER VERY CLOSELY NOW
OLS U IU / LIST
* VARIABLE   ESTIMATED  STANDARD   T-RATIO        PARTIAL STANDARDIZED ELASTICITY
*   NAME    COEFFICIENT   ERROR      45 DF   P-VALUE CORR. COEFFICIENT  AT MEANS
* IU        0.99880     0.7162E-03   1395.     0.000 1.000     1.0000     0.9982
* CONSTANT  0.10700E-01 0.4343E-02   2.464     0.018 0.345     0.0000     0.0018
*    OBS.   OBSERVED     PREDICTED   CALCULATED
*      NO.    VALUE        VALUE       RESIDUAL
*       1    4.0542       4.0704     -0.16161E-01   *            I
*       2    4.2217       4.2346     -0.12876E-01      *         I
*       3    4.4009       4.4087     -0.77599E-02          *     I
*       4    4.4998       4.5047     -0.49102E-02            *   I
*       5    4.5518       4.5546     -0.27972E-02              * I
*       6    4.6753       4.6695      0.57241E-02                I    *
*       7    4.7101       4.7009      0.91582E-02                I      *
*       8    4.7722       4.7587      0.13510E-01                I          *
*       9    4.8039       4.7906      0.13227E-01                I          *
*      10    4.7952       4.7841      0.11135E-01                I        *
*      11    4.7508       4.7431      0.77011E-02                I     *
*      12    4.5603       4.5606     -0.30267E-03                *
*      13    4.6241       4.6253     -0.12668E-02               *I
*      14    4.7654       4.7635      0.19476E-02                I *
*      15    4.9515       4.9465      0.49830E-02                I   *
*      16    5.0874       5.0837      0.37259E-02                I  *
*      17    5.2256       5.2240      0.15729E-02                I*
*      18    5.3824       5.3854     -0.29723E-02              * I
*      19    5.4684       5.4745     -0.60774E-02           *    I
*      20    5.4606       5.4665     -0.59089E-02           *    I
*      21    5.3302       5.3264      0.38141E-02                I  *
*      22    5.3581       5.3555      0.25677E-02                I *
*      23    5.4093       5.4102     -0.84001E-03               *I
*      24    5.5223       5.5303     -0.80523E-02         *      I
*      25    5.5906       5.5970     -0.63291E-02           *    I
*      26    5.6856       5.6898     -0.41985E-02             *  I
*      27    5.8721       5.8733     -0.11886E-02               *I
*      28    5.9919       5.9911      0.74372E-03                I*
*      29    6.1496       6.1481      0.14248E-02                I*
*      30    6.3205       6.3201      0.40588E-03                *
*      31    6.3779       6.3782     -0.27976E-03                *
*      32    6.5260       6.5310     -0.49773E-02            *   I
*      33    6.6038       6.6077     -0.39017E-02             *  I
*      34    6.7491       6.7505     -0.14229E-02               *I
*      35    6.9049       6.9048      0.93800E-04                *
*      36    7.0938       7.0921      0.17721E-02                I*
*      37    7.3174       7.3136      0.37967E-02                I  *
*      38    7.4238       7.4200      0.37899E-02                I  *
*      39    7.3359       7.3334      0.25385E-02                I *
*      40    7.5249       7.5196      0.53759E-02                I   *
*      41    7.6256       7.6200      0.56249E-02                I    *
*      42    7.7177       7.7128      0.48863E-02                I   *
*      43    7.8911       7.8902      0.90929E-03                I*
*      44    8.0586       8.0618     -0.31863E-02             *  I
*      45    8.1619       8.1652     -0.32326E-02             *  I
*      46    8.2653       8.2692     -0.39536E-02             *  I
*      47    8.4202       8.4280     -0.78327E-02          *     I
*ANOTHER BREAK POINT AT OBSERVATION 8 WOULD MAKE THE FIT EVEN BETTER BUT IT IS PRETTY GOOD ALREADY!

*CHECK OUR COMPUTATIONS
*GENR FITTED Y
SMPL 1 47
GENR FY=0
DO #=1,17
GENR FY=FY+P#*FQ#
ENDO
*GENR THE INDIRECT UTILITY THAT CORRESPONDS TO FY, NEWU OR NU
GENR NU=0
SMPL 1 21
GENR NU=(FY-AP)/(BAP-.5*PG*VCV)
SMPL 22 32
GENR NU=(FY-AP-BAP*NU(21)+BBP*NU(21))/(BBP-.5*PG*VCV)
SMPL 33 47
GENR NU=(FY-AP-BAP*NU(21)-BBP*(NU(32)-NU(21))+BCP*NU(32))/(BCP-.5*PG*VCV)
SMPL 1 47
FORMAT(F8.0,10F10.5)
PRINT YEAR IU NU U AP BAP BBP BCP VCV FY Y / FORMAT
*U IS INDEX NUMBER U; IU IS THE INDIRECT U THAT IS GENERATED BY OUR REGRESSION; NU IS THE INDIRECT U THAT
*IS GENERATED BY OUR REGRESSION BUT USES FITTED EXPENDITURES TO GENERATE THE INDIRECT UTILITY FUNCTION
*NU AND U SHOULD COINCIDE AND THEY DO
STAT IU NU U / PCOR
* NAME         N    MEAN        ST. DEV     VARIANCE     MINIMUM      MAXIMUM
* IU           47   5.9324      1.2712      1.6159       4.0646       8.4275
* NU           47   5.9360      1.2697      1.6121       4.0543       8.4202
* U            47   5.9360      1.2697      1.6121       4.0542       8.4202
*IF THE FIT IN OUR ESTIMATING EQUATIONS IS GOOD, THEN OUR METHOD WORKS WELL.

*FINISH UP BY GENERATING ELASTICITIES
*GENR THE MATRIX OF SECOND ORDER PARTIAL DERIVATIVES OF THE COST FUNCTION WRT INPUT PRICES
DO #=1,17
DO $=1,17
GENR D#C$=(-C#(1)*C$(1)+C#(1)*G$*CV+G#*C$(1)*CV-G#*G$*VCV)*U/PG
ENDO
ENDO

*CALCULATE THE MATRIX OF ORDINARY PRICE ELASTICITIES OF INPUT DEMAND FOR EACH YEAR
DO #=1,17
DO $=1,17
GENR E#P$=D#C$*P$/FQ#
ENDO
ENDO
DO #=1,17
GENR CHECK#=E#P1+E#P2+E#P3+E#P4+E#P5+E#P6+E#P7+E#P8+E#P9+E#P10 &
+E#P11+E#P12+E#P13+E#P14+E#P15+E#P16+E#P17
ENDO
DO #=1,17
STAT CHECK#
ENDO
*ALL CHECK# ARE 0; CHECKS ARE SATISFIED
*PRINT OUT THE OWN ELASTICITIES OF DEMAND; THEY SHOULD ALL BE NEGATIVE (OR 0)
FORMAT(F8.0,9F10.5)
PRINT YEAR E1P1 E2P2 E3P3 E4P4 E5P5 E6P6 E7P7 E8P8 E9P9  / FORMAT
PRINT YEAR E10P10 E11P11 E12P12 E13P13 E14P14 E15P15 E16P16 E17P17 / FORMAT
STAT E1P1 E2P2 E3P3 E4P4 E5P5 E6P6 E7P7 E8P8 E9P9 E10P10
STAT E11P11 E12P12 E13P13 E14P14 E15P15 E16P16 E17P17
* NAME         N    MEAN        ST. DEV     VARIANCE     MINIMUM      MAXIMUM
* E1P1         47 -0.36259E-01 0.41693E-02 0.17383E-04 -0.47842E-01 -0.32284E-01
* E2P2         47 -0.11708E-01 0.49293E-02 0.24298E-04 -0.17901E-01 -0.31743E-02
* E3P3         47 -0.16808E-01 0.14431E-01 0.20825E-03 -0.54459E-01 -0.33146E-02
* E4P4         47 -0.94763E-01 0.12163E-01 0.14795E-03 -0.11076     -0.67778E-01
* E5P5         47 -0.10588     0.15716E-01 0.24698E-03 -0.12398     -0.76366E-01
* E6P6         47 -0.84837E-01 0.36806E-01 0.13547E-02 -0.15064     -0.34265E-01
* E7P7         47 -0.10102E-01 0.22122E-02 0.48936E-05 -0.12025E-01 -0.34690E-02
* E8P8         47 -0.41774E-01 0.39590E-02 0.15674E-04 -0.49540E-01 -0.33602E-01
* E9P9         47 -0.37729E-01 0.14988E-01 0.22464E-03 -0.86239E-01 -0.19814E-01
* E10P10       47 -0.39067E-02 0.19538E-02 0.38174E-05 -0.10032E-01 -0.19049E-02
* E11P11       47 -0.26730E-02 0.49768E-03 0.24769E-06 -0.40586E-02 -0.18932E-02
* E12P12       47 -0.12098     0.94544E-01 0.89385E-02 -0.47920     -0.53439E-01
* E13P13       47 -0.19709     0.65933E-01 0.43471E-02 -0.38234     -0.13094
* E14P14       47 -0.52674E-01 0.18662E-01 0.34827E-03 -0.84222E-01 -0.26422E-01
* E15P15       47 -0.29760E-01 0.23418E-02 0.54841E-05 -0.34585E-01 -0.25805E-01
* E16P16       47 -0.63494E-02 0.28165E-02 0.79326E-05 -0.10511E-01 -0.12193E-03
* E17P17       47 -0.73517E-02 0.24849E-02 0.61746E-05 -0.12161E-01 -0.25362E-02
*THE ONLY 3 COMMODITY CLASSES THAT HAVE AN AVERAGE OWN ELASTICITY OF DEMAND GREATER THAN 0.1 IN MAGNITUDE ARE
* E5P5     -0.10588   Aggregate housing services
* E12P12   -0.12098   Communications   
* E13P13   -0.19709   Recreation and culture
*MOST OF THE ELASTICITIES ARE QUITE SMALL IN MAGNITUDE. THEY WILL INCREASE AS WE ADD MORE COLUMNS TO THE MODEL 

*GENR INCOME ELASTICITIES OF DEMAND
DO #=1,17
GENR EU#=0
ENDO
SMPL 1 21
DO #=1,17
GENR EU#=(BA#(1)-C#(1)*CV+.5*G#*VCV)*U/FQ#
ENDO
SMPL 22 32
DO #=1,17
GENR EU#=(BB#(1)-C#(1)*CV+.5*G#*VCV)*U/FQ#
ENDO
SMPL 33 47
DO #=1,17
GENR EU#=(BC#(1)-C#(1)*CV+.5*G#*VCV)*U/FQ#
ENDO
SMPL 1 47
FORMAT(F8.0,9F10.4)
PRINT YEAR EU1-EU9 / FORMAT
PRINT YEAR EU10-EU17 / FORMAT
STAT EU1-EU17
* NAME         N    MEAN       ST. DEV     VARIANCE     MINIMUM      MAXIMUM
* EU1          47  0.34214     0.10378     0.10770E-01  0.21321      0.50823
* EU2          47 -0.37235     0.90145     0.81261      -1.5618      0.83555
* EU3          47  -1.7543     0.47741     0.22792      -2.9234     -0.99297
* EU4          47  0.41612     0.71301     0.50838     -0.24964       1.5576
* EU5          47   1.3931     0.10937     0.11963E-01   1.1862       1.5562
* EU6          47  0.14059     0.27350     0.74801E-01 -0.35950      0.44855
* EU7          47  0.95729     0.13215     0.17464E-01  0.77772       1.1011
* EU8          47   1.0673     0.70961     0.50355      0.21600       2.3386
* EU9          47   1.9672     0.42518     0.18078       1.4329       2.8519
* EU10         47  0.95666     0.36911     0.13624      0.53017       1.4259
* EU11         47  0.75158     0.71674     0.51372     -0.51373       1.5671
* EU12         47   1.9812     0.85622     0.73312       1.0285       3.7608
* EU13         47   1.4709     0.74121     0.54939      0.43213       2.6467
* EU14         47  0.24642     0.32905     0.10827     -0.35170      0.71296
* EU15         47  0.56066     0.16254     0.26419E-01  0.36154      0.74881
* EU16         47   1.7234     0.53513     0.28637       1.0452       2.8359
* EU17         47   1.4057      1.0339      1.0690     -0.28078       3.0862

*ON AVERAGE, 15 OF THE 17 COMMODITY GROUPS HAVE POSITIVE INCOME ELASTICITIES
*THE AVERAGE IS GREATER THAN 1 FOR THE FOLLOWING 7 CATEGORIES: 
*EU5  housing
*EU8 Health
*EU9 Purchase of vehicles
*EU12 Communications
*EU13 Recreation and culture
*EU16 Miscellaneous goods and services
*EU17 Final consumption expenditure of resident households abroad
*THE 2 NEGATIVE INCOME ELASTICITY OF DEMAND CATEGORIES ARE:
*EU3 Tobacco
*EU2 Alcoholic beverages
*THE REMAINING 8 CATEGORIES THAT HAVE INCOME ELASTICITIES BETWEEN 0 AND 1 ARE:

*1 IS THE SERIES       P31CP010: Food and non-alcoholic beverages
*2 IS THE SERIES       P31CP021: Alcoholic beverages
*3 IS THE SERIES       P31CP022: Tobacco
*4 IS THE SERIES       P31CP030: Clothing and footwear
*5 IS THE SERIES       P31CP041+P31CP042+P31CP043+P31CP044: HOUSING AGGREGATE
*6 IS THE SERIES       P31CP045: Electricity, gas and other fuels
*7 IS THE SERIES       P31CP050: Furnishings, households equipment and routine maintenance of the house
*8 IS THE SERIES       P31CP060: Health
*9 IS THE SERIES       P31CP071: Purchase of vehicles
*10 IS THE SERIES      P31CP072: Operation of personal transport equipment
*11 IS THE SERIES      P31CP073: Transport services
*12 IS THE SERIES      P31CP080: Communications
*13 IS THE SERIES      P31CP090: Recreation and culture
*14 IS THE SERIES      P31CP100: Education
*15 IS THE SERIES      P31CP110: Restaurants and hotels
*16 IS THE SERIES      P31CP120: Miscellaneous goods and services
*17 IS THE SERIES      P33:      Final consumption expenditure of resident households abroad
STOP















