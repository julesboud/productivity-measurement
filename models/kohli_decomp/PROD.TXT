*THIS IS THE FILE E59419\PROD.TXT THAT CALCULATES GROSS AND NET PRODUCTIVITY GROWTH RATES
*FOR CANADA AND THE CONTRIBUTIONS TO THOSE GROWTH RATES                       JUNE 8,2019                   
*THE DATA SOURCE FILE IS E59419\DATOUT.TXT (WE JUST COPY THE DATA FROM THIS OUTPUT FILE
*AND THEN PASTE IT INTO THIS INPUT PROGRAM).
SET NODOECHO
SET NOCOLOR
PAR 10000
*READ IN OUR PRODUCTION DATA FROM DATOUT.TXT
*YOUR SMPL STATEMENT MAY BE DIFFERENT!
SMPL 1 60
GENR YEAR=0
GENR PK=0
GENR QK=0
GENR VK=0
GENR CHECK=0
SMPL 1 59
READ YEAR Y1-Y6 QKS
   1960.    26.3291     5.8275     9.8194     6.7505    -7.3855   -22.8392    15.3102
   1961.    26.6542     6.5768     9.4772     7.1975    -7.3855   -23.1658    15.8170
   1962.    28.0356     6.9110    10.5019     7.5312    -7.5519   -23.8817    16.2360
   1963.    29.1733     7.2484    10.8989     8.1945    -7.6852   -24.3020    16.7382
   1964.    30.7173     7.6818    12.0890     9.3073    -8.6546   -25.1535    17.2206
   1965.    32.5863     8.0263    13.9418     9.7265    -9.8109   -26.0396    17.8583
   1966.    34.1303     8.7091    15.2896    11.0036   -11.1150   -27.0978    18.7336
   1967.    35.4305     9.4369    14.3780    12.1846   -11.7243   -27.8731    19.7464
   1968.    36.9745    10.0417    14.9307    13.6826   -12.9179   -28.0557    20.5773
   1969.    38.6810    10.5265    16.1755    14.7757   -14.6399   -28.7721    21.4194
   1970.    39.3311    11.3602    15.2833    16.1311   -14.4145   -28.9216    22.3925
   1971.    41.6013    11.7473    16.4598    16.9161   -15.3679   -29.3850    23.1167
   1972.    44.4545    12.1412    17.3892    18.3771   -17.5684   -30.1761    23.9721
   1973.    47.4473    12.7060    19.3790    20.2311   -20.1006   -31.6326    24.9239
   1974.    49.8181    13.4434    21.0395    19.3183   -22.1271   -32.8131    26.0882
   1975.    51.7206    14.2986    20.4534    17.7156   -21.4833   -33.0545    27.4393
   1976.    54.3728    14.5120    22.3489    19.0918   -22.7999   -33.4266    28.6540
   1977.    55.8839    15.0599    22.6205    20.3166   -22.7167   -33.5441    30.0210
   1978.    57.5511    15.2098    22.6305    22.3415   -23.4307   -34.5975    31.3304
   1979.    58.8683    15.3365    25.3592    23.1841   -25.1098   -36.2242    32.5554
   1980.    59.8734    15.7450    24.7267    23.4320   -24.3383   -37.0969    34.0615
   1981.    60.5903    16.0256    27.5354    23.8102   -24.8282   -37.5278    35.3290
   1982.    59.0380    16.2152    21.4347    23.4788   -20.8857   -35.7933    36.8818
   1983.    60.5145    16.3912    23.2062    24.8339   -22.9956   -35.8113    37.3977
   1984.    62.8379    16.7613    25.6319    29.4589   -26.9925   -36.9227    38.0997
   1985.    65.9172    17.4282    27.8113    30.7788   -29.2221   -38.1872    39.0750
   1986.    68.1726    17.7128    28.6506    32.1621   -31.1418   -39.4162    40.2604
   1987.    70.8153    17.9660    30.7683    33.1867   -32.8232   -40.6935    41.4866
   1988.    73.7400    18.4907    34.3823    36.2053   -37.2626   -41.9086    42.9731
   1989.    76.2601    18.9458    35.7844    36.5090   -39.4265   -42.7031    44.8831
   1990.    77.3115    19.5666    32.9745    38.1600   -40.1900   -42.8023    46.8484
   1991.    76.4567    20.0274    30.7081    38.7719   -41.1977   -41.5037    48.2202
   1992.    77.6407    20.1903    29.6036    41.6498   -43.3076   -41.0117    49.1649
   1993.    79.0775    20.1499    30.5640    46.1561   -46.5462   -41.1079    49.8542
   1994.    81.3605    19.9211    33.1391    52.0774   -50.4057   -42.1546    50.6363
   1995.    83.1793    19.7232    34.3116    56.6969   -53.3182   -42.8325    51.7248
   1996.    85.6472    19.3469    34.5787    59.9433   -56.1757   -43.4991    52.8515
   1997.    89.8392    19.2318    40.1057    65.0927   -64.2451   -44.2165    53.8539
   1998.    92.3073    19.6017    40.5567    71.2875   -67.6481   -45.1306    55.5214
   1999.    95.9495    20.0260    42.6630    79.0019   -73.1014   -46.3354    57.0386
   2000.    99.8447    20.7142    46.0201    86.1484   -79.3120   -47.4912    58.6621
   2001.   102.2780    21.4196    44.7693    83.5908   -75.3965   -47.9471    60.5421
   2002.   106.3654    21.9041    45.7734    84.5857   -76.7693   -48.6128    62.0020
   2003.   109.2856    22.5350    49.8427    83.1247   -80.0149   -49.5328    63.5025
   2004.   112.6095    22.9576    54.1342    87.7231   -86.7951   -50.7605    65.5316
   2005.   117.0342    23.2017    59.7677    89.6708   -93.1403   -51.0538    68.1207
   2006.   121.9331    23.8402    63.1941    90.4487   -98.0782   -51.8495    71.3525
   2007.   127.2912    24.4063    64.7735    91.4822  -103.7161   -52.7713    74.8998
   2008.   131.0613    25.3243    65.9131    87.3253  -104.6073   -53.1864    78.5030
   2009.   131.1314    26.0072    56.1025    76.0019   -91.5938   -51.1343    81.9849
   2010.   135.8272    26.5926    63.6071    81.0475  -104.2033   -52.0037    83.8339
   2011.   138.9496    26.9413    68.3107    84.9106  -110.0108   -52.6904    86.7752
   2012.   141.6134    27.1293    70.8102    87.2596  -114.0781   -53.6777    90.2802
   2013.   145.3221    26.9149    72.8651    89.3414  -116.3441   -54.2857    93.9801
   2014.   149.0919    27.0637    73.7717    94.9089  -119.1989   -54.4655    97.7352
   2015.   152.5129    27.4325    68.5738    98.1056  -119.9171   -55.1570   101.5438
   2016.   155.9334    27.9376    65.5716    99.4050  -119.9134   -55.3865   104.3763
   2017.   161.3917    28.5321    70.0298   100.5152  -124.9652   -55.9555   106.7218
   2018.   164.7692    29.2489    69.9178   103.8092  -128.5486   -56.5946   109.8085
*NOTE Y5 AND Y6 SHOULD BE NEGATIVE
FORMAT(F8.0,7F11.4)
PRINT YEAR Y1-Y6 QKS / FORMAT
READ YEAR P1-P6 PKS
   1960.   0.89773   1.00000   1.00000   1.00000   1.06756   1.00000   1.00000
   1961.   0.89406   1.03759   0.99259   1.01562   1.09436   1.03783   0.96396
   1962.   0.89892   1.06873   0.99925   1.05575   1.14531   1.07745   1.02562
   1963.   0.91206   1.10010   1.02845   1.06535   1.17343   1.12623   1.08333
   1964.   0.91637   1.13763   1.05964   1.08914   1.18224   1.13993   1.21536
   1965.   0.92881   1.19782   1.11629   1.10790   1.18695   1.26369   1.21335
   1966.   0.96463   1.29635   1.16962   1.14308   1.21241   1.36296   1.29526
   1967.   1.00397   1.38287   1.20580   1.16253   1.22609   1.46402   1.26310
   1968.   1.04758   1.47604   1.22064   1.18143   1.25516   1.57377   1.34024
   1969.   1.08730   1.59531   1.27829   1.20617   1.28478   1.71252   1.36642
   1970.   1.12923   1.71713   1.33401   1.24790   1.31257   1.83811   1.44504
   1971.   1.15718   1.82561   1.41138   1.24839   1.35308   1.98098   1.51103
   1972.   1.20991   1.96554   1.49374   1.29656   1.38653   2.15391   1.58919
   1973.   1.28490   2.13364   1.65426   1.46369   1.48518   2.35356   1.82326
   1974.   1.44942   2.44945   1.93407   1.86865   1.79576   2.70429   2.04906
   1975.   1.65765   2.78712   2.15431   2.13925   2.06156   3.12912   2.18034
   1976.   1.77151   3.12528   2.29680   2.28642   2.11659   3.56607   2.41501
   1977.   1.91431   3.39763   2.42453   2.50194   2.39397   3.93488   2.57977
   1978.   2.07924   3.63897   2.59791   2.73290   2.71434   4.15447   2.79366
   1979.   2.27931   3.98494   2.83243   3.21207   3.06781   4.46399   3.15937
   1980.   2.52763   4.38464   3.08743   3.73553   3.53846   4.91796   3.39638
   1981.   2.74708   4.91939   3.38401   4.04099   3.95426   5.56273   3.61587
   1982.   3.01638   5.49390   3.60822   4.14727   4.11756   6.24893   3.58475
   1983.   3.26127   5.82635   3.67125   4.21319   4.13814   6.56162   4.07891
   1984.   3.41848   6.07350   3.77787   4.35662   4.34065   6.86016   4.49672
   1985.   3.55972   6.32756   3.87159   4.46287   4.46402   7.16425   4.75829
   1986.   3.73458   6.56857   3.98508   4.41701   4.54393   7.37589   4.84206
   1987.   3.85586   6.87489   4.13981   4.49783   4.48351   7.76067   5.06764
   1988.   4.01147   7.16083   4.28586   4.50810   4.37933   8.26106   5.33811
   1989.   4.15743   7.57466   4.43099   4.60311   4.37871   8.73799   5.37826
   1990.   4.36741   8.03974   4.49350   4.56465   4.41114   9.19693   5.25920
   1991.   4.59609   8.41563   4.42007   4.40139   4.33221   9.77799   5.01921
   1992.   4.65546   8.69817   4.45994   4.51208   4.48891  10.15719   5.00482
   1993.   4.72635   8.85551   4.51561   4.71053   4.74804  10.35248   5.23625
   1994.   4.76954   9.01570   4.66404   4.97955   5.03493  10.38077   5.73014
   1995.   4.82523   9.13223   4.69727   5.28907   5.19419  10.53928   6.07353
   1996.   4.90363   9.22659   4.70656   5.31574   5.12027  10.68002   6.19985
   1997.   4.97151   9.36202   4.79795   5.30675   5.15076  11.12098   6.34864
   1998.   5.01776   9.51809   4.88055   5.27519   5.32223  11.51246   6.19830
   1999.   5.09405   9.72422   4.88667   5.33407   5.30013  11.78906   6.65678
   2000.   5.20488  10.20213   4.95455   5.67018   5.40961  12.45550   7.27764
   2001.   5.36642  10.42459   5.02903   5.74611   5.54572  12.78581   7.37429
   2002.   5.42990  10.77862   5.14766   5.64085   5.57733  13.08859   7.45088
   2003.   5.55648  11.07814   5.15229   5.55131   5.20113  13.36237   7.82806
   2004.   5.63263  11.29755   5.27608   5.66995   5.08295  13.75425   8.19918
   2005.   5.74221  11.68784   5.38303   5.82591   5.04749  14.43864   8.51556
   2006.   5.83330  12.08347   5.58802   5.83938   5.00759  15.10787   8.49538
   2007.   5.93187  12.44381   5.82314   5.88460   4.90107  15.77466   8.45843
   2008.   6.10028  12.90299   6.05177   6.50737   5.19288  16.34323   8.67442
   2009.   6.11949  13.27081   6.15048   5.87593   5.16276  16.86988   7.36388
   2010.   6.19963  13.45454   6.15058   5.97304   4.97920  17.09071   7.96290
   2011.   6.33471  13.92438   6.27225   6.38251   5.14857  17.75379   8.34221
   2012.   6.40844  14.18283   6.41689   6.32438   5.18093  18.20148   8.09136
   2013.   6.50498  14.63310   6.50251   6.42089   5.22749  18.72902   8.10508
   2014.   6.62072  14.93871   6.72487   6.62674   5.47099  19.38208   8.27383
   2015.   6.68082  15.14847   6.92227   6.41264   5.69979  19.66401   7.58455
   2016.   6.73839  15.25836   7.07671   6.36223   5.72594  19.57259   7.69156
   2017.   6.80166  15.52044   7.20034   6.61365   5.76175  20.17641   8.06372
   2018.   6.91795  15.78956   7.30232   6.80185   5.90538  20.85639   8.00359
FORMAT(F8.0,7F10.5)
PRINT YEAR P1-P6 PKS / FORMAT
*NORMALIZE PRICES SO THAT ALL PRICES EQUAL ONE IN 1960
DO #=1,6
GENR C#=P#(1)
ENDO
DO #=1,6
GENR P#=P#/C#
GENR Y#=Y#*C#
ENDO 
FORMAT(F8.0,7F10.5)
PRINT YEAR P1-P6 PKS / FORMAT
FORMAT(F8.0,7F11.2)
PRINT YEAR Y1-Y6 QKS / FORMAT
*SEE IF THE VALUE OF INPUTS IS EQUAL TO THE VALUE OF OUTPUTS
GENR CHECK=P1*Y1+P2*Y2+P3*Y3+P4*Y4+P5*Y5+P6*Y6-PKS*QKS
FORMAT(F8.0,F10.5)
PRINT YEAR CHECK / FORMAT
STAT CHECK
*THE MIN AND MAX FOR CHECK SHOULD BE 0 AND IT IS EXCEPT FOR ROUNDING ERRORS
*P1 IS THE PRICE OF CONSUMPTION, P2 IS THE PRICE OF GOVT OUTPUT, P3 IS THE PRICE OF INVESTMENT
*P4 IS THE PRICE OF EXPORTS, P5 IS THE PRICE OF IMPORTS, P6 IS THE PRICE OF LABOUR 
*PKS IS THE (GROSS) PRICE OF CAPITAL SERVICES (INCLUDES DEPRECIATION) AND Y1,Y2,Y3,Y4,Y5,Y6 AND QKS ARE THE 
*CORRESPONDING QUANTITIES (Y5 AND Y6 ARE NEGATIVE).
*GENR GROSS PROFITS, GPROF
GENR GPROF=P1*Y1+P2*Y2+P3*Y3+P4*Y4+P5*Y5+P6*Y6
*WE NOW DOWNLOAD SOME ADDITIONAL CAPITAL STOCK DATA FROM E59419\DATOUT.TXT.
SMPL 1 60
READ YEAR PK QK VK
   1960.   1.00000  103.3524  103.3524
   1961.   1.00000  106.7735  106.7735
   1962.   0.99259  109.6019  108.7901
   1963.   0.99925  112.9918  112.9068
   1964.   1.02845  116.2488  119.5562
   1965.   1.05964  120.5536  127.7433
   1966.   1.11629  126.4620  141.1678
   1967.   1.16962  133.2987  155.9091
   1968.   1.20580  138.9079  167.4954
   1969.   1.22064  144.5926  176.4960
   1970.   1.27829  151.1615  193.2283
   1971.   1.33401  156.0506  208.1726
   1972.   1.41138  161.8248  228.3959
   1973.   1.49374  168.2499  251.3217
   1974.   1.65426  176.1100  291.3318
   1975.   1.93407  185.2305  358.2493
   1976.   2.15431  193.4302  416.7084
   1977.   2.29680  202.6582  465.4651
   1978.   2.42453  211.4972  512.7809
   1979.   2.59791  219.7666  570.9342
   1980.   2.83243  229.9336  651.2706
   1981.   3.08743  238.4898  736.3204
   1982.   3.38401  248.9724  842.5253
   1983.   3.60822  252.4552  910.9144
   1984.   3.67125  257.1942  944.2250
   1985.   3.77787  263.7778  996.5194
   1986.   3.87159  271.7797 1052.2192
   1987.   3.98508  280.0571 1116.0508
   1988.   4.13981  290.0923 1200.9275
   1989.   4.28586  302.9859 1298.5556
   1990.   4.43099  316.2524 1401.3099
   1991.   4.49350  325.5125 1462.6899
   1992.   4.42007  331.8902 1466.9768
   1993.   4.45994  336.5434 1500.9625
   1994.   4.51561  341.8227 1543.5378
   1995.   4.66404  349.1706 1628.5463
   1996.   4.69727  356.7767 1675.8758
   1997.   4.70656  363.5432 1711.0390
   1998.   4.79795  374.7997 1798.2698
   1999.   4.88055  385.0420 1879.2165
   2000.   4.88667  396.0014 1935.1271
   2001.   4.95455  408.6923 2024.8869
   2002.   5.02903  418.5475 2104.8862
   2003.   5.14766  428.6764 2206.6824
   2004.   5.15229  442.3744 2279.2410
   2005.   5.27608  459.8520 2426.2141
   2006.   5.38303  481.6683 2592.8338
   2007.   5.58802  505.6145 2825.3841
   2008.   5.82314  529.9382 3085.9044
   2009.   6.05177  553.4432 3349.3092
   2010.   6.15048  565.9248 3480.7071
   2011.   6.15058  585.7805 3602.8916
   2012.   6.27225  609.4406 3822.5657
   2013.   6.41689  634.4173 4070.9860
   2014.   6.50251  659.7660 4290.1326
   2015.   6.72487  685.4761 4609.7351
   2016.   6.92227  704.5975 4877.4116
   2017.   7.07671  720.4304 5098.2767
   2018.   7.20034  741.2676 5337.3779
   2019.   7.30232  760.9861 5556.9638
*REGENR VK AS PK*QK
GENR VK=PK*QK
FORMAT(F8.0,F10.5,2F12.4)
PRINT YEAR PK QK VK / FORMAT
*PK, QK AND VK ARE THE PRICE, QUANTITY AND VALUE OF THE BEGINNING OF THE YEAR CAPITAL STOCK
SMPL 1 59
READ YEAR PC R TRK D IK
   1960.    1.00000    0.07868    0.03237    0.06191   -0.00804
   1961.    1.00488    0.08215    0.03337    0.06227    0.00173
   1962.    1.01951    0.09907    0.03436    0.06489    0.01165
   1963.    1.04390    0.11394    0.03536    0.06763    0.02249
   1964.    1.05854    0.14109    0.03635    0.06696    0.03536
   1965.    1.08293    0.14162    0.03735    0.06664    0.04139
   1966.    1.12683    0.14202    0.03574    0.06684    0.03962
   1967.    1.17561    0.12629    0.03521    0.06578    0.03436
   1968.    1.22439    0.12863    0.03750    0.06656    0.03271
   1969.    1.27317    0.13373    0.04248    0.06644    0.03679
   1970.    1.31707    0.14206    0.03794    0.06876    0.04656
   1971.    1.35580    0.15360    0.03648    0.06848    0.05827
   1972.    1.41995    0.17406    0.03753    0.06775    0.08046
   1973.    1.52055    0.21145    0.03931    0.06846    0.10638
   1974.    1.68794    0.22561    0.04222    0.06768    0.11777
   1975.    1.87917    0.20295    0.03967    0.06615    0.10934
   1976.    2.03260    0.17888    0.03618    0.06783    0.08652
   1977.    2.20325    0.16519    0.03512    0.06800    0.07169
   1978.    2.38967    0.17135    0.03516    0.06790    0.07356
   1979.    2.60848    0.18783    0.03467    0.06913    0.08251
   1980.    2.87670    0.18856    0.03493    0.07033    0.08741
   1981.    3.20603    0.17481    0.03330    0.07150    0.07843
   1982.    3.52639    0.14053    0.02789    0.07210    0.06004
   1983.    3.77518    0.13281    0.02843    0.07315    0.04154
   1984.    3.95123    0.13399    0.03156    0.07406    0.02874
   1985.    4.10563    0.13712    0.03091    0.07510    0.02772
   1986.    4.28570    0.13914    0.03169    0.07496    0.03117
   1987.    4.46066    0.14544    0.03256    0.07403    0.03358
   1988.    4.63126    0.14760    0.03473    0.07408    0.03311
   1989.    4.83209    0.13438    0.03547    0.07432    0.02463
   1990.    5.02512    0.11284    0.03261    0.07499    0.01297
   1991.    5.25976    0.09616    0.03058    0.07474    0.00587
   1992.    5.34179    0.09838    0.03082    0.07518    0.00630
   1993.    5.44807    0.11119    0.03269    0.07513    0.01340
   1994.    5.50986    0.12692    0.03548    0.07545    0.01557
   1995.    5.58275    0.12951    0.03663    0.07648    0.01417
   1996.    5.66572    0.12899    0.03856    0.07795    0.01238
   1997.    5.74299    0.13090    0.04296    0.07936    0.01133
   1998.    5.81831    0.12136    0.04061    0.08088    0.01183
   1999.    5.91135    0.13052    0.04459    0.08234    0.01178
   2000.    6.04376    0.14767    0.04656    0.08416    0.01225
   2001.    6.16968    0.14799    0.04139    0.08543    0.01414
   2002.    6.29032    0.14772    0.03984    0.08516    0.01465
   2003.    6.39723    0.15560    0.04033    0.08432    0.01600
   2004.    6.49452    0.16984    0.04311    0.08286    0.01850
   2005.    6.60116    0.18046    0.04281    0.08253    0.02604
   2006.    6.68393    0.18284    0.04443    0.08148    0.03325
   2007.    6.78684    0.17695    0.04094    0.08000    0.03557
   2008.    6.88746    0.16829    0.03892    0.08002    0.03005
   2009.    6.89830    0.12073    0.03598    0.07882    0.02094
   2010.    6.99207    0.12878    0.03557    0.07731    0.01549
   2011.    7.13997    0.13815    0.03524    0.07622    0.01456
   2012.    7.23261    0.13304    0.03417    0.07521    0.01854
   2013.    7.32886    0.13388    0.03394    0.07490    0.02343
   2014.    7.46980    0.13910    0.03419    0.07285    0.02530
   2015.    7.54551    0.11905    0.03286    0.07214    0.02600
   2016.    7.61726    0.11490    0.03205    0.07059    0.02248
   2017.    7.70881    0.11776    0.03205    0.06828    0.01850
   2018.    7.84062    0.11017    0.03205    0.06772    0.01419
FORMAT(F8.0,5F10.5)
PRINT YEAR PC R TRK D IK / FORMAT
*PC IS THE PRICE OF CONSUMPTION THAT HOUSEHOLDS PAY,R IS THE (NOMINAL) EX POST RATE OF RETURN ON A UNIT
*OF THE CAPITAL STOCK FOR THE GIVEN YEAR,TRK IS THE RATE OF TAXATION ON A UNIT OF THE CAPITAL STOCK,
*D IS THE GEOMETRIC DEPRECIATION RATE AND IK IS THE EX POST RATE OF ASSET PRICE CHANGE.
*BECAUSE WE HAVE NOT ENTERED OUR DATA FROM E59419\DATOUT.TXT WITH ENOUGH DECIMAL PLACES, OUR DATA
*WILL NOT ADD UP EXACTLY IN THIS FILE SO WE WILL REGENR SOME OF OUR CAPITAL VARIABLES TO MAKE THE
*DATA ADD UP.
SMPL 1 59
*NOW GENR THE EXPECTED CHANGE IN THE VALUE OF THE BEGINNING OF THE PERIOD CAPITAL STOCK OVER THE PERIOD AS IT DEPRECIATES.
*THE BEGINNING OF THE PERIOD VALUE OF THE CAPITAL STOCK IS PK*QK=VK; THE END OF PERIOD VALUE OF THE INITIAL CAPITAL 
*STOCK IS (1-D)*(1+IK)*VK. THE DIFFERENCE IN THESE TWO STOCKS IS DVK. THUS DVK=VK-(1-D)*(1+IK)*VK.
GENR DVK=VK-(1-D)*(1+IK)*VK
*WE CAN SET GPROF EQUAL TO THE EXPECTED VALUE OF CAPITAL SERVICES WHICH IS VK*((1+R)-(1+IK)*(1-D))=VK*R+DVK=GPROF
*THUS THE EXPECTED BALANCING NOMINAL RATE OF RETURN ON THE VALUE OF ASSETS R IS EQUAL TO R=(GPROF-DVK)/VK
*THIS R IS AN EXPECTED R THAT USES AN EXPECTED END OF PERIOD PRICE FOR THE BEGINNING OF THE PERIOD CAPITAL STOCK.
*THIS NEW R WILL BE A SMOOTHED VERSION OF THE ACTUAL EX POST RATE OF RETURN ON ASSETS.  
GENR R=(GPROF-DVK)/VK
FORMAT(F8.0,3F10.3,3F10.5)
PRINT YEAR GPROF VK DVK D IK R / FORMAT
STAT  GPROF VK DVK D IK R
***
*SWITCH THE QUANTITY OF LABOUR FROM NEGATIVE TO POSITIVE
GENR QL=-Y6
GENR PL=P6
GENR VL=PL*QL
*GENERATE AN EX POST USER COST OF CAPITAL PU THAT USES SMOOTHED END OF PERIOD ASSET PRICES:
SMPL 1 59
GENR PU=PK*((1+R)-(1+IK)*(1-D))
*GENR THE VALUE OF CAPITAL SERVICES
GENR VKS=PU*QK
*NORMALIZE THE USER COST
GENR CON=PU(1)
GENR PKS=PU/CON
GENR QKS=VKS/PKS
FORMAT(F8.0,4F11.3,2F10.5)
PRINT YEAR VL QL VKS QKS PL PKS / FORMAT
***
*CONSTRUCT A TORNQVIST-THEIL OUTPUT AGGREGATE. NOTE: SHAZAM CONSTRUCTS A TORNQVIST-THEIL PRICE INDEX 
*OR "DIVISIA" PRICE INDEX DIRECTLY AND CALCULATES THE QUANTITY INDEX IMPLICITLY BY DIVIDING 
*VALUE IN EACH YEAR BY THE PRICE INDEX
SMPL 1 59
INDEX P1 Y1 P2 Y2 P3 Y3 P4 Y4 P5 Y5 / CHAIN DIVISIA=PY QDIVISIA=QY
GENR VY=PY*QY
*TO APPLY THE DIEWERT-MORRISON ECONOMIC JOURNAL (1986) METHODOLOGY, WE NEED TO CONSTRUCT A TORNQVIST-
*THEIL INPUT QUANTITY INDEX AND THEN DEFINE THE CORRESPONDING PRICE INDEX BY DIVIDING THE VALUE
*AGGREGATE BY THE DIRECTLY CONSTRUCTED QUANTITY INDEX. WE CAN USE SHAZAM TO DO THIS BUT WE HAVE TO
*REVERSE THE USUAL ORDER OF ENTERING PRICE AND THEN QUANTITY FOR EACH SERIES AND ENTER QUANTITY FIRST
*AND THEN PRICE FOR EACH QUANTITY
*CONSTRUCT A TORNQVIST INPUT AGGREGATE
INDEX QL PL QKS PKS / CHAIN DIVISIA=QZ QDIVISIA=PZ
*NORMALIZE THE PRICE SERIES TO EQUAL 1 IN OBSERVATION 1
GENR C=PZ(1)
GENR PZ=PZ/C
GENR QZ=QZ*C
GENR VZ=PZ*QZ
*GENR THE SHARE OF LABOUR AND CAPITAL SERVICE AS FRACTIONS OF GDP
GENR SLG=PL*QL/VZ
GENR SKG=PKS*QKS/VZ
*CHECK THAT THE VALUE OF OUTPUT VY IS EQUAL TO THE VALUE OF INPUT VZ
GENR CHECK=VY-VZ
FORMAT(F8.0,2F11.3,3F10.5)
PRINT YEAR VY VZ SLG SKG CHECK / FORMAT
STAT SLG SKG CHECK
*BECAUSE WE GENERATED THE BALANCING R AGAIN, CHECK IS NOW EXACTLY SATISFIED (IT WAS ONLY APPROXIMATELY
*SATISFIED BEFORE BECAUSE OF ROUNDING ERRORS WHEN WE COPIED IN OUR BASIC PRODUCTION DATA.
*WE WILL LATER DEFINE VY AS NET DOMESTIC PRODUCT (RATHER THAN GROSS DOMESTIC PRODUCT, OUR CURRENT DEFINITION)
*SO WE WILL SAVE VY AS VYG FOR LATER USE
GENR VYG=VY
*GENR THE LEVEL OF TOTAL FACTOR PRODUCTIVITY OR MULTIFACTOR PRODUCTIVITY (FOR GDP) AS QY DIVIDED BY QZ
GENR PROD=QY/QZ
FORMAT(F8.0,3F10.5,4F11.3)
PRINT YEAR PROD PY PZ QY QZ VY VZ / FORMAT
*VY IS EXACTLY EQUAL TO VZ FOR EACH OBSERVATION SO OUR DATA ADD UP
*GROSS OUTPUT TOTAL FACTOR PRODUCTIVITY FOR CANADA GREW 1.51 FOLD OVER THE SAMPLE PERIOD WHICH IS NOT GREAT.
*NOTE THAT THE CANADIAN TFP LEVEL PEAKED IN 2005 AT 1.60. THUS FOR THE LAST 13 YEARS, CANADA'S TFP WAS 
*BELOW THIS 2005 PEAK. IT SEEMS THAT THE TFP OF MANY OECD COUNTRIES PEAKED AROUND 2005. WHY IS THIS? 
***
*NOW CALCULATE TFP GROWTH RATES
SMPL 2 59
GENR YG=QY/LAG(QY)
GENR ZG=QZ/LAG(QZ)
GENR PRODG=YG/ZG
FORMAT(F6.0,3F10.5)
PRINT YEAR PRODG YG ZG / FORMAT
STAT PRODG YG ZG
* NAME         N    MEAN        ST. DEV     VARIANCE    MINIMUM      MAXIMUM
* PRODG        58   1.0072     0.16337E-01 0.26691E-03  0.96938       1.0399
* YG           58   1.0307     0.21680E-01 0.47001E-03  0.96537       1.0702
* ZG           58   1.0233     0.11575E-01 0.13398E-03  0.98670       1.0451
*THE (ARITHMETIC) AVERAGE TFP GROWTH RATE IS 0.72% PER YEAR WHICH IS THE SAME RATE WE GOT USING CHAINED FISHER INDEXES
*TO AGGREGATE OUTPUTS AND INPUTS. IT CAN BE SEEN THAT BOTH INDEX NUMBER FORMULAE GIVE ESSENTIALLY THE SAME 
*ANSWERS, AS PREDICTED BY INDEX NUMBER THEORY; I.E., INDEX NUMBER THEORY PREDICTS THAT THE FISHER AND TT INDEXES 
*WILL APPROXIMATE EACH OTHER FAIRLY CLOSELY (IF WE USE ANNUAL DATA WHICH TRENDS FAIRLY SMOOTHLY).
***
*WE WILL NOW IMPLEMENT THE DIEWERT MORRISON KOHLI DECOMPOSITION OF (GROSS) REAL INCOME GROWTH GENERATED BY THE 
*CANADIAN PRODUCTION SECTOR. WE WILL DEFLATE NOMINAL INCOME BY PC=PRICE OF CONSUMPTION.
*WE RELABEL NET OUTPUTS P1-P5 AS PC, PG, PI, PX AND PM. 
*FOR SOURCES OF INCOME, WE HAVE VL AND VKS.
SMPL 1 59
GENR PC=P1
GENR QC=Y1
GENR PG=P2
GENR QG=Y2
GENR PI=P3
GENR QI=Y3 
GENR PX=P4
GENR QX=Y4
GENR PM=P5
GENR QM=Y5
FORMAT(F6.0,7F12.5)
PRINT YEAR PC PG PI PX PM PL PKS / FORMAT
FORMAT(F6.0,7F12.3)
PRINT YEAR QC QG QI QX QM QL QKS / FORMAT
*WE WILL LOOK AT THE (GROSS) INCOME GENERATED BY THE CANADIAN PRODUCTION SECTOR AND DEFLATE IT
*BY THE HOUSEHOLD PRICE OF CONSUMPTION TO GET A REAL (GROSS) INCOME MEASURE. WE WILL LOOK AT 
*GROWTH OF THIS MEASURE OF REAL INCOME AND DECOMPOSE ITS GROWTH INTO EXPLANATORY FACTORS USING 
*THE DIEWERT-MORRISON ECONOMIC JOURNAL METHODOLOGY EXPLAINED IN CHAPTER 8.
***
*WE FIRST NEED TO DEFLATE ALL PRICES BY THE PRICE OF CONSUMPTION
SMPL 1 59
GENR PG=PG/PC
GENR PI=PI/PC
GENR PX=PX/PC
GENR PM=PM/PC
GENR PL=PL/PC
GENR PKS=PKS/PC
GENR PC=1
FORMAT(F6.0,6F12.5)
PRINT YEAR PG PI PX PM PL PKS / FORMAT
*GENR A REAL INCOME AGGREGATE
GENR RI=PC*QC+PG*QG+PI*QI+PX*QX+PM*QM
*GENR LAGGED REAL INCOME
SMPL 2 59
GENR LRI=LAG(RI)
*GENR TRANSLOG PRODUCTIVITY DECOMPOSITION WITH THE VARIOUS LINK FACTORS
*SEE CHAPTER 8, EQUATIONS (97)-(110) 
GENR LPC=LAG(PC)
GENR LQC=LAG(QC)
GENR LPG=LAG(PG)
GENR LQG=LAG(QG)
GENR LPI=LAG(PI)
GENR LQI=LAG(QI)
GENR LPX=LAG(PX)
GENR LQX=LAG(QX)
GENR LPM=LAG(PM)
GENR LQM=LAG(QM)
GENR LPL=LAG(PL)
GENR LQL=LAG(QL)
GENR LPKS=LAG(PKS)
GENR LQKS=LAG(QKS)
GENR RLINK=RI/LAG(RI)
***
*GENR THE OUTPUT PRICE LINK FACTORS
GENR LLPC=(.5*(((PC*QC)/RI)+((LPC*LQC)/LRI))*(LOG(PC/LPC))) 
GENR PCLINK=EXP(LLPC)
GENR LLPG=(.5*(((PG*QG)/RI)+((LPG*LQG)/LRI))*(LOG(PG/LPG))) 
GENR PGLINK=EXP(LLPG)
GENR LLPI=(.5*(((PI*QI)/RI)+((LPI*LQI)/LRI))*(LOG(PI/LPI))) 
GENR PILINK=EXP(LLPI)
GENR LLPX=(.5*(((PX*QX)/RI)+((LPX*LQX)/LRI))*(LOG(PX/LPX))) 
GENR PXLINK=EXP(LLPX)
GENR LLPM=(.5*(((PM*QM)/RI)+((LPM*LQM)/LRI))*(LOG(PM/LPM)))
GENR PMLINK=EXP(LLPM)
*GENR INPUT GROWTH EFFECTS
GENR LLQL=.5*(((PL*QL)/RI)+((LPL*LQL)/LRI))*(LOG(QL/LQL))
GENR QLLINK=EXP(LLQL)
GENR LLQK=.5*(((PKS*QKS)/RI)+((LPKS*LQKS)/LRI))*(LOG(QKS/LQKS))
GENR QKLINK=EXP(LLQK)
*GENR PRODUCTIVITY LINK FACTOR
GENR TLINK=RLINK/(PCLINK*PGLINK*PILINK*PXLINK*PMLINK*QLLINK*QKLINK)
*IT IS USEFUL TO COMBINE THE EFFECTS OF REAL EXPORT AND IMPORT PRICE CHANGES (INTO TRADE PRICE CHANGES) FOR SOME PURPOSES
GENR PTLINK=PXLINK*PMLINK
FORMAT(F6.0,10F10.5)
PRINT YEAR RLINK TLINK PCLINK PGLINK PILINK PXLINK PMLINK QLLINK QKLINK PTLINK / FORMAT
*NOTE: PCLINK SHOULD ALWAYS EQUAL 1
STAT RLINK TLINK PGLINK PILINK PXLINK PMLINK QLLINK QKLINK PTLINK
* NAME         N    MEAN        ST. DEV      VARIANCE     MINIMUM      MAXIMUM
* RLINK        58   1.0346     0.29850E-01 0.89104E-03  0.94294       1.0951
* TLINK        58   1.0072     0.16337E-01 0.26691E-03  0.96938       1.0399
* PGLINK       58   1.0026     0.33346E-02 0.11120E-04  0.99522       1.0117
* PILINK       58  0.99991     0.51382E-02 0.26401E-04  0.98522       1.0109
* PXLINK       58  0.99928     0.11871E-01 0.14093E-03  0.96531       1.0315
* PMLINK       58   1.0019     0.10222E-01 0.10448E-03  0.98183       1.0354
* QLLINK       58   1.0095     0.10764E-01 0.11587E-03  0.97088       1.0299
* QKLINK       58   1.0137     0.40493E-02 0.16397E-04   1.0052       1.0213
* PTLINK       58   1.0011     0.99135E-02 0.98277E-04  0.96822       1.0191
*THUS CANADIAN REAL INCOME GENERATED BY THE ECONOMY GREW AT AN AVERAGE ANNUAL RATE OF 3.46% PER YEAR.
*TOTAL FACTOR PRODUCTIVITY GROWTH, TLINK, CONTRIBUTES 0.72% PER YEAR, THE SAME AS OUR EARLIER RATES
*COMPUTED ABOVE (THE RESULTS NOW SHOULD AGREE WITH OUR EARLIER RESULTS, WHICH IS A CHECK ON OUR COMPUTATIONS).
*OUR RESULTS HERE SHOULD BE CLOSE TO THE FISHER INDEX RESULTS THAT WE CALCULATED IN DATOUT.TXT.
*LOOKING AT THE ABOVE AVERAGES, WE SEE THAT THE AVERAGE RATE OF REAL (GROSS) INCOME GROWTH 
*(THIS IS THE RLINK AVERAGE) IS 1.0346 OR 3.46% PER YEAR. THE FACTORS THAT EXPLAIN THIS GROWTH ARE:
*PRODUCTIVITY GROWTH 0.72% PER YEAR (TLINK), GROWTH OF REAL GOVERNMENT OUTPUT PRICES .26% PER YEAR (PGLINK),
*CHANGE IN REAL INVESTMENT PRICES -.009% PER YEAR (PILINK),
*CHANGE IN REAL EXPORT PRICES -.07% PER YEAR (PXLINK) (THUS EXPORT PRICES DO NOT GROW AS FAST AS THE PRICE OF C)
*CHANGE IN REAL IMPORT PRICES .19% PER YEAR (PMLINK),(THUS IMPORT PRICES GROW SLOWER THAN THE PRICE OF C)
*GROWTH IN LABOUR INPUT 0.95% PER YEAR (QLLINK) AND GROWTH IN (GROSS) CAPITAL INPUT 1.37% PER YEAR (QKLINK).
*IF WE COMBINE THE EFFECTS OF CHANGES IN IMPORT AND EXPORT PRICES, THEN CHANGES IN THE REAL TERMS 
*OF TRADE CONTRIBUTED 0.11% PER YEAR TO THE GROWTH IN REAL INCOME. (THE EFFECTS OF TERMS OF TRADE IMPROVEMENTS 
*IN THE FIRST DECADE OF THE PRESENT CENTURY WERE MUCH BIGGER AS WE SHALL SEE).
***
*LOOK AT THE GROWTH DECOMPOSITION BY DECADE
SMPL 2 10
*1960s RESULTS
STAT RLINK TLINK PGLINK PILINK PXLINK PMLINK QLLINK QKLINK PTLINK
SMPL 11 20
*1970s RESULTS
STAT RLINK TLINK PGLINK PILINK PXLINK PMLINK QLLINK QKLINK PTLINK
SMPL 21 30
*1980s RESULTS
STAT RLINK TLINK PGLINK PILINK PXLINK PMLINK QLLINK QKLINK PTLINK
SMPL 31 40
*1990s RESULTS
STAT RLINK TLINK PGLINK PILINK PXLINK PMLINK QLLINK QKLINK PTLINK
SMPL 41 50
*NAUGHTS RESULTS
STAT RLINK TLINK PGLINK PILINK PXLINK PMLINK QLLINK QKLINK PTLINK
*THE TEENS RESULTS
SMPL 51 59
STAT RLINK TLINK PGLINK PILINK PXLINK PMLINK QLLINK QKLINK PTLINK
*YOU CAN SEE THAT THIS DMK GROWTH DECOMPOSITION IS A PRETTY USEFUL TOOL TO ANALYZE THE ECONOMY.
***
*DO A KOHLI TYPE DECOMPOSITION OF REAL INCOME INTO MULTIPLICATIVE EFFECTS
SMPL 1 59
GENR RIL=1
GENR TFP=1
GENR CC=1
GENR GG=1
GENR II=1
GENR XX=1
GENR MM=1
GENR TT=1
GENR LL=1
GENR KK=1
SMPL 2 59
GENR RIL=LAG(RIL)*RLINK
GENR TFP=LAG(TFP)*TLINK
GENR CC=LAG(CC)*PCLINK
GENR GG=LAG(GG)*PGLINK
GENR II=LAG(II)*PILINK
GENR XX=LAG(XX)*PXLINK
GENR MM=LAG(MM)*PMLINK
GENR TT=LAG(TT)*PTLINK 
GENR LL=LAG(LL)*QLLINK
GENR KK=LAG(KK)*QKLINK
SMPL 1 59
FORMAT(F8.0,10F10.5)
PRINT YEAR RIL TFP CC GG II XX MM LL KK TT / FORMAT
*YEAR       RIL      TFP        CC       GG          II       XX        MM        LL        KK        TT 
*2018.   7.00461   1.50743   1.00000   1.16210   0.99379   0.95543   1.11010   1.72155   2.20358   1.06063
*NOTE THAT CANADIAN REAL (GROSS) INCOME GREW 7.00 FOLD OVER THE 59 YEAR PERIOD, WHICH IS NOT BAD.
*LOOKING AT THE LAST COLUMN IN THE ABOVE TABLE, IT CAN BE SEEN THAT THE OVERALL
*EFFECTS OF REAL CHANGES IN THE PRICES OF CANADIAN IMPORTS AND EXPORTS ARE FAIRLY SMALL (GROWTH FACTOR FOR 2018 IS 1.06)
*THE BIGGEST GROWTH FACTOR IS DUE TO CAPITAL ACCUMULATION (2.20),THEN LABOUR INPUT GROWTH (1.72) FOLLOWED BY
*TFP GROWTH (1.51) FOLLOWED BY INCREASES IN REAL GOVERNMENT OUTPUT PRICES (1.16).
*REAL DECREASES IN INVESTMENT PRICES ENDED UP WITH A GROWTH FACTOR LESS THAN 1 (.994) AS DID THE GROWTH IN EXPORT
*PRICES (.955). THE DECLINE IN REAL EXPORT PRICES WAS OFFSET BY A COMPANION DECLINE IN REAL IMPORT PRICES WHICH ENDED 
*UP WITH A GROWTH FACTOR OF 1.11. THE COMBINED EFFECTS OF CHANGES IN EXPORT AND IMPORT PRICES LED TO AN OVERALL
*GROWTH OF REAL INCOME FACTOR EQUAL TO 1.06, WHICH IS A SMALL EFFECT OVER 59 YEARS.
*RIL SHOULD EQUAL TFP*CC*GG*II*XX*MM*LL*KK
GENR CHK=TFP*CC*GG*II*XX*MM*LL*KK-RIL
STAT CHK
*THE CHECK IS OK (IT SHOULD BE EQUAL TO O); ALL ENTRIES FOR CHECK ARE ESSENTIALLY 0 (EXCEPT FOR ROUNDING ERRORS)
***
*READ IN THE POPULATION OF CANADA FROM DATOUT.TXT
SMPL 1 59
READ YEAR POP
 1960.        18106.8
 1961.        18497.9
 1962.        18866.7
 1963.        19218.4
 1964.        19564.0
 1965.        19912.7
 1966.        20264.4
 1967.        20617.1
 1968.        20970.8
 1969.        21325.5
 1970.        21680.2
 1971.        21962.0
 1972.        22218.5
 1973.        22491.8
 1974.        22808.0
 1975.        23143.3
 1976.        23449.8
 1977.        23725.8
 1978.        23963.2
 1979.        24201.5
 1980.        24515.7
 1981.        24819.9
 1982.        25116.9
 1983.        25366.5
 1984.        25607.1
 1985.        25842.1
 1986.        26100.3
 1987.        26446.6
 1988.        26791.7
 1989.        27276.8
 1990.        27691.1
 1991.        28037.4
 1992.        28371.3
 1993.        28684.8
 1994.        29000.7
 1995.        29302.3
 1996.        29610.2
 1997.        29905.9
 1998.        30155.2
 1999.        30401.3
 2000.        30685.7
 2001.        31020.6
 2002.        31358.4
 2003.        31641.6
 2004.        31938.0
 2005.        32242.4
 2006.        32570.5
 2007.        32887.9
 2008.        33245.8
 2009.        33628.6
 2010.        34005.3
 2011.        34342.8
 2012.        34750.5
 2013.        35152.4
 2014.        35535.3
 2015.        35702.9
 2016.        36109.5
 2017.        36540.3
 2018.        37058.9
FORMAT(F6.0,F15.1)
PRINT YEAR POP / FORMAT 
*NORMALIZE POP TO EQUAL 1 IN 1960
GENR CON=POP(1)
GENR POP=POP/CON
*GENR NORMALIZED PER CAPITA (GROSS) REAL INCOME GROWTH
GENR RIPERPOP=RIL/POP
FORMAT(F6.0,F12.5)
PRINT YEAR RIPERPOP / FORMAT
*THUS PER POP GROSS REAL INCOME INCREASED 3.42 FOLD IN CANADA OVER THE 59 YEAR PERIOD. THIS IS OK BUT NOT AS 
*LARGE AS THE CORRESPONDING INCREASE FOR MANY EUROPEAN COUNTRIES WITH LOW POPULATION GROWTH. IT IS ALSO NOT
*AS LARGE AS THE CORRESPONDING US INCREASE DUE TO THE SUPERIOR PRODUCTIVITY PERFORMANCE OF THE US.
*NOTE ALSO THAT PER POP GROSS REAL INCOME PEAKED IN 2018 AT 3.42 TIMES THE LEVEL AT 1960.
***
*WE NOW IMPLEMENT THE DMK NET PRODUCT MODEL
*THE PROBLEM WITH ALL OF THE ABOVE ANALYSIS IS THAT IT OVERSTATES REAL INCOME. WE CAN CONSUME THE AMOUNT
*OF MONEY SET ASIDE FOR DEPRECIATION IN THE SHORT RUN, BUT THIS IS NOT SUSTAINABLE IN THE LONG RUN.
*THUS WE NOW REDO THE ABOVE ANALYSIS USING NET REAL INCOME INSTEAD OF GROSS REAL INCOME
*THE SAME METHODOLOGY (AND PROGRAMS) CAN BE USED; ALL WE NEED TO DO IS TAKE DEPRECIATION OUT OF 
*THE USER COST OF CAPITAL AND TREAT IT AS A NEGATIVE OUTPUT. WE WILL ALSO FOLLOW HAYEK AND TAKE A MAINTENANCE
*OF REAL FINANCIAL CAPITAL POINT OF VIEW (INSTEAD OF THE VIEW OF PIGOU WHO TOOK A MAINTENANCE OF REAL 
*PHYSICAL CAPITAL POINT OF VIEW TO THE MEASUREMENT OF INCOME) AND TREAT REAL ASSET PRICE APPRECIATION 
*AS A CONTRIBUTOR TO REAL INCOME GROWTH, JUST AS WE TREAT THE GROWTH OF REAL WAGES AS A CONTRIBUTOR TO
*REAL INCOME GROWTH. 
*THE EXPORTS, IMPORTS AND LABOUR VARIABLES REMAIN UNCHANGED. WE JUST HAVE TO REDEFINE CAPITAL SERVICES AS
*WAITING SERVICES (FOLLOWING RYMES) AND DEFINE A NEW DOMESTIC OUTPUT AGGREGATE (THAT TREATS DEPRECIATION AS A 
*NEGATIVE OUTPUT AND ASSET PRICE APPRECIATION AS A POSITIVE OUTPUT).
*RECALL THAT THE USER COST THAT WE USED IN THE GROSS INCOME MODEL ABOVE WAS EQUAL TO PK*((1+R)-(1-D)*(1+IK))
*WHICH CAN BE DECOMPOSED INTO PK*R + PK*D - PK*(1-D)*IK. THE FIRST TERM, PK*R, IS WAITING SERVICES AND THIS
*TERM IS A CONTRIBUTOR TO INCOME. THE SECOND TERM IS PK*D AND THIS IS DEPRECIATION AND SHOULD BE TAKEN OUT
*OF INCOME AND TREATED AS A NEGATIVE OUTPUT. THE THIRD TERM, - PK*(1-D)*IK, IS MINUS THE VALUE OF ASSET 
*APPRECIATION. IF PK*(1-D)*IK IS POSITIVE, THIS TERM SHOULD BE ADDED TO THE VALUE OF GROSS INVESTMENT; IF THIS TERM 
*IS NEGATIVE, THEN IT SHOULD BE TREATED AS AN OBSOLESCENCE CHARGE AND SUBTRACTED FROM THE VALUE OF GROSS INVESTMENT.
*THUS OUR NEW CONTRIBUTION OF CAPITAL SERVICES TO NOMINAL INCOME WILL JUST BOIL DOWN TO THE TERM PK*R; THE REMAINING 
*TERMS WILL BE SHIFTED FROM THE PRIMARY INPUT CLASSIFICATION TO AN OUTPUT CLASSIFICATION, WITH A CHANGE IN SIGN.
*THUS OUR NEW DOMESTIC NET INVESTMENT AGGREGATE WILL BE EQUAL TO PI*QI - PK*D*QK + PK*(1-D)*IK*QK WHERE PI*QI IS
*OUR OLD GROSS INVESTMENT. OUR NEW CONTRIBUTION OF CAPITAL SERVICES TO NOMINAL INCOME WILL BE R*PK*QK.
*THE NEW TERM THAT IS AN ADDITION TO NET OUTPUT IS PK*(1-D)*IK*QK. WE COULD TAKE THE PRICE OF THIS VALUE TERM
*TO BE PK*(1-D)*IK AND THE CORRESPONDING QUANTITY TO BE THE BEGINNING OF THE PERIOD CAPITAL STOCK, QK.
*HOWEVER, THERE IS A PROBLEM WITH THIS TREATMENT: IK CAN BE POSITIVE OR NEGATIVE AND INDEX NUMBER THEORY
*IS NOT VALID WHEN A PRICE CAN BE OF EITHER SIGN. THUS WE NEED TO SPLIT UP THE TERM PK*(1-D)*IK*QK
*INTO TWO TERMS; ONE INVOLVES THE BEGINNING OF THE PERIOD CAPITAL STOCK AND THE OTHER INVOLVES THE 
*DEPRECIATED END OF PERIOD CAPITAL STOCK (EXCLUDING NEW INVESTMENT). RECALL THAT THE USUAL USER COST 
*OF CAPITAL IS EQUAL TO PK*(1+R)-(1-D)*(1+IK)*PK. THUS THE ANTI-DISCOUNTED VALUE OF THE BEGINNING 
*OF THE PERIOD CAPITAL STOCK IS PK*(1+R)*QK AND ITS VALUE AT THE END OF THE PERIOD IS PK*(1+IK)*(1-D)*QK.
*RECALL 1+IK=PK(t+1)/PK(t). THUS THE TERM PK(t)*(1+IK)*(1-D)*QK(t) = PK(t+1)*(1-D)*QK(t). THUS THE USUAL
*USER COST VALUE OF CAPITAL SERVICES, (PK*(1+R)-(1-D)*(1+IK)*PK)*QK = PK*R*QK + PK*QK - PK(t+1)*(1-D)*QK(t).
*WE WILL LEAVE THE WAITING SERVICES TERM PK*R*QK AS AN INCOME SOURCE BUT TRANSFER THE LAST TWO TERMS,
*PK*QK - PK(t+1)*(1-D)*QK(t), OVER TO THE OUTPUT SIDE OF THE ECONOMIC ACCOUNTS AFTER CHANGING THEIR SIGNS.
*THUS MINUS THE VALUE OF THE STARTING CAPITAL STOCK, -PK*QK, IS TREATED AS AN INTERMEDIATE INPUT (LIKE IMPORTS)
*AND THE DEPRECIATED VALUE OF THE STARTING CAPITAL STOCK,PK(t+1)*(1-D)*QK(t), IS TREATED AS A NET OUTPUT.
*THUS OUR NEW OUTPUT AGGREGATE IS VY - PK*QK + PK(t+1)*(1-D)*QK(t) WHICH FOLLOWS THE HICK AND EDWARDS
*AND BELL TREATMENT OF INCOME. THE PRICE OF THE LAST TERM IS TAKEN TO BE PK(t+1)=PK(t)*(1+IK) AND THE 
*CORRESPONDING QUANTITY IS TAKEN TO BE (1-D)*QK(t).        
SMPL 1 59
*GENR THE PRICE AND QUANTITY OF CAPITAL WAITING SERVICES
GENR PKW=PK*R
GENR QKW=QK
GENR VKW=PKW*QKW
*THE PRICE AND QUANTITY OF THE STARTING CAPITAL STOCK, PK AND QK HAVE ALREADY BEEN GENERATED
*GENR THE PRICE AND QUANTITY OF THE END OF PERIOD CAPITAL STOCK. HOWEVER, SINCE WE TREAT THE BEGINNING OF THE 
*PERIOD CAPITAL STOCK AS AN INPUT, WE NEED TO CHANGE THE SIGN OF THE QUANTITY (LIKE IMPORTS).THUS GENR THE
*PRICE PKB AND QUANTITY QKB OF THE BEGINNING OF THE PERIOD CAPITAL STOCKS:
GENR PKB=PK
GENR QKB=-QK
GENR VKB=PKB*QKB
*GENR THE PRICE AND QUANTITY OF THE END OF PERIOD CAPITAL STOCKS:
GENR PKE=PK*(1+IK)
GENR QKE=(1-D)*QK
GENR VKE=PKE*QKE
FORMAT(F8.0,3F10.5,6F10.3)
PRINT YEAR PKW PKB PKE QKW QKB QKE VKW VKB VKE / FORMAT
*ALL 3 PRICES ARE ALWAYS POSITIVE WHICH IS WHAT WE WANTED TO ACHIEVE. 
*NORMALIZE THE PRICES TO EQUAL 1 IN THE BASE PERIOD
*PKB IS ALREADY NORMALIZED
GENR CON=PKW(1)
GENR PKW=PKW/CON
GENR QKW=CON*QKW
GENR CON=PKE(1)
GENR PKE=PKE/CON
GENR QKE=CON*QKE
GENR CHECK=VY+VKB+VKE-VL-VKW
*CHECK SHOULD BE EQUAL TO 0
FORMAT(F8.0,3F10.5,7F10.3,F10.5)
PRINT YEAR PKW PKB PKE QKW QKB QKE VKW VKB VKE VL CHECK / FORMAT
STAT PKW PKB PKE QKW QKB QKE VKW VKB VKE VL CHECK 
* NAME         N    MEAN        ST. DEV     VARIANCE     MINIMUM      MAXIMUM
* PKW          59   6.7793      3.3853      11.460       1.0000       12.567
* PKB          59   3.8100      1.9449      3.7826      0.99259       7.2003
* PKE          59   3.9485      1.9765      3.9067       1.0000       7.3617
* QKW          59   26.256      14.263      203.42       8.1321       58.325
* QKB          59  -333.69      181.27      32857.      -741.27      -103.35
* QKE          59   306.20      166.05      27572.       96.174       685.51
* VKW          59   220.15      189.96      36083.       8.1321       600.34
* VKB          59  -1604.3      1459.2     0.21294E+07  -5337.4      -103.35
* VKE          59   1518.6      1375.5     0.18920E+07   96.174       5046.5
* VL           59   427.54      357.02     0.12746E+06   22.839       1180.4
* CHECK        59 -0.21015E-13 0.20275E-12 0.41106E-25 -0.90949E-12  0.45475E-12
*CHECK IS SATISFIED; CHECK SHOULD EQUAL 0.
*NOTE THAT VKB AND VKE ARE MUCH BIGGER IN MAGNITUDE THAN WAITING SERVICES VKW. HOWEVER, THE NET EFFECT 
*OF VKB AND VKE IS RELATIVELY SMALL. THE NET EFFECT IS THE NEGATIVE OF AUGMENTED DEPRECIATION WHERE 
*AUGMENTED DEPRECIATION IS EQUAL TO THE VALUE OF DEPRECIATION LESS (EXPECTED) CAPITAL GAINS.
*IF THERE ARE CAPITAL LOSSES (SO IK IS NEGATIVE), THEN THE NEGATIVE CAPITAL GAINS CORRESPOND TO AN OBSOLESCENCE CHARGE.
***
*GENR NEW NET OUTPUT AND PRIMARY INPUT AGGREGATES.
*OUR NEW NET PRODUCT INPUT AGGREGATE IS EQUAL TO VL PLUS VKW; LABOUR SERVICES PLUS WAITING SERVICES
*WE NORMALIZE THIS INCOME BY DIVIDING IT BY P1
*PL IS ALREADY NORMALIZED. WE NEED TO NORMALIZE WAITING SERVICES
GENR PKW=PKW/P1
*GENR NET DOMESTIC PRODUCT FROM THE INCOME SIDE (TORNQVIST-THEIL DIRECT QUANTITY INDEX)
INDEX QL PL QKW PKW / CHAIN DIVISIA=QZ QDIVISIA=PZ
GENR VZ=PZ*QZ
*NORMALIZE THE AGGREGATE NET PRODUCT INPUT PRICE (AND THE CORRESPONDING INPUT QUANTITY)
GENR C=PZ(1)
GENR PZ=PZ/C
GENR QZ=QZ*C
*GENR A NEW NET PRODUCT OUTPUT PRICE AND QUANTITY AGGREGATE
*THE NEW OUTPUT AGGREGATE IS EQUAL TO THE VALUE OF C+G+I+X-M+VKB+VKE DIVIDED BY P1 (THE PRICE OF CONSUMPTION)
*PC, PG, PI, PX AND PM ARE ALREADY NORMALIZED. WE NEED TO NORMALIZE PKB AND PGKE
GENR PKB=PKB/P1
GENR PKE=PKE/P1
*GENR REAL NET OUTPUT USING THE TORNQVIST THEIL PRICE INDEX
INDEX PC QC PG QG PI QI PX QX PM QM PKB QKB PKE QKE / CHAIN DIVISIA=PY QDIVISIA=QY
GENR VY=PY*QY
GENR CHECK=VY-VZ
STAT CHECK
*CHECK IS 0 SO CHECK IS SATISFIED; THE REAL VALUE OF OUTPUT EQUALS THE REAL VALUE OF PRIMARY INPUT.
*GENR NET PRODUCTIVITY LEVELS FOR CANADA
GENR NPROD=QY/QZ
FORMAT(F8.0,4F10.3,3F10.5)
PRINT YEAR VY VZ QY QZ PY PZ NPROD / FORMAT
*CANADA'S NET TFP ENDED UP AT 1.56 IN 2018; NOT MUCH CHANGE FROM THE GROSS PRODUCTIVITY RESULTS!
*THE PEAK OF NET TFP WAS 1.594 IN 2005; SAME PEAK AS THE GROSS TFP PEAK. NOT A VERY GOOD
*PERFORMANCE FOR CANADA IN THE LAST 13 YEARS.
*FOR MOST OECD COUNTRIES, NET TPF GROWTH WILL BE HIGHER THAN THE CORRESPONDING GROSS TFP GROWTH.
*THE HIGHER THE GROSS RATE OF TFP GROWTH, THE HIGHER WILL BE THIS MAGNIFICATION EFFECT. 
***
*CALCULATE NEW LABOUR AND CAPITAL SHARES OF NET INCOME AND COMPARE THEM TO OUR PREVIOUS GROSS SHARES.
*GENR THE NEW LABOUR SHARE SLN AND THE NEW WAITING SERVICES OR CAPITAL SHARE SKN
GENR SLN=PL*QL/VZ
GENR SKN=PKW*QKW/VZ
GENR CHECK=1-SLN-SKN
FORMAT(F8.0,5F10.5)
PRINT YEAR SLN SLG SKN SKG  CHECK / FORMAT
STAT SLN SLG SKN SKG  CHECK
* NAME         N    MEAN        ST. DEV     VARIANCE    MINIMUM      MAXIMUM
* SLN          59  0.65993     0.37608E-01 0.14143E-02  0.57448      0.74269
* SLG          59  0.59820     0.22470E-01 0.50492E-03  0.55962      0.63354
* SKN          59  0.34007     0.37608E-01 0.14143E-02  0.25731      0.42552
* SKG          59  0.40180     0.22470E-01 0.50492E-03  0.36646      0.44038
* CHECK        59  0.18817E-17 0.81144E-16 0.65844E-32 -0.22204E-15  0.22204E-15
*THE ABOVE RESULTS ARE VERY INTERESTING. THERE IS A LOT OF CONCERN AMONG ECONOMISTS ABOUT THE DECLINING SHARE OF 
*LABOUR INCOME AS A SHARE OF GDP. BUT DEPRECIATION IS NOT INCOME! THEREFORE, ECONOMISTS SHOULD BE USING THE 
*SHARE OF NET INCOME AS THE INDICATOR ON THE POSSIBLE DECLINE OF LABOUR'S SHARE OF THE ECONOMIC INCOME PIE.
*THE RESULTS FOR CANADA SHOW THAT LABOUR'S SHARE OF NET INCOME HAS NOT DECLINED SINCE 1965 AND ON AVERAGE
*LABOUR'S SHARE OF NET INCOME IS SUBSTANTIALLY HIGHER ON AVERAGE THAN LABOUR'S SHARE OF GROSS INCOME.
*THIS RESULT MAKES SENSE; OVER TIME, THERE HAS BEEN A SHIFT IN INVESTMENT TO MACHINERY AND EQUIPMENT OVER
*INVESTMENT IN STRUCTURES. THE DEPRECIATION RATE FOR M&E (PARTICULARLY FOR COMPUTERS) ARE SUBSTANTIALLY
*HIGHER THAN THE DEPRECIATION RATE FOR STRUCTURES. THUS OVER TIME, DEPRECIATION (AND OBSOLESCENCE) RATES
*HAVE INCREASED SUBSTANTIALLY AND THUS GROSS OUTPUT HAS GROWN FASTER THAN NET OUTPUT.
*WHAT ARE THE RESULTS FOR YOUR COUNTRY?
***
*NOW CALCULATE (NET DOMESTIC PRODUCT) TFP GROWTH RATES
SMPL 2 59
GENR YG=QY/LAG(QY)
GENR ZG=QZ/LAG(QZ)
GENR PRODG=YG/ZG
FORMAT(F6.0,3F10.5)
PRINT YEAR PRODG YG ZG / FORMAT
STAT PRODG YG ZG
* NAME         N    MEAN        ST. DEV      VARIANCE   MINIMUM      MAXIMUM
* PRODG        58   1.0078     0.16833E-01 0.28334E-03  0.96828       1.0419
* YG           58   1.0303     0.23153E-01 0.53607E-03  0.95801       1.0761
* ZG           58   1.0223     0.12498E-01 0.15619E-03  0.98552       1.0449
*THUS THE NEW (ARITHMETIC) AVERAGE RATE OF TFP GROWTH FOR NET PRODUCT IS 0.78% PER YEAR, AS COMPARED
*TO OUR GROSS PRODUCT AVERAGE RATE OF TFP GROWTH OF 0.72% PER YEAR. THUS MOVING FROM A GROSS PRODUCT
*FRAMEWORK FOR MEASURING TFP GROWTH TO A NET PRODUCT FRAMEWORK WILL GENERALLY MAGNIFY THE EFFECTS OF
*TFP GROWTH. FOR MOST COUNTRIES, THE MAGNIFICATION EFFECT WILL BE MUCH LARGER THAN CANADA'S EFFECT.
***
*WE WILL NOW IMPLEMENT THE DMK PRODUCTIVITY DECOMPOSITION FOR THE NET INCOME MODEL
*GENR A REAL INCOME AGGREGATE FROM THE OUTPUT SIDE
SMPL 1 59
GENR RI=PC*QC+PG*QG+PI*QI+PX*QX+PM*QM+PKB*QKB+PKE*QKE
GENR CHECK=RI-PL*QL-PKW*QKW
STAT CHECK
*CHECK SHOULD BE EQUAL TO 0 FOR EACH OBSERVATION AND THIS IS THE CASE EXCEPT FOR ROUNDING ERROR.
*GENR LAGGED REAL INCOME
SMPL 2 59
GENR LRI=LAG(RI)
*GENR TRANSLOG PRODUCTIVITY DECOMPOSITION WITH THE VARIOUS LINK FACTORS
*SEE CHAPTER 8, EQUATIONS (97)-(110) 
GENR LPC=LAG(PC)
GENR LQC=LAG(QC)
GENR LPG=LAG(PG)
GENR LQG=LAG(QG)
GENR LPI=LAG(PI)
GENR LQI=LAG(QI)
GENR LPX=LAG(PX)
GENR LQX=LAG(QX)
GENR LPM=LAG(PM)
GENR LQM=LAG(QM)
GENR LPKB=LAG(PKB)
GENR LQKB=LAG(QKB)
GENR LPKE=LAG(PKE)
GENR LQKE=LAG(QKE)
GENR LPL=LAG(PL)
GENR LQL=LAG(QL)
GENR LPKW=LAG(PKW)
GENR LQKW=LAG(QKW)
GENR RLINK=RI/LAG(RI)
*GENR THE OUTPUT PRICE LINK FACTORS
GENR LLPC=(.5*(((PC*QC)/RI)+((LPC*LQC)/LRI))*(LOG(PC/LPC))) 
GENR PCLINK=EXP(LLPC)
GENR LLPG=(.5*(((PG*QG)/RI)+((LPG*LQG)/LRI))*(LOG(PG/LPG))) 
GENR PGLINK=EXP(LLPG)
GENR LLPI=(.5*(((PI*QI)/RI)+((LPI*LQI)/LRI))*(LOG(PI/LPI))) 
GENR PILINK=EXP(LLPI)
GENR LLPX=(.5*(((PX*QX)/RI)+((LPX*LQX)/LRI))*(LOG(PX/LPX))) 
GENR PXLINK=EXP(LLPX)
GENR LLPM=(.5*(((PM*QM)/RI)+((LPM*LQM)/LRI))*(LOG(PM/LPM)))
GENR PMLINK=EXP(LLPM)
GENR LLPKB=(.5*(((PKB*QKB)/RI)+((LPKB*LQKB)/LRI))*(LOG(PKB/LPKB)))
GENR PKBLINK=EXP(LLPKB)
GENR LLPKE=(.5*(((PKE*QKE)/RI)+((LPKE*LQKE)/LRI))*(LOG(PKE/LPKE)))
GENR PKELINK=EXP(LLPKE)
*GENR INPUT GROWTH EFFECTS
GENR LLQL=.5*(((PL*QL)/RI)+((LPL*LQL)/LRI))*(LOG(QL/LQL))
GENR QLLINK=EXP(LLQL)
GENR LLQKW=.5*(((PKW*QKW)/RI)+((LPKW*LQKW)/LRI))*(LOG(QKW/LQKW))
GENR QKWLINK=EXP(LLQKW)
*GENR PRODUCTIVITY LINK FACTOR
GENR TLINK=RLINK/(PCLINK*PGLINK*PILINK*PXLINK*PMLINK*PKBLINK*PKELINK*QLLINK*QKWLINK)
*IT IS USEFUL TO COMBINE THE EFFECTS OF REAL EXPORT AND IMPORT PRICE CHANGE FOR SOME PURPOSES
GENR PTLINK=PXLINK*PMLINK
*IT IS ALSO USEFUL COMBINE THE PRICE EFFECTS OF REAL PRICE CHANGES IN THE BEGINNING AND END OF PERIOD CAPITAL STOCKS
*THESE TWO EFFECTS LARGELY OFFSET EACH OTHER SO IT IS USEFUL TO LOOK AT THE NET EFFECTS OF THESE TWO EFFECTS
GENR PKNLINK=PKBLINK*PKELINK
FORMAT(F6.0,13F9.5)
PRINT YEAR RLINK TLINK PCLINK PGLINK PILINK PXLINK PMLINK PKBLINK PKELINK QLLINK QKWLINK PTLINK PKNLINK / FORMAT
*NOTE: PCLINK SHOULD ALWAYS EQUAL 1
STAT RLINK TLINK PCLINK PGLINK PILINK PXLINK PMLINK PKBLINK PKELINK QLLINK QKWLINK PTLINK PKNLINK
* NAME         N    MEAN        ST. DEV      VARIANCE     MINIMUM      MAXIMUM
* RLINK        58   1.0361     0.45282E-01 0.20505E-02  0.90956       1.1470
* TLINK        58   1.0078     0.16833E-01 0.28334E-03  0.96828       1.0419
* PCLINK       58   1.0000      0.0000      0.0000       1.0000       1.0000
* PGLINK       58   1.0028     0.35293E-02 0.12456E-04  0.99491       1.0111
* PILINK       58  0.99987     0.55298E-02 0.30579E-04  0.98270       1.0114
* PXLINK       58  0.99904     0.12971E-01 0.16825E-03  0.96072       1.0300
* PMLINK       58   1.0022     0.11322E-01 0.12819E-03  0.98101       1.0410
* PKBLINK      58   1.0037     0.41411E-01 0.17148E-02  0.91700       1.1014
* PKELINK      58  0.99934     0.44252E-01 0.19583E-02  0.89825       1.1001
* QLLINK       58   1.0103     0.11528E-01 0.13290E-03  0.97034       1.0288
* QKWLINK      58   1.0119     0.43285E-02 0.18736E-04   1.0038       1.0214
* PTLINK       58   1.0011     0.11077E-01 0.12271E-03  0.96402       1.0223
* PKNLINK      58   1.0014     0.19509E-01 0.38059E-03  0.95844       1.0512
*THUS CANADIAN REAL NET INCOME GENERATED BY THE ECONOMY GREW AT AN AVERAGE ANNUAL RATE OF 3.61% PER YEAR, HIGHER
*THAN THE 3.46% PER YEAR GROWTH RATE FOR GROSS INCOME. (BUT NOT BY THAT MUCH--THE DIFFERENCE WILL BE LARGER FOR MANY COUNTRIES) 
*TOTAL FACTOR PRODUCTIVITY GROWTH, TLINK, CONTRIBUTED 0.78% PER YEAR. NOTE THAT TFP GROSS INCOME GROWTH AVERAGED .72% 
*PER YEAR. IT IS TYPICAL FOR NET TFP GROWTH TO EXCEED GROSS OUTPUT TFP GROWTH; THERE IS A MAGNIFICATION EFFECT. 
*LOOKING AT THE ABOVE AVERAGES, WE SEE THAT THE GROWTH OF REAL GOVERNMENT OUTPUT PRICES CONTRIBUTED .28% PER YEAR (PGLINK),
*CHANGE IN REAL INVESTMENT PRICES CONTRIBUTED ESSENTIALLY 0% PER YEAR (PILINK),
*CHANGE IN REAL EXPORT PRICES -.013% PER YEAR (PXLINK) (THUS EXPORT PRICES DO NOT GROW AS FAST AS THE PRICE OF C)
*CHANGE IN REAL IMPORT PRICES .22% PER YEAR (PMLINK),(THUS IMPORT PRICES GREW SLOWER THAN THE PRICE OF C)
*CHANGES IN THE PRICE OF THE BEGINNING OF THE PERIOD CAPITAL STOCK CONTRIBUTED .37% PER YEAR
*CHANGES IN THE PRICE OF THE END OF THE PERIOD CAPITAL STOCK CONTRIBUTED -.064% PER YEAR
*THE NET CHANGES IN THE PRICES OF BEGINNING AND END OF PERIOD CAPITAL STOCKS CONTRIBUTED .14 % PER YEAR
*GROWTH IN LABOUR INPUT CONTRIBUTED 1.03% PER YEAR (QLLINK) AND GROWTH IN WAITING SERVICES 1.19% PER YEAR (QKWLINK).
*IF WE COMBINE THE EFFECTS OF CHANGES IN IMPORT AND EXPORT PRICES, THEN CHANGES IN THE REAL TERMS 
*OF TRADE CONTRIBUTED 0.11% PER YEAR TO THE GROWTH IN REAL INCOME.
*LOOK AT THE GROWTH DECOMPOSITION BY DECADE
SMPL 2 10
*1960s RESULTS
STAT RLINK TLINK PGLINK PILINK PXLINK PMLINK PKNLINK QLLINK QKLINK PTLINK
SMPL 11 20
*1970s RESULTS
STAT RLINK TLINK PGLINK PILINK PXLINK PMLINK PKNLINK QLLINK QKLINK PTLINK
SMPL 21 30
*1980s RESULTS
STAT RLINK TLINK PGLINK PILINK PXLINK PMLINK PKNLINK QLLINK QKLINK PTLINK
SMPL 31 40
*1990s RESULTS
STAT RLINK TLINK PGLINK PILINK PXLINK PMLINK PKNLINK QLLINK QKLINK PTLINK
SMPL 41 50
*NAUGHTS RESULTS
STAT RLINK TLINK PGLINK PILINK PXLINK PMLINK PKNLINK QLLINK QKLINK PTLINK
*THE TEENS RESULTS
SMPL 51 59
STAT RLINK TLINK PGLINK PILINK PXLINK PMLINK PKNLINK QLLINK QKLINK PTLINK
***
*WE CAN DO A KOHLI TYPE DECOMPOSITION OF REAL INCOME INTO MULTIPLICATIVE EFFECTS
SMPL 1 59
GENR RIL=1
GENR TFP=1
GENR CC=1
GENR GG=1
GENR II=1
GENR XX=1
GENR MM=1
GENR KB=1
GENR KE=1
GENR PT=1
GENR KN=1
GENR LL=1
GENR KW=1
SMPL 2 59
GENR RIL=LAG(RIL)*RLINK
GENR TFP=LAG(TFP)*TLINK
GENR CC=LAG(CC)*PCLINK
GENR GG=LAG(GG)*PGLINK
GENR II=LAG(II)*PILINK
GENR XX=LAG(XX)*PXLINK
GENR MM=LAG(MM)*PMLINK
GENR PT=LAG(PT)*PTLINK 
GENR KB=LAG(KB)*PKBLINK
GENR KE=LAG(KE)*PKELINK
GENR KN=LAG(KN)*PKNLINK 
GENR LL=LAG(LL)*QLLINK
GENR KW=LAG(KW)*QKWLINK
SMPL 1 59
FORMAT(F8.0,13F8.4)
PRINT YEAR RIL TFP CC GG II XX MM PT KB KE KN LL KW / FORMAT
*   YEAR     RIL    TFP      CC      GG     II       XX     MM      PT       KB      KE      KN      LL      KW
*   1960.  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000
*   1961.  1.0638  1.0093  1.0000  1.0082  0.9990  1.0043  0.9928  0.9971  0.9866  1.0437  1.0298  1.0105  1.0087
*   1962.  1.1773  1.0483  1.0000  1.0132  0.9994  1.0117  0.9832  0.9948  1.0269  1.0346  1.0624  1.0328  1.0161
*   1963.  1.2787  1.0773  1.0000  1.0161  1.0034  1.0105  0.9810  0.9913  1.0504  1.0427  1.0953  1.0454  1.0257
*   1964.  1.4405  1.1224  1.0000  1.0218  1.0105  1.0144  0.9804  0.9945  0.9839  1.1470  1.1285  1.0692  1.0358
*   1965.  1.5915  1.1563  1.0000  1.0292  1.0220  1.0152  0.9825  0.9974  0.9434  1.2120  1.1435  1.0931  1.0495
*   1966.  1.7122  1.1826  1.0000  1.0375  1.0248  1.0137  0.9863  0.9999  0.9105  1.2494  1.1376  1.1216  1.0674
*   1967.  1.7466  1.1738  1.0000  1.0428  1.0219  1.0084  0.9931  1.0014  0.8953  1.2543  1.1230  1.1427  1.0866
*   1968.  1.8178  1.2098  1.0000  1.0480  1.0132  1.0021  0.9977  0.9997  0.9234  1.2127  1.1197  1.1478  1.1014
*   1969.  1.9428  1.2264  1.0000  1.0577  1.0157  0.9980  1.0012  0.9992  0.9825  1.1530  1.1328  1.1675  1.1158
*   1970.  2.0692  1.2395  1.0000  1.0667  1.0170  0.9971  1.0052  1.0023  0.9630  1.2017  1.1573  1.1715  1.1324
*   1971.  2.2590  1.2795  1.0000  1.0762  1.0254  0.9913  1.0038  0.9951  0.9226  1.2858  1.1863  1.1837  1.1450
*   1972.  2.5095  1.2997  1.0000  1.0835  1.0285  0.9898  1.0085  0.9982  0.8985  1.3829  1.2425  1.2038  1.1604
*   1973.  2.8783  1.3206  1.0000  1.0888  1.0393  1.0037  1.0065  1.0103  0.9049  1.4435  1.3062  1.2384  1.1785
*   1974.  3.0890  1.3026  1.0000  1.0928  1.0490  1.0331  0.9895  1.0223  0.9376  1.4201  1.3315  1.2650  1.2014
*   1975.  3.0800  1.2949  1.0000  1.0916  1.0419  1.0333  0.9886  1.0215  0.8979  1.4626  1.3133  1.2704  1.2271
*   1976.  3.1701  1.3300  1.0000  1.1038  1.0412  1.0334  0.9985  1.0318  0.8234  1.5287  1.2587  1.2790  1.2485
*   1977.  3.1629  1.3594  1.0000  1.1054  1.0348  1.0364  0.9870  1.0229  0.8481  1.4397  1.2210  1.2818  1.2706
*   1978.  3.2287  1.3571  1.0000  1.1016  1.0312  1.0379  0.9757  1.0127  0.9035  1.3566  1.2258  1.3068  1.2910
*   1979.  3.4201  1.3411  1.0000  1.1014  1.0297  1.0576  0.9674  1.0231  0.9493  1.3145  1.2479  1.3440  1.3104
*   1980.  3.5004  1.3218  1.0000  1.0994  1.0252  1.0719  0.9566  1.0254  0.9843  1.2797  1.2596  1.3634  1.3344
*   1981.  3.5609  1.3397  1.0000  1.1075  1.0275  1.0705  0.9490  1.0159  0.9780  1.2650  1.2372  1.3730  1.3536
*   1982.  3.2872  1.3160  1.0000  1.1121  1.0199  1.0501  0.9628  1.0110  0.9821  1.2108  1.1892  1.3322  1.3750
*   1983.  3.1637  1.3387  1.0000  1.1065  1.0056  1.0313  0.9812  1.0119  1.0170  1.1210  1.1401  1.3327  1.3815
*   1984.  3.2205  1.3776  1.0000  1.1048  1.0010  1.0269  0.9810  1.0074  1.0963  1.0123  1.1099  1.3600  1.3902
*   1985.  3.3403  1.3945  1.0000  1.1050  0.9969  1.0212  0.9848  1.0058  1.1287  0.9824  1.1089  1.3909  1.4020
*   1986.  3.3928  1.3826  1.0000  1.1018  0.9919  1.0018  0.9944  0.9962  1.1946  0.9380  1.1205  1.4205  1.4160
*   1987.  3.5943  1.3905  1.0000  1.1058  0.9935  0.9974  1.0088  1.0061  1.2033  0.9364  1.1268  1.4509  1.4304
*   1988.  3.7824  1.4096  1.0000  1.1061  0.9922  0.9859  1.0287  1.0141  1.2074  0.9324  1.1258  1.4794  1.4476
*   1989.  3.8181  1.3948  1.0000  1.1120  0.9915  0.9813  1.0403  1.0209  1.2104  0.9133  1.1055  1.4981  1.4684
*   1990.  3.6620  1.3666  1.0000  1.1151  0.9818  0.9639  1.0543  1.0162  1.2588  0.8572  1.0790  1.5006  1.4876
*   1991.  3.4464  1.3513  1.0000  1.1133  0.9648  0.9378  1.0781  1.0110  1.3865  0.7700  1.0675  1.4673  1.4993
*   1992.  3.4922  1.3636  1.0000  1.1203  0.9639  0.9414  1.0699  1.0073  1.4983  0.7171  1.0744  1.4543  1.5068
*   1993.  3.6334  1.3924  1.0000  1.1213  0.9633  0.9507  1.0543  1.0023  1.5221  0.7186  1.0939  1.4568  1.5125
*   1994.  3.8500  1.4264  1.0000  1.1242  0.9687  0.9680  1.0342  1.0011  1.5097  0.7278  1.0988  1.4829  1.5195
*   1995.  3.9788  1.4399  1.0000  1.1246  0.9676  0.9885  1.0260  1.0142  1.4350  0.7609  1.0918  1.4992  1.5296
*   1996.  4.0239  1.4310  1.0000  1.1228  0.9643  0.9835  1.0392  1.0221  1.4672  0.7422  1.0890  1.5151  1.5402
*   1997.  4.1728  1.4626  1.0000  1.1231  0.9657  0.9763  1.0428  1.0181  1.5097  0.7210  1.0885  1.5321  1.5493
*   1998.  4.2621  1.4818  1.0000  1.1251  0.9677  0.9689  1.0312  0.9992  1.4738  0.7382  1.0879  1.5541  1.5637
*   1999.  4.5039  1.5176  1.0000  1.1269  0.9641  0.9669  1.0410  1.0066  1.4668  0.7414  1.0874  1.5829  1.5766
*   2000.  4.8857  1.5557  1.0000  1.1342  0.9622  0.9880  1.0415  1.0290  1.5364  0.7108  1.0922  1.6097  1.5907
*   2001.  4.9298  1.5533  1.0000  1.1317  0.9584  0.9788  1.0444  1.0222  1.5945  0.6894  1.0993  1.6201  1.6072
*   2002.  5.0563  1.5726  1.0000  1.1378  0.9611  0.9637  1.0473  1.0092  1.5834  0.6947  1.0999  1.6352  1.6198
*   2003.  5.2439  1.5669  1.0000  1.1390  0.9558  0.9457  1.0902  1.0311  1.5824  0.6969  1.1029  1.6557  1.6328
*   2004.  5.5850  1.5775  1.0000  1.1407  0.9583  0.9490  1.1067  1.0503  1.6262  0.6828  1.1104  1.6823  1.6509
*   2005.  5.9310  1.5945  1.0000  1.1446  0.9585  0.9524  1.1185  1.0653  1.6111  0.6988  1.1258  1.6885  1.6744
*   2006.  6.2482  1.5918  1.0000  1.1493  0.9643  0.9469  1.1290  1.0690  1.5968  0.7144  1.1407  1.7049  1.7037
*   2007.  6.5108  1.5740  1.0000  1.1526  0.9709  0.9433  1.1458  1.0809  1.5294  0.7476  1.1434  1.7237  1.7351
*   2008.  6.5979  1.5433  1.0000  1.1548  0.9738  0.9716  1.1327  1.1005  1.4861  0.7599  1.1293  1.7322  1.7659
*   2009.  6.0012  1.4944  1.0000  1.1621  0.9774  0.9334  1.1366  1.0609  1.3636  0.8075  1.1011  1.6882  1.7926
*   2010.  6.2510  1.5236  1.0000  1.1624  0.9738  0.9346  1.1581  1.0823  1.3523  0.8032  1.0861  1.7075  1.8058
*   2011.  6.5579  1.5413  1.0000  1.1663  0.9733  0.9502  1.1527  1.0953  1.4289  0.7611  1.0875  1.7223  1.8272
*   2012.  6.7193  1.5273  1.0000  1.1684  0.9766  0.9428  1.1551  1.0891  1.4001  0.7831  1.0964  1.7434  1.8523
*   2013.  6.9591  1.5229  1.0000  1.1732  0.9761  0.9429  1.1579  1.0917  1.3719  0.8077  1.1081  1.7563  1.8782
*   2014.  7.2343  1.5503  1.0000  1.1741  0.9808  0.9478  1.1453  1.0855  1.3877  0.8026  1.1137  1.7600  1.9045
*   2015.  7.0869  1.5215  1.0000  1.1756  0.9866  0.9327  1.1305  1.0545  1.2982  0.8566  1.1121  1.7745  1.9300
*   2016.  7.0739  1.5209  1.0000  1.1752  0.9904  0.9268  1.1324  1.0495  1.2240  0.8974  1.0984  1.7794  1.9481
*   2017.  7.3697  1.5556  1.0000  1.1775  0.9927  0.9374  1.1339  1.0629  1.1788  0.9199  1.0844  1.7914  1.9630
*   2018.  7.4094  1.5555  1.0000  1.1776  0.9918  0.9415  1.1302  1.0640  1.1775  0.9099  1.0714  1.8049  1.9821
*   YEAR     RIL    TFP      CC      GG     II       XX     MM      PT       KB      KE      KN      LL      KW
*CANADIAN NET REAL INCOME GREW 7.41 FOLD OVER THE 59 YEARS. THE BIGGEST CONTRIBUTORS TO THIS GROWTH WERE:
*WAITING SERVICES KW, FINAL GROWTH FACTOR WAS 1.98; IN THE MACRO LITERATURE, THIS EFFECT IS KNOWN AS CAPITAL DEEPENING.
*LABOUR GROWTH: FINAL GROWTH FACTOR WAS 1.81. FOR MOST OECD COUNTRIES, KW WILL BE MUCH BIGGER THAN LL FOR THE FINAL YEAR.
*TFP: FINAL FACTOR WAS 1.5
*THE ABOVE 3 FACTORS WERE THE MAIN EXPLANATORY FACTORS
*DECREASES IN THE REAL PRICE OF THE BEGINNING OF THE PERIOD CAPITAL KKB, FINAL GROWTH FACTOR WAS 1.18
*NOTE THAT KB ENTERS THE NET OUTPUT AGGREGATE WITH A NEGATIVE SIGN. THUS THIS FACTOR OF PRODUCTION IS
*SIMILAR TO IMPORTS; DECREASES IN THE REAL PRICES OF THESE INTERMEDIATE INPUTS INCREASES REAL INCOME.
*INCREASES IN THE REAL PRICE OF GOVERNMENT OUTPUT GG: FINAL GROWTH FACTOR WAS 1.18
*DECREASES IN THE REAL PRICE OF IMPORTS MM CONTRIBUTED TO REAL INCOME GROWTH; FINAL GROWTH FACTOR WAS 1.13
*DECREASES IN THE REAL PRICE OF INVESTMENT II HAD A NEGATIVE EFFECT ON REAL INCOME GROWTH: FINAL GROWTH FACTOR WAS .941
*DECREASES IN THE REAL PRICE OF EXPORTS XX HAD A NEGATIVE EFFECT ON REAL INCOME GROWTH: FINAL GROWTH FACTOR WAS .992
*DECREASES IN THE REAL PRICES FOR THE END OF PERIOD CAPITAL STOCKS KKE HAD A BIGGER NEGATIVE EFFECT ON REAL INCOME 
*GROWTH, FINAL GROWTH FACTOR WAS 0.910. BUT THE NET EFFECT OF CHANGES IN THE BEGINNING AND END OF PERIOD DECREASES IN THE
*REAL PRICES OF CAPITAL HAD A NET GROWTH FACTOR OF 1.07
*COMPARE THE ABOVE RESULTS FOR NET INCOME WITH THE 2016 RESULTS FOR THE GROSS INCOME MODEL THAT WE IMPLEMENTED ABOVE
*RIL SHOULD EQUAL TFP*CC*GG*II*XX*MM*KKB*KKE*LL*KW
GENR CHK=TFP*CC*GG*II*XX*MM*KB*KE*LL*KW-RIL
STAT CHK
* NAME         N    MEAN        ST. DEV      VARIANCE     MINIMUM      MAXIMUM
* CHK          59  0.15355E-14 0.57042E-14 0.32538E-28 -0.44409E-14  0.16875E-13
*THE CHECK IS OK; ALL ENTRIES FOR CHECK ARE ESSENTIALLY 0 (EXCEPT FOR ROUNDING ERRORS)
***
*FINALLY GENR NORMALIZED PER CAPITA (NET) REAL INCOME 
GENR RIPERPOP=RIL/POP
FORMAT(F6.0,F12.5)
PRINT YEAR RIPERPOP / FORMAT
* YEAR      RIPERPOP
* 1960.     1.00000
* 1961.     1.04133
* 1962.     1.12984
* 1963.     1.20471
* 1964.     1.33324
* 1965.     1.44715
* 1966.     1.52992
* 1967.     1.53396
* 1968.     1.56954
* 1969.     1.64955
* 1970.     1.72812
* 1971.     1.86247
* 1972.     2.04511
* 1973.     2.31717
* 1974.     2.45229
* 1975.     2.40973
* 1976.     2.44778
* 1977.     2.41383
* 1978.     2.43961
* 1979.     2.55882
* 1980.     2.58536
* 1981.     2.59776
* 1982.     2.36971
* 1983.     2.25830
* 1984.     2.27725
* 1985.     2.34048
* 1986.     2.35374
* 1987.     2.46083
* 1988.     2.55626
* 1989.     2.53453
* 1990.     2.39451
* 1991.     2.22572
* 1992.     2.22874
* 1993.     2.29352
* 1994.     2.40379
* 1995.     2.45859
* 1996.     2.46065
* 1997.     2.52643
* 1998.     2.55918
* 1999.     2.68248
* 2000.     2.88289
* 2001.     2.87753
* 2002.     2.91961
* 2003.     3.00081
* 2004.     3.16633
* 2005.     3.33078
* 2006.     3.47354
* 2007.     3.58458
* 2008.     3.59346
* 2009.     3.23125
* 2010.     3.32848
* 2011.     3.45758
* 2012.     3.50108
* 2013.     3.58460
* 2014.     3.68618
* 2015.     3.59415
* 2016.     3.54715
* 2017.     3.65188
* 2018.     3.62021
*THUS PER POP NET REAL INCOME INCREASED 3.62 FOLD IN CANADA OVER THE 59 YEAR PERIOD. THIS IS BETTER THAN THE GROSS INCREASE
*WHICH WAS A 3.42 FOLD INCREASE. 
*NOTE THAT PER POP NET REAL INCOME PEAKED IN 2014 AT 3.69.
*TO SEE THE TRENDS IN REAL INCOME GROWTH, LOOK AT THE RESIDUALS IN THE FOLLOWING LINEAR REGRESSION:
*FIRST GENR A TIME TREND
GENR T=TIME(-1)
*THUS THE T VARIABLE WILL HAVE A VALUE OF 0 AT OBS 1, 1 AT OBS 2, 2 AT OBS 3 AND SO ON.
OLS RIPERPOP T / LIST
*IT CAN BE SEEN FROM THE CHART OF RESIDUALS THAT PER CAPITA REAL INCOME GROWTH WAS HIGHER THAN AVERAGE UP UNTIL OBS 14 (1973)
*AND THEN ENTERED A LONG PERIOD OF LESS THAN AVERAGE GROWTH THAT ENDED AT OBS 33 (1992). THEN REAL INCOME GROWTH INCREASED
*FROM OBS 33 (1992) TO OBS 48 (2007) AND SINCE THEN, GROWTH HAS TRENDED BELOW AVERAGE AGAIN.
*WHAT ARE THE RESULTS FOR YOUR COUNTRY? 
STOP
