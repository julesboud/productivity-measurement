*THIS IS THE FILE E59419C\CON1.TXT THAT ESTIMATES NONHOMOTHETIC LEONTIEF PREFERENCES             JUly 2, 2019
*WE DO NOT IMPOSE MONEY METRIC UTILITY SCALING IN THIS MODEL
PAR 10000                   
SIZE 1000
SET NODOECHO
*READ IN CANADIAN DATA FOR 1995-2018 FOR 17 CLASSES OF PER POP CONSUMPTION FROM E59419C\CDATOUT.TXT
SMPL 1 33
READ YEAR P1-P9 
   1985.   1.00000   1.00000   1.00000   1.00000   1.00000   1.00000   1.00000   1.00000   1.00000
   1986.   1.08081   1.10020   1.11920   1.09374   1.07878   1.05148   1.09041   1.10967   1.17568
   1987.   1.13579   1.18814   1.20754   1.17806   1.18601   1.11203   1.16006   1.17853   1.30819
   1988.   1.23865   1.22683   1.31907   1.25635   1.30791   1.16366   1.22593   1.26678   1.41357
   1989.   1.32558   1.30501   1.48947   1.32069   1.41193   1.20684   1.28549   1.37106   1.47655
   1990.   1.36967   1.39833   1.66873   1.38248   1.48231   1.27020   1.33940   1.48489   1.48039
   1991.   1.40268   1.45070   1.81845   1.40490   1.51105   1.32850   1.36029   1.58759   1.54660
   1992.   1.42741   1.50054   2.18350   1.42519   1.51771   1.38134   1.36461   1.54918   1.59462
   1993.   1.45502   1.55733   2.49074   1.41770   1.52410   1.41216   1.38620   1.58936   1.67345
   1994.   1.49049   1.61311   2.69924   1.41868   1.53196   1.42428   1.40707   1.66393   1.73870
   1995.   1.54037   1.70116   3.13760   1.42059   1.55871   1.43444   1.42974   1.73161   1.75008
   1996.   1.58939   1.74321   3.28548   1.42728   1.59540   1.45691   1.44616   1.82523   1.63757
   1997.   1.61070   1.76305   3.39283   1.42534   1.64325   1.47247   1.44963   1.89143   1.52936
   1998.   1.68923   1.79000   3.52070   1.40910   1.68197   1.43159   1.45570   1.87536   1.46444
   1999.   1.71227   1.79827   3.79570   1.39586   1.72289   1.43275   1.45967   2.07594   1.46423
   2000.   1.74502   1.93044   4.30896   1.49544   1.77635   1.58664   1.49303   2.06298   1.46495
   2001.   1.82720   1.97864   4.53981   1.48837   1.83944   1.64727   1.52754   2.13063   1.48470
   2002.   1.89743   2.01557   4.76304   1.50712   1.90733   1.72711   1.52783   2.24390   1.55102
   2003.   1.94634   2.09354   4.94371   1.50970   1.97838   1.79639   1.51476   2.29083   1.49165
   2004.   1.96189   2.16553   4.95969   1.47905   2.05686   1.85682   1.49206   2.35732   1.41504
   2005.   2.05244   2.21593   5.16277   1.45227   2.15215   1.91770   1.49094   2.40023   1.38854
   2006.   2.19318   2.27635   5.56019   1.44119   2.26944   1.98428   1.49948   2.53003   1.40000
   2007.   2.25464   2.35770   5.83753   1.44768   2.41862   2.12298   1.50120   2.58083   1.39309
   2008.   2.34528   2.44708   6.07872   1.43137   2.59616   2.20192   1.49338   2.59126   1.36547
   2009.   2.35795   2.51646   6.36500   1.43690   2.71646   2.43937   1.52554   2.65357   1.37134
   2010.   2.39914   2.55778   7.77426   1.40696   2.82863   2.70454   1.51779   2.67182   1.36071
   2011.   2.42596   2.60481   8.27714   1.41322   2.95277   3.14317   1.52077   2.69743   1.32949
   2012.   2.45480   2.66604   8.86338   1.40982   3.05675   3.68870   1.50064   2.76157   1.30016
   2013.   2.48981   2.73867   9.92116   1.40499   3.14107   3.90917   1.50294   2.83124   1.27409
   2014.   2.55137   2.79576  11.22214   1.38082   3.20957   3.84047   1.49440   2.89136   1.26748
   2015.   2.53452   2.85545  12.63424   1.38316   3.24287   3.83722   1.52627   2.97068   1.32516
   2016.   2.57419   2.87728  14.05046   1.37280   3.28098   4.04080   1.52202   3.00560   1.31152
   2017.   2.54878   2.94138  15.96832   1.32753   3.33466   4.44474   1.48980   3.06670   1.29569

FORMAT(F8.0,9F10.5)
PRINT YEAR P1-P9 / FORMAT
READ YEAR P10-P17
   1985.   1.00000   1.00000   1.00000   1.00000   1.00000   1.00000   1.00000   1.00000
   1986.   1.05777   1.04339   1.03444   1.08949   1.10206   1.09287   1.07920   1.04944
   1987.   1.10338   1.11597   1.11398   1.15056   1.21907   1.17624   1.14931   1.04781
   1988.   1.11019   1.19830   1.13363   1.19647   1.35726   1.23388   1.21910   0.96725
   1989.   1.20737   1.28462   1.12549   1.24076   1.52745   1.31852   1.30327   1.06175
   1990.   1.32751   1.34009   1.15619   1.28992   1.70998   1.41133   1.37226   1.14946
   1991.   1.32065   1.26406   1.20545   1.32519   1.85858   1.46464   1.41215   1.18329
   1992.   1.34018   1.22348   1.20472   1.36426   1.98486   1.51508   1.43567   1.31193
   1993.   1.34587   1.24340   1.19725   1.38864   2.06684   1.55955   1.46084   1.34423
   1994.   1.36799   1.25355   1.21382   1.40352   2.15160   1.60373   1.50465   1.35071
   1995.   1.41830   1.24404   1.21033   1.42192   2.30447   1.64711   1.56637   1.36413
   1996.   1.43527   1.30105   1.20121   1.41089   2.37941   1.68444   1.57343   1.36114
   1997.   1.41593   1.35232   1.20031   1.42013   2.47866   1.71438   1.64069   1.43547
   1998.   1.40432   1.35982   1.15632   1.41907   2.63970   1.75588   1.63162   1.51944
   1999.   1.47429   1.38003   1.09495   1.41496   2.72763   1.81345   1.66224   1.50045
   2000.   1.60080   1.38496   1.17241   1.47121   2.91442   1.97529   1.73812   1.66401
   2001.   1.57891   1.33587   1.17698   1.48662   2.98811   2.04126   1.81101   1.71404
   2002.   1.62813   1.39566   1.22432   1.47846   3.26015   2.10333   1.86266   1.68485
   2003.   1.68636   1.40383   1.24194   1.44805   3.39754   2.18402   1.87369   1.51186
   2004.   1.77714   1.47207   1.26307   1.43938   3.70491   2.25268   1.88425   1.52566
   2005.   1.94750   1.60200   1.26333   1.43959   3.91548   2.32428   1.93343   1.55093
   2006.   2.04471   1.69167   1.27041   1.44515   4.09385   2.40676   1.96699   1.56737
   2007.   2.24916   1.72850   1.28989   1.45472   4.24190   2.49242   1.98233   1.49407
   2008.   2.16253   1.62872   1.25830   1.47628   4.53150   2.48600   2.14810   1.66427
   2009.   2.17161   1.70080   1.25851   1.48619   4.81824   2.54372   2.19621   1.45807
   2010.   2.23963   1.72151   1.20437   1.46427   5.07346   2.59410   2.22838   1.35583
   2011.   2.31016   1.80667   1.17682   1.45380   5.35709   2.68219   2.27100   1.33397
   2012.   2.34495   1.81245   1.22703   1.46541   5.66292   2.74597   2.35631   1.36287
   2013.   2.42872   1.98192   1.11538   1.47327   5.97997   2.80075   2.43393   1.51690
   2014.   2.31320   2.07616   1.01520   1.49592   6.30235   2.84795   2.49639   1.60683
   2015.   2.27453   2.12553   0.88609   1.52077   6.59157   2.92444   2.55412   1.73699
   2016.   2.30209   2.11511   0.81349   1.52108   6.78731   2.96177   2.60333   1.66431
   2017.   2.41135   2.15486   0.78219   1.51379   6.98437   3.02235   2.65984   1.68636
PRINT YEAR P10-P17 / FORMAT
READ YEAR Q1-Q9 
   1985.   1.18670   0.17032   0.20084   0.57239   1.56477   0.20027   0.69621   0.37338   0.34747
   1986.   1.16815   0.16177   0.19824   0.55793   1.60136   0.20566   0.67735   0.38858   0.26656
   1987.   1.16774   0.16187   0.19410   0.56232   1.63475   0.20408   0.69460   0.39061   0.25855
   1988.   1.14383   0.16078   0.19044   0.55474   1.67218   0.20506   0.70379   0.41480   0.31118
   1989.   1.14658   0.16379   0.18703   0.54092   1.70626   0.21580   0.71109   0.41803   0.35497
   1990.   1.13051   0.15859   0.17648   0.50819   1.72145   0.21413   0.66596   0.41988   0.32720
   1991.   1.14362   0.15412   0.16354   0.52049   1.75949   0.21210   0.68666   0.42474   0.30179
   1992.   1.15056   0.15619   0.15182   0.49895   1.79503   0.21975   0.69999   0.45114   0.31909
   1993.   1.15354   0.16632   0.13890   0.49158   1.84064   0.21639   0.70833   0.46453   0.31671
   1994.   1.19261   0.18018   0.12897   0.49630   1.88640   0.22333   0.71946   0.46050   0.35585
   1995.   1.20789   0.17588   0.11855   0.51209   1.92512   0.22699   0.71475   0.45611   0.35708
   1996.   1.18492   0.17848   0.12032   0.51216   1.95995   0.22902   0.71266   0.44873   0.39972
   1997.   1.21429   0.18753   0.12002   0.51757   2.00010   0.24015   0.72240   0.43884   0.48996
   1998.   1.20315   0.19615   0.12157   0.54628   2.04806   0.24885   0.72299   0.47013   0.53184
   1999.   1.22606   0.20611   0.11997   0.56525   2.09339   0.25639   0.77550   0.47065   0.52375
   2000.   1.25855   0.21019   0.11447   0.56178   2.13259   0.26045   0.78401   0.49915   0.54238
   2001.   1.28520   0.21183   0.10949   0.58188   2.16502   0.26051   0.82671   0.54017   0.53699
   2002.   1.29738   0.21714   0.10836   0.61989   2.20719   0.26565   0.86333   0.56527   0.54709
   2003.   1.33019   0.22020   0.10571   0.65708   2.25642   0.27771   0.89868   0.58755   0.59658
   2004.   1.36050   0.23251   0.10700   0.70155   2.30349   0.27693   0.93815   0.60557   0.62096
   2005.   1.37336   0.23615   0.10243   0.73895   2.34082   0.27734   0.91259   0.61501   0.62535
   2006.   1.37697   0.24688   0.09843   0.79546   2.36552   0.27986   0.97344   0.64140   0.65662
   2007.   1.38643   0.25352   0.09181   0.83340   2.37741   0.28327   1.02632   0.67173   0.71485
   2008.   1.39060   0.25890   0.08767   0.85948   2.39056   0.28382   1.03504   0.69896   0.54086
   2009.   1.39477   0.26455   0.08377   0.90146   2.41756   0.28405   1.04220   0.72023   0.57359
   2010.   1.40568   0.27222   0.07757   0.92372   2.44944   0.28239   1.06944   0.74780   0.58052
   2011.   1.42178   0.28026   0.07273   0.92295   2.46630   0.26453   1.09827   0.77608   0.61200
   2012.   1.43997   0.27387   0.07000   0.93543   2.47468   0.24646   1.11038   0.82107   0.68480
   2013.   1.46053   0.27352   0.06669   0.97659   2.48921   0.24013   1.13637   0.82652   0.69428
   2014.   1.44636   0.27816   0.05897   0.98426   2.50562   0.23874   1.18894   0.84095   0.70642
   2015.   1.48582   0.27648   0.05438   1.03357   2.52370   0.24021   1.21462   0.85112   0.73033
   2016.   1.48579   0.27899   0.05035   1.04375   2.54035   0.24286   1.22483   0.87108   0.72913
   2017.   1.52604   0.27901   0.04997   1.07038   2.55915   0.23822   1.24431   0.88604   0.72016
PRINT YEAR Q1-Q9 / FORMAT
READ YEAR Q10-Q17 
   1985.   0.68665   0.23606   0.13143   0.93449   0.17063   0.68424   1.13641   0.13675
   1986.   0.69842   0.23574   0.13591   0.93211   0.17804   0.65669   1.28147   0.13819
   1987.   0.70113   0.24154   0.14119   0.97261   0.17345   0.66340   1.33461   0.15832
   1988.   0.69947   0.25916   0.14946   1.02506   0.18125   0.67455   1.42351   0.18948
   1989.   0.71114   0.26912   0.15974   1.08328   0.19312   0.68809   1.46730   0.20591
   1990.   0.69001   0.28137   0.16258   1.06697   0.18697   0.65300   1.47600   0.18840
   1991.   0.70012   0.30212   0.17604   1.09466   0.18667   0.65172   1.48726   0.17198
   1992.   0.71491   0.30279   0.20089   1.11449   0.18447   0.62606   1.48062   0.17428
   1993.   0.72818   0.29585   0.22230   1.18526   0.18817   0.65001   1.42636   0.17255
   1994.   0.73514   0.30208   0.24210   1.27981   0.19058   0.69853   1.44406   0.19014
   1995.   0.73769   0.33411   0.27682   1.36848   0.19058   0.73032   1.45663   0.20900
   1996.   0.73134   0.33806   0.30940   1.45314   0.19721   0.69692   1.52325   0.23768
   1997.   0.75891   0.33592   0.33441   1.53376   0.20381   0.72892   1.60593   0.26091
   1998.   0.79512   0.36175   0.37880   1.60713   0.21158   0.79319   1.72865   0.29044
   1999.   0.78720   0.37490   0.42740   1.66737   0.22243   0.82005   1.81161   0.29518
   2000.   0.77848   0.41596   0.47832   1.71152   0.22058   0.82223   1.81498   0.32170
   2001.   0.78603   0.42814   0.50507   1.76524   0.23286   0.80410   1.82572   0.28989
   2002.   0.80821   0.44573   0.53408   1.88210   0.22734   0.83242   1.84507   0.29642
   2003.   0.81919   0.46862   0.55479   2.01978   0.23217   0.85798   1.93959   0.39618
   2004.   0.85565   0.49213   0.59255   2.11042   0.23160   0.85231   2.03395   0.47188
   2005.   0.82738   0.50307   0.62698   2.17825   0.23890   0.85716   2.14638   0.48149
   2006.   0.85177   0.55867   0.63973   2.28163   0.24470   0.89096   2.26340   0.53243
   2007.   0.87310   0.63140   0.65237   2.39560   0.24519   0.88356   2.35575   0.65718
   2008.   0.85421   0.60736   0.66196   2.38247   0.25276   0.86403   2.22099   0.64361
   2009.   0.87870   0.59237   0.65950   2.44715   0.26735   0.88748   2.24058   0.77581
   2010.   0.92666   0.66121   0.69684   2.59611   0.27359   0.91068   2.25131   0.89355
   2011.   0.92698   0.68156   0.71625   2.69623   0.27859   0.91492   2.24641   0.95233
   2012.   0.92726   0.66515   0.70323   2.61503   0.28275   0.89940   2.23165   0.97790
   2013.   0.91939   0.61472   0.77890   2.61039   0.28518   0.91532   2.29151   0.94728
   2014.   0.90321   0.59081   0.86079   2.67692   0.28425   0.94407   2.31887   0.87906
   2015.   0.87745   0.59103   0.96742   2.69451   0.28427   0.93572   2.36958   0.87605
   2016.   0.86842   0.59527   1.04844   2.68162   0.28415   0.93906   2.40976   0.93191
   2017.   0.86794   0.59882   1.08895   2.73428   0.28587   0.95375   2.44551   0.94431
PRINT YEAR Q10-Q17 / FORMAT
*1 IS THE SERIES       P31CP010: Food and non-alcoholic beverages
*2 IS THE SERIES       P31CP021: Alcoholic beverages
*3 IS THE SERIES       P31CP022: Tobacco
*4 IS THE SERIES       P31CP030: Clothing and footwear
*5 IS THE SERIES       P31CP041+P31CP042+P31CP043+P31CP044: HOUSING AGGREGATE
*6 IS THE SERIES       P31CP045: Electricity, gas and other fuels
*7 IS THE SERIES       P31CP050: Furnishings, households equipment and routine maintenance of the house
*8 IS THE SERIES       P31CP060: Health
*9 IS THE SERIES       P31CP071: Purchase of vehicles
*10 IS THE SERIES      P31CP072: Operation of personal transport equipment
*11 IS THE SERIES      P31CP073: Transport services
*12 IS THE SERIES      P31CP080: Communications
*13 IS THE SERIES      P31CP090: Recreation and culture
*14 IS THE SERIES      P31CP100: Education
*15 IS THE SERIES      P31CP110: Restaurants and hotels
*16 IS THE SERIES      P31CP120: Miscellaneous goods and services
*17 IS THE SERIES      P33:      Final consumption expenditure of resident households abroad
DO #=1,17
GENR V#=P#*Q#
ENDO

*GENR CHAINED FISHER PRICE AND QUANTITY INDEXES
INDEX P1 Q1 P2 Q2 P3 Q3 P4 Q4 P5 Q5 P6 Q6 P7 Q7 P8 Q8 P9 Q9 P10 Q10 &
P11 Q11 P12 Q12 P13 Q13 P14 Q14 P15 Q15 P16 Q16 P17 Q17 / CHAIN FISHER=PF QFISHER=QF
*GENR EXPENDITURE Y ON THE 17 COMMODITIES
GENR Y=PF*QF
*GENR THE NORMALIZED QUADRATIC FIXED BASE AND CHAINED INDEXES
*WE FIRST NEED TO GENR FIXED WEIGHTS SUMMING TO 1,G1 TO G17. WE INITIALLY DEFINE THESE G# AS SAMPLE MEANS
DO #=1,17
STAT Q# / MEAN=GG#
ENDO
*SUM THE GG#
SMPL 1 1
GENR SUM=0
DO #=1,17
GENR SUM=SUM+GG#
ENDO
*DEFINE THE NORMALIZED GG#
DO #=1,17
GENR GG#=GG#/SUM
ENDO
FORMAT(9F10.5)
PRINT GG1-GG9 / FORMAT
PRINT GG10-GG17 / FORMAT
SMPL 1 33
GENR ONE=1
DO #=1,17
GENR G#=GG#(1)*ONE
ENDO
*GENR THE LOWE PRICE INDEX PG
GENR PG=0
DO #=1,17
GENR PG=PG+P#*G#
ENDO
*GENR PG NORMALIZED PRICES:
DO #=1,17
GENR PN#=P#/PG
ENDO
FORMAT(9F10.5)
PRINT PG PN1-PN8 / FORMAT
PRINT PN9-PN17 / FORMAT
STAT PG PN1-PN17

*THE EXACT INDEX NUMBER FORMULA FOR NORMALIZED QUADRATIC PREFERENCES USING A FIXED BASE IS
*u(t)/u(1)=SUM(PN#(t)+PN#(1))Q#(t)/(SUM(PN#(t)+PN#(1))Q#(1))
GENR NUM=0
GENR DEN=0
DO #=1,17
GENR NUM=NUM+(PN#+PN#(1))*Q#
GENR DEN=DEN+(PN#+PN#(1))*Q#(1)
ENDO
GENR QNFB=NUM/DEN
*NORMALIZE QNFB TO EQUAL Y IN OBSERVATION 1
GENR CON=QNFB(1)
GENR QNFB=QNFB*Y(1)/CON
GENR PNFB=Y/QNFB
*NOW CONSTRUCT THE NORMALIZED QUADRATIC CHAIN LINKS
GENR QNCH=1
GENR QNCHL=1
GENR NUML=0
GENR DENL=0
SMPL 2 33
DO #=1,17
GENR NUML=NUML+(PN#+LAG(PN#))*Q#
GENR DENL=DENL+(PN#+LAG(PN#))*LAG(Q#)
ENDO
*NOW CONSTRUCT THE NORMALIZED QUADRATIC EXACT INDEX NUMBER FORMULA USING THE CHAIN PRINCIPLE
GENR QNCHL=NUML/DENL
GENR QNCH=LAG(QNCH)*QNCHL
*NORMALIZE QNCH TO EQUAL Y AT OBSERVATION 1
SMPL 1 33
GENR CON=QNCH(1)
GENR QNCH=QNCH*Y(1)/CON
GENR PNCH=Y/QNCH
FORMAT(F8.0,7F10.5)
PRINT YEAR QF QNCH QNFB PF PNCH PNFB Y / FORMAT
*   YEAR      QF        QNCH      QNFB      PF        PNCH      PNFB       Y
*   1985.   9.42901   9.42901   9.42901   1.00000   1.00000   1.00000   9.42901
*   1986.   9.47789   9.47789   9.47789   1.08487   1.08487   1.08487  10.28229
*   1987.   9.64763   9.64763   9.64692   1.16056   1.16056   1.16064  11.19662
*   1988.   9.95313   9.95313   9.94844   1.23539   1.23539   1.23597  12.29599
*   1989.  10.21571  10.21570  10.21129   1.31845   1.31845   1.31902  13.46888
*   1990.  10.02299  10.02298  10.01815   1.38995   1.38995   1.39062  13.93147
*   1991.  10.12546  10.12545  10.12224   1.42675   1.42675   1.42720  14.44647
*   1992.  10.22121  10.22120  10.21281   1.45483   1.45483   1.45603  14.87015
*   1993.  10.33576  10.33575  10.32383   1.48220   1.48220   1.48391  15.31962
*   1994.  10.68357  10.68356  10.67150   1.51261   1.51261   1.51432  16.16007
*   1995.  10.92398  10.92397  10.91254   1.55381   1.55381   1.55544  16.97382
*   1996.  11.14574  11.14573  11.13178   1.57552   1.57552   1.57749  17.56031
*   1997.  11.58996  11.58995  11.58457   1.60232   1.60232   1.60306  18.57081
*   1998.  12.13405  12.13403  12.12103   1.61821   1.61822   1.61995  19.63550
*   1999.  12.50055  12.50053  12.47602   1.64933   1.64933   1.65257  20.61753
*   2000.  12.75038  12.75036  12.72683   1.72463   1.72463   1.72782  21.98966
*   2001.  12.95913  12.95911  12.93337   1.76905   1.76905   1.77257  22.92531
*   2002.  13.32383  13.32381  13.30486   1.82057   1.82057   1.82317  24.25698
*   2003.  13.92029  13.92027  13.89359   1.84433   1.84433   1.84787  25.67356
*   2004.  14.42630  14.42628  14.41754   1.87579   1.87580   1.87693  27.06075
*   2005.  14.69361  14.69358  14.67184   1.93201   1.93201   1.93488  28.38820
*   2006.  15.23701  15.23699  15.20494   1.99714   1.99714   2.00135  30.43045
*   2007.  15.74801  15.74799  15.72309   2.05507   2.05507   2.05832  32.36323
*   2008.  15.51279  15.51277  15.46696   2.12126   2.12127   2.12755  32.90672
*   2009.  15.85834  15.85833  15.79214   2.16360   2.16360   2.17267  34.31107
*   2010.  16.32160  16.32160  16.18677   2.20002   2.20002   2.21834  35.90781
*   2011.  16.54152  16.54152  16.39556   2.25074   2.25074   2.27077  37.23060
*   2012.  16.55908  16.55908  16.38913   2.30924   2.30924   2.33319  38.23891
*   2013.  16.68267  16.68268  16.48590   2.37123   2.37123   2.39953  39.55840
*   2014.  16.77637  16.77639  16.55935   2.40975   2.40975   2.44133  40.42684
*   2015.  16.95788  16.95790  16.72883   2.44835   2.44835   2.48188  41.51889
*   2016.  17.10059  17.10061  16.79531   2.47049   2.47049   2.51540  42.24691
*   2017.  17.31293  17.31296  16.90802   2.50543   2.50543   2.56543  43.37640
*THE CHAINED FISHER AND CHAINED NORMALIZED QUADRATIC INDEXES DIFFER ONLY IN THE 4TH DECIMAL PLACE
*THEY ARE INCREDIBLY CLOSE!

*RUN SEPARATE EQ BY EQU NONHOMOTHETIC LEONTIEF (NO SUBSTITUTION PREFERENCES) REGRESSIONS USING QNCH AS THE UTILITY LEVEL
GENR U=QNCH
*THE EXPENDITURE FUNCTION IS E(U,P) = A.P +B.PU
*THE HICKSIAN DEMAND FUNCTIONS ARE Q=A+BU ; NOTE THAT DEMANDS DO NOT RESPOND TO PRICE CHANGES.
*FIRST ESTIMATE THE HICKSIAN DEMAND FUNCTIONS EQUATION BY EQUATION 
DO #=1,17
OLS Q# U / LIST 
ENDO
*THE FITS ARE NOT GREAT BUT THE MODEL IS VERY SIMPLE. 
*THE R SQUARES FOR THE 20 EQUATIONS ARE AS FOLLOWS:
* .9651 .9855 .8774 .8814 .9710 .4955 .9425 .9411 .9045 .9450 .9599 .9424 .9962 .9745 .9521 .9744 .9124
*NONUNITARY INCOME ELASTICITIES ARE EXPLAINING THE DATA REASONABLY WELL.
*ONLY THE 6TH EQUATION HAS A TERRIBLE FIT.
*WE WILL NOW RUN A SYSTEM REGRESSION 
NL 17 / NCOEF=34 GENRVAR CONV=.000001 ITER=1000 PITER=50 LIST
EQ Q1=A1+B1*U
EQ Q2=A2+B2*U
EQ Q3=A3+B3*U
EQ Q4=A4+B4*U
EQ Q5=A5+B5*U
EQ Q6=A6+B6*U
EQ Q7=A7+B7*U
EQ Q8=A8+B8*U
EQ Q9=A9+B9*U
EQ Q10=A10+B10*U
EQ Q11=A11+B11*U
EQ Q12=A12+B12*U
EQ Q13=A13+B13*U
EQ Q14=A14+B14*U
EQ Q15=A15+B15*U
EQ Q16=A16+B16*U
EQ Q17=A17+B17*U
COEF A1 0
COEF A2 0
COEF A3 0
COEF A4 0
COEF A5 0
COEF A6 0
COEF A7 0
COEF A8 0
COEF A9 0
COEF A10 0
COEF A11 0
COEF A12 0
COEF A13 0
COEF A14 0
COEF A15 0
COEF A16 0
COEF A17 0
COEF B1 .05
COEF B2 .05
COEF B3 .05
COEF B4 .05
COEF B5 .05
COEF B6 .05
COEF B7 .05
COEF B8 .05
COEF B9 .05
COEF B10 .05
COEF B11 .05
COEF B12 .05
COEF B13 .05
COEF B14 .05
COEF B15 .05
COEF B16 .05
COEF B17 .05
END
* INITIAL LOG-LIKELIHOOD  = 1309.529
* FINAL STATISTICS:  TIME =     0.1970 SEC.   ITER. NO.   127   FUNCT. EVALUATIONS   154
* FINAL LOG-LIKELIHOOD FUNCTION = 1625.117
*THE SYSTEM ESTIMATES ARE THE SAME AS THE EQ BY EQ ESTIMATES THAT WE GENERATED EARLIER. THIS MAKES SENSE
*SINCE EACH EQUATION IS COMPLETELY INDEPENDENT OF THE OTHER EQUATIONS.
*NOTE THAT NOT ALL ELEMENTS OF THE GRADIENT VECTOR ARE CLOSE TO 0. NEVERTHELESS, THE ESTIMATED COEFFICIENTS HAVE
*STABILIZED SO THAT THE ALGORITHM STOPS. THIS MAY HAPPEN TO YOU; AS LONG AS THE GRADIENTS ARE NOT TOO FAR FROM
*0, WE WILL BE OK.

*GENR FITTED DEMAND EQUATIONS
DO #= 1,17
GENR FQ#=A#+B#*U
ENDO
*COMPARE FITTED DEMANDS WITH ACTUAL DEMANDS
FORMAT(F8.0,10F10.5)
PRINT YEAR Q1 FQ1 Q2 FQ2 Q3 FQ3 Q4 FQ4 Q5 FQ5 / FORMAT
PRINT YEAR Q6 FQ6 Q7 FQ7 Q8 FQ8 Q9 FQ9 Q10 FQ10 / FORMAT
PRINT YEAR Q11 FQ11 Q12 FQ12 Q13 FQ13 Q14 FQ14 Q15 FQ15 / FORMAT
PRINT YEAR Q16 FQ16 Q17 FQ17  / FORMAT
STAT Q1 FQ1 Q2 FQ2 Q3 FQ3 Q4 FQ4 Q5 FQ5 Q6 FQ6 Q7 FQ7 Q8 FQ8 Q9 FQ9 Q10 FQ10
STAT Q11 FQ11 Q12 FQ12 Q13 FQ13 Q14 FQ14 Q15 FQ15 Q16 FQ16 Q17 FQ17  
*THE AVERAGE FITTED DEMAND COINCIDES EXACTLY WITH THE CORRESPONDING ACTUAL AVERAGE DEMAND.

*GENR THE INDIRECT UTILITY FUNCTION THAT IS IMPLIED BY OUR ESTIMATES
*GENR TOTAL EXPENDITURE FOR EACH PERIOD
GENR Y=0
DO #=1,17
GENR Y=Y+V#
ENDO 
*GENR A.P AND B.P
GENR AP=0
GENR BP=0
DO #=1,17
GENR AP=AP+P#*A#
GENR BP=BP+P#*B#
ENDO
*GENR INDIRECT UTILITY THAT IS IMPLIED BY OUR COEFFICIENT ESTIMATES
GENR IU=(Y-AP)/BP
FORMAT(F8.0,5F10.5)
PRINT YEAR U IU AP BP Y / FORMAT
*   YEAR       U        IU         AP       BP         Y
*   1985.   9.42901   9.54156  -1.32920   1.12751   9.42901
*   1986.   9.47789   9.58647  -1.39643   1.21825  10.28229
*   1987.   9.64763   9.73064  -1.42280   1.29688  11.19662
*   1988.   9.95313   9.99814  -1.28158   1.35801  12.29599
*   1989.  10.21570  10.24276  -1.23054   1.43510  13.46888
*   1990.  10.02298  10.06939  -1.22393   1.50510  13.93147
*   1991.  10.12545  10.16400  -1.24225   1.54356  14.44647
*   1992.  10.22120  10.24953  -1.23309   1.57112  14.87015
*   1993.  10.33575  10.35135  -1.17122   1.59311  15.31962
*   1994.  10.68356  10.67264  -1.11718   1.61884  16.16007
*   1995.  10.92397  10.89120  -0.93247   1.64411  16.97382
*   1996.  11.14573  11.10038  -0.79202   1.65331  17.56031
*   1997.  11.58995  11.51983  -0.79352   1.68096  18.57081
*   1998.  12.13403  12.03489  -0.69060   1.68893  19.63550
*   1999.  12.50053  12.38488  -0.48098   1.70357  20.61753
*   2000.  12.75036  12.62513  -0.43635   1.77630  21.98966
*   2001.  12.95911  12.82949  -0.31969   1.81184  22.92531
*   2002.  13.32381  13.19553  -0.15180   1.84978  24.25698
*   2003.  13.92027  13.80362   0.23355   1.84300  25.67356
*   2004.  14.42628  14.31187   0.34880   1.86642  27.06075
*   2005.  14.69358  14.58546   0.58925   1.90594  28.38820
*   2006.  15.23699  15.14198   0.89181   1.95078  30.43045
*   2007.  15.74799  15.67328   1.27447   1.98355  32.36323
*   2008.  15.51277  15.43070   1.37419   2.04349  32.90672
*   2009.  15.85833  15.79665   1.76179   2.06052  34.31107
*   2010.  16.32160  16.29464   2.56661   2.04615  35.90781
*   2011.  16.54152  16.53705   2.98756   2.07069  37.23060
*   2012.  16.55908  16.55137   3.29452   2.11127  38.23891
*   2013.  16.68268  16.70139   3.68780   2.14776  39.55840
*   2014.  16.77639  16.80752   4.09108   2.16187  40.42684
*   2015.  16.95790  17.00746   4.47551   2.17807  41.51889
*   2016.  17.10061  17.15647   5.16479   2.16141  42.24691
*   2017.  17.31296  17.38262   5.92511   2.15452  43.37640
STAT U IU / PCOR 
* NAME        N    MEAN        ST. DEV      VARIANCE     MINIMUM      MAXIMUM
* U            33   13.245      2.7816      7.7375       9.4290       17.313
* IU           33   13.223      2.7654      7.6477       9.5416       17.383
*  CORRELATION MATRIX OF VARIABLES -       33 OBSERVATIONS
* U          1.0000
* IU        0.99965       1.0000
*              U            IU

*THE CORRELATION BETWEEN INDEX NUMBER U, IU AND ECONOMETRIC INDIRECT UTILITY U IS .99987; VERY CLOSE.
*WE REGRESS IU ON U TO SEE HOW TO SPLINE UTILITY IN THE FOLLOWING REGRESSION
OLS IU U / LIST
*HERE IS A PLOT OF THE RESIDUALS FOR THE ABOVE REGRESSION
*     OBS.   OBSERVED     PREDICTED   CALCULATED
*      NO.    VALUE        VALUE       RESIDUAL
*       1    9.5416       9.4308      0.11078                    I      *
*       2    9.5865       9.4794      0.10712                    I      *
*       3    9.7306       9.6480      0.82590E-01                I     *
*       4    9.9981       9.9517      0.46483E-01                I  *
*       5    10.243       10.213      0.30148E-01                I *
*       6    10.069       10.021      0.48303E-01                I  *
*       7    10.164       10.123      0.41083E-01                I  *
*       8    10.250       10.218      0.31450E-01                I *
*       9    10.351       10.332      0.19437E-01                I*
*      10    10.673       10.678     -0.49485E-02                *
*      11    10.891       10.917     -0.25315E-01              * I
*      12    11.100       11.137     -0.36516E-01              * I
*      13    11.520       11.578     -0.58546E-01            *   I
*      14    12.035       12.119     -0.84213E-01          *     I
*      15    12.385       12.483     -0.98462E-01         *      I
*      16    12.625       12.732     -0.10650             *      I
*      17    12.829       12.939     -0.10960             *      I
*      18    13.196       13.302     -0.10600             *      I
*      19    13.804       13.894     -0.90697E-01          *     I
*      20    14.312       14.397     -0.85339E-01          *     I
*      21    14.585       14.663     -0.77399E-01           *    I
*      22    15.142       15.203     -0.60934E-01            *   I
*      23    15.673       15.711     -0.37481E-01             *  I
*      24    15.431       15.477     -0.46288E-01             *  I
*      25    15.797       15.820     -0.23770E-01              * I
*      26    16.295       16.281      0.13804E-01                I*
*      27    16.537       16.499      0.37648E-01                I  *
*      28    16.551       16.517      0.34523E-01                I *
*      29    16.701       16.640      0.61706E-01                I   *
*      30    16.808       16.733      0.74712E-01                I    *
*      31    17.007       16.913      0.94254E-01                I     *
*      32    17.156       17.055      0.10143                    I      *
*      33    17.383       17.266      0.11655                    I       *

* DURBIN-WATSON = 0.0627    VON NEUMANN RATIO = 0.0647    RHO =  0.97012
* RESIDUAL SUM = -0.10539E-12  RESIDUAL VARIANCE =  0.54871E-02
* SUM OF ABSOLUTE ERRORS=   2.1040
* R-SQUARE BETWEEN OBSERVED AND PREDICTED = 0.9993

* 2 REASONABLE BREAK POINTS ARE AT OBS 12 and 16
*OUR ECONOMETRICALLY BASED ESTIMATES OF INDIRECT UTILITY IU ARE FAIRLY CLOSE TO THE INDEX NUMBER ESTIMATES U 
*WE DO NOT HAVE AN EXACT CORRESPONDENCE BUT NEVERTHELESS, OUR ECONOMETRIC ESTIMATES OF UTILITY 
*ARE CLOSE ENOUGH TO FU TO JUSTIFY USING U AS AN APPROXIMATION TO IU.

*GENR INCOME ELASTICITIES OF DEMAND FOR EACH COMMODITY
DO #=1,17
GENR EU#=B#*U/FQ#
ENDO
FORMAT(F8.0,9F9.4)
PRINT YEAR EU1-EU9 / FORMAT
PRINT YEAR EU10-EU17 / FORMAT
*THESE ELASTICITIES LOOK OK
STAT EU1-EU17
STOP

* EU1          33  0.44782     0.52510E-01 0.27573E-02  0.37057      0.51946
* EU2          33   1.0165     0.35739E-02 0.12773E-04   1.0120       1.0222
* EU3          33  -2.1786      1.3077      1.7101      -4.8441     -0.82292
* EU4          33   1.2855     0.78385E-01 0.61442E-02   1.1913       1.4181
* EU5          33  0.70914     0.43969E-01 0.19333E-02  0.64164      0.76677
* EU6          33  0.37225     0.49548E-01 0.24550E-02  0.30022      0.44064
* EU7          33   1.0182     0.39657E-02 0.15727E-04   1.0133       1.0246
* EU8          33   1.3553     0.10279     0.10566E-01   1.2330       1.5313
* EU9          33   1.4249     0.12917     0.16684E-01   1.2727       1.6487
* EU10         33  0.46406     0.52829E-01 0.27909E-02  0.38613      0.53595
* EU11         33   1.6570     0.23166     0.53666E-01   1.3930       2.0748
* EU12         33   3.5243      1.8130      3.2868       1.9106       8.0060
* EU13         33   1.7678     0.28840     0.83172E-01   1.4443       2.2981
* EU14         33  0.81399     0.32309E-01 0.10439E-02  0.76352      0.85567
* EU15         33  0.62460     0.49932E-01 0.24932E-02  0.54900      0.69089
* EU16         33   1.0181     0.39408E-02 0.15530E-04   1.0132       1.0245
* EU17         33   4.9585      3.9008      15.216       2.0496       16.748

*ON AVERAGE, 16 OF THE 17 COMMODITY GROUPS HAVE POSITIVE INCOME ELASTICITIES
*THE AVERAGE IS GREATER THAN 1 FOR THE FOLLOWING 10 CATEGORIES:
*EU2  Alcoholic beverages             
*EU4  Clothing and footwear 
*EU7 Furnishings, households equipment and routine maintenance of the house
*EU8 Health
*EU9 Purchase of vehicles
*EU11 Transport services
*EU12 Communications
*EU13 Recreation and culture
*EU16 Miscellaneous goods and services
*EU17 Final consumption expenditure of resident households abroad

*THE NEGATIVE INCOME ELASTICITY OF DEMAND CATEGORY IS:
*EU3 Tobacco  (TASTE CHANGE IS PROBABLY BEHIND THE LOWER CONSUMPTION OF TOBACCO OVER TIME)

*THE 6 CATEGORIES THAT HAVE INCOME ELASTICITIES BETWEEN 0 AND 1 ARE:
*EU1  Food and non-alcoholic beverages  FOOD, DRINKS AND CLOTHING GROWS LESS THAN INCOME GROWTH
*EU5  Housing
*EU6 Electricity, gas and other fuels
*EU10 Operation of personal transport equipment  TIME SPENT GOING TO AND FROM WORK DOES NOT CHANGE MUCH
*EU14 Education
*EU15 Restaurants and hotels

*1 IS THE SERIES       P31CP010: Food and non-alcoholic beverages
*2 IS THE SERIES       P31CP021: Alcoholic beverages
*3 IS THE SERIES       P31CP022: Tobacco
*4 IS THE SERIES       P31CP030: Clothing and footwear
*5 IS THE SERIES       P31CP041+P31CP042+P31CP043+P31CP044: HOUSING AGGREGATE
*6 IS THE SERIES       P31CP045: Electricity, gas and other fuels
*7 IS THE SERIES       P31CP050: Furnishings, households equipment and routine maintenance of the house
*8 IS THE SERIES       P31CP060: Health
*9 IS THE SERIES       P31CP071: Purchase of vehicles
*10 IS THE SERIES      P31CP072: Operation of personal transport equipment
*11 IS THE SERIES      P31CP073: Transport services
*12 IS THE SERIES      P31CP080: Communications
*13 IS THE SERIES      P31CP090: Recreation and culture
*14 IS THE SERIES      P31CP100: Education
*15 IS THE SERIES      P31CP110: Restaurants and hotels
*16 IS THE SERIES      P31CP120: Miscellaneous goods and services
*17 IS THE SERIES      P33:      Final consumption expenditure of resident households abroad
STOP