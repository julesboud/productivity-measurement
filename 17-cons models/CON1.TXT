*THIS IS THE FILE E59419C\CON1.TXT THAT ESTIMATES NONHOMOTHETIC LEONTIEF PREFERENCES             JUly 2, 2019
*WE DO NOT IMPOSE MONEY METRIC UTILITY SCALING IN THIS MODEL
PAR 10000                   
SIZE 1000
SET NODOECHO
*READ IN CANADIAN DATA FOR 1995-2018 FOR 17 CLASSES OF PER POP CONSUMPTION FROM E59419C\CDATOUT.TXT
SMPL 1 24
READ YEAR P1-P9 
   1995.   1.00000   1.00000   1.00000   1.00000   1.00000   1.00000   1.00000   1.00000   1.00000
   1996.   1.01100   1.02319   1.02207   0.99450   1.01176   1.01117   1.01129   1.01208   1.04213
   1997.   1.02483   1.04483   1.08894   1.00850   1.01920   1.04733   1.02317   1.02320   1.06633
   1998.   1.03978   1.06417   1.14201   1.01823   1.03028   1.05416   1.03589   1.04535   1.07372
   1999.   1.05109   1.08460   1.17458   1.03337   1.04112   1.08522   1.06160   1.06634   1.09766
   2000.   1.06733   1.10045   1.23336   1.03142   1.05375   1.18847   1.07334   1.09039   1.08959
   2001.   1.11371   1.12579   1.38605   1.03455   1.06723   1.30032   1.08603   1.11960   1.10150
   2002.   1.14323   1.15096   1.77427   1.02739   1.08385   1.25609   1.10303   1.14159   1.11323
   2003.   1.16231   1.17148   2.04585   1.00599   1.09496   1.36631   1.11013   1.16160   1.11455
   2004.   1.18215   1.19991   2.13756   1.00156   1.10536   1.41420   1.10992   1.18103   1.11466
   2005.   1.21089   1.21975   2.15046   0.99347   1.11459   1.52205   1.11169   1.21062   1.12207
   2006.   1.23876   1.22926   2.15558   0.97346   1.13560   1.59517   1.11317   1.23950   1.12208
   2007.   1.26922   1.25305   2.22575   0.96529   1.16760   1.58676   1.11565   1.26406   1.11806
   2008.   1.31311   1.26470   2.24866   0.93669   1.19481   1.71241   1.11039   1.28708   1.03764
   2009.   1.37925   1.28468   2.31779   0.92129   1.21356   1.54121   1.12936   1.32084   0.99360
   2010.   1.39441   1.28147   2.42111   0.89116   1.22811   1.60992   1.12079   1.35012   1.04349
   2011.   1.44210   1.28118   2.53252   0.88468   1.24329   1.66535   1.12172   1.37234   1.06043
   2012.   1.47516   1.29553   2.58673   0.87956   1.26199   1.68802   1.12491   1.37936   1.08394
   2013.   1.49314   1.31596   2.65332   0.87739   1.28363   1.74250   1.12828   1.38734   1.09615
   2014.   1.53201   1.32971   2.86486   0.88983   1.30346   1.85533   1.13331   1.40341   1.11676
   2015.   1.57639   1.35718   3.00918   0.90238   1.31953   1.83457   1.15755   1.42426   1.13966
   2016.   1.59441   1.37821   3.17269   0.89981   1.33128   1.83636   1.18247   1.44524   1.16934
   2017.   1.58848   1.39917   3.33244   0.89296   1.34180   1.80611   1.18179   1.47358   1.20028
   2018.   1.59933   1.42161   3.60265   0.90227   1.36168   1.80472   1.18549   1.49108   1.22195
FORMAT(F8.0,9F10.5)
PRINT YEAR P1-P9 / FORMAT
READ YEAR P10-P17
   1995.   1.00000   1.00000   1.00000   1.00000   1.00000   1.00000   1.00000   1.00000
   1996.   1.02772   1.02777   1.04795   1.00721   1.04597   1.01509   1.02736   1.02031
   1997.   1.04105   1.02885   1.08806   1.01499   1.07942   1.03099   1.05699   1.05659
   1998.   1.00166   1.06325   1.11485   1.01526   1.12912   1.05296   1.07165   1.14239
   1999.   1.05172   1.10383   1.07588   1.02075   1.17503   1.07576   1.09145   1.17537
   2000.   1.17542   1.14867   1.07723   1.02844   1.21610   1.10374   1.12055   1.22417
   2001.   1.17726   1.15165   1.09287   1.03786   1.25542   1.13519   1.12646   1.29436
   2002.   1.18979   1.20282   1.10572   1.05048   1.29524   1.16901   1.14885   1.32607
   2003.   1.24967   1.20494   1.10837   1.05809   1.35196   1.19371   1.17317   1.24804
   2004.   1.32910   1.21416   1.11588   1.05607   1.42351   1.22574   1.19334   1.22704
   2005.   1.44759   1.24044   1.12324   1.05342   1.45563   1.26071   1.21451   1.18511
   2006.   1.50812   1.28720   1.12817   1.04416   1.47606   1.29414   1.23324   1.15148
   2007.   1.57481   1.29769   1.14560   1.03514   1.50816   1.32914   1.25257   1.14786
   2008.   1.70892   1.34006   1.16009   1.02756   1.55603   1.36158   1.26557   1.19342
   2009.   1.55828   1.30531   1.17229   1.03476   1.62155   1.39816   1.26414   1.22696
   2010.   1.65295   1.35053   1.20811   1.03924   1.68494   1.43105   1.29071   1.13138
   2011.   1.84357   1.38876   1.22703   1.04502   1.74443   1.46709   1.30841   1.14082
   2012.   1.89206   1.42732   1.24736   1.04154   1.80982   1.50095   1.31796   1.15053
   2013.   1.90767   1.46762   1.26849   1.04021   1.87522   1.52798   1.33646   1.20244
   2014.   1.92208   1.48347   1.32841   1.04816   1.92927   1.55694   1.35493   1.28503
   2015.   1.74672   1.47623   1.37606   1.06409   1.98534   1.60087   1.35930   1.38238
   2016.   1.70451   1.46423   1.37777   1.08000   2.04259   1.64291   1.36219   1.41120
   2017.   1.82211   1.47242   1.37080   1.08945   2.09687   1.68400   1.36948   1.41420
   2018.   1.94697   1.49824   1.37215   1.10288   2.16226   1.73262   1.38295   1.43629
PRINT YEAR P10-P17 / FORMAT
READ YEAR Q1-Q9 
   1995.   1.61728   0.33014   0.26483   0.85328   3.34547   0.51740   0.88928   0.46676   0.84447
   1996.   1.62690   0.30554   0.26385   0.84805   3.37949   0.53429   0.88667   0.47434   0.88931
   1997.   1.64083   0.31690   0.26294   0.85666   3.42956   0.51032   0.92585   0.51520   1.05235
   1998.   1.66242   0.32652   0.26610   0.87416   3.48469   0.47300   0.96147   0.54374   1.06509
   1999.   1.68788   0.33730   0.25616   0.89166   3.54029   0.48445   0.98717   0.56290   1.14338
   2000.   1.72550   0.34530   0.24576   0.92886   3.60051   0.49697   1.02817   0.58830   1.19917
   2001.   1.72951   0.35361   0.23581   0.95244   3.65851   0.46747   1.06378   0.61686   1.20582
   2002.   1.73747   0.36615   0.22122   0.97684   3.74303   0.47820   1.11196   0.65084   1.33484
   2003.   1.75812   0.37602   0.20714   1.00471   3.83907   0.48707   1.15025   0.66962   1.34803
   2004.   1.77630   0.37722   0.19986   1.02632   3.94520   0.48199   1.20264   0.70220   1.31954
   2005.   1.77485   0.38388   0.18896   1.05835   4.05284   0.47952   1.24541   0.73094   1.35101
   2006.   1.78915   0.39748   0.18016   1.12379   4.16285   0.45601   1.32053   0.76877   1.38691
   2007.   1.80231   0.40864   0.17209   1.17144   4.27169   0.47686   1.37809   0.80751   1.44789
   2008.   1.81606   0.41849   0.16745   1.20205   4.37998   0.46975   1.41246   0.83314   1.50939
   2009.   1.81176   0.41637   0.16342   1.18857   4.46900   0.46266   1.35670   0.84508   1.45600
   2010.   1.81535   0.41823   0.16939   1.26973   4.56486   0.44734   1.38279   0.86084   1.50734
   2011.   1.79472   0.42383   0.16438   1.30598   4.66052   0.45478   1.37793   0.87142   1.48624
   2012.   1.78401   0.42983   0.16242   1.32936   4.74536   0.43633   1.37115   0.88018   1.54680
   2013.   1.79653   0.42608   0.15847   1.36355   4.84009   0.44011   1.38483   0.89738   1.62302
   2014.   1.80752   0.43152   0.15157   1.39068   4.93804   0.44150   1.42067   0.90993   1.69430
   2015.   1.81958   0.43888   0.14858   1.44545   5.07595   0.43593   1.43673   0.93435   1.76368
   2016.   1.83981   0.44251   0.14254   1.45865   5.17184   0.42173   1.45204   0.95584   1.80997
   2017.   1.88962   0.44997   0.13810   1.48819   5.26937   0.42684   1.49886   0.96598   1.91593
   2018.   1.89766   0.45631   0.13227   1.49040   5.34634   0.44140   1.51770   0.97374   1.86462
PRINT YEAR Q1-Q9 / FORMAT
READ YEAR Q10-Q17 
   1995.   0.90358   0.31626   0.28752   1.40057   0.16132   1.14940   1.98561   0.47791
   1996.   0.91305   0.33040   0.29791   1.44687   0.16615   1.16076   2.06859   0.49848
   1997.   0.91477   0.35253   0.30793   1.53986   0.17360   1.19199   2.14873   0.49727
   1998.   0.94696   0.35624   0.32509   1.64866   0.17704   1.23043   2.21876   0.44434
   1999.   0.98515   0.34358   0.34777   1.74594   0.17955   1.26732   2.28663   0.45412
   2000.   0.99152   0.34746   0.38254   1.85063   0.18190   1.30727   2.34209   0.48104
   2001.   0.99547   0.33397   0.40335   1.90765   0.18444   1.31129   2.38194   0.47134
   2002.   1.01190   0.31563   0.43656   1.96355   0.19211   1.30982   2.47002   0.44943
   2003.   1.01731   0.30782   0.45023   1.98801   0.19907   1.27831   2.48746   0.48455
   2004.   1.03039   0.32784   0.47176   2.04618   0.19987   1.29594   2.58784   0.54875
   2005.   1.03883   0.34154   0.49901   2.12251   0.20587   1.30573   2.68601   0.61797
   2006.   1.04934   0.35125   0.52371   2.22134   0.21139   1.31819   2.78256   0.68080
   2007.   1.07325   0.36616   0.53548   2.33043   0.21550   1.32783   2.91215   0.76470
   2008.   1.06660   0.37606   0.54527   2.38516   0.22033   1.32729   2.91503   0.79037
   2009.   1.05126   0.36386   0.57201   2.34796   0.22303   1.26800   2.83550   0.75008
   2010.   1.07207   0.38217   0.57010   2.37495   0.22984   1.27354   2.92931   0.89398
   2011.   1.08574   0.39869   0.58719   2.37892   0.23559   1.27783   2.98777   0.93267
   2012.   1.07348   0.40455   0.58965   2.39240   0.24073   1.28803   2.97455   0.96782
   2013.   1.10036   0.40380   0.60190   2.38706   0.24617   1.30088   3.02679   0.94417
   2014.   1.11993   0.41652   0.59754   2.39630   0.25065   1.33088   3.11939   0.90259
   2015.   1.14072   0.42777   0.60086   2.40425   0.25644   1.34966   3.22616   0.85493
   2016.   1.15061   0.44643   0.61625   2.38875   0.26114   1.37419   3.28693   0.82696
   2017.   1.16477   0.46845   0.63848   2.42740   0.26590   1.39804   3.37407   0.88098
   2018.   1.15677   0.48211   0.64674   2.41942   0.26920   1.39865   3.44671   0.89121
PRINT YEAR Q10-Q17 / FORMAT
*1 IS THE SERIES       P31CP010: Food and non-alcoholic beverages
*2 IS THE SERIES       P31CP021: Alcoholic beverages
*3 IS THE SERIES       P31CP022: Tobacco
*4 IS THE SERIES       P31CP030: Clothing and footwear
*5 IS THE SERIES       P31CP041+P31CP042+P31CP043+P31CP044: HOUSING AGGREGATE
*6 IS THE SERIES       P31CP045: Electricity, gas and other fuels
*7 IS THE SERIES       P31CP050: Furnishings, households equipment and routine maintenance of the house
*8 IS THE SERIES       P31CP060: Health
*9 IS THE SERIES       P31CP071: Purchase of vehicles
*10 IS THE SERIES      P31CP072: Operation of personal transport equipment
*11 IS THE SERIES      P31CP073: Transport services
*12 IS THE SERIES      P31CP080: Communications
*13 IS THE SERIES      P31CP090: Recreation and culture
*14 IS THE SERIES      P31CP100: Education
*15 IS THE SERIES      P31CP110: Restaurants and hotels
*16 IS THE SERIES      P31CP120: Miscellaneous goods and services
*17 IS THE SERIES      P33:      Final consumption expenditure of resident households abroad
DO #=1,17
GENR V#=P#*Q#
ENDO

*GENR CHAINED FISHER PRICE AND QUANTITY INDEXES
INDEX P1 Q1 P2 Q2 P3 Q3 P4 Q4 P5 Q5 P6 Q6 P7 Q7 P8 Q8 P9 Q9 P10 Q10 &
P11 Q11 P12 Q12 P13 Q13 P14 Q14 P15 Q15 P16 Q16 P17 Q17 / CHAIN FISHER=PF QFISHER=QF
*GENR EXPENDITURE Y ON THE 17 COMMODITIES
GENR Y=PF*QF
*GENR THE NORMALIZED QUADRATIC FIXED BASE AND CHAINED INDEXES
*WE FIRST NEED TO GENR FIXED WEIGHTS SUMMING TO 1,G1 TO G17. WE INITIALLY DEFINE THESE G# AS SAMPLE MEANS
DO #=1,17
STAT Q# / MEAN=GG#
ENDO
*SUM THE GG#
SMPL 1 1
GENR SUM=0
DO #=1,17
GENR SUM=SUM+GG#
ENDO
*DEFINE THE NORMALIZED GG#
DO #=1,17
GENR GG#=GG#/SUM
ENDO
FORMAT(9F10.5)
PRINT GG1-GG9 / FORMAT
PRINT GG10-GG17 / FORMAT
SMPL 1 24
GENR ONE=1
DO #=1,17
GENR G#=GG#(1)*ONE
ENDO
*GENR THE LOWE PRICE INDEX PG
GENR PG=0
DO #=1,17
GENR PG=PG+P#*G#
ENDO
*GENR PG NORMALIZED PRICES:
DO #=1,17
GENR PN#=P#/PG
ENDO
FORMAT(9F10.5)
PRINT PG PN1-PN8 / FORMAT
PRINT PN9-PN17 / FORMAT
STAT PG PN1-PN17

*THE EXACT INDEX NUMBER FORMULA FOR NORMALIZED QUADRATIC PREFERENCES USING A FIXED BASE IS
*u(t)/u(1)=SUM(PN#(t)+PN#(1))Q#(t)/(SUM(PN#(t)+PN#(1))Q#(1))
GENR NUM=0
GENR DEN=0
DO #=1,17
GENR NUM=NUM+(PN#+PN#(1))*Q#
GENR DEN=DEN+(PN#+PN#(1))*Q#(1)
ENDO
GENR QNFB=NUM/DEN
*NORMALIZE QNFB TO EQUAL Y IN OBSERVATION 1
GENR CON=QNFB(1)
GENR QNFB=QNFB*Y(1)/CON
GENR PNFB=Y/QNFB
*NOW CONSTRUCT THE NORMALIZED QUADRATIC CHAIN LINKS
GENR QNCH=1
GENR QNCHL=1
GENR NUML=0
GENR DENL=0
SMPL 2 24
DO #=1,17
GENR NUML=NUML+(PN#+LAG(PN#))*Q#
GENR DENL=DENL+(PN#+LAG(PN#))*LAG(Q#)
ENDO
*NOW CONSTRUCT THE NORMALIZED QUADRATIC EXACT INDEX NUMBER FORMULA USING THE CHAIN PRINCIPLE
GENR QNCHL=NUML/DENL
GENR QNCH=LAG(QNCH)*QNCHL
*NORMALIZE QNCH TO EQUAL Y AT OBSERVATION 1
SMPL 1 24
GENR CON=QNCH(1)
GENR QNCH=QNCH*Y(1)/CON
GENR PNCH=Y/QNCH
FORMAT(F8.0,7F10.5)
PRINT YEAR QF QNCH QNFB PF PNCH PNFB Y / FORMAT
*   YEAR      QF        QNCH      QNFB      PF        PNCH      PNFB       Y
*   1995.  15.81108  15.81108  15.81108   1.00000   1.00000   1.00000  15.81108
*   1996.  16.09158  16.09158  16.09158   1.01710   1.01710   1.01710  16.36678
*   1997.  16.64186  16.64186  16.64047   1.03446   1.03446   1.03455  17.21536
*   1998.  17.00409  17.00409  17.00400   1.04747   1.04747   1.04747  17.81120
*   1999.  17.49895  17.49895  17.49807   1.06593   1.06593   1.06598  18.65260
*   2000.  18.03685  18.03685  18.02844   1.09090   1.09090   1.09141  19.67646
*   2001.  18.25272  18.25272  18.23881   1.11290   1.11290   1.11375  20.31351
*   2002.  18.72987  18.72987  18.71273   1.13506   1.13506   1.13610  21.25956
*   2003.  18.99839  18.99838  18.97225   1.15313   1.15313   1.15472  21.90755
*   2004.  19.47251  19.47251  19.44019   1.16957   1.16957   1.17152  22.77450
*   2005.  19.98959  19.98958  19.95457   1.18921   1.18921   1.19130  23.77184
*   2006.  20.58417  20.58416  20.55469   1.20478   1.20478   1.20651  24.79945
*   2007.  21.29055  21.29055  21.25857   1.22313   1.22313   1.22497  26.04112
*   2008.  21.62527  21.62526  21.57018   1.24177   1.24177   1.24494  26.85359
*   2009.  21.37512  21.37511  21.32871   1.24405   1.24405   1.24675  26.59167
*   2010.  21.91988  21.91988  21.86685   1.26221   1.26221   1.26527  27.66740
*   2011.  22.17251  22.17250  22.09277   1.28957   1.28957   1.29422  28.59291
*   2012.  22.32817  22.32816  22.25264   1.30664   1.30664   1.31107  29.17481
*   2013.  22.64249  22.64249  22.56238   1.32470   1.32470   1.32940  29.99444
*   2014.  23.00342  23.00342  22.90949   1.35056   1.35056   1.35610  31.06754
*   2015.  23.41638  23.41637  23.34194   1.36498   1.36498   1.36934  31.96298
*   2016.  23.69004  23.69004  23.61330   1.37872   1.37872   1.38320  32.66183
*   2017.  24.27526  24.27525  24.19638   1.39510   1.39510   1.39965  33.86643
*   2018.  24.44292  24.44292  24.33596   1.41937   1.41937   1.42561  34.69351
*THE CHAINED FISHER AND CHAINED NORMALIZED QUADRATIC INDEXES DIFFER ONLY IN THE 5TH DECIMAL PLACE
*THEY ARE INCREDIBLY CLOSE!

*RUN SEPARATE EQ BY EQU NONHOMOTHETIC LEONTIEF (NO SUBSTITUTION PREFERENCES) REGRESSIONS USING QNCH AS THE UTILITY LEVEL
GENR U=QNCH
*THE EXPENDITURE FUNCTION IS E(U,P) = A.P +B.PU
*THE HICKSIAN DEMAND FUNCTIONS ARE Q=A+BU ; NOTE THAT DEMANDS DO NOT RESPOND TO PRICE CHANGES.
*FIRST ESTIMATE THE HICKSIAN DEMAND FUNCTIONS EQUATION BY EQUATION 
DO #=1,17
OLS Q# U / LIST 
ENDO
*THE FITS ARE NOT GREAT BUT THE MODEL IS VERY SIMPLE. 
*THE R SQUARES FOR THE 20 EQUATIONS ARE AS FOLLOWS:
* .9090 .9787 .9674 .9713 .9732 .8821 .9640 .9942 .9594 .9690 .7323 .9765 .9209 .9802 .6674 .9938 .8315
*NONUNITARY INCOME ELASTICITIES ARE EXPLAINING THE DATA REASONABLY WELL.

*WE WILL NOW RUN A SYSTEM REGRESSION 
NL 17 / NCOEF=34 GENRVAR CONV=.000001 ITER=1000 PITER=50 LIST
EQ Q1=A1+B1*U
EQ Q2=A2+B2*U
EQ Q3=A3+B3*U
EQ Q4=A4+B4*U
EQ Q5=A5+B5*U
EQ Q6=A6+B6*U
EQ Q7=A7+B7*U
EQ Q8=A8+B8*U
EQ Q9=A9+B9*U
EQ Q10=A10+B10*U
EQ Q11=A11+B11*U
EQ Q12=A12+B12*U
EQ Q13=A13+B13*U
EQ Q14=A14+B14*U
EQ Q15=A15+B15*U
EQ Q16=A16+B16*U
EQ Q17=A17+B17*U
COEF A1 0
COEF A2 0
COEF A3 0
COEF A4 0
COEF A5 0
COEF A6 0
COEF A7 0
COEF A8 0
COEF A9 0
COEF A10 0
COEF A11 0
COEF A12 0
COEF A13 0
COEF A14 0
COEF A15 0
COEF A16 0
COEF A17 0
COEF B1 .05
COEF B2 .05
COEF B3 .05
COEF B4 .05
COEF B5 .05
COEF B6 .05
COEF B7 .05
COEF B8 .05
COEF B9 .05
COEF B10 .05
COEF B11 .05
COEF B12 .05
COEF B13 .05
COEF B14 .05
COEF B15 .05
COEF B16 .05
COEF B17 .05
END
* INITIAL LOG-LIKELIHOOD  = 1106.113
* FINAL STATISTICS: TIME =     0.1420 SEC.   ITER. NO.   140   FUNCT. EVALUATIONS   179
* FINAL LOG-LIKELIHOOD FUNCTION = 1378.661
* THE GRADIENT VECTOR IS CLOSE TO 0 SO THE NONLINEAR REGRESSION CONVERGED
*THE SYSTEM ESTIMATES ARE THE SAME AS THE EQ BY EQ ESTIMATES THAT WE GENERATED EARLIER. THIS MAKES SENSE
*SINCE EACH EQUATION IS COMPLETELY INDEPENDENT OF THE OTHER EQUATIONS.
*NOTE THAT NOT ALL ELEMENTS OF THE GRADIENT VECTOR ARE CLOSE TO 0. NEVERTHELESS, THE ESTIMATED COEFFICIENTS HAVE
*STABILIZED SO THAT THE ALGORITHM STOPS. THIS MAY HAPPEN TO YOU; AS LONG AS THE GRADIENTS ARE NOT TOO FAR FROM
*0, WE WILL BE OK.

*GENR FITTED DEMAND EQUATIONS
DO #= 1,17
GENR FQ#=A#+B#*U
ENDO
*COMPARE FITTED DEMANDS WITH ACTUAL DEMANDS
FORMAT(F8.0,10F10.5)
PRINT YEAR Q1 FQ1 Q2 FQ2 Q3 FQ3 Q4 FQ4 Q5 FQ5 / FORMAT
PRINT YEAR Q6 FQ6 Q7 FQ7 Q8 FQ8 Q9 FQ9 Q10 FQ10 / FORMAT
PRINT YEAR Q11 FQ11 Q12 FQ12 Q13 FQ13 Q14 FQ14 Q15 FQ15 / FORMAT
PRINT YEAR Q16 FQ16 Q17 FQ17  / FORMAT
STAT Q1 FQ1 Q2 FQ2 Q3 FQ3 Q4 FQ4 Q5 FQ5 Q6 FQ6 Q7 FQ7 Q8 FQ8 Q9 FQ9 Q10 FQ10
STAT Q11 FQ11 Q12 FQ12 Q13 FQ13 Q14 FQ14 Q15 FQ15 Q16 FQ16 Q17 FQ17  
*THE AVERAGE FITTED DEMAND COINCIDES EXACTLY WITH THE CORRESPONDING ACTUAL AVERAGE DEMAND.

*GENR THE INDIRECT UTILITY FUNCTION THAT IS IMPLIED BY OUR ESTIMATES
*GENR TOTAL EXPENDITURE FOR EACH PERIOD
GENR Y=0
DO #=1,17
GENR Y=Y+V#
ENDO 
*GENR A.P AND B.P
GENR AP=0
GENR BP=0
DO #=1,17
GENR AP=AP+P#*A#
GENR BP=BP+P#*B#
ENDO
*GENR INDIRECT UTILITY THAT IS IMPLIED BY OUR COEFFICIENT ESTIMATES
GENR IU=(Y-AP)/BP
FORMAT(F8.0,5F10.5)
PRINT YEAR U IU AP BP Y / FORMAT
*   YEAR       U        IU         AP       BP         Y
*   1995.  15.81108  15.88218  -0.89131   1.05164  15.81108
*   1996.  16.09158  16.14639  -0.92660   1.07104  16.36678
*   1997.  16.64186  16.67045  -0.92760   1.08833  17.21536
*   1998.  17.00409  17.01769  -0.98305   1.10440  17.81120
*   1999.  17.49895  17.48929  -0.95670   1.12122  18.65260
*   2000.  18.03685  18.00384  -0.81942   1.13842  19.67646
*   2001.  18.25272  18.21008  -0.67545   1.15260  20.31351
*   2002.  18.72987  18.67333  -0.49638   1.16508  21.25956
*   2003.  18.99838  18.94550  -0.17739   1.16571  21.90755
*   2004.  19.47251  19.41875  -0.01932   1.17380  22.77450
*   2005.  19.98958  19.94078   0.17558   1.18332  23.77184
*   2006.  20.58416  20.54007   0.31849   1.19186  24.79945
*   2007.  21.29055  21.25223   0.41330   1.20589  26.04112
*   2008.  21.62526  21.59424   0.66473   1.21277  26.85359
*   2009.  21.37511  21.34274   0.60321   1.21767  26.59167
*   2010.  21.91988  21.89153   0.78884   1.22781  27.66740
*   2011.  22.17250  22.14827   1.00988   1.24538  28.59291
*   2012.  22.32816  22.30655   1.09818   1.25867  29.17481
*   2013.  22.64249  22.63633   1.14532   1.27446  29.99444
*   2014.  23.00342  23.01590   1.27766   1.29432  31.06754
*   2015.  23.41637  23.44440   1.20587   1.31192  31.96298
*   2016.  23.69004  23.72795   1.25793   1.32350  32.66183
*   2017.  24.27525  24.34242   1.36048   1.33536  33.86643
*   2018.  24.44292  24.52120   1.54852   1.35169  34.69351
STAT U IU / PCOR 
* NAME         N    MEAN       ST. DEV      VARIANCE     MINIMUM      MAXIMUM
* U            24   20.387      2.6801      7.1829       15.811       24.443
* IU           24   20.382      2.6850      7.2094       15.882       24.521*
*  CORRELATION MATRIX OF VARIABLES -       24 OBSERVATIONS
* U          1.0000
* IU        0.99987       1.0000
*              U            IU
*THE CORRELATION BETWEEN INDEX NUMBER U, IU AND ECONOMETRIC INDIRECT UTILITY U IS .99987; VERY CLOSE.
*WE REGRESS IU ON U TO SEE HOW TO SPLINE UTILITY IN THE FOLLOWING REGRESSION
OLS IU U / LIST
*HERE IS A PLOT OF THE RESIDUALS FOR THE ABOVE REGRESSION
*     OBS.   OBSERVED     PREDICTED   CALCULATED
*      NO.    VALUE        VALUE       RESIDUAL
*       1    15.882       15.798      0.84434E-01                I         *
*       2    16.146       16.079      0.67660E-01                I       *
*       3    16.670       16.630      0.40497E-01                I    *
*       4    17.018       16.993      0.24874E-01                I  *
*       5    17.489       17.489      0.78040E-03                *
*       6    18.004       18.027     -0.23501E-01             *  I
*       7    18.210       18.244     -0.33503E-01            *   I
*       8    18.673       18.722     -0.48210E-01           *    I
*       9    18.945       18.991     -0.45025E-01           *    I
*      10    19.419       19.465     -0.46709E-01           *    I
*      11    19.941       19.983     -0.42644E-01           *    I
*      12    20.540       20.579     -0.38948E-01            *   I
*      13    21.252       21.287     -0.34390E-01            *   I
*      14    21.594       21.622     -0.27666E-01             *  I
*      15    21.343       21.371     -0.28589E-01             *  I
*      16    21.892       21.917     -0.25502E-01             *  I
*      17    22.148       22.170     -0.21818E-01              * I
*      18    22.307       22.326     -0.19461E-01              * I
*      19    22.636       22.641     -0.45511E-02               *I
*      20    23.016       23.002      0.13473E-01                I *
*      21    23.444       23.416      0.28311E-01                I  *
*      22    23.728       23.690      0.37718E-01                I   *
*      23    24.342       24.276      0.65971E-01                I       *
*      24    24.521       24.444      0.76798E-01                I        *
* DURBIN-WATSON = 0.1098    VON NEUMANN RATIO = 0.1145    RHO =  0.91943
* RESIDUAL SUM = -0.33487E-13  RESIDUAL VARIANCE =  0.19298E-02
* SUM OF ABSOLUTE ERRORS=  0.88103
* R-SQUARE BETWEEN OBSERVED AND PREDICTED = 0.9997
* 2 REASONABLE BREAK POINTS ARE AT OBS 8 AND 18
*OUR ECONOMETRICALLY BASED ESTIMATES OF INDIRECT UTILITY IU ARE FAIRLY CLOSE TO THE INDEX NUMBER ESTIMATES U 
*WE DO NOT HAVE AN EXACT CORRESPONDENCE BUT NEVERTHELESS, OUR ECONOMETRIC ESTIMATES OF UTILITY 
*ARE CLOSE ENOUGH TO FU TO JUSTIFY USING U AS AN APPROXIMATION TO IU.

*GENR INCOME ELASTICITIES OF DEMAND FOR EACH COMMODITY
DO #=1,17
GENR EU#=B#*U/FQ#
ENDO
FORMAT(F8.0,9F9.4)
PRINT YEAR EU1-EU9 / FORMAT
PRINT YEAR EU10-EU17 / FORMAT
*THESE ELASTICITIES LOOK OK
STAT EU1-EU17
* EU1          24  0.30943     0.28460E-01 0.80997E-03  0.25888      0.35066
* EU2          24  0.88522     0.13892E-01 0.19298E-03  0.85862      0.90374
* EU3          24  -1.9215     0.69344     0.48086      -3.2760     -0.98247
* EU4          24   1.4901     0.10287     0.10582E-01   1.3646       1.7036
* EU5          24   1.1601     0.25730E-01 0.66202E-03   1.1271       1.2112
* EU6          24 -0.43341     0.80294E-01 0.64471E-02 -0.56245     -0.30353
* EU7          24   1.2643     0.46537E-01 0.21657E-02   1.2056       1.3580
* EU8          24   1.7150     0.17477     0.30545E-01   1.5088       2.0892
* EU9          24   1.5608     0.12377     0.15319E-01   1.4114       1.8203
* EU10         24  0.54789     0.33342E-01 0.11117E-02  0.48682      0.59457
* EU11         24  0.84239     0.18116E-01 0.32818E-03  0.80790      0.86669
* EU12         24   1.8473     0.22467     0.50475E-01   1.5875       2.3371
* EU13         24   1.1923     0.31820E-01 0.10125E-02   1.1517       1.2558
* EU14         24   1.1810     0.29655E-01 0.87940E-03   1.1432       1.2401
* EU15         24  0.30259     0.28098E-01 0.78952E-03  0.25273      0.34334
* EU16         24   1.1894     0.31259E-01 0.97710E-03   1.1495       1.2517
* EU17         24   2.0493     0.31207     0.97390E-01   1.6993       2.7488

* EU1          47  0.19990     0.33863E-01 0.11467E-02  0.14688      0.26339
* EU2          47  0.19690E-01 0.41245E-02 0.17012E-04  0.13545E-01  0.27726E-01
* EU3          47  -2.4239      2.0154      4.0618      -9.3286     -0.76952
* EU4          47  0.92465     0.14265E-01 0.20348E-03  0.89714      0.94768
* EU5          47   1.1399     0.32391E-01 0.10492E-02   1.0898       1.2066
* EU6          47 -0.46621     0.14981     0.22444E-01 -0.79092     -0.27007
* EU7          47   1.1543     0.36155E-01 0.13072E-02   1.0986       1.2290
* EU8          47   1.9208     0.35294     0.12457       1.4544       2.8482
* EU9          47   1.5941     0.18983     0.36034E-01   1.3260       2.0435
* EU10         47  0.72277     0.41375E-01 0.17119E-02  0.64759      0.79238
* EU11         47  0.41320     0.50795E-01 0.25801E-02  0.32877      0.50427
* EU12         47   3.2357      1.5269      2.3315       1.7557       9.4281
* EU13         47   2.0462     0.42706     0.18238       1.4964       3.2151
* EU14         47   1.0113     0.23272E-02 0.54156E-05   1.0076       1.0159
* EU15         47  0.29754     0.44036E-01 0.19391E-02  0.22669      0.37843
* EU16         47   1.6781     0.22775     0.51869E-01   1.3619       2.2318
* EU17         47   1.3861     0.10782     0.11624E-01   1.2273       1.6252

*ON AVERAGE, 15 OF THE 17 COMMODITY GROUPS HAVE POSITIVE INCOME ELASTICITIES
*THE AVERAGE IS GREATER THAN 1 FOR THE FOLLOWING 10 CATEGORIES:
*EU4  Clothing and footwear 
*EU5  housing
*EU7 Furnishings, households equipment and routine maintenance of the house
*EU8 Health
*EU9 Purchase of vehicles
*EU12 Communications
*EU13 Recreation and culture
*EU14 Education
*EU16 Miscellaneous goods and services
*EU17 Final consumption expenditure of resident households abroad
*THE 2 NEGATIVE INCOME ELASTICITY OF DEMAND CATEGORIES ARE:
*EU3 Tobacco  (TASTE CHANGE IS PROBABLY BEHIND THE LOWER CONSUMPTION OF TOBACCO OVER TIME)
*EU6 Electricity, gas and other fuels
*THE 5 CATEGORIES THAT HAVE INCOME ELASTICITIES BETWEEN 0 AND 1 ARE:
*EU1  Food and non-alcoholic beverages  FOOD, DRINKS AND CLOTHING GROWS LESS THAN INCOME GROWTH
*EU2  Alcoholic beverages               WHICH MAKES SENSE; THERE IS ONLY SO MUCH THAT EACH OF US CAN EAT
*EU4  Clothing and footwear             AND HOW MANY DRESSES OR SUITS DO WE REALLY NEED?
*EU10 Operation of personal transport equipment  TIME SPENT GOING TO AND FROM WORK DOES NOT CHANGE MUCH
*EU11 Transport services
*EU15 Restaurants and hotels            AGAIN, THE RELATIVE DECLINE HERE AS INCOME GROWS TIES IN WITH 
*                                       A LIMITATION ON HOW MUCH WE CAN EAT AND HOW MUCH TIME WE HAVE
*                                       FOR VACATIONS.

*1 IS THE SERIES       P31CP010: Food and non-alcoholic beverages
*2 IS THE SERIES       P31CP021: Alcoholic beverages
*3 IS THE SERIES       P31CP022: Tobacco
*4 IS THE SERIES       P31CP030: Clothing and footwear
*5 IS THE SERIES       P31CP041+P31CP042+P31CP043+P31CP044: HOUSING AGGREGATE
*6 IS THE SERIES       P31CP045: Electricity, gas and other fuels
*7 IS THE SERIES       P31CP050: Furnishings, households equipment and routine maintenance of the house
*8 IS THE SERIES       P31CP060: Health
*9 IS THE SERIES       P31CP071: Purchase of vehicles
*10 IS THE SERIES      P31CP072: Operation of personal transport equipment
*11 IS THE SERIES      P31CP073: Transport services
*12 IS THE SERIES      P31CP080: Communications
*13 IS THE SERIES      P31CP090: Recreation and culture
*14 IS THE SERIES      P31CP100: Education
*15 IS THE SERIES      P31CP110: Restaurants and hotels
*16 IS THE SERIES      P31CP120: Miscellaneous goods and services
*17 IS THE SERIES      P33:      Final consumption expenditure of resident households abroad
STOP













