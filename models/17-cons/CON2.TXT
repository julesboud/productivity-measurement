*THIS IS THE FILE E59418C\CON2.TXT THAT ESTIMATES NONHOMOTHETIC LEONTIEF PREFERENCES            JULY 2, 2019
*WE DO NOT IMPOSE MONEY METRIC UTILITY SCALING IN THIS MODEL; WE SPLINE UTILITY IN THIS MODEL.
*WE HAVE 2 BREAK POINTS IN THIS MODEL
PAR 10000                   
SIZE 1000
SET NODOECHO
*READ IN CANADIAN DATA FOR 1995-2018 FOR 17 CLASSES OF PER POP CONSUMPTION FROM E59419C\CDATOUT.TXT
SMPL 1 24
READ YEAR P1-P9 
   1995.   1.00000   1.00000   1.00000   1.00000   1.00000   1.00000   1.00000   1.00000   1.00000
   1996.   1.01100   1.02319   1.02207   0.99450   1.01176   1.01117   1.01129   1.01208   1.04213
   1997.   1.02483   1.04483   1.08894   1.00850   1.01920   1.04733   1.02317   1.02320   1.06633
   1998.   1.03978   1.06417   1.14201   1.01823   1.03028   1.05416   1.03589   1.04535   1.07372
   1999.   1.05109   1.08460   1.17458   1.03337   1.04112   1.08522   1.06160   1.06634   1.09766
   2000.   1.06733   1.10045   1.23336   1.03142   1.05375   1.18847   1.07334   1.09039   1.08959
   2001.   1.11371   1.12579   1.38605   1.03455   1.06723   1.30032   1.08603   1.11960   1.10150
   2002.   1.14323   1.15096   1.77427   1.02739   1.08385   1.25609   1.10303   1.14159   1.11323
   2003.   1.16231   1.17148   2.04585   1.00599   1.09496   1.36631   1.11013   1.16160   1.11455
   2004.   1.18215   1.19991   2.13756   1.00156   1.10536   1.41420   1.10992   1.18103   1.11466
   2005.   1.21089   1.21975   2.15046   0.99347   1.11459   1.52205   1.11169   1.21062   1.12207
   2006.   1.23876   1.22926   2.15558   0.97346   1.13560   1.59517   1.11317   1.23950   1.12208
   2007.   1.26922   1.25305   2.22575   0.96529   1.16760   1.58676   1.11565   1.26406   1.11806
   2008.   1.31311   1.26470   2.24866   0.93669   1.19481   1.71241   1.11039   1.28708   1.03764
   2009.   1.37925   1.28468   2.31779   0.92129   1.21356   1.54121   1.12936   1.32084   0.99360
   2010.   1.39441   1.28147   2.42111   0.89116   1.22811   1.60992   1.12079   1.35012   1.04349
   2011.   1.44210   1.28118   2.53252   0.88468   1.24329   1.66535   1.12172   1.37234   1.06043
   2012.   1.47516   1.29553   2.58673   0.87956   1.26199   1.68802   1.12491   1.37936   1.08394
   2013.   1.49314   1.31596   2.65332   0.87739   1.28363   1.74250   1.12828   1.38734   1.09615
   2014.   1.53201   1.32971   2.86486   0.88983   1.30346   1.85533   1.13331   1.40341   1.11676
   2015.   1.57639   1.35718   3.00918   0.90238   1.31953   1.83457   1.15755   1.42426   1.13966
   2016.   1.59441   1.37821   3.17269   0.89981   1.33128   1.83636   1.18247   1.44524   1.16934
   2017.   1.58848   1.39917   3.33244   0.89296   1.34180   1.80611   1.18179   1.47358   1.20028
   2018.   1.59933   1.42161   3.60265   0.90227   1.36168   1.80472   1.18549   1.49108   1.22195
FORMAT(F8.0,9F10.5)
PRINT YEAR P1-P9 / FORMAT
READ YEAR P10-P17
   1995.   1.00000   1.00000   1.00000   1.00000   1.00000   1.00000   1.00000   1.00000
   1996.   1.02772   1.02777   1.04795   1.00721   1.04597   1.01509   1.02736   1.02031
   1997.   1.04105   1.02885   1.08806   1.01499   1.07942   1.03099   1.05699   1.05659
   1998.   1.00166   1.06325   1.11485   1.01526   1.12912   1.05296   1.07165   1.14239
   1999.   1.05172   1.10383   1.07588   1.02075   1.17503   1.07576   1.09145   1.17537
   2000.   1.17542   1.14867   1.07723   1.02844   1.21610   1.10374   1.12055   1.22417
   2001.   1.17726   1.15165   1.09287   1.03786   1.25542   1.13519   1.12646   1.29436
   2002.   1.18979   1.20282   1.10572   1.05048   1.29524   1.16901   1.14885   1.32607
   2003.   1.24967   1.20494   1.10837   1.05809   1.35196   1.19371   1.17317   1.24804
   2004.   1.32910   1.21416   1.11588   1.05607   1.42351   1.22574   1.19334   1.22704
   2005.   1.44759   1.24044   1.12324   1.05342   1.45563   1.26071   1.21451   1.18511
   2006.   1.50812   1.28720   1.12817   1.04416   1.47606   1.29414   1.23324   1.15148
   2007.   1.57481   1.29769   1.14560   1.03514   1.50816   1.32914   1.25257   1.14786
   2008.   1.70892   1.34006   1.16009   1.02756   1.55603   1.36158   1.26557   1.19342
   2009.   1.55828   1.30531   1.17229   1.03476   1.62155   1.39816   1.26414   1.22696
   2010.   1.65295   1.35053   1.20811   1.03924   1.68494   1.43105   1.29071   1.13138
   2011.   1.84357   1.38876   1.22703   1.04502   1.74443   1.46709   1.30841   1.14082
   2012.   1.89206   1.42732   1.24736   1.04154   1.80982   1.50095   1.31796   1.15053
   2013.   1.90767   1.46762   1.26849   1.04021   1.87522   1.52798   1.33646   1.20244
   2014.   1.92208   1.48347   1.32841   1.04816   1.92927   1.55694   1.35493   1.28503
   2015.   1.74672   1.47623   1.37606   1.06409   1.98534   1.60087   1.35930   1.38238
   2016.   1.70451   1.46423   1.37777   1.08000   2.04259   1.64291   1.36219   1.41120
   2017.   1.82211   1.47242   1.37080   1.08945   2.09687   1.68400   1.36948   1.41420
   2018.   1.94697   1.49824   1.37215   1.10288   2.16226   1.73262   1.38295   1.43629
PRINT YEAR P10-P17 / FORMAT
READ YEAR Q1-Q9 
   1995.   1.61728   0.33014   0.26483   0.85328   3.34547   0.51740   0.88928   0.46676   0.84447
   1996.   1.62690   0.30554   0.26385   0.84805   3.37949   0.53429   0.88667   0.47434   0.88931
   1997.   1.64083   0.31690   0.26294   0.85666   3.42956   0.51032   0.92585   0.51520   1.05235
   1998.   1.66242   0.32652   0.26610   0.87416   3.48469   0.47300   0.96147   0.54374   1.06509
   1999.   1.68788   0.33730   0.25616   0.89166   3.54029   0.48445   0.98717   0.56290   1.14338
   2000.   1.72550   0.34530   0.24576   0.92886   3.60051   0.49697   1.02817   0.58830   1.19917
   2001.   1.72951   0.35361   0.23581   0.95244   3.65851   0.46747   1.06378   0.61686   1.20582
   2002.   1.73747   0.36615   0.22122   0.97684   3.74303   0.47820   1.11196   0.65084   1.33484
   2003.   1.75812   0.37602   0.20714   1.00471   3.83907   0.48707   1.15025   0.66962   1.34803
   2004.   1.77630   0.37722   0.19986   1.02632   3.94520   0.48199   1.20264   0.70220   1.31954
   2005.   1.77485   0.38388   0.18896   1.05835   4.05284   0.47952   1.24541   0.73094   1.35101
   2006.   1.78915   0.39748   0.18016   1.12379   4.16285   0.45601   1.32053   0.76877   1.38691
   2007.   1.80231   0.40864   0.17209   1.17144   4.27169   0.47686   1.37809   0.80751   1.44789
   2008.   1.81606   0.41849   0.16745   1.20205   4.37998   0.46975   1.41246   0.83314   1.50939
   2009.   1.81176   0.41637   0.16342   1.18857   4.46900   0.46266   1.35670   0.84508   1.45600
   2010.   1.81535   0.41823   0.16939   1.26973   4.56486   0.44734   1.38279   0.86084   1.50734
   2011.   1.79472   0.42383   0.16438   1.30598   4.66052   0.45478   1.37793   0.87142   1.48624
   2012.   1.78401   0.42983   0.16242   1.32936   4.74536   0.43633   1.37115   0.88018   1.54680
   2013.   1.79653   0.42608   0.15847   1.36355   4.84009   0.44011   1.38483   0.89738   1.62302
   2014.   1.80752   0.43152   0.15157   1.39068   4.93804   0.44150   1.42067   0.90993   1.69430
   2015.   1.81958   0.43888   0.14858   1.44545   5.07595   0.43593   1.43673   0.93435   1.76368
   2016.   1.83981   0.44251   0.14254   1.45865   5.17184   0.42173   1.45204   0.95584   1.80997
   2017.   1.88962   0.44997   0.13810   1.48819   5.26937   0.42684   1.49886   0.96598   1.91593
   2018.   1.89766   0.45631   0.13227   1.49040   5.34634   0.44140   1.51770   0.97374   1.86462
PRINT YEAR Q1-Q9 / FORMAT
READ YEAR Q10-Q17 
   1995.   0.90358   0.31626   0.28752   1.40057   0.16132   1.14940   1.98561   0.47791
   1996.   0.91305   0.33040   0.29791   1.44687   0.16615   1.16076   2.06859   0.49848
   1997.   0.91477   0.35253   0.30793   1.53986   0.17360   1.19199   2.14873   0.49727
   1998.   0.94696   0.35624   0.32509   1.64866   0.17704   1.23043   2.21876   0.44434
   1999.   0.98515   0.34358   0.34777   1.74594   0.17955   1.26732   2.28663   0.45412
   2000.   0.99152   0.34746   0.38254   1.85063   0.18190   1.30727   2.34209   0.48104
   2001.   0.99547   0.33397   0.40335   1.90765   0.18444   1.31129   2.38194   0.47134
   2002.   1.01190   0.31563   0.43656   1.96355   0.19211   1.30982   2.47002   0.44943
   2003.   1.01731   0.30782   0.45023   1.98801   0.19907   1.27831   2.48746   0.48455
   2004.   1.03039   0.32784   0.47176   2.04618   0.19987   1.29594   2.58784   0.54875
   2005.   1.03883   0.34154   0.49901   2.12251   0.20587   1.30573   2.68601   0.61797
   2006.   1.04934   0.35125   0.52371   2.22134   0.21139   1.31819   2.78256   0.68080
   2007.   1.07325   0.36616   0.53548   2.33043   0.21550   1.32783   2.91215   0.76470
   2008.   1.06660   0.37606   0.54527   2.38516   0.22033   1.32729   2.91503   0.79037
   2009.   1.05126   0.36386   0.57201   2.34796   0.22303   1.26800   2.83550   0.75008
   2010.   1.07207   0.38217   0.57010   2.37495   0.22984   1.27354   2.92931   0.89398
   2011.   1.08574   0.39869   0.58719   2.37892   0.23559   1.27783   2.98777   0.93267
   2012.   1.07348   0.40455   0.58965   2.39240   0.24073   1.28803   2.97455   0.96782
   2013.   1.10036   0.40380   0.60190   2.38706   0.24617   1.30088   3.02679   0.94417
   2014.   1.11993   0.41652   0.59754   2.39630   0.25065   1.33088   3.11939   0.90259
   2015.   1.14072   0.42777   0.60086   2.40425   0.25644   1.34966   3.22616   0.85493
   2016.   1.15061   0.44643   0.61625   2.38875   0.26114   1.37419   3.28693   0.82696
   2017.   1.16477   0.46845   0.63848   2.42740   0.26590   1.39804   3.37407   0.88098
   2018.   1.15677   0.48211   0.64674   2.41942   0.26920   1.39865   3.44671   0.89121
PRINT YEAR Q10-Q17 / FORMAT
*1 IS THE SERIES       P31CP010: Food and non-alcoholic beverages
*2 IS THE SERIES       P31CP021: Alcoholic beverages
*3 IS THE SERIES       P31CP022: Tobacco
*4 IS THE SERIES       P31CP030: Clothing and footwear
*5 IS THE SERIES       P31CP041+P31CP042+P31CP043+P31CP044: HOUSING AGGREGATE
*6 IS THE SERIES       P31CP045: Electricity, gas and other fuels
*7 IS THE SERIES       P31CP050: Furnishings, households equipment and routine maintenance of the house
*8 IS THE SERIES       P31CP060: Health
*9 IS THE SERIES       P31CP071: Purchase of vehicles
*10 IS THE SERIES      P31CP072: Operation of personal transport equipment
*11 IS THE SERIES      P31CP073: Transport services
*12 IS THE SERIES      P31CP080: Communications
*13 IS THE SERIES      P31CP090: Recreation and culture
*14 IS THE SERIES      P31CP100: Education
*15 IS THE SERIES      P31CP110: Restaurants and hotels
*16 IS THE SERIES      P31CP120: Miscellaneous goods and services
*17 IS THE SERIES      P33:      Final consumption expenditure of resident households abroad
DO #=1,17
GENR V#=P#*Q#
ENDO

*GENR CHAINED FISHER PRICE AND QUANTITY INDEXES
INDEX P1 Q1 P2 Q2 P3 Q3 P4 Q4 P5 Q5 P6 Q6 P7 Q7 P8 Q8 P9 Q9 P10 Q10 &
P11 Q11 P12 Q12 P13 Q13 P14 Q14 P15 Q15 P16 Q16 P17 Q17 / CHAIN FISHER=PF QFISHER=QF
*GENR EXPENDITURE Y ON THE 17 COMMODITIES
GENR Y=PF*QF
*GENR THE NORMALIZED QUADRATIC FIXED BASE AND CHAINED INDEXES
*WE FIRST NEED TO GENR FIXED WEIGHTS SUMMING TO 1,G1 TO G17. WE INITIALLY DEFINE THESE G# AS SAMPLE MEANS
DO #=1,17
STAT Q# / MEAN=GG#
ENDO
*SUM THE GG#
SMPL 1 1
GENR SUM=0
DO #=1,17
GENR SUM=SUM+GG#
ENDO
*DEFINE THE NORMALIZED GG#
DO #=1,17
GENR GG#=GG#/SUM
ENDO
FORMAT(9F10.5)
PRINT GG1-GG9 / FORMAT
PRINT GG10-GG17 / FORMAT
SMPL 1 24
GENR ONE=1
DO #=1,17
GENR G#=GG#(1)*ONE
ENDO
*GENR THE LOWE PRICE INDEX PG
GENR PG=0
DO #=1,17
GENR PG=PG+P#*G#
ENDO
*GENR PG NORMALIZED PRICES:
DO #=1,17
GENR PN#=P#/PG
ENDO
FORMAT(9F10.5)
PRINT PG PN1-PN8 / FORMAT
PRINT PN9-PN17 / FORMAT
STAT PG PN1-PN17

*THE EXACT INDEX NUMBER FORMULA FOR NORMALIZED QUADRATIC PREFERENCES USING A FIXED BASE IS
*u(t)/u(1)=SUM(PN#(t)+PN#(1))Q#(t)/(SUM(PN#(t)+PN#(1))Q#(1))
GENR NUM=0
GENR DEN=0
DO #=1,17
GENR NUM=NUM+(PN#+PN#(1))*Q#
GENR DEN=DEN+(PN#+PN#(1))*Q#(1)
ENDO
GENR QNFB=NUM/DEN
*NORMALIZE QNFB TO EQUAL Y IN OBSERVATION 1
GENR CON=QNFB(1)
GENR QNFB=QNFB*Y(1)/CON
GENR PNFB=Y/QNFB
*NOW CONSTRUCT THE NORMALIZED QUADRATIC CHAIN LINKS
GENR QNCH=1
GENR QNCHL=1
GENR NUML=0
GENR DENL=0
SMPL 2 24
DO #=1,17
GENR NUML=NUML+(PN#+LAG(PN#))*Q#
GENR DENL=DENL+(PN#+LAG(PN#))*LAG(Q#)
ENDO
*NOW CONSTRUCT THE NORMALIZED QUADRATIC EXACT INDEX NUMBER FORMULA USING THE CHAIN PRINCIPLE
GENR QNCHL=NUML/DENL
GENR QNCH=LAG(QNCH)*QNCHL
*NORMALIZE QNCH TO EQUAL Y AT OBSERVATION 1
SMPL 1 24
GENR CON=QNCH(1)
GENR QNCH=QNCH*Y(1)/CON
GENR PNCH=Y/QNCH
FORMAT(F8.0,7F10.5)
PRINT YEAR QF QNCH QNFB PF PNCH PNFB Y / FORMAT
*   YEAR      QF        QNCH      QNFB      PF        PNCH      PNFB       Y
*   1995.  15.81108  15.81108  15.81108   1.00000   1.00000   1.00000  15.81108
*   1996.  16.09158  16.09158  16.09158   1.01710   1.01710   1.01710  16.36678
*   1997.  16.64186  16.64186  16.64047   1.03446   1.03446   1.03455  17.21536
*   1998.  17.00409  17.00409  17.00400   1.04747   1.04747   1.04747  17.81120
*   1999.  17.49895  17.49895  17.49807   1.06593   1.06593   1.06598  18.65260
*   2000.  18.03685  18.03685  18.02844   1.09090   1.09090   1.09141  19.67646
*   2001.  18.25272  18.25272  18.23881   1.11290   1.11290   1.11375  20.31351
*   2002.  18.72987  18.72987  18.71273   1.13506   1.13506   1.13610  21.25956
*   2003.  18.99839  18.99838  18.97225   1.15313   1.15313   1.15472  21.90755
*   2004.  19.47251  19.47251  19.44019   1.16957   1.16957   1.17152  22.77450
*   2005.  19.98959  19.98958  19.95457   1.18921   1.18921   1.19130  23.77184
*   2006.  20.58417  20.58416  20.55469   1.20478   1.20478   1.20651  24.79945
*   2007.  21.29055  21.29055  21.25857   1.22313   1.22313   1.22497  26.04112
*   2008.  21.62527  21.62526  21.57018   1.24177   1.24177   1.24494  26.85359
*   2009.  21.37512  21.37511  21.32871   1.24405   1.24405   1.24675  26.59167
*   2010.  21.91988  21.91988  21.86685   1.26221   1.26221   1.26527  27.66740
*   2011.  22.17251  22.17250  22.09277   1.28957   1.28957   1.29422  28.59291
*   2012.  22.32817  22.32816  22.25264   1.30664   1.30664   1.31107  29.17481
*   2013.  22.64249  22.64249  22.56238   1.32470   1.32470   1.32940  29.99444
*   2014.  23.00342  23.00342  22.90949   1.35056   1.35056   1.35610  31.06754
*   2015.  23.41638  23.41637  23.34194   1.36498   1.36498   1.36934  31.96298
*   2016.  23.69004  23.69004  23.61330   1.37872   1.37872   1.38320  32.66183
*   2017.  24.27526  24.27525  24.19638   1.39510   1.39510   1.39965  33.86643
*   2018.  24.44292  24.44292  24.33596   1.41937   1.41937   1.42561  34.69351
*THE CHAINED FISHER AND CHAINED NORMALIZED QUADRATIC INDEXES DIFFER ONLY IN THE 5TH DECIMAL PLACE
*THEY ARE INCREDIBLY CLOSE!

*RUN SEPARATE EQ BY EQU NONHOMOTHETIC LEONTIEF (NO SUBSTITUTION PREFERENCES) REGRESSIONS USING QNCH AS THE UTILITY LEVEL
GENR U=QNCH
*THE EXPENDITURE FUNCTION IS E(U,P) = A.P +B.PU

*USE QNCH AS THE EXOGENOUS UTILITY LEVEL WHEN WE FIT A NORMALIZED QUADRATIC EXPENDITURE FUNCTION BELOW.
GENR U=QNCH
*THE EXPENDITURE FUNCTION  WITHOUT SPLINES ON UTILITY IS E(U,P) = A.P +B.PU
*THE HICKSIAN DEMAND FUNCTIONS IN CON1 WERE Q=A+BU
*IN THIS RUN, WE WILL SPLINE UTILITY AT 2 BREAK POINTS 8 AND 18
GENR U=QNCH
DO #=1,3
GENR U#=0
ENDO
GENR U1=U
SMPL 9 24
GENR U1=U1(8)
GENR U2=U-U(8)
SMPL 19 24
GENR U2=U2(18)
GENR U3=U-U(18)
SMPL 1 24
GENR CHECK=U-U1-U2-U3
STAT CHECK
*CHECK SHOULD BE 0 FOR ALL OBSERVATIONS AND THIS CHECK IS SATISFIED

*WE WILL NOW RUN A SYSTEM REGRESSION WITH UTILITY SPLINES 
*WE WILL USE THE FINISHING COEFS FROM CON1OUT.TXT AS STARTING VALUES HERE
*THIS STEP IS NOT REALLY NECESSARY SINCE THE NONLINEAR REGRESSION IS ACTUALLY A SERIES OF 
*UNRELATED LINEAR REGRESSIONS AND ALMOST ANY STARTING VALUES WILL EVENTUALLY CONVERGE TO THE TRUE VALUES.
NL 17 / NCOEF=68 GENRVAR CONV=.000001 ITER=1000 PITER=50 LIST
EQ Q1=A1+BA1*U1+BB1*U2+BC1*U3
EQ Q2=A2+BA2*U1+BB2*U2+BC2*U3
EQ Q3=A3+BA3*U1+BB3*U2+BC3*U3
EQ Q4=A4+BA4*U1+BB4*U2+BC4*U3
EQ Q5=A5+BA5*U1+BB5*U2+BC5*U3
EQ Q6=A6+BA6*U1+BB6*U2+BC6*U3
EQ Q7=A7+BA7*U1+BB7*U2+BC7*U3
EQ Q8=A8+BA8*U1+BB8*U2+BC8*U3
EQ Q9=A9+BA9*U1+BB9*U2+BC9*U3
EQ Q10=A10+BA10*U1+BB10*U2+BC10*U3
EQ Q11=A11+BA11*U1+BB11*U2+BC11*U3
EQ Q12=A12+BA12*U1+BB12*U2+BC12*U3
EQ Q13=A13+BA13*U1+BB13*U2+BC13*U3
EQ Q14=A14+BA14*U1+BB14*U2+BC14*U3
EQ Q15=A15+BA15*U1+BB15*U2+BC15*U3
EQ Q16=A16+BA16*U1+BB16*U2+BC16*U3
EQ Q17=A17+BA17*U1+BB17*U2+BC17*U3
COEF A1        1.2181     
COEF BA1       0.026911
COEF BB1       0.026911
COEF BC1       0.026911
COEF A2       0.044241
COEF BA2       0.016994
COEF BB2       0.016994
COEF BC2       0.016994
COEF A3       0.53828     
COEF BA3      -0.016872
COEF BB3      -0.016872
COEF BC3      -0.016872
COEF A4      -0.53998     
COEF BA4       0.082688
COEF BB4       0.082688
COEF BC4       0.082688
COEF A5      -0.66399     
COEF BA5       0.24086
COEF BB5       0.24086
COEF BC5       0.24086     
COEF A6       0.66821     
COEF BA6      -0.0098409
COEF BB6      -0.0098409
COEF BC6      -0.0098409
COEF A7      -0.31872     
COEF BA7       0.076462
COEF BB7       0.076462
COEF BC7       0.076462
COEF A8      -0.50980     
COEF BA8       0.061846
COEF BB8       0.061846
COEF BC8       0.061846
COEF A9      -0.75587     
COEF BA9       0.10608
COEF BB9       0.10608 
COEF BC9       0.10608      
COEF A10      0.46956     
COEF BA10      0.028172
COEF BB10      0.028172
COEF BC10      0.028172
COEF A11      0.058133
COEF BA11      0.015463
COEF BB11      0.015463
COEF BC11      0.015463
COEF A12     -0.39331     
COEF BA12      0.043479
COEF BB12      0.043479
COEF BC12      0.043479
COEF A13     -0.39485     
COEF BA13      0.12261
COEF BB13      0.12261 
COEF BC13      0.12261      
COEF A14     -0.037890
COEF BA14      0.012377
COEF BB14      0.012377
COEF BC14      0.012377
COEF A15      0.90063     
COEF BA15      0.19265
COEF BB15      0.19265
COEF BC15      0.19265
COEF A16     -0.50416     
COEF BA16      0.15856 
COEF BB16      0.15856  
COEF BC16      0.15856      
COEF A17     -0.66986     
COEF BA17      0.066592
COEF BB17      0.066592
COEF BC17      0.066592
END
* INITIAL LOG-LIKELIHOOD = 1200.131
* THE FINAL LL IN E59419C\CON1OUT.TXT WAS 1378.661 WHICH IS RATHER FAR FROM 1200.131
* I COULD NOT FIGURE OUT WHY THIS DIFFERENCE WAS SO BIG. USUALLY THE ERROR IS CAUSED BY INPUTTING
*INCORRECT STARTING COEFS BUT I CHECKED THIS AND I THINK I ENTERED THE STARTING COEF VALUES CORRECTLY.
*THE END RESULTS IN THIS REGRESSION LOOK JUST FINE SO I IGNORED THIS PROBLEM! I JUST COMPARED THE
*FINAL LL IN CON2 WITH THE FINAL LL IN CON1.
* FINAL STATISTICS FOR CON2: TIME =     0.3410 SEC.   ITER. NO.   170   FUNCT. EVALUATIONS   218
* FINAL LOG-LIKELIHOOD FOR CON2 = 1526.097, A GAIN OF 147.44 LL POINTS FOR ADDING 34 ADDITIONAL PARAMETERS
*GRADIENT VECTOR IS OK; T STATS ARE GENERALLY GOOD
*THE R SQUARES FOR THE 17 EQUATIONS ARE NOW MUCH HIGHER!

*GENR FITTED DEMAND EQUATIONS
DO #= 1,17
GENR FQ#=A#+BA#*U1+BB#*U2+BC#*U3
ENDO
*COMPARE FITTED DEMANDS WITH ACTUAL DEMANDS
FORMAT(F8.0,10F10.5)
PRINT YEAR Q1 FQ1 Q2 FQ2 Q3 FQ3 Q4 FQ4 Q5 FQ5 / FORMAT
PRINT YEAR Q6 FQ6 Q7 FQ7 Q8 FQ8 Q9 FQ9 Q10 FQ10 / FORMAT
PRINT YEAR Q11 FQ11 Q12 FQ12 Q13 FQ13 Q14 FQ14 Q15 FQ15 / FORMAT
PRINT YEAR Q16 FQ16 Q17 FQ17 / FORMAT
*THE FITS ARE NOT TOO BAD.
STAT Q1 FQ1 Q2 FQ2 Q3 FQ3 Q4 FQ4 Q5 FQ5 Q6 FQ6 Q7 FQ7 Q8 FQ8 Q9 FQ9 Q10 FQ10
STAT Q11 FQ11 Q12 FQ12 Q13 FQ13 Q14 FQ14 Q15 FQ15 Q16 FQ16 Q17 FQ17 
*THE FITTED DEMANDS COINCIDE WITH THE FITTED DEMANDS IN THE EQUATIONS ON AVERAGE
*THIS SHOULD ALWAYS BE THE CASE BECAUSE EACH EQUATION HAS AN INDEPENDENT CONSTANT TERM IN IT.

*GENR TOTAL EXPENDITURE FOR EACH PERIOD
GENR Y=0
DO #=1,17
GENR Y=Y+V#
ENDO 
*GENR THE COMPONENTS OF THE EXPENDITURE FUNCTION THAT ARE IMPLIED BY OUR ESTIMATES
*GENR A.P , BA.P. BB.P AND BC.P
GENR AP=0
GENR BAP=0
GENR BBP=0
GENR BCP=0
DO #=1,17
GENR AP=AP+P#*A#
GENR BAP=BAP+P#*BA#
GENR BBP=BBP+P#*BB#
GENR BCP=BCP+P#*BC#
ENDO
*GENR THE INDIRECT UTILITY FUNCTION THAT CORRESPONDS TO OUR ESTIMATED COEFS
GENR IU=0
SMPL 1 8
GENR IU=(Y-AP)/BAP
SMPL 9 18
GENR IU=IU(8)+((Y-AP-BAP*IU(8))/BBP)
SMPL 19 24
GENR IU=IU(18)+(Y-AP-BAP*IU(8)-BBP*(IU(18)-IU(8)))/BCP
SMPL 1 24
FORMAT(F8.0,7F10.5)
PRINT YEAR U IU AP BAP BBP BCP Y / FORMAT
*   YEAR      U         IU        AP       BAP        BBP       BCP        Y
*   1995.  15.81108  15.81789  -0.15434   1.00933   1.06907   1.06085  15.81108
*   1996.  16.09158  16.09441  -0.20013   1.02936   1.08737   1.08307  16.36678
*   1997.  16.64186  16.63937  -0.17778   1.04530   1.10547   1.09975  17.21536
*   1998.  17.00409  16.99945  -0.09532   1.05336   1.12694   1.11005  17.81120
*   1999.  17.49895  17.49368  -0.02317   1.06757   1.14433   1.12924  18.65260
*   2000.  18.03685  18.03582   0.17368   1.08134   1.16333   1.14583  19.67646
*   2001.  18.25272  18.25656   0.38925   1.09135   1.18069   1.15570  20.31351
*   2002.  18.72987  18.74705   0.60478   1.10176   1.19335   1.17102  21.25956
*   2003.  18.99838  19.00331   0.79102   1.11017   1.18708   1.18313  21.90755
*   2004.  19.47251  19.46550   0.90629   1.12080   1.19205   1.19812  22.77450
*   2005.  19.98958  19.97687   1.01065   1.13564   1.19633   1.21729  23.77184
*   2006.  20.58416  20.57105   1.12130   1.14616   1.20127   1.23539  24.79945
*   2007.  21.29055  21.28039   1.23679   1.15907   1.21388   1.25635  26.04112
*   2008.  21.62526  21.61852   1.60731   1.15906   1.22492   1.26001  26.85359
*   2009.  21.37511  21.36621   1.59072   1.16128   1.23336   1.25682  26.59167
*   2010.  21.91988  21.91910   1.58681   1.18254   1.23310   1.28525  27.66740
*   2011.  22.17250  22.17914   1.76754   1.20252   1.24756   1.30989  28.59291
*   2012.  22.32816  22.34080   1.86246   1.21550   1.25922   1.32953  29.17481
*   2013.  22.64249  22.65181   2.00633   1.22573   1.27737   1.34625  29.99444
*   2014.  23.00342  23.00943   2.24702   1.23932   1.30103   1.36314  31.06754
*   2015.  23.41637  23.41700   2.28763   1.25033   1.32445   1.37107  31.96298
*   2016.  23.69004  23.68907   2.32911   1.26252   1.33595   1.38193  32.66183
*   2017.  24.27525  24.27384   2.38245   1.27728   1.34473   1.39991  33.86643
*   2018.  24.44292  24.43979   2.57626   1.29334   1.35952   1.42216  34.69351
*INDEX UTILITY IU AND ECONOMETRIC UTILITY U ARE VERY CLOSE INDEED! 
STAT U IU / PCOR
* NAME        N    MEAN        ST. DEV      VARIANCE     MINIMUM      MAXIMUM
* U            24   20.387      2.6801      7.1829       15.811       24.443
* IU           24   20.387      2.6800      7.1822       15.818       24.440
*  CORRELATION MATRIX OF VARIABLES -       24 OBSERVATIONS
* U          1.0000
* IU         1.0000       1.0000
*              U            IU
*THE CORRELATION BETWEEN U AND OUR INDIRECT UTILITY IU IS 1.0000; VERY HIGH INDEED. 
OLS IU U / LIST
*    OBS.   OBSERVED     PREDICTED   CALCULATED
*      NO.    VALUE        VALUE       RESIDUAL
*       1    15.818       15.811      0.68699E-02                I   *
*       2    16.094       16.092      0.29105E-02                I *
*       3    16.639       16.642     -0.23793E-02               *I
*       4    16.999       17.004     -0.45218E-02             *  I
*       5    17.494       17.499     -0.51110E-02             *  I
*       6    18.036       18.037     -0.84594E-03               *I
*       7    18.257       18.253      0.40300E-02                I  *
*       8    18.747       18.730      0.17406E-01                I          *
*       9    19.003       18.998      0.51638E-02                I  *
*      10    19.466       19.472     -0.67422E-02            *   I
*      11    19.977       19.989     -0.12425E-01        *       I
*      12    20.571       20.584     -0.12790E-01        *       I
*      13    21.280       21.290     -0.97877E-02          *     I
*      14    21.619       21.625     -0.63610E-02            *   I
*      15    21.366       21.375     -0.85402E-02           *    I
*      16    21.919       21.919     -0.38043E-03                *
*      17    22.179       22.172      0.70485E-02                I   *
*      18    22.341       22.328      0.13057E-01                I       *
*      19    22.652       22.642      0.97593E-02                I     *
*      20    23.009       23.003      0.64675E-02                I   *
*      21    23.417       23.416      0.11144E-02                I*
*      22    23.689       23.690     -0.47034E-03                *
*      23    24.274       24.275     -0.88250E-03               *I
*      24    24.440       24.442     -0.25883E-02              * I
* DURBIN-WATSON = 0.5977    VON NEUMANN RATIO = 0.6237    RHO =  0.68510
* RESIDUAL SUM = -0.18605E-13  RESIDUAL VARIANCE =  0.63337E-04
* SUM OF ABSOLUTE ERRORS=  0.14765
* R-SQUARE BETWEEN OBSERVED AND PREDICTED = 1.0000
*WE HAVE NOT ELIMINATED ALL OF THE AUTOCORRELATION BETWEEN U AND IU BUT NOTE HOW SMALL THE RESIDUALS ARE.
*OUR ECONOMETRICALLY GENERATED FITTED U, FU, IS VERY CLOSE TO OUR INDEX NUMBER U
*OUR ESTIMATION PROCEDURE IS JUSTIFIED!

*DO A CHECK ON OUR METHODOLOGY
*IF WE CONSTRUCT FITTED EXPENDITURE OR INCOME AND USE IT IN PLACE OF ACTUAL EXPENDITURE, THE IMPLICIT UTILITY
*FUNCTION THAT WE GENERATE SHOULD EXACTLY COINCIDE WITH OUR INDEX UTILITY
GENR FY=0
DO #=1,17
GENR FY=FY+P#*FQ#
ENDO
*GENR A NEW INDIRECT UTILITY FUNCTION THAT CORRESPONDS TO OUR ESTIMATED COEFS USING FITTED EXPENDITURE
GENR NU=0
SMPL 1 8
GENR NU=(FY-AP)/BAP
SMPL 9 18
GENR NU=NU(8)+((FY-AP-BAP*NU(8))/BBP)
SMPL 19 24
GENR NU=NU(18)+(FY-AP-BAP*NU(8)-BBP*(NU(18)-NU(8)))/BCP
SMPL 1 24
FORMAT(F8.0,9F10.5)
PRINT YEAR U NU IU AP BAP BBP BCP Y FY / FORMAT
*   YEAR       U         NU        IU       AP        BAP       BBP       BCP        Y         FY
*   1995.  15.81108  15.81108  15.81789  -0.15434   1.00933   1.06907   1.06085  15.81108  15.80420
*   1996.  16.09158  16.09158  16.09441  -0.20013   1.02936   1.08737   1.08307  16.36678  16.36386
*   1997.  16.64186  16.64186  16.63937  -0.17778   1.04530   1.10547   1.09975  17.21536  17.21795
*   1998.  17.00409  17.00409  16.99945  -0.09532   1.05336   1.12694   1.11005  17.81120  17.81610
*   1999.  17.49895  17.49895  17.49368  -0.02317   1.06757   1.14433   1.12924  18.65260  18.65822
*   2000.  18.03685  18.03685  18.03582   0.17368   1.08134   1.16333   1.14583  19.67646  19.67757
*   2001.  18.25272  18.25272  18.25656   0.38925   1.09135   1.18069   1.15570  20.31351  20.30933
*   2002.  18.72987  18.72987  18.74705   0.60478   1.10176   1.19335   1.17102  21.25956  21.24062
*   2003.  18.99838  18.99838  19.00331   0.79102   1.11017   1.18708   1.18313  21.90755  21.90302
*   2004.  19.47251  19.47251  19.46550   0.90629   1.12080   1.19205   1.19812  22.77450  22.78407
*   2005.  19.98958  19.98958  19.97687   1.01065   1.13564   1.19633   1.21729  23.77184  23.78810
*   2006.  20.58416  20.58416  20.57105   1.12130   1.14616   1.20127   1.23539  24.79945  24.81615
*   2007.  21.29055  21.29055  21.28039   1.23679   1.15907   1.21388   1.25635  26.04112  26.05438
*   2008.  21.62526  21.62526  21.61852   1.60731   1.15906   1.22492   1.26001  26.85359  26.86298
*   2009.  21.37511  21.37511  21.36621   1.59072   1.16128   1.23336   1.25682  26.59167  26.60390
*   2010.  21.91988  21.91988  21.91910   1.58681   1.18254   1.23310   1.28525  27.66740  27.66923
*   2011.  22.17250  22.17250  22.17914   1.76754   1.20252   1.24756   1.30989  28.59291  28.58541
*   2012.  22.32816  22.32816  22.34080   1.86246   1.21550   1.25922   1.32953  29.17481  29.15965
*   2013.  22.64249  22.64249  22.65181   2.00633   1.22573   1.27737   1.34625  29.99444  29.98365
*   2014.  23.00342  23.00342  23.00943   2.24702   1.23932   1.30103   1.36314  31.06754  31.06120
*   2015.  23.41637  23.41637  23.41700   2.28763   1.25033   1.32445   1.37107  31.96298  31.96397
*   2016.  23.69004  23.69004  23.68907   2.32911   1.26252   1.33595   1.38193  32.66183  32.66501
*   2017.  24.27525  24.27525  24.27384   2.38245   1.27728   1.34473   1.39991  33.86643  33.87026
*   2018.  24.44292  24.44292  24.43979   2.57626   1.29334   1.35952   1.42216  34.69351  34.69988
*OUR METHODOLOGY CHECK PASSES; NU IS EXACTLY EQUAL TO U.
STAT U NU IU AP BAP BBP BCP Y FY

*GENR INCOME ELASTICITIES OF DEMAND
DO #=1,17
GENR EU#=0
ENDO
SMPL 1 8
DO #=1,17
GENR EU#=BA#*U/FQ#
ENDO
SMPL 9 18
DO #=1,17
GENR EU#=BB#*U/FQ#
ENDO
SMPL 19 24
DO #=1,17
GENR EU#=BC#*U/FQ#
ENDO
SMPL 1 24
FORMAT(F8.0,9F10.4)
PRINT YEAR EU1-EU9 / FORMAT
PRINT YEAR EU10-EU17 / FORMAT
*IN MOST CASES, AS WE MOVE THROUGH A BREAK POINT, THE INCOME ELASTICITY OF DEMAND CHANGES SUBSTANTIALLY.
*THIS IS NORMAL WHEN WE USE LINEAR SPLINES ON UTILITY.
STAT EU1-EU17
* NAME         N   MEAN        ST. DEV     VARIANCE     MINIMUM      MAXIMUM
* EU1          24  0.35505     0.17973     0.32303E-01  0.13615      0.54281
* EU2          24  0.85722     0.13228     0.17498E-01  0.62393      0.94388
* EU3          24  -1.7332     0.40838     0.16678      -2.5146      -1.0947
* EU4          24   1.3988     0.45052     0.20297      0.76963       1.9022
* EU5          24   1.1356     0.36681     0.13455      0.62075       1.5377
* EU6          24 -0.44732     0.85934E-01 0.73847E-02 -0.61050     -0.33079
* EU7          24   1.2251     0.38380     0.14730      0.61379       1.6925
* EU8          24   1.6690     0.37105     0.13767       1.0845       2.1951
* EU9          24   1.7938     0.74760     0.55890      0.93535       2.6426
* EU10         24  0.60990     0.20805     0.43286E-01  0.35685      0.86798
* EU11         24  0.87895     0.99602     0.99206     -0.39950       2.2835
* EU12         24   1.8528     0.75038     0.56308      0.85299       3.1889
* EU13         24   1.1456     0.82308     0.67747     -0.63230E-01   2.2647
* EU14         24   1.1862     0.24548     0.60260E-01  0.88347       1.5545
* EU15         24  0.44596     0.50550     0.25554     -0.14350      0.96622
* EU16         24   1.2318     0.15207     0.23125E-01   1.0837       1.4927
* EU17         24   1.2213      2.3099      5.3357     -0.87096       5.1963
*ON AVERAGE, 15 OF THE 17 COMMODITY GROUPS HAVE POSITIVE INCOME ELASTICITIES
*THE AVERAGE IS GREATER THAN 1 FOR THE FOLLOWING 10 CATEGORIES:
*EU4 Clothing and footwear 
*EU5 Housing
*EU7 Furnishings, households equipment and routine maintenance of the house
*EU8 Health
*EU9 Purchase of vehicles
*EU12 Communications
*EU13 Recreation and culture
*EU14 Education
*EU16 Miscellaneous goods and services
*EU17 Final consumption expenditure of resident households abroad
*THE 2 NEGATIVE INCOME ELASTICITY OF DEMAND CATEGORIES ARE:
*EU3 Tobacco
*EU6 Electricity, gas and other fuels
*THE 5 CATEGORIES THAT HAVE INCOME ELASTICITIES BETWEEN 0 AND 1 ARE:
*EU1  Food and non-alcoholic beverages
*EU2  Alcoholic beverages
*EU10 Operation of personal transport equipment
*EU11 Transport services
*EU15 Restaurants and hotels

*1 IS THE SERIES       P31CP010: Food and non-alcoholic beverages
*2 IS THE SERIES       P31CP021: Alcoholic beverages
*3 IS THE SERIES       P31CP022: Tobacco
*4 IS THE SERIES       P31CP030: Clothing and footwear
*5 IS THE SERIES       P31CP041+P31CP042+P31CP043+P31CP044: HOUSING AGGREGATE
*6 IS THE SERIES       P31CP045: Electricity, gas and other fuels
*7 IS THE SERIES       P31CP050: Furnishings, households equipment and routine maintenance of the house
*8 IS THE SERIES       P31CP060: Health
*9 IS THE SERIES       P31CP071: Purchase of vehicles
*10 IS THE SERIES      P31CP072: Operation of personal transport equipment
*11 IS THE SERIES      P31CP073: Transport services
*12 IS THE SERIES      P31CP080: Communications
*13 IS THE SERIES      P31CP090: Recreation and culture
*14 IS THE SERIES      P31CP100: Education
*15 IS THE SERIES      P31CP110: Restaurants and hotels
*16 IS THE SERIES      P31CP120: Miscellaneous goods and services
*17 IS THE SERIES      P33:      Final consumption expenditure of resident households abroad
STOP

