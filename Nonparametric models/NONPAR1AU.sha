*THIS IS THE FILE E59419\NONPAR1.TXT WHICH CONSTRUCTS NONPARAMETRIC ESTIMATES OF EFFICIENCY FOR 
*CANADA FOR THE YEARS 1994-2018. SEE CHAPTER 11 BENCHMARKING FOR THE THEORY
*THIS MODEL CALCULATES TECHNICAL EFFICIENCY FOR EACH OBS ASSUMING A CONVEX TECHNOLOGY
*READ IN THE DATA FOR AUSTRALIA; YOU WILL READ IN YOUR DATA FOR THE LAST
*25 YEARS IN YOUR SAMPLE.
*IT IS FAIRLY EASY TO RUN THIS PROGRAM; ALL YOU HAVE TO DO IS TO READ IN YOUR DATA AND DO A BIT 
*OF EDITING TO REFLECT THE RESULTS FOR YOUR COUNTRY AS OPPOSED TO CANADA
SET NODOECHO
SMPL 1 25
*THE DATA ARE CONSUMPTION, GOVERNMENT, INVESTMENT, EXPORTS, IMPORTS, LABOUR AND CAPITAL SERVICES
READ YEAR P1 P2 P3 P4 P5 P6 PKS
   1994.   8.00714  11.15714   5.82757   5.38022   6.54539  15.04484   6.50138
   1995.   8.18699  11.37962   5.82298   5.51763   6.47497  15.87896   6.64199
   1996.   8.32370  11.52470   5.72017   5.30233   6.04832  16.88546   6.68257
   1997.   8.48063  11.72522   5.77483   5.48756   6.28750  17.28719   7.00619
   1998.   8.54248  12.09110   5.88506   5.31521   6.39261  18.15573   7.05421
   1999.   8.71517  12.35386   5.93090   5.46351   6.30780  18.43192   7.38883
   2000.   8.86219  12.95245   6.15234   6.13307   6.98403  19.40703   7.26417
   2001.   9.05914  13.26191   6.31262   6.16636   6.94528  20.58987   7.67985
   2002.   9.29872  13.71834   6.38389   5.98871   6.64379  21.19647   7.90116
   2003.   9.45262  14.04170   6.45752   5.72617   5.91150  22.23328   8.30968
   2004.   9.66460  14.62494   6.61186   6.29483   5.91280  23.17486   8.52151
   2005.   9.95437  15.24812   6.78587   7.19299   6.07200  24.16659   8.94951
   2006.  10.36341  15.99453   6.97385   7.64919   6.03088  25.54128   9.41351
   2007.  10.71588  16.72282   7.15171   7.95202   5.92852  27.02829   9.71069
   2008.  11.09277  17.53036   7.37007   9.48366   6.58958  27.85875  10.32228
   2009.  11.35477  18.20536   7.33460   8.05430   5.80293  29.06747  10.03213
   2010.  11.57713  18.96744   7.41213   9.40783   5.62178  30.76927  10.51113
   2011.  11.93112  19.56004   7.40492   9.53947   5.68162  32.04965  10.64578
   2012.  12.21270  19.82026   7.48087   8.62293   5.69573  32.89573  10.19783
   2013.  12.50176  20.14774   7.64627   8.92774   6.14136  33.96291  10.13347
   2014.  12.79281  20.40310   7.81764   8.06737   6.21891  34.45058   9.77819
   2015.  12.94752  20.67183   8.01797   7.43538   6.42004  34.85585   9.50519
   2016.  13.08610  20.83614   8.05568   8.23826   6.22315  35.15085  10.29608
   2017.  13.24949  21.17386   8.15994   8.54262   6.33439  35.51986  10.55688
   2018.  13.46374  21.30174   8.34889   9.61275   6.75329  36.17887  11.02915
FORMAT(F8.0,7F11.5)
PRINT YEAR P1 P2 P3 P4 P5 P6 PKS / FORMAT
GENR P7=PKS
READ YEAR Y1 Y2 Y3 Y4 Y5 Y6 QKS
   1994.    32.6984     7.9898    22.1053    16.4686   -15.5555   -17.9701    30.1804
   1995.    33.8116     8.3246    22.5168    18.1089   -16.2846   -18.2498    31.2180
   1996.    34.8164     8.4906    24.1881    20.0799   -17.8957   -18.2907    32.2326
   1997.    36.5395     8.8349    26.1632    20.9993   -19.7294   -18.6170    33.3858
   1998.    38.6338     9.2351    27.6235    21.4016   -20.7382   -18.7763    34.6659
   1999.    40.2787     9.5194    29.3274    23.5186   -23.2366   -19.4291    36.0519
   2000.    41.5597     9.6802    26.9081    25.5510   -23.0102   -19.7092    37.5467
   2001.    42.8471     9.9780    29.2652    25.4109   -23.3206   -19.6024    38.5867
   2002.    44.5745    10.2733    32.6416    25.5375   -26.3983   -20.1173    39.8592
   2003.    46.8206    10.7282    36.2308    25.8668   -29.9618   -20.3979    41.4780
   2004.    48.9486    11.0758    38.4453    26.7617   -33.7069   -21.0632    43.4511
   2005.    50.5377    11.4227    40.5341    27.5567   -36.4486   -21.5771    45.5620
   2006.    53.2877    11.7827    42.9589    28.6981   -40.2995   -22.1979    47.7825
   2007.    55.9073    12.1391    47.1876    29.8485   -46.1198   -22.8144    50.1373
   2008.    56.2261    12.6454    46.8421    30.5664   -44.5403   -23.0073    52.8987
   2009.    58.0553    12.8646    47.6358    32.0023   -47.7201   -22.9598    55.4474
   2010.    60.3689    13.3023    50.6611    32.2776   -52.6195   -23.5929    57.9033
   2011.    62.1638    13.7881    56.1773    33.7633   -58.5977   -24.0624    60.6184
   2012.    63.2636    13.8284    57.2881    35.5539   -58.7584   -24.1859    63.8922
   2013.    64.8063    14.0412    55.9145    37.6704   -57.3875   -24.2735    67.1145
   2014.    66.3271    14.3820    54.5639    40.2439   -57.9407   -24.6444    69.9342
   2015.    68.1531    14.9960    52.7001    42.9985   -57.8722   -25.1144    72.3540
   2016.    69.7614    15.7463    52.6797    45.3650   -60.5939   -25.4963    74.3773
   2017.    71.7556    16.3624    55.0908    46.9006   -64.6131   -26.2596    76.2867
   2018.    73.2624    17.2095    55.0827    48.5057   -65.3162   -26.9031    78.4020
FORMAT(F8.0,7F11.4)
PRINT YEAR Y1 Y2 Y3 Y4 Y5 Y6 QKS / FORMAT
GENR Y7=QKS
*WE NEED TO MAKE THE OUTPUT DATA NEGATIVE AND IMPORTS POSITIVE, THE LABOUR AND CAPITAL DATA POSITIVE
*BECAUSE OF THE WAY SHAZAM SETS UP AN LP AS MAX c'x SUBJECT TO Ax < b (or Ax = b), x nonnegative
GENR Y1=-Y1
GENR Y2=-Y2
GENR Y3=-Y3
GENR Y4=-Y4
GENR Y5=-Y5
GENR Y6=-Y6
FORMAT(F8.0,7F11.4)
PRINT YEAR Y1 Y2 Y3 Y4 Y5 Y6 Y7 / FORMAT
*CONSTRUCT THE A MATRIX WHICH WILL BE COMMON TO ALL OF THE LP'S FOR TECHNICAL EFFICIENCY UNDER CONVEXITY
*WE FIRST CONSTRUCT THE TRANSPOSE OF A. LOAD IN THE VECTORS Y1-Y7
MATRIX B=Y1
MATRIX B=B|Y2
MATRIX B=B|Y3
MATRIX B=B|Y4
MATRIX B=B|Y5
MATRIX B=B|Y6
MATRIX B=B|Y7
PRINT B 
*ADD COLUMNS OF 1'S AND -1'S TO B
GENR ONE=1
GENR MINONE=-1
MATRIX B=B|ONE
MATRIX B=B|MINONE
*TAKE THE TRANSPOSE OF A
MATRIX A=B'
*NOW WE NEED TO ADD A SPECIFIC COLUMN TO THE A MATRIX; ONE FOR EACH OF OUR 25 OBSERVATIONS
*FOR PROBLEM #, THE SPECIFIC COLUMN CONSISTS OF 5 0's, THE PRIMARY INPUT VECTOR FOR OBSERVATION #
*WHICH IS TWO MORE ROWS AND A FINAL TWO ROWS CONSISTING OF 0's
SMPL 1 9
DO #=1,25
GENR D#=0
ENDO
SMPL 6 6
DO #=1,25
GENR D#=-Y6(#)
ENDO
SMPL 7 7
DO #=1,25
GENR D#=-Y7(#)
ENDO
SMPL 1 9
FORMAT(5F13.5)
PRINT D1-D5 / FORMAT
PRINT D20-D25 / FORMAT 
DO #=1,25
MATRIX A#=A|D#
ENDO
PRINT A1
PRINT A25
*EVERYTHING SEEMS TO BE WORKING OK; WE NOW HAVE THE A MATRIX FOR EACH OF OUR 25 LP PROBLEMS
*GENR THE C VECTOR FOR EACH PROGRAM
SMPL 1 26
GENR C=0
SMPL 26 26
GENR C=-1
SMPL 1 26
PRINT C
*NOW TO GENR THE B VECTORS FOR EACH PROGRAM
SMPL 1 9
DO #=1,25
GENR B#=0
ENDO
SMPL 1 1
DO #=1,25
GENR B#=Y1(#)
ENDO
SMPL 2 2
DO #=1,25
GENR B#=Y2(#)
ENDO
SMPL 3 3
DO #=1,25
GENR B#=Y3(#)
ENDO
SMPL 4 4
DO #=1,25
GENR B#=Y4(#)
ENDO
SMPL 5 5
DO #=1,25
GENR B#=Y5(#)
ENDO
SMPL 8 8
DO #=1,25
GENR B#=1
ENDO
SMPL 9 9
DO #=1,25
GENR B#=-1
ENDO
SMPL 1 9
PRINT B1-B5 / FORMAT
PRINT B20-B25 / FORMAT
*NOW RUN THE LP'S TO TEST FOR EFFICIENCY OF EACH OBSERVATION ASSUMING A CONVEX TECHNOLOGY
DO #=1,25
LP C A# B# / ITER=50 PRIMAL=F#
MATRIX E#=C'F#
ENDO
*RECALL THAT WE WERE SOLVING A MINIMIZATION PROBLEM BUT WE HAD TO CONVERT IT TO A MAXIMIZATION PROBLEM TO 
*SUIT THE SHAZAM FORMAT FOR RUNNING LP'S.  THUS OUR EFFICIENCY OF OBSERVATION # IS EQUAL TO MINUS 
*THE OPTIMIZED OBJECTIVE FUNCTION.
*FOR EACH OF THE 25 LP'S, THE PRIMAL SOLUTION IS GENERATED AS F#. WE INNER PRODUCT THIS SOLUTION VECTOR
*WITH THE OBJECTIVE FUNCTION C VECTOR TO GET THE OPTIMIZED OBJECTIVE FUNCTION VALUE E
SMPL 1 25
GENR E=0
DO #=1,25
SMPL # #
GENR E=E#(1)
ENDO
SMPL 1 25
*CHANGE THE SIGN OF THE EFFICIENCY MEASURES FROM NEGATIVE TO POSITIVE
GENR E=-E
FORMAT(F8.0,F10.4)
PRINT YEAR E / FORMAT
STOP
*   YEAR        E
*   1994.    1.0000
*   1995.    1.0000
*   1996.    1.0000
*   1997.    1.0000
*   1998.    1.0000
*   1999.    1.0000
*   2000.    1.0000
*   2001.    1.0000
*   2002.    1.0000
*   2003.    1.0000
*   2004.    1.0000
*   2005.    1.0000
*   2006.    1.0000
*   2007.    1.0000
*   2008.    1.0000
*   2009.    1.0000
*   2010.    1.0000
*   2011.    1.0000
*   2012.    1.0000
*   2013.    1.0000
*   2014.    1.0000
*   2015.    1.0000
*   2016.    1.0000
*   2017.    1.0000
*   2018.    1.0000
*ALL THE OBSERVATIONS ARE EFFICIENT USING THIS EFFICIENCY MODEL. THIS IS THE PROBLEM WITH THE 
*MODELS THAT USE ONLY QUANTITY DATA: TOO MANY OBSERVATIONS ARE REGARDED AS BEING EFFICIENT.
STOP

