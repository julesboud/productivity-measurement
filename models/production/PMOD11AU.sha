*THIS IS PMOD11.TXT:                                                                               JUNE 19, 2019
*IN THIS RUN WE ESTIMATE AN NQ COST FUNCTION WITH A RANK 4 SUBSTITUTION MATRIX WITH SINGLE TIME TRENDS FOR TECHNICAL PROGRESS
*IN THIS RUN WE ALLOW FOR LINEAR TIME TRENDS FOR THE C, D, F AND H VECTORS IN THE SUBSTITUTION MATRIX 
*READ IN YOUR DATA FROM THE END OF DATOUT.TXT.
*1=CONSUMPTION,2=GOVERNENT,3=GROSS INVESTMENT,4=EXPORTS,5=-IMPORTS,6=-LABOUR,7=CAPITAL SERVICES.
SIZE 10000
PAR 10000
SET NODOECHO
*READ IN OUR PRODUCTION DATA FROM DATOUT.TXT
*YOUR SMPL STATEMENT MAY BE DIFFERENT!
SMPL 1 60
READ YEAR Y1-Y6 QKS
   1959.     9.5730     1.8430     5.2450     2.1550    -2.3320    -8.7080     6.6994
   1960.     9.7850     1.9106     5.8133     2.2625    -2.6239    -9.0615     7.0219
   1961.    10.0304     1.9845     5.1597     2.5689    -2.2497    -9.0789     7.4039
   1962.    10.5775     2.0655     5.9914     2.5117    -2.6396    -9.6721     7.6808
   1963.    11.3223     2.1298     6.4178     2.9259    -2.9361   -10.1849     8.0473
   1964.    11.8887     2.3238     7.2833     2.9183    -3.4965   -10.7354     8.4441
   1965.    12.2379     2.5571     7.3815     2.9607    -3.5927   -10.9962     8.9236
   1966.    12.8640     2.6937     8.0388     3.2853    -3.6533   -11.3943     9.3972
   1967.    13.5024     2.9404     8.3696     3.4431    -4.0144   -11.6354     9.9311
   1968.    14.2211     3.0345     9.3974     3.6677    -4.1530   -11.7320    10.4749
   1969.    15.0899     3.2640     9.4890     4.2698    -4.4992   -11.9534    11.1304
   1970.    15.6754     3.4337     9.7915     4.6829    -4.6371   -12.3324    11.7396
   1971.    16.2408     3.5809     9.7237     5.0336    -4.2672   -12.5924    12.3748
   1972.    16.9991     3.6950     9.6718     5.1349    -4.3212   -12.7743    12.9623
   1973.    18.0663     3.7882    11.0839     4.8245    -5.6321   -13.1499    13.5267
   1974.    18.9474     4.1249    10.0235     5.2965    -5.7771   -13.2653    14.2497
   1975.    19.0906     4.4643    10.0794     5.5034    -5.4937   -13.1942    14.8392
   1976.    20.1076     4.4928    10.8607     5.8966    -6.0167   -13.2546    15.4131
   1977.    20.5056     4.6267    10.5783     6.0295    -5.7348   -13.4175    16.0682
   1978.    20.8097     4.7798    12.3571     6.4572    -6.1975   -13.4619    16.6457
   1979.    21.1814     4.8877    12.4916     6.9136    -6.2037   -13.8677    17.4142
   1980.    21.8674     5.1098    13.8719     6.5780    -6.7904   -14.2368    18.1515
   1981.    23.0879     5.1866    15.1804     6.7333    -7.5759   -14.3537    19.0269
   1982.    23.6443     5.3185    12.7100     6.7683    -6.9364   -13.9933    20.0298
   1983.    23.8922     5.5664    14.3346     7.2848    -7.3518   -13.9025    20.6558
   1984.    24.1048     5.9565    15.9216     8.4095    -8.5753   -14.4929    21.4419
   1985.    25.3508     6.2152    16.4682     8.7277    -8.5550   -15.0439    22.3891
   1986.    25.8630     6.4258    15.9968     9.6026    -8.1506   -15.4767    23.3450
   1987.    26.6846     6.6676    17.6890    10.4142    -9.0653   -15.9354    24.1557
   1988.    27.9211     6.8637    20.0586    10.5221   -11.3210   -16.5702    25.1135
   1989.    29.1240     7.0456    20.5265    11.0135   -11.9569   -17.3535    26.3205
   1990.    29.4056     7.2711    17.5060    12.2532   -11.2736   -16.8312    27.5180
   1991.    30.0919     7.4565    16.6801    13.4118   -11.6680   -16.5218    28.2321
   1992.    30.6542     7.6461    18.2692    14.4057   -12.4374   -16.4798    28.7591
   1993.    31.3129     7.7292    19.4782    15.7725   -13.3705   -17.1897    29.4262
   1994.    32.6984     7.9898    22.1053    16.4686   -15.5555   -17.9701    30.1804
   1995.    33.8116     8.3246    22.5168    18.1089   -16.2846   -18.2498    31.2180
   1996.    34.8164     8.4906    24.1881    20.0799   -17.8957   -18.2907    32.2326
   1997.    36.5395     8.8349    26.1632    20.9993   -19.7294   -18.6170    33.3858
   1998.    38.6338     9.2351    27.6235    21.4016   -20.7382   -18.7763    34.6659
   1999.    40.2787     9.5194    29.3274    23.5186   -23.2366   -19.4291    36.0519
   2000.    41.5597     9.6802    26.9081    25.5510   -23.0102   -19.7092    37.5467
   2001.    42.8471     9.9780    29.2652    25.4109   -23.3206   -19.6024    38.5867
   2002.    44.5745    10.2733    32.6416    25.5375   -26.3983   -20.1173    39.8592
   2003.    46.8206    10.7282    36.2308    25.8668   -29.9618   -20.3979    41.4780
   2004.    48.9486    11.0758    38.4453    26.7617   -33.7069   -21.0632    43.4511
   2005.    50.5377    11.4227    40.5341    27.5567   -36.4486   -21.5771    45.5620
   2006.    53.2877    11.7827    42.9589    28.6981   -40.2995   -22.1979    47.7825
   2007.    55.9073    12.1391    47.1876    29.8485   -46.1198   -22.8144    50.1373
   2008.    56.2261    12.6454    46.8421    30.5664   -44.5403   -23.0073    52.8987
   2009.    58.0553    12.8646    47.6358    32.0023   -47.7201   -22.9598    55.4474
   2010.    60.3689    13.3023    50.6611    32.2776   -52.6195   -23.5929    57.9033
   2011.    62.1638    13.7881    56.1773    33.7633   -58.5977   -24.0624    60.6184
   2012.    63.2636    13.8284    57.2881    35.5539   -58.7584   -24.1859    63.8922
   2013.    64.8063    14.0412    55.9145    37.6704   -57.3875   -24.2735    67.1145
   2014.    66.3271    14.3820    54.5639    40.2439   -57.9407   -24.6444    69.9342
   2015.    68.1531    14.9960    52.7001    42.9985   -57.8722   -25.1144    72.3540
   2016.    69.7614    15.7463    52.6797    45.3650   -60.5939   -25.4963    74.3773
   2017.    71.7556    16.3624    55.0908    46.9006   -64.6131   -26.2596    76.2867
   2018.    73.2624    17.2095    55.0827    48.5057   -65.3162   -26.9031    78.4020
*NOTE Y5 AND Y6 SHOULD BE NEGATIVE
FORMAT(F8.0,7F11.4)
PRINT YEAR Y1-Y6 QKS / FORMAT
READ YEAR P1-P6 PKS 
   1959.   0.90631   1.00000   1.00000   0.99954   1.07663   1.00000   1.00000
   1960.   0.94399   1.04102   1.00183   0.96131   1.08161   1.03473   0.99843
   1961.   0.95603   1.07282   0.97989   0.96341   1.07283   1.06598   0.96678
   1962.   0.96701   1.08736   0.98943   0.99373   1.08211   1.06044   1.01364
   1963.   0.98289   1.13437   1.01623   1.08268   1.06890   1.10129   1.10340
   1964.   1.01332   1.18644   1.06792   1.04855   1.08602   1.17316   1.09549
   1965.   1.05083   1.22092   1.07729   1.06291   1.10057   1.23677   1.06764
   1966.   1.08264   1.28892   1.11311   1.06383   1.10722   1.30090   1.16782
   1967.   1.12484   1.35119   1.15119   1.04121   1.12992   1.37995   1.18705
   1968.   1.16538   1.40878   1.17224   1.06553   1.13315   1.50922   1.27541
   1969.   1.21677   1.48895   1.28243   1.11948   1.17466   1.66106   1.35034
   1970.   1.29183   1.63468   1.32339   1.08950   1.22490   1.84762   1.31668
   1971.   1.38091   1.79257   1.39391   1.13299   1.35778   2.01961   1.36385
   1972.   1.47314   1.96970   1.46229   1.37081   1.38712   2.22316   1.47417
   1973.   1.64898   2.30216   1.66476   1.64016   1.52128   2.63777   1.59852
   1974.   1.95077   2.90071   1.90562   1.91033   1.96017   3.38900   1.53448
   1975.   2.23476   3.33762   2.18525   2.02365   2.19688   3.94336   1.79440
   1976.   2.50726   3.73796   2.38851   2.25334   2.53080   4.45647   2.08532
   1977.   2.75086   4.04930   2.56403   2.35409   2.86671   4.85301   2.17230
   1978.   2.97563   4.31355   2.67644   2.60374   3.15837   5.17965   2.59071
   1979.   3.24394   4.74107   2.91892   3.18226   3.69507   5.65415   2.81460
   1980.   3.56005   5.31041   3.14967   3.43036   4.01565   6.36204   2.94178
   1981.   3.90980   6.01477   3.45616   3.51612   4.17311   7.25412   3.25157
   1982.   4.31558   6.64285   3.77066   3.78822   4.55411   8.14129   3.26620
   1983.   4.60230   7.03167   3.96983   3.96729   4.67191   8.84243   3.75817
   1984.   4.85683   7.46263   4.14186   4.25457   5.08323   9.33288   3.93607
   1985.   5.23190   7.95661   4.51118   4.46659   5.88355   9.89331   4.29631
   1986.   5.69682   8.42640   4.89667   4.60157   6.38858  10.46696   4.70919
   1987.   6.08654   8.77414   5.13194   4.96449   6.34859  11.15281   5.30402
   1988.   6.51536   9.31343   5.43642   5.28385   5.84453  11.97067   5.81211
   1989.   6.95668   9.88107   5.70624   5.54754   6.09750  12.76681   5.92675
   1990.   7.39550  10.37434   5.74616   5.42830   6.24823  13.81157   5.70909
   1991.   7.68057  10.78970   5.67053   5.25359   6.22721  14.29268   5.94434
   1992.   7.82802  10.97829   5.73901   5.40836   6.64688  14.92097   6.19268
   1993.   7.90396  11.07086   5.81440   5.31665   6.69295  14.86704   6.29127
   1994.   8.00714  11.15714   5.82757   5.38022   6.54539  15.04484   6.50138
   1995.   8.18699  11.37962   5.82298   5.51763   6.47497  15.87896   6.64199
   1996.   8.32370  11.52470   5.72017   5.30233   6.04832  16.88546   6.68257
   1997.   8.48063  11.72522   5.77483   5.48756   6.28750  17.28719   7.00619
   1998.   8.54248  12.09110   5.88506   5.31521   6.39261  18.15573   7.05421
   1999.   8.71517  12.35386   5.93090   5.46351   6.30780  18.43192   7.38883
   2000.   8.86219  12.95245   6.15234   6.13307   6.98403  19.40703   7.26417
   2001.   9.05914  13.26191   6.31262   6.16636   6.94528  20.58987   7.67985
   2002.   9.29872  13.71834   6.38389   5.98871   6.64379  21.19647   7.90116
   2003.   9.45262  14.04170   6.45752   5.72617   5.91150  22.23328   8.30968
   2004.   9.66460  14.62494   6.61186   6.29483   5.91280  23.17486   8.52151
   2005.   9.95437  15.24812   6.78587   7.19299   6.07200  24.16659   8.94951
   2006.  10.36341  15.99453   6.97385   7.64919   6.03088  25.54128   9.41351
   2007.  10.71588  16.72282   7.15171   7.95202   5.92852  27.02829   9.71069
   2008.  11.09277  17.53036   7.37007   9.48366   6.58958  27.85875  10.32228
   2009.  11.35477  18.20536   7.33460   8.05430   5.80293  29.06747  10.03213
   2010.  11.57713  18.96744   7.41213   9.40783   5.62178  30.76927  10.51113
   2011.  11.93112  19.56004   7.40492   9.53947   5.68162  32.04965  10.64578
   2012.  12.21270  19.82026   7.48087   8.62293   5.69573  32.89573  10.19783
   2013.  12.50176  20.14774   7.64627   8.92774   6.14136  33.96291  10.13347
   2014.  12.79281  20.40310   7.81764   8.06737   6.21891  34.45058   9.77819
   2015.  12.94752  20.67183   8.01797   7.43538   6.42004  34.85585   9.50519
   2016.  13.08610  20.83614   8.05568   8.23826   6.22315  35.15085  10.29608
   2017.  13.24949  21.17386   8.15994   8.54262   6.33439  35.51986  10.55688
   2018.  13.46374  21.30174   8.34889   9.61275   6.75329  36.17887  11.02915
FORMAT(F8.0,7F10.5)
PRINT YEAR P1-P6 PKS / FORMAT
*NORMALIZE PRICES SO THAT ALL PRICES EQUAL ONE IN 1960
DO #=1,6
GENR CON#=P#(1)
ENDO
DO #=1,6
GENR P#=P#/CON#
GENR Y#=Y#*CON#
ENDO 
FORMAT(F8.0,7F10.5)
PRINT YEAR P1-P6 PKS / FORMAT
FORMAT(F8.0,7F11.3)
PRINT YEAR Y1-Y6 QKS / FORMAT
*SEE IF THE VALUE OF INPUTS IS EQUAL TO THE VALUE OF OUTPUTS
GENR CHECK=P1*Y1+P2*Y2+P3*Y3+P4*Y4+P5*Y5+P6*Y6-PKS*QKS
FORMAT(F8.0,F10.5)
PRINT YEAR CHECK / FORMAT
STAT CHECK
*THE MIN AND MAX FOR CHECK SHOULD BE 0 AND IT IS EXCEPT FOR ROUNDING ERRORS
*P1 IS THE PRICE OF CONSUMPTION, P2 IS THE PRICE OF GOVT OUTPUT, P3 IS THE PRICE OF INVESTMENT
*P4 IS THE PRICE OF EXPORTS, P5 IS THE PRICE OF IMPORTS, P6 IS THE PRICE OF LABOUR 
*PKS IS THE (GROSS) PRICE OF CAPITAL SERVICES (INCLUDES DEPRECIATION) AND Y1,Y2,Y3,Y4,Y5,Y6 AND QKS ARE THE 
*CORRESPONDING QUANTITIES (Y5 AND Y6 ARE NEGATIVE).
*GENR GROSS PROFITS, V
GENR V=P1*Y1+P2*Y2+P3*Y3+P4*Y4+P5*Y5+P6*Y6
GENR PK=PKS
GENR K=QKS
*GENR ALSO VK, THE VALUE OF CAPITAL SERVICES. V AND VK SHOULD BE EQUAL SINCE WE HAVE USED BALANCING REAL RATES OF RETURN
GENR VK=PK*K
FORMAT(F6.0,3F12.3,F12.5)
PRINT YEAR V VK K PK / FORMAT
STAT V VK
*THERE IS A BIT OF ROUNDING ERROR BUT BASICALLY V AND VK ARE EQUAL.
GENR T=TIME(-1)
***
*GENR VARIABLES FOR THE NQ MODEL
*GENR THE AVERAGE VARIABLE OUTPUT AND INPUT QUANTITY VECTOR; WE WILL USE A NORMALIZATION OF THIS VECTOR AS OUR ALPHA VECTOR. 
SMPL 1 60
DO #=1,6
STAT Y# / MEAN=YM#
ENDO
*CHANGE THE SIGNS OF YM5 AND YM6 FROM NEGATIVE TO POSITIVE
SMPL 1 1
GENR YM5=-YM5
GENR YM6=-YM6
GENR YMT=0
DO #=1,6
GENR YMT=YMT+YM#
ENDO
SMPL 1 60;
DO #=1,6
GENR GG#=YM#(1)/YMT(1)
ENDO
FORMAT(13F9.4)
SMPL 1 1
PRINT YM1-YM6 YMT GG1-GG6 / FORMAT
*NOTE THAT THE GG# SUM TO 1; THE GG VECTOR IS OUR ALPHA VECTOR FOR THE NORMALIZED QUADRATIC FUNCTIONAL FORM
SMPL 1 60
DO #=1,6
GENR PG#=P#*GG#
ENDO
GENR PG=0
DO#=1,6
GENR PG=PG+PG#
ENDO
*PG IS THE INNER PRODUCT OF THE PRICE VECTOR p WITH THE ALPHA VECTOR IN THE NQ FUNCTIONAL FORM. IT SHOULD START OFF AT 1
*WHICH IT DOES.
*GENR NORMALIZED PRICES v = p/p.g; I.E., PRICES p DIVIDED BY PG = p.g
DO #=1,6
GENR V#=P#/PG
ENDO
FORMAT(F8.0,7F10.4)
PRINT YEAR PG V1-V6 / FORMAT
*GENR DIFFERENCES OF NORMALIZED PRICES WITH THE FIRST NORMALIZED INPUT PRICE
DO #=1,6
GENR V1#=V#-V1
ENDO
*GENR DIFFERENCES OF NORMALIZED PRICES WITH THE SECOND NORMALIZED INPUT PRICE
DO #=2,6
GENR V2#=V#-V2
ENDO
*GENR DIFFERENCES OF NORMALIZED PRICES WITH THE THIRD NORMALIZED INPUT PRICE
DO #=3,6
GENR V3#=V#-V3
ENDO
*GENR DIFFERENCES OF NORMALIZED PRICES WITH THE FOURTH NORMALIZED INPUT PRICE
DO #=4,6
GENR V4#=V#-V4
ENDO
*OUR NQ UNIT PROFIT FUNCTION WITH A RANK ONE SUBSTITUTION MATRIX IS EQUAL TO P(p) DEFINED AS FOLLOWS:
*P(p) = a.p + b.pt + (1/2)(p.c)(p.c)/p.g
*WHERE a.p = SUM(i=1,6)a(i)p(i); p.c = SUM(i=1,6)p(i)c(i) and p.g = SUM(i=1,6)p(i)g(i) AND
*b.p = SUM(i=1,6)b(i)p(i).
*DENOTE THE VECTOR OF FIRST ORDER PARTIAL DERIVATIVES OF P(p) as DP(p). IT IS EQUAL TO:
*DP(p) = a + bt + c(c.v) - (1/2)g(c.v)(c.v)
*WHERE v = p/p.g.
*WE ALSO NEED TO IMPOSE THE FOLLOWING RESTRICTION ON THE COLUMN VECTOR c: C.1 = 0 WHERE 1 = A VECTOR OF ONES
*WE SET c(1) = -SUM(n=2,6)c(n). THEREFORE c.v = SUM(n=2,6)c(n)(v(n)-v(1)) = SUM(n=2,6)c(n)V1#

*FOR THE RANK 2 SUBSTITUTION MATRIX, WE ADD THE TERM (1/2)(p.d)(p.d)/p.g TO THE UNIT COST FUNCTION.
*WE SET THE FIRST COMPONENT OF THE VECTOR d EQUAL TO 0 SO THAT d(1) = 0 (FOR IDENTIFICATION)
*WE ALSO SET d(2)=-SUM(n=3,6)d(n)

*FOR THE RANK 3 SUBSTITUTION MATRIX, WE ADD THE TERM (1/2)(p.f)(p.f)/p.g TO THE UNIT COST FUNCTION.
*WE SET THE FIRST 2 COMPONENTS OF THE VECTOR f EQUAL TO 0 SO THAT f(1)=f(2)=0 (FOR IDENTIFICATION)
*WE ALSO SET f(3)=-SUM(n=4,6)f(n)

*FOR THE RANK 4 SUBSTITUTION MATRIX, WE ADD THE TERM - (1/2)(p.h)(p.h)/p.g TO THE UNIT COST FUNCTION.
*WE SET THE FIRST 3 COMPONENTS OF THE VECTOR h EQUAL TO 0 SO THAT h(1)=h(2)=h(3)=0 (FOR IDENTIFICATION)
*WE ALSO SET h(4)=-SUM(n=5,6)h(n)

*GENR A NORMALIZED TIME TREND VARIABLE W WHICH STARTS AT 0 FOR OBS 1 AND TRENDS LINEARLY TO END UP AT 1 AT OBS 59 
GENR W=T/58
*NOTE THAT THE STARTING COEFs FOR THE FF# ARE SET EQUAL TO THE FINAL F# FROM PMOD10OUT.TXT, EXCEPT THAT TINY
*FINAL COEFS FROM PMOD9OUT ARE SET EQUAL TO 0.0001.
*WE ALLOW FOR LINEAR TIME TRENDS IN THE C D F AND H VECTORS IN THE SUBSTITUTION MATRIX FOR THIS MODEL 

NL 6 / NCOEF=40 LIST CONV=.000001 ITER=1000 PITER=50 GENRVAR
EQ Y1=(A1+B1*T)*K &
+(-(C2+C3+C4+C5+C6)*(C2*V12+C3*V13+C4*V14+C5*V15+C6*V16) &
-(1/2)*GG1*((H5*V45+H6*V46)**2) &
-(1/2)*GG1*((F4*V34+F5*V35+F6*V36)**2) &
-(1/2)*GG1*((D3*V23+D4*V24+D5*V25+D6*V26)**2) &
-(1/2)*GG1*((C2*V12+C3*V13+C4*V14+C5*V15+C6*V16)**2))*K*(1-W) &
+(-(CC2+CC3+CC4+CC5+CC6)*(CC2*V12+CC3*V13+CC4*V14+CC5*V15+CC6*V16) &
-(1/2)*GG1*((HH5*V45+HH6*V46)**2) &
-(1/2)*GG1*((FF4*V34+FF5*V35+FF6*V36)**2) &
-(1/2)*GG1*((DD3*V23+DD4*V24+DD5*V25+DD6*V26)**2) &
-(1/2)*GG1*((CC2*V12+CC3*V13+CC4*V14+CC5*V15+CC6*V16)**2))*K*W
EQ Y2=(A2+B2*T)*K &
+(C2*(C2*V12+C3*V13+C4*V14+C5*V15+C6*V16) &
-(D3+D4+D5+D6)*(D3*V23+D4*V24+D5*V25+D6*V26)  &
-(1/2)*GG2*((H5*V45+H6*V46)**2) &
-(1/2)*GG2*((F4*V34+F5*V35+F6*V36)**2) &
-(1/2)*GG2*((D3*V23+D4*V24+D5*V25+D6*V26)**2) &
-(1/2)*GG2*((C2*V12+C3*V13+C4*V14+C5*V15+C6*V16)**2))*K*(1-W) &
+(CC2*(CC2*V12+CC3*V13+CC4*V14+CC5*V15+CC6*V16) &
-(DD3+DD4+DD5+DD6)*(DD3*V23+DD4*V24+DD5*V25+DD6*V26)  &
-(1/2)*GG2*((HH5*V45+HH6*V46)**2) &
-(1/2)*GG2*((FF4*V34+FF5*V35+FF6*V36)**2) &
-(1/2)*GG2*((DD3*V23+DD4*V24+DD5*V25+DD6*V26)**2) &
-(1/2)*GG2*((CC2*V12+CC3*V13+CC4*V14+CC5*V15+CC6*V16)**2))*K*W
EQ Y3=(A3+B3*T)*K &
+(C3*(C2*V12+C3*V13+C4*V14+C5*V15+C6*V16) &
+D3*(D3*V23+D4*V24+D5*V25+D6*V26)  &
-(F4+F5+F6)*(F4*V34+F5*V35+F6*V36) &
-(1/2)*GG3*((H5*V45+H6*V46)**2) &
-(1/2)*GG3*((F4*V34+F5*V35+F6*V36)**2) &
-(1/2)*GG3*((D3*V23+D4*V24+D5*V25+D6*V26)**2) &
-(1/2)*GG3*((C2*V12+C3*V13+C4*V14+C5*V15+C6*V16)**2))*K*(1-W) &
+(CC3*(CC2*V12+CC3*V13+CC4*V14+CC5*V15+CC6*V16) &
+DD3*(DD3*V23+DD4*V24+DD5*V25+DD6*V26)  &
-(FF4+FF5+FF6)*(FF4*V34+FF5*V35+FF6*V36) &
-(1/2)*GG3*((HH5*V45+HH6*V46)**2) &
-(1/2)*GG3*((FF4*V34+FF5*V35+FF6*V36)**2) &
-(1/2)*GG3*((DD3*V23+DD4*V24+DD5*V25+DD6*V26)**2) &
-(1/2)*GG3*((CC2*V12+CC3*V13+CC4*V14+CC5*V15+CC6*V16)**2))*K*W
EQ Y4=(A4+B4*T)*K &
+(C4*(C2*V12+C3*V13+C4*V14+C5*V15+C6*V16) &
+D4*(D3*V23+D4*V24+D5*V25+D6*V26)  &
+F4*(F4*V34+F5*V35+F6*V36) &
-(H5+H6)*(H5*V45+H6*V46) &
-(1/2)*GG4*((H5*V45+H6*V46)**2) &
-(1/2)*GG4*((F4*V34+F5*V35+F6*V36)**2) &
-(1/2)*GG4*((D3*V23+D4*V24+D5*V25+D6*V26)**2) &
-(1/2)*GG4*((C2*V12+C3*V13+C4*V14+C5*V15+C6*V16)**2))*K*(1-W) &
+(CC4*(CC2*V12+CC3*V13+CC4*V14+CC5*V15+CC6*V16) &
+DD4*(DD3*V23+DD4*V24+DD5*V25+DD6*V26)  &
+FF4*(FF4*V34+FF5*V35+FF6*V36) &
-(HH5+HH6)*(HH5*V45+HH6*V46) &
-(1/2)*GG4*((HH5*V45+HH6*V46)**2) &
-(1/2)*GG4*((FF4*V34+FF5*V35+FF6*V36)**2) &
-(1/2)*GG4*((DD3*V23+DD4*V24+DD5*V25+DD6*V26)**2) &
-(1/2)*GG4*((CC2*V12+CC3*V13+CC4*V14+CC5*V15+CC6*V16)**2))*K*W
EQ Y5=(A5+B5*T)*K &
+(C5*(C2*V12+C3*V13+C4*V14+C5*V15+C6*V16) &
+D5*(D3*V23+D4*V24+D5*V25+D6*V26) &
+F5*(F4*V34+F5*V35+F6*V36) &
+H5*(H5*V45+H6*V46) &
-(1/2)*GG5*((H5*V45+H6*V46)**2) &
-(1/2)*GG5*((F4*V34+F5*V35+F6*V36)**2) &
-(1/2)*GG5*((D3*V23+D4*V24+D5*V25+D6*V26)**2) &
-(1/2)*GG5*((C2*V12+C3*V13+C4*V14+C5*V15+C6*V16)**2))*K*(1-W) &
+(CC5*(CC2*V12+CC3*V13+CC4*V14+CC5*V15+CC6*V16) &
+DD5*(DD3*V23+DD4*V24+DD5*V25+DD6*V26) &
+FF5*(FF4*V34+FF5*V35+FF6*V36) &
+HH5*(HH5*V45+HH6*V46) &
-(1/2)*GG5*((HH5*V45+HH6*V46)**2) &
-(1/2)*GG5*((FF4*V34+FF5*V35+FF6*V36)**2) &
-(1/2)*GG5*((DD3*V23+DD4*V24+DD5*V25+DD6*V26)**2) &
-(1/2)*GG5*((CC2*V12+CC3*V13+CC4*V14+CC5*V15+CC6*V16)**2))*K*W
EQ Y6=(A6+B6*T)*K &
+(C6*(C2*V12+C3*V13+C4*V14+C5*V15+C6*V16) &
+D6*(D3*V23+D4*V24+D5*V25+D6*V26) &
+F6*(F4*V34+F5*V35+F6*V36) &
+H6*(H5*V45+H6*V46) &
-(1/2)*GG6*((H5*V45+H6*V46)**2) &
-(1/2)*GG6*((F4*V34+F5*V35+F6*V36)**2) &
-(1/2)*GG6*((D3*V23+D4*V24+D5*V25+D6*V26)**2) &
-(1/2)*GG6*((C2*V12+C3*V13+C4*V14+C5*V15+C6*V16)**2))*K*(1-W) &
+(CC6*(CC2*V12+CC3*V13+CC4*V14+CC5*V15+CC6*V16) &
+DD6*(DD3*V23+DD4*V24+DD5*V25+DD6*V26) &
+FF6*(FF4*V34+FF5*V35+FF6*V36) &
+HH6*(HH5*V45+HH6*V46) &
-(1/2)*GG6*((HH5*V45+HH6*V46)**2) &
-(1/2)*GG6*((FF4*V34+FF5*V35+FF6*V36)**2) &
-(1/2)*GG6*((DD3*V23+DD4*V24+DD5*V25+DD6*V26)**2) &
-(1/2)*GG6*((CC2*V12+CC3*V13+CC4*V14+CC5*V15+CC6*V16)**2))*K*W
COEF A1        1.6006    
COEF B1      -0.013558
COEF C2       0.033027
COEF C3      -0.49369    
COEF C4      -0.48154    
COEF C5       0.57615    
COEF C6       0.73784    
COEF H5      -0.0001
COEF H6       0.0001
COEF HH5      0.0001
COEF HH6      0.0001
COEF F4       0.18785    
COEF F5       0.33523    
COEF F6       0.18420    
COEF D3      -0.14856    
COEF D4       0.23872    
COEF D5      -0.10348    
COEF D6       0.44107    
COEF CC2     -0.092961
COEF CC3     -0.48921    
COEF CC4     -0.32411    
COEF CC5       1.2606    
COEF CC6      0.13015    
COEF FF4     -0.0001
COEF FF5     -0.0001
COEF FF6     -0.0001
COEF DD3     -0.34485    
COEF DD4     -0.14272    
COEF DD5      0.33593    
COEF DD6      0.43143    
COEF A2       0.34666    
COEF B2       0.00016254
COEF A3        1.2332    
COEF B3      -0.0052349
COEF A4       0.62974    
COEF B4       0.00035953
COEF A5      -0.67818    
COEF B5      -0.0020214
COEF A6       -1.4873    
COEF B6       0.016486
END
* FINAL LL FROM PMOD10OUT.TXT WAS -352.2840 
* STARTING LL FOR PMOD11.TXT IS   -352.3651, WHICH IS CLOSE TO THE FINAL LL IN PMOD10.TXT.     
* FINAL STATISTICS FOR PMOD11.TXT:  TIME =     0.3540 SEC.   ITER. NO.    52   FUNCT. EVALUATIONS    72
* FINAL LOG-LIKELIHOOD FUNCTION = -352.2840, WHICH IS THE SAME AS THE PMOD10 LL.
* THUS THE NEW HH5 AND HH6 ARE ESTIMATED AS 0's. H5 AND H6 ARE ALSO STILL 0's 
*HERE ARE THE ESTIMATED COEFFICIENTS
*       COEFFICIENT    ST. ERROR   T-RATIO
* A1        1.6006     0.49155E-01  32.562
* B1      -0.13558E-01 0.14381E-02 -9.4274
* C2       0.33027E-01 0.11540     0.28620
* C3      -0.49369     0.43325     -1.1395
* C4      -0.48154     0.18954     -2.5406
* C5       0.57615     0.17656      3.2632
* C6       0.73784     0.12424      5.9386
* H5      -0.15812E-08 0.17885    -0.88405E-08
* H6      -0.56345E-08 0.23849    -0.23626E-07
* F4       0.18785     0.27313     0.68778
* F5       0.33523     0.35330     0.94886
* F6       0.18420     0.31036     0.59350
* D3      -0.14856     0.28349    -0.52405
* D4       0.23872     0.14414      1.6562
* D5      -0.10348     0.16536    -0.62578
* D6       0.44107     0.17056      2.5860
* CC2     -0.92961E-01 0.50328E-01 -1.8471
* CC3     -0.48921     0.17675     -2.7677
* CC4     -0.32411     0.59175E-01 -5.4771
* CC5       1.2606     0.12202      10.331
* CC6      0.13015     0.79121E-01  1.6449
* HH5      0.64344E-08 0.23707     0.27141E-07
* HH6     -0.43493E-08 0.12761    -0.34083E-07
* FF4     -0.63112E-08 0.23777    -0.26543E-07
* FF5     -0.19997E-08 0.36107    -0.55382E-08
* FF6     -0.13482E-07 0.22716    -0.59349E-07
* DD3     -0.34485     0.18356     -1.8787
* DD4     -0.14272     0.63618E-01 -2.2434
* DD5      0.33593     0.21544      1.5593
* DD6      0.43143     0.33146E-01  13.016
* A2       0.34666     0.13850E-01  25.029
* B2       0.16254E-03 0.43964E-03 0.36970
* A3        1.2332     0.10057      12.263
* B3      -0.52349E-02 0.29302E-02 -1.7866
* A4       0.62974     0.68620E-01  9.1772
* B4       0.35953E-03 0.13815E-02 0.26025
* A5      -0.67818     0.68998E-01 -9.8290
* B5      -0.20214E-02 0.23412E-02-0.86339
* A6       -1.4873     0.28443E-01 -52.293
* B6       0.16486E-01 0.99365E-03  16.591
*R SQUARES ARE:0.9824 0.9801 0.9422 0.9581 0.9819 0.9395; STILL NOT GREAT BUT BETTER THAN CANADA!
*THE STANDARD ERRORS FOR SOME ELEMENTS OF THE SUBSTITUTION MATRIX ARE RATHER LARGE; HENCE WE WILL NOT BE ABLE 
*TO GENERATE VERY ACCURATE PRICE ELASTICITIES OF NET SUPPLY
*BREAK POINTS FOR THE CANADIAN DATA (WE WILL USE THESE BREAK POINTS IN THE FOLLOWING MODEL)
*EQ1: 11 23 32 43 49 58
*EQ2: 13 17 24 27 31 43
*EQ3: 30 33 40 49 51 53
*EQ4: 25 29 31 42 53 57
*EQ5: 14 23 25 27 33 49
*EQ6: 23 33 44 47 49 58

*NOT DONE

*LET US SEE HOW THE ELASTICITIES TURN OUT AND COMPARE THEM WITH THE ELASTICITIES FROM PMOD7OUT.TXT

*FIRST GENR THE C VECTOR AND THEN C TIMES C TRANSPOSE = THE C MATRIX
SMPL 1 60
GENR C1=0
DO #=2,6
GENR C1=C1-C#
ENDO
SMPL 1 1
FORMAT(6F10.6)
PRINT C1-C6 / FORMAT
*GENR THE ELEMENTS OF THE 6X6 RANK ONE C MATRIX
DO #=1,6
DO $=1,6
GENR C#$=C#(1)*C$(1)
ENDO
ENDO
*GENR THE D VECTOR AND THEN D TIMES D TRANSPOSE = THE D MATRIX
SMPL 1 60
GENR D1=0
GENR D2=0
DO #=3,6
GENR D2=D2-D#
ENDO
SMPL 1 1
FORMAT(6F10.6)
PRINT D1-D6 / FORMAT
*GENR THE ELEMENTS OF THE 6X6 RANK ONE D MATRIX
DO #=1,6
DO $=1,6
GENR D#$=D#(1)*D$(1)
ENDO
ENDO
*GENR THE F VECTOR AND THEN F TIMES F TRANSPOSE = THE F MATRIX
SMPL 1 60
GENR F1=0
GENR F2=0
GENR F3=0
DO #=4,6
GENR F3=F3-F#
ENDO
SMPL 1 1
FORMAT(6F10.6)
PRINT F1-F6 / FORMAT
*GENR THE ELEMENTS OF THE 6X6 RANK ONE F MATRIX
DO #=1,6
DO $=1,6
GENR F#$=F#(1)*F$(1)
ENDO
ENDO
*GENR THE H VECTOR AND THEN H TIMES H TRANSPOSE = THE H MATRIX
SMPL 1 60
GENR H1=0
GENR H2=0
GENR H3=0
GENR H4=0
DO #=5,6
GENR H4=H4-H#
ENDO
SMPL 1 1
FORMAT(6F10.6)
PRINT H1-H6 / FORMAT
*GENR THE ELEMENTS OF THE 6X6 RANK ONE H MATRIX
DO #=1,6
DO $=1,6
GENR H#$=H#(1)*H$(1)
ENDO
ENDO

*ADD THE D, F AND H MATRICES TO THE C MATRIX
DO #=1,6
DO $=1,6
GENR C#$=C#$+D#(1)*D$(1)+F#(1)*F$(1)+H#(1)*H$(1)
ENDO
ENDO

*GENR THE INNER PRODUCT OF ROW # OF THE NEW C MATRIX WITH THE VECTOR OF NORMALIZED PRICES FOR EACH OBSERVATION
SMPL 1 60
DO #=1,6
GENR CV#=C#1(1)*V1+C#2(1)*V2+C#3(1)*V3+C#4(1)*V4+C#5(1)*V5+C#6(1)*V6
ENDO 
*GENR V TRANSPOSE TIMES THE C MATRIX TIMES V
GENR VCV=0
DO #=1,6
GENR VCV=VCV+V#*CV#
ENDO
FORMAT(F8.0,7F10.5)
PRINT YEAR VCV CV1-CV6 / FORMAT
*THESE NUMBERS SHOULD ALL START AT 0 AND THEY DO.

*NOW PERFORM THE SAME OPERATIONS TO CONSTRUCT THE CC DD FF AND HH MATRICES
SMPL 1 60
GENR CC1=0
DO #=2,6
GENR CC1=CC1-CC#
ENDO
SMPL 1 1
FORMAT(6F10.6)
PRINT CC1-CC6 / FORMAT
PRINT C1-C6 / FORMAT
*GENR THE ELEMENTS OF THE 6X6 RANK ONE CC MATRIX
DO #=1,6
DO $=1,6
GENR CC#$=CC#(1)*CC$(1)
ENDO
ENDO
*GENR THE DD VECTOR AND THEN DD TIMES DD TRANSPOSE = THE DD MATRIX
SMPL 1 60
GENR DD1=0
GENR DD2=0
DO #=3,6
GENR DD2=DD2-DD#
ENDO
SMPL 1 1
FORMAT(6F10.6)
PRINT DD1-DD6 / FORMAT
PRINT D1-D6 / FORMAT
*GENR THE ELEMENTS OF THE 6X6 RANK ONE DD MATRIX
DO #=1,6
DO $=1,6
GENR DD#$=DD#(1)*DD$(1)
ENDO
ENDO
*GENR THE FF VECTOR AND THEN FF TIMES FF TRANSPOSE = THE FF MATRIX
SMPL 1 60
GENR FF1=0
GENR FF2=0
GENR FF3=0
DO #=4,6
GENR FF3=FF3-FF#
ENDO
SMPL 1 1
FORMAT(6F10.6)
PRINT FF1-FF6 / FORMAT
PRINT F1-F6 / FORMAT
*GENR THE ELEMENTS OF THE 6X6 RANK ONE FF MATRIX
DO #=1,6
DO $=1,6
GENR FF#$=FF#(1)*FF$(1)
ENDO
ENDO
*GENR THE HH VECTOR AND THEN HH TIMES HH TRANSPOSE = THE HH MATRIX
SMPL 1 60
GENR HH1=0
GENR HH2=0
GENR HH3=0
GENR HH4=0
DO #=5,6
GENR HH4=HH4-HH#
ENDO
SMPL 1 1
FORMAT(6F10.6)
PRINT HH1-HH6 / FORMAT
PRINT H1-H6 / FORMAT 
*GENR THE ELEMENTS OF THE 6X6 RANK ONE HH MATRIX
DO #=1,6
DO $=1,6
GENR HH#$=HH#(1)*HH$(1)
ENDO
ENDO

*ADD THE DD, FF AND HH MATRICES TO THE CC MATRIX
DO #=1,6
DO $=1,6
GENR CC#$=CC#$+DD#(1)*DD$(1)+FF#(1)*FF$(1)+HH#(1)*HH$(1)
ENDO
ENDO

*GENR THE INNER PRODUCT OF ROW # OF THE NEW CC MATRIX WITH THE VECTOR OF NORMALIZED PRICES FOR EACH OBSERVATION
SMPL 1 60
DO #=1,6
GENR CCV#=CC#1(1)*V1+CC#2(1)*V2+CC#3(1)*V3+CC#4(1)*V4+CC#5(1)*V5+CC#6(1)*V6
ENDO 
*GENR V TRANSPOSE TIMES THE CC MATRIX TIMES V
GENR VCCV=0
DO #=1,6
GENR VCCV=VCCV+V#*CCV#
ENDO
FORMAT(F8.0,7F10.5)
PRINT YEAR VCV CV1-CV6 / FORMAT
PRINT YEAR VCCV CCV1-CCV6 / FORMAT
*THESE NUMBERS SHOULD ALL START AT 0 AND THEY DO.

*GENR A NEW FINAL SUBSTITUTION MATRIX CF WHICH IS EQUAL TO C*(1-W) + CC*W
SMPL 1 60
DO #=1,6
DO $=1,6
GENR CF#$=C#$(1)*(1-W)+CC#$(1)*W
ENDO
ENDO

*GENR THE INNER PRODUCT OF ROW # OF THE NEW CF MATRIX WITH THE VECTOR OF NORMALIZED PRICES FOR EACH OBSERVATION
SMPL 1 60
DO #=1,6
GENR CFV#=CF#1*V1+CF#2*V2+CF#3*V3+CF#4*V4+CF#5*V5+CF#6*V6
ENDO 
*GENR V TRANSPOSE TIMES THE CF MATRIX TIMES V
GENR VCFV=0
DO #=1,6
GENR VCFV=VCFV+V#*CFV#
ENDO
FORMAT(F8.0,7F10.5)
PRINT YEAR VCFV CFV1-CFV6 / FORMAT
PRINT YEAR VCV CV1-CV6 / FORMAT
PRINT YEAR VCCV CCV1-CCV6 / FORMAT
STAT VCFV VCV VCCV CFV1-CFV6 CV1-CV6 CCV1-CCV6  

*GENR FITTED DEMANDS WHICH ARE ALSO FIRST ORDER PARTIAL DERIVATIVES OF THE PROFIT FUNCTION
SMPL 1 60
DO #=1,6
GENR FY#=(A#+B#*T+CF#1*V1+CF#2*V2+CF#3*V3+CF#4*V4+CF#5*V5+CF#6*V6-.5*GG#(1)*VCFV)*K
ENDO
FORMAT(F8.0,12F9.3)
PRINT YEAR Y1 FY1 Y2 FY2 Y3 FY3 Y4 FY4 Y5 FY5 Y6 FY6 / FORMAT

STAT Y1 FY1 Y2 FY2 Y3 FY3 Y4 FY4 Y5 FY5 Y6 FY6
*THE FITTED SERIES FY# ARE STILL NOT THAT CLOSE TO THE CORRESPONDING ACTUAL SERIES Y#
*FY# SHOULD COINCIDE WITH THE FITTED VALUES IN EQ # IN THE ABOVE NONLINEAR REGRESSION
*THIS CHECK PASSES FOR AUSTRALIA

*GENR THE FITTED V
GENR FV=0
DO #=1,6
GENR FV=FV+P#*FY#
ENDO

*GENR A MEASURE OF TECHNICAL PROGRESS (THE PARTIAL DERIVATIVE OF VARIABLE PROFITS WRT TIME DIVIDED BY
*THE (FITTED) VALUE OF LABOUR AND CAPITAL INPUT
*SINCE THE SUBSTITUTION MATRIX IS NOW A FUNCTION OF T, THERE WILL BE A NEW ADDITIONAL TERM TO OUR 
*OLD MEASURE OF TECHNICAL PROGRESS. CALL THIS NEW TERM BIAS0
*WE WILL CALCULATE THIS NEW TERM BY DIFFERENCING THE SUBSTITUTION MATRIX CF#$
SMPL 2 60
DO #=1,6
DO $=1,6
GENR DCF#$=CF#$-LAG(CF#$)
ENDO
ENDO
DO #=1,6
GENR BIAS0#=DCF#1*P1+DCF#2*P2+DCF#3*P3+DCF#4*P4+DCF#5*P5+DCF#6*P6
ENDO
GENR BIAS0=0
DO #=1,6
GENR BIAS0= BIAS0+P#*BIAS0#
ENDO
GENR BIAS0=(.5*BIAS0*K)/(PG*(FV-P6*FY6))
*DEFINE THE NET OUTPUT BIAS CONTRIBUTION TERMS BIAS1-BIAS6; THESE BIAS TERMS ARE THE SAME AS IN PMOD7OUT.TXT
DO #=1,6
GENR BIAS#=B#*P#*K/(FV-P6*FY6)
ENDO
GENR TECH=BIAS0
DO #=1,6
GENR TECH=TECH+BIAS#
ENDO 
FORMAT(F8.0,8F10.5,2F10.3)
PRINT YEAR TECH BIAS0 BIAS1-BIAS6 V FV / FORMAT
STAT TECH BIAS0 BIAS1-BIAS6 V FV
* NAME         N    MEAN        ST. DEV      VARIANCE     MINIMUM      MAXIMUM
* TECH         59  0.33676E-02 0.26923E-02 0.72484E-05 -0.12167E-02  0.73142E-02
* BIAS0        59 -0.28190E-02 0.24029E-02 0.57738E-05 -0.78280E-02  0.16790E-04
* BIAS1        59 -0.68728E-02 0.14329E-02 0.20531E-05 -0.88138E-02 -0.44497E-02
* BIAS2        59  0.10849E-03 0.29594E-04 0.87579E-09  0.53724E-04  0.14936E-03
* BIAS3        59 -0.18874E-02 0.15562E-03 0.24219E-07 -0.21493E-02 -0.16100E-02
* BIAS4        59  0.12880E-03 0.12796E-04 0.16375E-09  0.10278E-03  0.15749E-03
* BIAS5        59 -0.69518E-03 0.14576E-03 0.21245E-07 -0.10049E-02 -0.45222E-03
* BIAS6        59  0.15405E-01 0.63297E-02 0.40065E-04  0.54161E-02  0.25543E-01
* V            59   234.76      250.03      62515.       7.0106       864.71
* FV           59   233.24      255.02      65037.       11.555       946.67
*NOTE THAT WE HAVE DEFINED TECH ONLY FOR THE YEARS 1960-2018, SIMILAR TO OUR INDEX NUMBER ESTIMATES
*NOTE THAT BIAS0 ADDS A NEGATIVE CONTRIBUTION TO TECH. THE ELEMENTS IN THE FINAL
*SUBSTITUTION MATRIX TEND TO BE SMALLER IN MAGNITUDE THAN THE ELEMENTS IN THE INITIAL SUBSTITUTION MATRIX
*AND SO THIS ADDS A NEGATIVE TREND TO TECH. AVERAGE TECH IS NOW ONLY .34% PER YEAR!
*BIAS6 IS FAIRLY LARGE AND POSITIVE SO TECHNICAL PROGRESS IS PRIMARILY LABOUR SAVING!
*FITTED V (FV) IS STILL NOT THAT CLOSE TO ACTUAL V; THUS OUR ESTIMATES OF TECHNICAL PROGRESS WILL NOT BE ACCURATE (YET).
*FOR COMPARISON PURPOSES, HERE ARE THE ESTIMATES FOR TECH FROM PMOD7OUT.TXT
* NAME         N    MEAN        ST. DEV      VARIANCE     MINIMUM      MAXIMUM
* TECH         60  0.46873E-02 0.17952E-02 0.32226E-05  0.25308E-02  0.80830E-02
* BIAS1        60 -0.14472E-02 0.22884E-03 0.52367E-07 -0.18327E-02 -0.11046E-02
* BIAS2        60  0.31035E-03 0.73563E-04 0.54115E-08  0.18200E-03  0.43481E-03
* BIAS3        60  0.66717E-02 0.38860E-03 0.15101E-06  0.57248E-02  0.74380E-02
* BIAS4        60  0.16558E-02 0.12565E-03 0.15788E-07  0.14013E-02  0.19309E-02
* BIAS5        60 -0.60381E-02 0.11906E-02 0.14175E-05 -0.85447E-02 -0.38271E-02
* BIAS6        60  0.35347E-02 0.13734E-02 0.18862E-05  0.14941E-02  0.60187E-02
* V            60   230.96      249.65      62323.       6.6994       864.71
* FV           60   229.46      256.97      66032.       9.1988       956.54

*WE DO NOT HAVE TO CHECK CURVATURE CONDITIONS FOR THIS FUNCTIONAL FORM; THEY ARE AUTOMATICALLY SATISFIED
*HOWEVER, WE STILL NEED TO CALCULATE ELASTICITIES OF NET SUPPLY FOR THIS MODEL
*GENR THE MATRIX OF SECOND ORDER PARTIAL DERIVATIVES OF THE UNIT PROFIT FUNCTION WRT VARIABLE PRICES FOR EACH PERIOD
SMPL 1 60
DO #=1,6
DO $=1,6
GENR DC#$=(CF#$-CFV#*GG$(1)-GG#(1)*CFV$+GG#(1)*GG$(1)*VCFV)/PG
ENDO
ENDO
FORMAT(F8.0,6F11.6)
PRINT YEAR DC11 DC12 DC13 DC14 DC15 DC16 / FORMAT
PRINT YEAR DC21 DC22 DC23 DC24 DC25 DC26 / FORMAT
PRINT YEAR DC31 DC32 DC33 DC34 DC35 DC36 / FORMAT
PRINT YEAR DC41 DC42 DC43 DC44 DC45 DC46 / FORMAT
PRINT YEAR DC51 DC52 DC53 DC54 DC55 DC56 / FORMAT
PRINT YEAR DC61 DC62 DC63 DC64 DC65 DC66 / FORMAT
*THESE DERIVATIVES ARE TRENDING DOWNWARD BECAUSE WE ARE DIVIDING EACH TERM BY PG WHICH TRENDS UPWARD; I.E., THE SECOND
*ORDER DERIVATIVES OF THE PROFIT FUNCTION ARE HOMOGEOUS OF DEGREE MINUS 1 IN PRICE p WHICH TREND UP AND SO THE 2nd
*DERIVATIVES WILL IN GENERAL TREND DOWN.

*GENR THE MATRIX OF NET SUPPLY PRICE ELASTICITIES
DO #=1,6
DO $=1,6
GENR E#$=DC#$*P$*K/FY#
ENDO
ENDO
*GENR CHECKS ON OUR COMPUTATIONS
DO #=1,6
GENR CHECK#=E#1+E#2+E#3+E#4+E#5+E#6
ENDO
STAT CHECK1-CHECK6
*ALL CHECK# SHOULD EQUAL 0 AND THEY DO. NOTE THAT A NUMBER LIKE 0.17347E-16 IS 0 (PLUS ROUNDING ERROR)
FORMAT(F8.0,6F10.4)
PRINT YEAR E11 E12 E13 E14 E15 E16 / FORMAT
STAT E11 E12 E13 E14 E15 E16
PRINT YEAR E21 E22 E23 E24 E25 E26 / FORMAT
STAT E21 E22 E23 E24 E25 E26
PRINT YEAR E31 E32 E33 E34 E35 E36 / FORMAT
STAT E31 E32 E33 E34 E35 E36
PRINT YEAR E41 E42 E43 E44 E45 E46 / FORMAT
STAT E41 E42 E43 E44 E45 E46
PRINT YEAR E51 E52 E53 E54 E55 E56 / FORMAT
STAT E51 E52 E53 E54 E55 E56
PRINT YEAR E61 E62 E63 E64 E65 E66 / FORMAT
STAT E61 E62 E63 E64 E65 E66 

*LIST THE OWN ELASTICITIES OF NET SUPPLY
PRINT YEAR E11 E22 E33 E44 E55 E66 / FORMAT
STAT E11 E22 E33 E44 E55 E66
*   YEAR       E11       E22       E33       E44       E55       E66
*   1959.    0.0864    0.5309    0.6212    0.5147   -0.6710   -0.5196
*   1960.    0.0951    0.5284    0.6216    0.5044   -0.7031   -0.5321
*   1961.    0.1013    0.5399    0.6233    0.5059   -0.7341   -0.5488
*   1962.    0.0997    0.5344    0.6095    0.4973   -0.7546   -0.5361
*   1963.    0.0943    0.5499    0.5912    0.4930   -0.7370   -0.5370
*   1964.    0.1016    0.5450    0.6012    0.4849   -0.7613   -0.5581
*   1965.    0.1079    0.5498    0.6042    0.4804   -0.7866   -0.5767
*   1966.    0.1120    0.5527    0.6027    0.4727   -0.7966   -0.5902
*   1967.    0.1202    0.5518    0.6102    0.4637   -0.8243   -0.6102
*   1968.    0.1285    0.5706    0.6228    0.4647   -0.8367   -0.6526
*   1969.    0.1296    0.5729    0.6315    0.4585   -0.8336   -0.6765
*   1970.    0.1475    0.5907    0.6592    0.4596   -0.8880   -0.7277
*   1971.    0.1606    0.5949    0.6828    0.4682   -0.9862   -0.7488
*   1972.    0.1509    0.6205    0.6526    0.4753   -0.9225   -0.7583
*   1973.    0.1486    0.6433    0.6496    0.4814   -0.8941   -0.7872
*   1974.    0.1784    0.6845    0.7254    0.5329   -1.1052   -0.8680
*   1975.    0.1893    0.6841    0.7376    0.5160   -1.1329   -0.8949
*   1976.    0.2013    0.6888    0.7539    0.5232   -1.2451   -0.9105
*   1977.    0.2171    0.6827    0.7758    0.5223   -1.4030   -0.9178
*   1978.    0.2236    0.6805    0.7701    0.5256   -1.5080   -0.9107
*   1979.    0.2210    0.6748    0.7651    0.5495   -1.6627   -0.8842
*   1980.    0.2315    0.6906    0.7732    0.5499   -1.7254   -0.9135
*   1981.    0.2401    0.7094    0.7747    0.5276   -1.6513   -0.9611
*   1982.    0.2495    0.7188    0.7810    0.5199   -1.6953   -0.9861
*   1983.    0.2536    0.7291    0.7724    0.5033   -1.6371   -1.0147
*   1984.    0.2611    0.7277    0.7740    0.5078   -1.7761   -1.0093
*   1985.    0.2786    0.7111    0.8067    0.5129   -2.1398   -0.9877
*   1986.    0.2856    0.6894    0.7963    0.4852   -2.2176   -0.9656
*   1987.    0.2729    0.6814    0.7404    0.4521   -1.9078   -0.9674
*   1988.    0.2443    0.6680    0.6529    0.3972   -1.4110   -0.9696
*   1989.    0.2466    0.6648    0.6372    0.3831   -1.3919   -0.9727
*   1990.    0.2684    0.6922    0.6480    0.3719   -1.4330   -1.0271
*   1991.    0.2807    0.7038    0.6334    0.3534   -1.4260   -1.0475
*   1992.    0.2991    0.7213    0.6588    0.3644   -1.6030   -1.0744
*   1993.    0.2990    0.7035    0.6412    0.3454   -1.6093   -1.0521
*   1994.    0.2931    0.6939    0.6121    0.3288   -1.5169   -1.0465
*   1995.    0.2981    0.7141    0.6051    0.3243   -1.4704   -1.0878
*   1996.    0.3059    0.7523    0.5990    0.3068   -1.3369   -1.1659
*   1997.    0.3116    0.7518    0.5929    0.3059   -1.4004   -1.1631
*   1998.    0.3261    0.7828    0.6134    0.2988   -1.4618   -1.2111
*   1999.    0.3161    0.7649    0.5765    0.2838   -1.3734   -1.1899
*   2000.    0.3247    0.7791    0.5897    0.3065   -1.5619   -1.1920
*   2001.    0.3276    0.8007    0.5896    0.2956   -1.5088   -1.2350
*   2002.    0.3183    0.7923    0.5538    0.2667   -1.3512   -1.2339
*   2003.    0.3002    0.7969    0.5181    0.2343   -1.0919   -1.2691
*   2004.    0.2853    0.7828    0.4868    0.2326   -1.0262   -1.2528
*   2005.    0.2700    0.7595    0.4533    0.2365   -0.9871   -1.2222
*   2006.    0.2598    0.7515    0.4264    0.2270   -0.9153   -1.2172
*   2007.    0.2520    0.7520    0.4058    0.2164   -0.8495   -1.2233
*   2008.    0.2415    0.7120    0.3771    0.2290   -0.9012   -1.1598
*   2009.    0.2417    0.7447    0.3642    0.1890   -0.7723   -1.2038
*   2010.    0.2204    0.7254    0.3299    0.1936   -0.6894   -1.1896
*   2011.    0.2216    0.7331    0.3158    0.1858   -0.6842   -1.1899
*   2012.    0.2311    0.7544    0.3169    0.1660   -0.6970   -1.2004
*   2013.    0.2362    0.7537    0.3136    0.1646   -0.7540   -1.1847
*   2014.    0.2419    0.7586    0.3123    0.1441   -0.7716   -1.1703
*   2015.    0.2471    0.7628    0.3130    0.1288   -0.8115   -1.1502
*   2016.    0.2255    0.7105    0.2816    0.1263   -0.7431   -1.0992
*   2017.    0.2179    0.6853    0.2656    0.1208   -0.7423   -1.0593
*   2018.    0.2124    0.6496    0.2523    0.1252   -0.7744   -1.0152
* NAME        N    MEAN        ST. DEV      VARIANCE     MINIMUM      MAXIMUM
* E11          60  0.22420     0.70850E-01 0.50197E-02  0.86354E-01  0.32762
* E22          60  0.68412     0.79013E-01 0.62431E-02  0.52840      0.80070
* E33          60  0.58444     0.15674     0.24567E-01  0.25234      0.80670
* E44          60  0.37175     0.13881     0.19269E-01  0.12080      0.54987
* E55          60  -1.1667     0.41053     0.16854      -2.2176     -0.67096
* E66          60 -0.96712     0.22998     0.52893E-01  -1.2691     -0.51963
*NOTE THAT ALL E## ARE POSITIVE FOR #=1,4 AND E55 AND E66 ARE NEGATIVE (WHICH IS CONSISTENT WITH OUR THEORY)
*THESE ELASTICITIES ARE VERY REASONABLE BUT NOTE THAT THEY ARE STILL TRENDING QUITE A BIT
*FOR COMPARISON PURPOSES, WE LIST THE AVERAGE OWN ELASTICITIES FROM PMOD7OUT.TXT
* NAME         N    MEAN       ST. DEV     VARIANCE     MINIMUM      MAXIMUM
* E11          60  0.26689     0.82436E-01 0.67956E-02  0.14110      0.40729
* E22          60  0.37216     0.11141     0.12412E-01  0.20117      0.57995
* E33          60   1.3701     0.17892     0.32011E-01   1.1210       1.7827
* E44          60  0.20892     0.52371E-01 0.27428E-02  0.13063      0.32746
* E55          60  -1.7291     0.89682     0.80428      -3.3044     -0.49707
* E66          60  -1.1063     0.55579     0.30890      -2.2263     -0.40863
*WHICH SET OF ELASTICITIES IS MORE PLAUSIBLE? BEFORE ANSWERING THIS QUESTION, WE NEED TO 
*IMPROVE OUR ESTIMATES OF TECHNICAL PROGRESS, WHICH WE WILL DO IN THE SUBSEQUENT FILE.
STOP  

